<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Jeremy Selva" />


<title>Chapter 6 Lab</title>

<script src="rmarkdown_libs/header-attrs-2.13/header-attrs.js"></script>
<script src="rmarkdown_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="rmarkdown_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="rmarkdown_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="rmarkdown_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="rmarkdown_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="rmarkdown_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="rmarkdown_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="rmarkdown_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="rmarkdown_libs/navigation-1.1/tabsets.js"></script>
<script src="rmarkdown_libs/navigation-1.1/codefolding.js"></script>
<script src="rmarkdown_libs/navigation-1.1/sourceembed.js"></script>
<script src="rmarkdown_libs/core-js-2.5.3/shim.min.js"></script>
<script src="rmarkdown_libs/react-17.0.0/react.min.js"></script>
<script src="rmarkdown_libs/react-17.0.0/react-dom.min.js"></script>
<script src="rmarkdown_libs/reactwidget-1.0.0/react-tools.js"></script>
<script src="rmarkdown_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="rmarkdown_libs/reactable-binding-0.2.3/reactable.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>


<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>





<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore"><strong>Chapter 6 Lab</strong></h1>
<h3 class="subtitle">This document was prepared on 2022-03-30.</h3>
<h4 class="author">Jeremy Selva</h4>

</div>


<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaps)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(report)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reactable)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vip)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(doParallel)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parsnip)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rsample)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(recipes)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tune)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(workflows)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dials)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(yardstick)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co"># For recipes::step_pls</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Warning message:</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co">#  `step_pls()` failed: Error in loadNamespace(x) : there is no package called ‘mixOmics’</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Install from Bioconductor</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mixOmics)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(report<span class="sc">::</span><span class="fu">report</span>(<span class="fu">sessionInfo</span>()))</span></code></pre></div>
<p>The analysis was done using the R Statistical language (v4.1.3; R Core Team, 2022) on Windows 10 x64, using the packages vip (v0.3.2), workflows (v0.2.6), Matrix (v1.4.0), ISLR (v1.4), reactable (v0.2.3), ggplot2 (v3.3.5), forcats (v0.5.1), scales (v1.1.1), tidyr (v1.2.0), dplyr (v1.0.8), glmnet (v4.1.3), rsample (v0.1.1), tibble (v3.1.6), report (v0.5.1), tune (v0.2.0), yardstick (v0.0.9), parsnip (v0.2.1), recipes (v0.2.0), dials (v0.1.0), foreach (v1.5.2), doParallel (v1.0.17), iterators (v1.0.14), mixOmics (v6.18.1), lattice (v0.20.45), magrittr (v2.0.2), leaps (v3.1) and MASS (v7.3.55).</p>
<div id="subset-selection-methods" class="section level1">
<h1>Subset Selection Methods</h1>
<div id="best-subset-selection" class="section level2">
<h2>Best Subset Selection</h2>
<p>We will be using the <code>Hitters</code> data set from the <code>ISLR</code> package. We wish to predict the baseball players <code>Salary</code> based on several different characteristics which are included in the data set.</p>
<p>Remove all rows with missing data from that column.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>Hitters <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(ISLR<span class="sc">::</span>Hitters) <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">drop_na</span>()</span></code></pre></div>
<p>Use <code>regsubsets()</code> function to performs best subset selection.</p>
<p>An asterisk indicates that a given variable is included in the corresponding model. For instance, this output indicates that the best two-variable model contains only Hits and CRBI.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>regfit.full <span class="ot">&lt;-</span> leaps<span class="sc">::</span><span class="fu">regsubsets</span>(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> Salary <span class="sc">~</span> .,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> Hitters,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">nvmax =</span> <span class="dv">8</span> <span class="co"># default</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(regfit.full)</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; Subset selection object
&gt; Call: regsubsets.formula(x = Salary ~ ., data = Hitters, nvmax = 8)
&gt; 19 Variables  (and intercept)
&gt;            Forced in Forced out
&gt; AtBat          FALSE      FALSE
&gt; Hits           FALSE      FALSE
&gt; HmRun          FALSE      FALSE
&gt; Runs           FALSE      FALSE
&gt; RBI            FALSE      FALSE
&gt; Walks          FALSE      FALSE
&gt; Years          FALSE      FALSE
&gt; CAtBat         FALSE      FALSE
&gt; CHits          FALSE      FALSE
&gt; CHmRun         FALSE      FALSE
&gt; CRuns          FALSE      FALSE
&gt; CRBI           FALSE      FALSE
&gt; CWalks         FALSE      FALSE
&gt; LeagueN        FALSE      FALSE
&gt; DivisionW      FALSE      FALSE
&gt; PutOuts        FALSE      FALSE
&gt; Assists        FALSE      FALSE
&gt; Errors         FALSE      FALSE
&gt; NewLeagueN     FALSE      FALSE
&gt; 1 subsets of each size up to 8
&gt; Selection Algorithm: exhaustive
&gt;          AtBat Hits HmRun Runs RBI Walks Years CAtBat CHits CHmRun CRuns CRBI
&gt; 1  ( 1 ) &quot; &quot;   &quot; &quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot; &quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot;*&quot; 
&gt; 2  ( 1 ) &quot; &quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot; &quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot;*&quot; 
&gt; 3  ( 1 ) &quot; &quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot; &quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot;*&quot; 
&gt; 4  ( 1 ) &quot; &quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot; &quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot;*&quot; 
&gt; 5  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot; &quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot;*&quot; 
&gt; 6  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot;*&quot; 
&gt; 7  ( 1 ) &quot; &quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot;*&quot;    &quot;*&quot;   &quot;*&quot;    &quot; &quot;   &quot; &quot; 
&gt; 8  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot;*&quot;    &quot;*&quot;   &quot; &quot; 
&gt;          CWalks LeagueN DivisionW PutOuts Assists Errors NewLeagueN
&gt; 1  ( 1 ) &quot; &quot;    &quot; &quot;     &quot; &quot;       &quot; &quot;     &quot; &quot;     &quot; &quot;    &quot; &quot;       
&gt; 2  ( 1 ) &quot; &quot;    &quot; &quot;     &quot; &quot;       &quot; &quot;     &quot; &quot;     &quot; &quot;    &quot; &quot;       
&gt; 3  ( 1 ) &quot; &quot;    &quot; &quot;     &quot; &quot;       &quot;*&quot;     &quot; &quot;     &quot; &quot;    &quot; &quot;       
&gt; 4  ( 1 ) &quot; &quot;    &quot; &quot;     &quot;*&quot;       &quot;*&quot;     &quot; &quot;     &quot; &quot;    &quot; &quot;       
&gt; 5  ( 1 ) &quot; &quot;    &quot; &quot;     &quot;*&quot;       &quot;*&quot;     &quot; &quot;     &quot; &quot;    &quot; &quot;       
&gt; 6  ( 1 ) &quot; &quot;    &quot; &quot;     &quot;*&quot;       &quot;*&quot;     &quot; &quot;     &quot; &quot;    &quot; &quot;       
&gt; 7  ( 1 ) &quot; &quot;    &quot; &quot;     &quot;*&quot;       &quot;*&quot;     &quot; &quot;     &quot; &quot;    &quot; &quot;       
&gt; 8  ( 1 ) &quot;*&quot;    &quot; &quot;     &quot;*&quot;       &quot;*&quot;     &quot; &quot;     &quot; &quot;    &quot; &quot;</code></pre>
<p>Here we fit up to a 19-variable model.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>regfit.full <span class="ot">&lt;-</span> leaps<span class="sc">::</span><span class="fu">regsubsets</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> Salary <span class="sc">~</span> .,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> Hitters,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">nvmax =</span> <span class="dv">19</span> <span class="co"># default</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>The <code>summary()</code> function also returns <span class="math inline">\(R^2\)</span>, <span class="math inline">\(RSS\)</span>, adjusted <span class="math inline">\(R^2\)</span>, <span class="math inline">\(C_p\)</span>, and <span class="math inline">\(BIC\)</span>. We can examine these to try to select the best overall model.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>reg.summary <span class="ot">&lt;-</span> regfit.full <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(reg.summary)</span></code></pre></div>
<pre><code>&gt; [1] &quot;which&quot;  &quot;rsq&quot;    &quot;rss&quot;    &quot;adjr2&quot;  &quot;cp&quot;     &quot;bic&quot;    &quot;outmat&quot; &quot;obj&quot;</code></pre>
<p>For instance, we see that the <span class="math inline">\(R^2\)</span> statistic increases from 32 %, when only one variable is included in the model, to almost 55 %, when all variables are included. As expected, the <span class="math inline">\(R^2\)</span> statistic increases monotonically as more variables are included.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>reg.summary<span class="sc">$</span>rsq</span></code></pre></div>
<pre><code>&gt;  [1] 0.3214501 0.4252237 0.4514294 0.4754067 0.4908036 0.5087146 0.5141227
&gt;  [8] 0.5285569 0.5346124 0.5404950 0.5426153 0.5436302 0.5444570 0.5452164
&gt; [15] 0.5454692 0.5457656 0.5459518 0.5460945 0.5461159</code></pre>
<p>The <code>regsubsets()</code> function has a built-in <code>plot()</code> command which can be used to display the selected variables for the best model with a given number of predictors, ranked according to the <span class="math inline">\(BIC\)</span>, <span class="math inline">\(C_p\)</span>, adjusted <span class="math inline">\(R^2\)</span>, or <span class="math inline">\(AIC\)</span>. To find out more about this function, type <code>?plot.regsubsets</code>.</p>
<p>The top row of each plot contains a black square for each variable selected according to the optimal model associated with that statistic. For instance, we see that several models share a <span class="math inline">\(BIC\)</span> close to <span class="math inline">\(−150\)</span>. However, the model with the lowest <span class="math inline">\(BIC\)</span> is the six-variable model that contains only <code>AtBat</code>, <code>Hits</code>, <code>Walks</code>, <code>CRBI</code>, <code>DivisionW</code>, and <code>PutOuts</code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(regfit.full, <span class="at">scale =</span> <span class="st">&quot;bic&quot;</span>)</span></code></pre></div>
<p><img src="img/unnamed-chunk-8-1.png" width="3883.2" style="display: block; margin: auto;" /></p>
<p>We can use the <code>coef()</code> function to see the coefficient estimates associated with this model.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(regfit.full, <span class="dv">6</span>)</span></code></pre></div>
<pre><code>&gt;  (Intercept)        AtBat         Hits        Walks         CRBI    DivisionW 
&gt;   91.5117981   -1.8685892    7.6043976    3.6976468    0.6430169 -122.9515338 
&gt;      PutOuts 
&gt;    0.2643076</code></pre>
</div>
<div id="forward-and-backward-stepwise-selection" class="section level2">
<h2>Forward and Backward Stepwise Selection</h2>
<p>We can also use the <code>regsubsets()</code> function to perform forward stepwise selection using the argument <code>method = "forward"</code></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>regfit.fwd <span class="ot">&lt;-</span> leaps<span class="sc">::</span><span class="fu">regsubsets</span>(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> Salary <span class="sc">~</span> .,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> Hitters,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">nvmax =</span> <span class="dv">19</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">&quot;forward&quot;</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(regfit.fwd)</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; Subset selection object
&gt; Call: regsubsets.formula(x = Salary ~ ., data = Hitters, nvmax = 19, 
&gt;     method = &quot;forward&quot;)
&gt; 19 Variables  (and intercept)
&gt;            Forced in Forced out
&gt; AtBat          FALSE      FALSE
&gt; Hits           FALSE      FALSE
&gt; HmRun          FALSE      FALSE
&gt; Runs           FALSE      FALSE
&gt; RBI            FALSE      FALSE
&gt; Walks          FALSE      FALSE
&gt; Years          FALSE      FALSE
&gt; CAtBat         FALSE      FALSE
&gt; CHits          FALSE      FALSE
&gt; CHmRun         FALSE      FALSE
&gt; CRuns          FALSE      FALSE
&gt; CRBI           FALSE      FALSE
&gt; CWalks         FALSE      FALSE
&gt; LeagueN        FALSE      FALSE
&gt; DivisionW      FALSE      FALSE
&gt; PutOuts        FALSE      FALSE
&gt; Assists        FALSE      FALSE
&gt; Errors         FALSE      FALSE
&gt; NewLeagueN     FALSE      FALSE
&gt; 1 subsets of each size up to 19
&gt; Selection Algorithm: forward
&gt;           AtBat Hits HmRun Runs RBI Walks Years CAtBat CHits CHmRun CRuns CRBI
&gt; 1  ( 1 )  &quot; &quot;   &quot; &quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot; &quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot;*&quot; 
&gt; 2  ( 1 )  &quot; &quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot; &quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot;*&quot; 
&gt; 3  ( 1 )  &quot; &quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot; &quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot;*&quot; 
&gt; 4  ( 1 )  &quot; &quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot; &quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot;*&quot; 
&gt; 5  ( 1 )  &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot; &quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot;*&quot; 
&gt; 6  ( 1 )  &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot;*&quot; 
&gt; 7  ( 1 )  &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot;*&quot; 
&gt; 8  ( 1 )  &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;    &quot;*&quot;   &quot;*&quot; 
&gt; 9  ( 1 )  &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot;*&quot;    &quot; &quot;   &quot; &quot;    &quot;*&quot;   &quot;*&quot; 
&gt; 10  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot;*&quot;    &quot; &quot;   &quot; &quot;    &quot;*&quot;   &quot;*&quot; 
&gt; 11  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot;*&quot;    &quot; &quot;   &quot; &quot;    &quot;*&quot;   &quot;*&quot; 
&gt; 12  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot;*&quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot;*&quot;    &quot; &quot;   &quot; &quot;    &quot;*&quot;   &quot;*&quot; 
&gt; 13  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot;*&quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot;*&quot;    &quot; &quot;   &quot; &quot;    &quot;*&quot;   &quot;*&quot; 
&gt; 14  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;   &quot;*&quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot;*&quot;    &quot; &quot;   &quot; &quot;    &quot;*&quot;   &quot;*&quot; 
&gt; 15  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;   &quot;*&quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot;*&quot;    &quot;*&quot;   &quot; &quot;    &quot;*&quot;   &quot;*&quot; 
&gt; 16  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;   &quot;*&quot;  &quot;*&quot; &quot;*&quot;   &quot; &quot;   &quot;*&quot;    &quot;*&quot;   &quot; &quot;    &quot;*&quot;   &quot;*&quot; 
&gt; 17  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;   &quot;*&quot;  &quot;*&quot; &quot;*&quot;   &quot; &quot;   &quot;*&quot;    &quot;*&quot;   &quot; &quot;    &quot;*&quot;   &quot;*&quot; 
&gt; 18  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;   &quot;*&quot;  &quot;*&quot; &quot;*&quot;   &quot;*&quot;   &quot;*&quot;    &quot;*&quot;   &quot; &quot;    &quot;*&quot;   &quot;*&quot; 
&gt; 19  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;   &quot;*&quot;  &quot;*&quot; &quot;*&quot;   &quot;*&quot;   &quot;*&quot;    &quot;*&quot;   &quot;*&quot;    &quot;*&quot;   &quot;*&quot; 
&gt;           CWalks LeagueN DivisionW PutOuts Assists Errors NewLeagueN
&gt; 1  ( 1 )  &quot; &quot;    &quot; &quot;     &quot; &quot;       &quot; &quot;     &quot; &quot;     &quot; &quot;    &quot; &quot;       
&gt; 2  ( 1 )  &quot; &quot;    &quot; &quot;     &quot; &quot;       &quot; &quot;     &quot; &quot;     &quot; &quot;    &quot; &quot;       
&gt; 3  ( 1 )  &quot; &quot;    &quot; &quot;     &quot; &quot;       &quot;*&quot;     &quot; &quot;     &quot; &quot;    &quot; &quot;       
&gt; 4  ( 1 )  &quot; &quot;    &quot; &quot;     &quot;*&quot;       &quot;*&quot;     &quot; &quot;     &quot; &quot;    &quot; &quot;       
&gt; 5  ( 1 )  &quot; &quot;    &quot; &quot;     &quot;*&quot;       &quot;*&quot;     &quot; &quot;     &quot; &quot;    &quot; &quot;       
&gt; 6  ( 1 )  &quot; &quot;    &quot; &quot;     &quot;*&quot;       &quot;*&quot;     &quot; &quot;     &quot; &quot;    &quot; &quot;       
&gt; 7  ( 1 )  &quot;*&quot;    &quot; &quot;     &quot;*&quot;       &quot;*&quot;     &quot; &quot;     &quot; &quot;    &quot; &quot;       
&gt; 8  ( 1 )  &quot;*&quot;    &quot; &quot;     &quot;*&quot;       &quot;*&quot;     &quot; &quot;     &quot; &quot;    &quot; &quot;       
&gt; 9  ( 1 )  &quot;*&quot;    &quot; &quot;     &quot;*&quot;       &quot;*&quot;     &quot; &quot;     &quot; &quot;    &quot; &quot;       
&gt; 10  ( 1 ) &quot;*&quot;    &quot; &quot;     &quot;*&quot;       &quot;*&quot;     &quot;*&quot;     &quot; &quot;    &quot; &quot;       
&gt; 11  ( 1 ) &quot;*&quot;    &quot;*&quot;     &quot;*&quot;       &quot;*&quot;     &quot;*&quot;     &quot; &quot;    &quot; &quot;       
&gt; 12  ( 1 ) &quot;*&quot;    &quot;*&quot;     &quot;*&quot;       &quot;*&quot;     &quot;*&quot;     &quot; &quot;    &quot; &quot;       
&gt; 13  ( 1 ) &quot;*&quot;    &quot;*&quot;     &quot;*&quot;       &quot;*&quot;     &quot;*&quot;     &quot;*&quot;    &quot; &quot;       
&gt; 14  ( 1 ) &quot;*&quot;    &quot;*&quot;     &quot;*&quot;       &quot;*&quot;     &quot;*&quot;     &quot;*&quot;    &quot; &quot;       
&gt; 15  ( 1 ) &quot;*&quot;    &quot;*&quot;     &quot;*&quot;       &quot;*&quot;     &quot;*&quot;     &quot;*&quot;    &quot; &quot;       
&gt; 16  ( 1 ) &quot;*&quot;    &quot;*&quot;     &quot;*&quot;       &quot;*&quot;     &quot;*&quot;     &quot;*&quot;    &quot; &quot;       
&gt; 17  ( 1 ) &quot;*&quot;    &quot;*&quot;     &quot;*&quot;       &quot;*&quot;     &quot;*&quot;     &quot;*&quot;    &quot;*&quot;       
&gt; 18  ( 1 ) &quot;*&quot;    &quot;*&quot;     &quot;*&quot;       &quot;*&quot;     &quot;*&quot;     &quot;*&quot;    &quot;*&quot;       
&gt; 19  ( 1 ) &quot;*&quot;    &quot;*&quot;     &quot;*&quot;       &quot;*&quot;     &quot;*&quot;     &quot;*&quot;    &quot;*&quot;</code></pre>
<p>To perform backward stepwise selection, use the argument <code>method = "backward"</code></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>regfit.bwd <span class="ot">&lt;-</span> leaps<span class="sc">::</span><span class="fu">regsubsets</span>(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> Salary <span class="sc">~</span> .,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> Hitters,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">nvmax =</span> <span class="dv">19</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">&quot;backward&quot;</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(regfit.bwd)</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; Subset selection object
&gt; Call: regsubsets.formula(x = Salary ~ ., data = Hitters, nvmax = 19, 
&gt;     method = &quot;backward&quot;)
&gt; 19 Variables  (and intercept)
&gt;            Forced in Forced out
&gt; AtBat          FALSE      FALSE
&gt; Hits           FALSE      FALSE
&gt; HmRun          FALSE      FALSE
&gt; Runs           FALSE      FALSE
&gt; RBI            FALSE      FALSE
&gt; Walks          FALSE      FALSE
&gt; Years          FALSE      FALSE
&gt; CAtBat         FALSE      FALSE
&gt; CHits          FALSE      FALSE
&gt; CHmRun         FALSE      FALSE
&gt; CRuns          FALSE      FALSE
&gt; CRBI           FALSE      FALSE
&gt; CWalks         FALSE      FALSE
&gt; LeagueN        FALSE      FALSE
&gt; DivisionW      FALSE      FALSE
&gt; PutOuts        FALSE      FALSE
&gt; Assists        FALSE      FALSE
&gt; Errors         FALSE      FALSE
&gt; NewLeagueN     FALSE      FALSE
&gt; 1 subsets of each size up to 19
&gt; Selection Algorithm: backward
&gt;           AtBat Hits HmRun Runs RBI Walks Years CAtBat CHits CHmRun CRuns CRBI
&gt; 1  ( 1 )  &quot; &quot;   &quot; &quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot; &quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;    &quot;*&quot;   &quot; &quot; 
&gt; 2  ( 1 )  &quot; &quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot; &quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;    &quot;*&quot;   &quot; &quot; 
&gt; 3  ( 1 )  &quot; &quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot; &quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;    &quot;*&quot;   &quot; &quot; 
&gt; 4  ( 1 )  &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot; &quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;    &quot;*&quot;   &quot; &quot; 
&gt; 5  ( 1 )  &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;    &quot;*&quot;   &quot; &quot; 
&gt; 6  ( 1 )  &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;    &quot;*&quot;   &quot; &quot; 
&gt; 7  ( 1 )  &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;    &quot;*&quot;   &quot; &quot; 
&gt; 8  ( 1 )  &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;    &quot;*&quot;   &quot;*&quot; 
&gt; 9  ( 1 )  &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot;*&quot;    &quot; &quot;   &quot; &quot;    &quot;*&quot;   &quot;*&quot; 
&gt; 10  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot;*&quot;    &quot; &quot;   &quot; &quot;    &quot;*&quot;   &quot;*&quot; 
&gt; 11  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot;*&quot;    &quot; &quot;   &quot; &quot;    &quot;*&quot;   &quot;*&quot; 
&gt; 12  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot;*&quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot;*&quot;    &quot; &quot;   &quot; &quot;    &quot;*&quot;   &quot;*&quot; 
&gt; 13  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot;*&quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot;*&quot;    &quot; &quot;   &quot; &quot;    &quot;*&quot;   &quot;*&quot; 
&gt; 14  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;   &quot;*&quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot;*&quot;    &quot; &quot;   &quot; &quot;    &quot;*&quot;   &quot;*&quot; 
&gt; 15  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;   &quot;*&quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot;*&quot;    &quot;*&quot;   &quot; &quot;    &quot;*&quot;   &quot;*&quot; 
&gt; 16  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;   &quot;*&quot;  &quot;*&quot; &quot;*&quot;   &quot; &quot;   &quot;*&quot;    &quot;*&quot;   &quot; &quot;    &quot;*&quot;   &quot;*&quot; 
&gt; 17  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;   &quot;*&quot;  &quot;*&quot; &quot;*&quot;   &quot; &quot;   &quot;*&quot;    &quot;*&quot;   &quot; &quot;    &quot;*&quot;   &quot;*&quot; 
&gt; 18  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;   &quot;*&quot;  &quot;*&quot; &quot;*&quot;   &quot;*&quot;   &quot;*&quot;    &quot;*&quot;   &quot; &quot;    &quot;*&quot;   &quot;*&quot; 
&gt; 19  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;   &quot;*&quot;  &quot;*&quot; &quot;*&quot;   &quot;*&quot;   &quot;*&quot;    &quot;*&quot;   &quot;*&quot;    &quot;*&quot;   &quot;*&quot; 
&gt;           CWalks LeagueN DivisionW PutOuts Assists Errors NewLeagueN
&gt; 1  ( 1 )  &quot; &quot;    &quot; &quot;     &quot; &quot;       &quot; &quot;     &quot; &quot;     &quot; &quot;    &quot; &quot;       
&gt; 2  ( 1 )  &quot; &quot;    &quot; &quot;     &quot; &quot;       &quot; &quot;     &quot; &quot;     &quot; &quot;    &quot; &quot;       
&gt; 3  ( 1 )  &quot; &quot;    &quot; &quot;     &quot; &quot;       &quot;*&quot;     &quot; &quot;     &quot; &quot;    &quot; &quot;       
&gt; 4  ( 1 )  &quot; &quot;    &quot; &quot;     &quot; &quot;       &quot;*&quot;     &quot; &quot;     &quot; &quot;    &quot; &quot;       
&gt; 5  ( 1 )  &quot; &quot;    &quot; &quot;     &quot; &quot;       &quot;*&quot;     &quot; &quot;     &quot; &quot;    &quot; &quot;       
&gt; 6  ( 1 )  &quot; &quot;    &quot; &quot;     &quot;*&quot;       &quot;*&quot;     &quot; &quot;     &quot; &quot;    &quot; &quot;       
&gt; 7  ( 1 )  &quot;*&quot;    &quot; &quot;     &quot;*&quot;       &quot;*&quot;     &quot; &quot;     &quot; &quot;    &quot; &quot;       
&gt; 8  ( 1 )  &quot;*&quot;    &quot; &quot;     &quot;*&quot;       &quot;*&quot;     &quot; &quot;     &quot; &quot;    &quot; &quot;       
&gt; 9  ( 1 )  &quot;*&quot;    &quot; &quot;     &quot;*&quot;       &quot;*&quot;     &quot; &quot;     &quot; &quot;    &quot; &quot;       
&gt; 10  ( 1 ) &quot;*&quot;    &quot; &quot;     &quot;*&quot;       &quot;*&quot;     &quot;*&quot;     &quot; &quot;    &quot; &quot;       
&gt; 11  ( 1 ) &quot;*&quot;    &quot;*&quot;     &quot;*&quot;       &quot;*&quot;     &quot;*&quot;     &quot; &quot;    &quot; &quot;       
&gt; 12  ( 1 ) &quot;*&quot;    &quot;*&quot;     &quot;*&quot;       &quot;*&quot;     &quot;*&quot;     &quot; &quot;    &quot; &quot;       
&gt; 13  ( 1 ) &quot;*&quot;    &quot;*&quot;     &quot;*&quot;       &quot;*&quot;     &quot;*&quot;     &quot;*&quot;    &quot; &quot;       
&gt; 14  ( 1 ) &quot;*&quot;    &quot;*&quot;     &quot;*&quot;       &quot;*&quot;     &quot;*&quot;     &quot;*&quot;    &quot; &quot;       
&gt; 15  ( 1 ) &quot;*&quot;    &quot;*&quot;     &quot;*&quot;       &quot;*&quot;     &quot;*&quot;     &quot;*&quot;    &quot; &quot;       
&gt; 16  ( 1 ) &quot;*&quot;    &quot;*&quot;     &quot;*&quot;       &quot;*&quot;     &quot;*&quot;     &quot;*&quot;    &quot; &quot;       
&gt; 17  ( 1 ) &quot;*&quot;    &quot;*&quot;     &quot;*&quot;       &quot;*&quot;     &quot;*&quot;     &quot;*&quot;    &quot;*&quot;       
&gt; 18  ( 1 ) &quot;*&quot;    &quot;*&quot;     &quot;*&quot;       &quot;*&quot;     &quot;*&quot;     &quot;*&quot;    &quot;*&quot;       
&gt; 19  ( 1 ) &quot;*&quot;    &quot;*&quot;     &quot;*&quot;       &quot;*&quot;     &quot;*&quot;     &quot;*&quot;    &quot;*&quot;</code></pre>
<p>For this data, the best seven-variable models identified by forward stepwise selection, backward stepwise selection, and best subset selection are different.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(regfit.full, <span class="dv">7</span>)</span></code></pre></div>
<pre><code>&gt;  (Intercept)         Hits        Walks       CAtBat        CHits       CHmRun 
&gt;   79.4509472    1.2833513    3.2274264   -0.3752350    1.4957073    1.4420538 
&gt;    DivisionW      PutOuts 
&gt; -129.9866432    0.2366813</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(regfit.fwd, <span class="dv">7</span>)</span></code></pre></div>
<pre><code>&gt;  (Intercept)        AtBat         Hits        Walks         CRBI       CWalks 
&gt;  109.7873062   -1.9588851    7.4498772    4.9131401    0.8537622   -0.3053070 
&gt;    DivisionW      PutOuts 
&gt; -127.1223928    0.2533404</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(regfit.bwd, <span class="dv">7</span>)</span></code></pre></div>
<pre><code>&gt;  (Intercept)        AtBat         Hits        Walks        CRuns       CWalks 
&gt;  105.6487488   -1.9762838    6.7574914    6.0558691    1.1293095   -0.7163346 
&gt;    DivisionW      PutOuts 
&gt; -116.1692169    0.3028847</code></pre>
</div>
<div id="choosing-among-models-using-the-validation-set-approach" class="section level2">
<h2>Choosing Among Models Using the Validation-Set Approach</h2>
<p>We split the samples into training set and a test set</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>Hitters <span class="ot">&lt;-</span> Hitters <span class="sc">%&gt;%</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">isTrainingSet =</span> <span class="fu">sample</span>(</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>),</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="fu">nrow</span>(Hitters),</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">replace =</span> <span class="cn">TRUE</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">relocate</span>(.data[[<span class="st">&quot;isTrainingSet&quot;</span>]])</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> Hitters <span class="sc">%&gt;%</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(.data[[<span class="st">&quot;isTrainingSet&quot;</span>]] <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">&quot;isTrainingSet&quot;</span>))</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> Hitters <span class="sc">%&gt;%</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(.data[[<span class="st">&quot;isTrainingSet&quot;</span>]] <span class="sc">==</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">&quot;isTrainingSet&quot;</span>))</span></code></pre></div>
<p>Now, we apply <code>regsubsets()</code> to the training set in order to perform best subset selection and compute the the validation set error for the best model of each model size.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>regfit.best <span class="ot">&lt;-</span> leaps<span class="sc">::</span><span class="fu">regsubsets</span>(Salary <span class="sc">~</span> ., <span class="at">data =</span> train, <span class="at">nvmax =</span> <span class="dv">19</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>test.mat <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">model.matrix</span>(Salary <span class="sc">~</span> ., <span class="at">data =</span> test)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>val.errors <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">19</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">19</span>) {</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  coefi <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">coef</span>(regfit.best, <span class="at">id =</span> i)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  pred <span class="ot">&lt;-</span> test.mat[, <span class="fu">names</span>(coefi)] <span class="sc">%*%</span> coefi</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  val.errors[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>((test<span class="sc">$</span>Salary <span class="sc">-</span> pred)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>val.errors</span></code></pre></div>
<pre><code>&gt;  [1] 135855.0 121223.7 112839.0 108921.6 108777.0 106698.8 111575.5 118578.6
&gt;  [9] 107488.7 111622.5 105683.6 106537.6 105781.1 106511.1 107497.2 107930.6
&gt; [17] 108624.8 110326.5 110231.6</code></pre>
<p>We find that the best model is the one that contains seven variables.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which.min</span>(val.errors)</span></code></pre></div>
<pre><code>&gt; [1] 11</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(regfit.best, <span class="dv">7</span>)</span></code></pre></div>
<pre><code>&gt; (Intercept)       AtBat        Hits       Walks      CHmRun       CRuns 
&gt; 197.8996737  -3.1466588   8.7295868  10.2800410   1.8032438   1.2066890 
&gt;      CWalks     Assists 
&gt;  -1.2903890   0.4338648</code></pre>
<p>However, the best seven-variable model on the full data set has a different set of variables than the best seven-variable model on the training set.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>regfit.best <span class="ot">&lt;-</span> leaps<span class="sc">::</span><span class="fu">regsubsets</span>(Salary <span class="sc">~</span> ., <span class="at">data =</span> Hitters, <span class="at">nvmax =</span> <span class="dv">19</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(regfit.best, <span class="dv">7</span>)</span></code></pre></div>
<pre><code>&gt;  (Intercept)         Hits        Walks       CAtBat        CHits       CHmRun 
&gt;   79.4509472    1.2833513    3.2274264   -0.3752350    1.4957073    1.4420538 
&gt;    DivisionW      PutOuts 
&gt; -129.9866432    0.2366813</code></pre>
</div>
<div id="choosing-among-models-using-cross-validation" class="section level2">
<h2>Choosing Among Models Using Cross-Validation</h2>
<p>We now try to choose among the models of different sizes using cross validation. Create a vector that allocates each observation to one of k = 10 folds.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(Hitters)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>k, <span class="at">length =</span> n))</span></code></pre></div>
<p>We write a for loop that performs cross-validation</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A predict method for regsubsets</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>predict.regsubsets <span class="ot">&lt;-</span> <span class="cf">function</span>(object, newdata, id, ...) {</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  form <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(object<span class="sc">$</span>call[[<span class="dv">2</span>]])</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  mat <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(form, newdata)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  coefi <span class="ot">&lt;-</span> <span class="fu">coef</span>(object, <span class="at">id =</span> id)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  xvars <span class="ot">&lt;-</span> <span class="fu">names</span>(coefi)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  mat[, xvars] <span class="sc">%*%</span> coefi</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>cv.errors <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, k, <span class="dv">19</span>,</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="cn">NULL</span>, <span class="fu">paste</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">19</span>))</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  best.fit <span class="ot">&lt;-</span> leaps<span class="sc">::</span><span class="fu">regsubsets</span>(Salary <span class="sc">~</span> .,</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> Hitters[folds <span class="sc">!=</span> j, ],</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">nvmax =</span> <span class="dv">19</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">19</span>) {</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>    pred <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">predict</span>(best.fit, Hitters[folds <span class="sc">==</span> j, ], <span class="at">id =</span> i)</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>    cv.errors[j, i] <span class="ot">&lt;-</span> <span class="fu">mean</span>((Hitters<span class="sc">$</span>Salary[folds <span class="sc">==</span> j] <span class="sc">-</span> pred)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>This has given us a <span class="math inline">\(10\)</span> by <span class="math inline">\(19\)</span> matrix, of which the <span class="math inline">\((j, i)\)</span>th element corresponds to the test <span class="math inline">\(MSE\)</span> for the <span class="math inline">\(j\)</span>th cross-validation fold for the best <span class="math inline">\(i\)</span>-variable model.</p>
<p>We use the <code>apply()</code> function to average over the columns of this <code>apply()</code> matrix in order to obtain a vector for which the <span class="math inline">\(i\)</span>th element is the cross validation error for the <span class="math inline">\(i\)</span>-variable model.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>mean.cv.errors <span class="ot">&lt;-</span> <span class="fu">apply</span>(cv.errors, <span class="dv">2</span>, mean)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mean.cv.errors, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>)</span></code></pre></div>
<p><img src="img/unnamed-chunk-19-1.png" width="3883.2" style="display: block; margin: auto;" /></p>
<p>We see that cross-validation selects a 10-variable model.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>regfit.best <span class="ot">&lt;-</span> leaps<span class="sc">::</span><span class="fu">regsubsets</span>(Salary <span class="sc">~</span> ., <span class="at">data =</span> Hitters, <span class="at">nvmax =</span> <span class="dv">19</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(regfit.best, <span class="dv">10</span>)</span></code></pre></div>
<pre><code>&gt;  (Intercept)        AtBat         Hits        Walks       CAtBat        CRuns 
&gt;  162.5354420   -2.1686501    6.9180175    5.7732246   -0.1300798    1.4082490 
&gt;         CRBI       CWalks    DivisionW      PutOuts      Assists 
&gt;    0.7743122   -0.8308264 -112.3800575    0.2973726    0.2831680</code></pre>
</div>
</div>
<div id="ridge-regression" class="section level1">
<h1>Ridge Regression</h1>
<div id="introduction-to-ridge-regression" class="section level2">
<h2>Introduction to ridge regression</h2>
<p>Set mixture to 0 to indicate Ridge Regression. For now, we set penalty/lambda as 0</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>Hitters <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(ISLR<span class="sc">::</span>Hitters) <span class="sc">%&gt;%</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">drop_na</span>()</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>ridge_spec <span class="ot">&lt;-</span> parsnip<span class="sc">::</span><span class="fu">linear_reg</span>(</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">mixture =</span> <span class="dv">0</span>,</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">penalty =</span> <span class="dv">0</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_mode</span>(<span class="st">&quot;regression&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">&quot;glmnet&quot;</span>)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>ridge_spec <span class="sc">%&gt;%</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">translate</span>()</span></code></pre></div>
<pre><code>&gt; Linear Regression Model Specification (regression)
&gt; 
&gt; Main Arguments:
&gt;   penalty = 0
&gt;   mixture = 0
&gt; 
&gt; Computational engine: glmnet 
&gt; 
&gt; Model fit template:
&gt; glmnet::glmnet(x = missing_arg(), y = missing_arg(), weights = missing_arg(), 
&gt;     alpha = 0, family = &quot;gaussian&quot;)</code></pre>
<p>Once the specification is created we can fit it to our data. We will use all the predictors.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>ridge_fit <span class="ot">&lt;-</span> ridge_spec <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">fit</span>(</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> Salary <span class="sc">~</span> .,</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> Hitters</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>We can see the parameter estimate for different values of penalty/lambda. Notice how the estimates are decreasing when the amount of penalty goes up</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>parsnip<span class="sc">::</span><span class="fu">tidy</span>(ridge_fit) <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-645c4a0173fa826ea5fd" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-645c4a0173fa826ea5fd">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"term":["(Intercept)","AtBat","Hits","HmRun","Runs","RBI","Walks","Years","CAtBat","CHits","CHmRun","CRuns","CRBI","CWalks","LeagueN","DivisionW","PutOuts","Assists","Errors","NewLeagueN"],"estimate":[81.126931905343,-0.68159588908878,2.77231158515167,-1.36568011504582,1.01482648205765,0.713022448716654,3.37855759692001,-9.06680040713677,-0.00119947769064437,0.136102881002513,0.697995816101639,0.295889602029511,0.257071062373432,-0.278966595389854,53.2127203431237,-122.834451506425,0.263887566925254,0.169879574615924,-3.68564533746002,-18.1050959562384],"penalty":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},"columns":[{"accessor":"term","name":"term","type":"character"},{"accessor":"estimate","name":"estimate","type":"numeric"},{"accessor":"penalty","name":"penalty","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"2809998446197878396f0e457a5a745b","key":"2809998446197878396f0e457a5a745b"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>parsnip<span class="sc">::</span><span class="fu">tidy</span>(ridge_fit, <span class="at">penalty =</span> <span class="dv">705</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-e80e9bb6c4dbcda42aea" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-e80e9bb6c4dbcda42aea">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"term":["(Intercept)","AtBat","Hits","HmRun","Runs","RBI","Walks","Years","CAtBat","CHits","CHmRun","CRuns","CRBI","CWalks","LeagueN","DivisionW","PutOuts","Assists","Errors","NewLeagueN"],"estimate":[54.3901900988229,0.111991026858279,0.656183080813358,1.17557058238517,0.937457802251324,0.846828376637506,1.32044897466514,2.58210271788695,0.0108284984948835,0.046811466934414,0.33843941992353,0.0937216470218284,0.0978893030649248,0.0717942214109513,13.69631792642,-54.7169353656736,0.118646551581848,0.0161035970550055,-0.704397815882292,8.6093630366201],"penalty":[705,705,705,705,705,705,705,705,705,705,705,705,705,705,705,705,705,705,705,705]},"columns":[{"accessor":"term","name":"term","type":"character"},{"accessor":"estimate","name":"estimate","type":"numeric"},{"accessor":"penalty","name":"penalty","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"db7f6caabd4f2a175c0f204d9945ade2","key":"db7f6caabd4f2a175c0f204d9945ade2"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>parsnip<span class="sc">::</span><span class="fu">tidy</span>(ridge_fit, <span class="at">penalty =</span> <span class="dv">11498</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-d000d9ac6052d99643cf" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-d000d9ac6052d99643cf">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"term":["(Intercept)","AtBat","Hits","HmRun","Runs","RBI","Walks","Years","CAtBat","CHits","CHmRun","CRuns","CRBI","CWalks","LeagueN","DivisionW","PutOuts","Assists","Errors","NewLeagueN"],"estimate":[407.205936774294,0.0370030829770469,0.138357552142382,0.525195507898014,0.230978289682357,0.240114774750315,0.289971555493143,1.1088323992277,0.00313521465449831,0.0116666839903429,0.0876427890639526,0.0234062578636385,0.0241657234471385,0.0250421169757924,0.0866292341487684,-6.22543133217844,0.0165065958061373,0.0026163350944088,-0.0205641577295531,0.30292289881745],"penalty":[11498,11498,11498,11498,11498,11498,11498,11498,11498,11498,11498,11498,11498,11498,11498,11498,11498,11498,11498,11498]},"columns":[{"accessor":"term","name":"term","type":"character"},{"accessor":"estimate","name":"estimate","type":"numeric"},{"accessor":"penalty","name":"penalty","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"cca2d45705dc5f7ebf6eb2135fd3fc98","key":"cca2d45705dc5f7ebf6eb2135fd3fc98"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>We can visualize how the magnitude of the coefficients are being regularized towards zero as the penalty goes up.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrange figure margin</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">1</span>))</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>ridge_fit <span class="sc">%&gt;%</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">extract_fit_engine</span>() <span class="sc">%&gt;%</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">xvar =</span> <span class="st">&quot;lambda&quot;</span>)</span></code></pre></div>
<p><img src="img/unnamed-chunk-24-1.png" width="3883.2" style="display: block; margin: auto;" /></p>
<p>It would be nice if we could find the “best” value of the penalty/lambda. We can do this using the <code>tune::tune_grid()</code></p>
<p>Need we need three things in order to use the <code>tune::tune_grid()</code></p>
<ul>
<li><p>a <code>resample</code> object containing the resamples the <code>workflow</code> should be fitted within,</p></li>
<li><p>a <code>workflow</code> object containing the model and preprocessor,and</p></li>
<li><p>a tibble <code>penalty_grid</code> containing the parameter values to be evaluated.</p></li>
</ul>
<p>First, we create a 10-fold cross-validation data set from the training data set.</p>
</div>
<div id="create-the-resample-object" class="section level2">
<h2>Create the resample object</h2>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>Hitters <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(ISLR<span class="sc">::</span>Hitters) <span class="sc">%&gt;%</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">drop_na</span>()</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>Hitters_split <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">initial_split</span>(Hitters, <span class="at">strata =</span> <span class="st">&quot;Salary&quot;</span>)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>Hitters_train <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">training</span>(Hitters_split)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>Hitters_test <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">testing</span>(Hitters_split)</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>Hitters_fold <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">vfold_cv</span>(Hitters_train, <span class="at">v =</span> <span class="dv">10</span>)</span></code></pre></div>
</div>
<div id="create-the-preprocessor" class="section level2">
<h2>Create the preprocessor</h2>
<p>We use the <code>recipes</code> package to create the preporcessing steps. However, the order of the preprocessing step is actually important. See the <a href="https://cran.r-project.org/web/packages/recipes/vignettes/Ordering.html">Ordering of steps vignette</a></p>
<p>We create a basic recipe.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>ridge_recipe <span class="ot">&lt;-</span> recipes<span class="sc">::</span><span class="fu">recipe</span>(</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> Salary <span class="sc">~</span> .,</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> Hitters_train</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>rec <span class="ot">&lt;-</span> recipes<span class="sc">::</span><span class="fu">prep</span>(<span class="at">x =</span> ridge_recipe, <span class="at">training =</span> Hitters_train)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>rec <span class="sc">%&gt;%</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>() <span class="sc">%&gt;%</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-f0dab8667e65fcb3cfa1" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-f0dab8667e65fcb3cfa1">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"variable":["AtBat","Hits","HmRun","Runs","RBI","Walks","Years","CAtBat","CHits","CHmRun","CRuns","CRBI","CWalks","League","Division","PutOuts","Assists","Errors","NewLeague","Salary"],"type":["numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","nominal","nominal","numeric","numeric","numeric","nominal","numeric"],"role":["predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","outcome"],"source":["original","original","original","original","original","original","original","original","original","original","original","original","original","original","original","original","original","original","original","original"]},"columns":[{"accessor":"variable","name":"variable","type":"character"},{"accessor":"type","name":"type","type":"character"},{"accessor":"role","name":"role","type":"character"},{"accessor":"source","name":"source","type":"character"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"c411a1329a41941d02bdceb1680a64d8","key":"c411a1329a41941d02bdceb1680a64d8"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>rec <span class="sc">%&gt;%</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">bake</span>(<span class="at">new_data =</span> Hitters_train) <span class="sc">%&gt;%</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-dceca249c5bba630e0d6" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-dceca249c5bba630e0d6">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"AtBat":[185,298,323,190,127,426,419,268,416,199,521,280,511,215,472,445,143,185,600,151,278,341,399,165,315,181,328,279,338,216,209,407,209,504,258,211,299,547,540,236,312,126,382,549,512,461,453,578,408,593,196,204,254,416,405,244,313,155,236,216,311,351,155,415,325,574,327,354,539,340,220,278,663,160,210,537,257,404,344,680,431,576,288,369,572,357,376,246,205,394,522,528,281,687,265,205,193,213,441,475,479,496,594,574,202,418,239,472,403,507,255,314,424,566,283,408,510,380,584,306,343,579,184,591,283,560,503,491,625,490,442,288,330,526,313,237,473,271,419,348,523,627,530,562,642,127,480,360,387,497,401,568,629,587,379,526,457,591,627,585,512,677,614,637,475,565,495,441,490,570,479,599,497,618,429,490,550,586,484,589,327,489,20,374,437,608,496,522,557,593,559,510,172,580,492,573],"Hits":[37,73,81,46,32,109,108,60,113,53,142,82,138,51,118,99,39,40,144,41,86,95,102,39,76,58,91,64,92,54,56,93,54,120,60,43,75,137,135,56,68,27,101,149,117,112,103,138,117,172,43,49,68,132,102,58,78,44,56,53,81,97,41,115,76,152,85,77,139,84,54,70,200,39,70,147,66,92,85,223,127,167,76,93,152,96,82,76,52,86,140,122,76,213,68,43,47,61,113,126,130,141,169,159,53,113,60,116,101,122,70,83,110,154,77,94,126,120,158,104,103,174,47,184,74,161,136,141,179,148,131,65,77,163,83,52,154,77,101,90,135,178,159,169,211,32,112,81,124,127,92,158,168,163,106,146,101,168,177,139,131,238,163,174,123,148,151,128,125,169,133,183,136,200,91,150,147,159,127,149,84,131,1,94,123,160,119,163,142,152,141,147,42,207,136,144],"HmRun":[1,0,6,2,8,3,6,5,24,5,20,16,25,4,12,1,5,4,33,4,4,6,3,2,13,6,12,0,18,2,12,8,3,28,8,10,6,2,30,6,2,3,16,7,29,18,8,1,11,22,7,6,2,7,18,9,6,6,0,1,3,4,12,27,16,31,3,16,5,11,10,7,29,8,13,23,5,11,24,31,8,8,7,9,18,7,21,5,8,1,16,1,3,10,8,2,10,4,5,3,18,20,4,21,4,13,0,16,12,29,7,13,15,22,14,4,2,5,15,14,6,7,5,20,4,26,5,11,4,14,18,8,19,12,9,0,6,5,18,11,8,14,3,17,14,4,18,5,1,7,17,20,18,4,10,13,14,19,25,31,26,31,29,31,27,24,17,16,24,21,10,10,7,20,12,21,29,12,20,21,22,19,0,5,9,28,8,9,21,23,2,10,3,8,5,9],"Runs":[23,24,26,24,16,55,55,24,58,29,67,44,76,19,63,46,18,23,85,26,33,48,56,13,35,34,51,31,42,27,22,47,25,71,28,26,38,58,82,41,32,8,50,73,54,54,53,56,66,82,29,23,28,57,49,28,32,21,27,31,42,55,21,97,33,91,30,36,93,62,30,22,108,18,32,58,31,54,69,119,77,89,34,43,105,50,42,35,31,38,73,67,42,91,26,24,21,17,76,61,66,65,74,107,31,48,30,60,45,78,49,39,70,76,45,42,42,54,70,50,48,67,20,83,34,89,62,77,94,64,68,30,47,88,43,15,61,35,65,50,52,68,82,88,107,14,50,37,67,65,49,89,73,92,38,71,42,80,98,93,69,117,89,89,76,90,61,70,81,72,48,80,58,98,41,69,85,72,66,89,53,77,0,36,62,130,57,82,58,69,48,56,17,107,76,85],"RBI":[8,24,32,8,22,43,36,25,69,22,86,45,96,18,54,24,30,11,117,21,38,42,34,9,60,23,43,26,60,25,36,30,14,71,33,35,23,47,88,19,22,10,55,47,88,54,33,59,41,100,27,25,26,49,85,25,41,23,15,15,30,29,29,71,52,101,44,55,58,33,39,37,121,31,51,88,26,49,64,96,45,49,37,42,49,45,60,39,27,28,77,45,25,65,30,17,29,22,52,43,72,78,51,75,26,61,11,62,53,85,35,46,47,84,47,36,44,51,84,58,36,78,28,79,29,96,48,47,60,78,77,36,53,50,41,25,48,29,58,45,44,76,50,73,59,25,71,44,27,48,66,75,102,51,60,70,63,72,81,94,96,113,83,116,93,104,84,73,105,88,72,74,38,110,42,58,91,79,65,86,62,55,0,26,55,74,33,46,81,75,61,52,14,71,50,60],"Walks":[21,7,8,15,14,62,22,15,16,21,45,47,61,11,30,29,15,18,65,19,45,20,34,16,25,22,33,30,21,33,19,30,12,54,18,39,26,12,55,21,24,5,22,42,43,35,52,34,34,57,30,12,22,33,20,35,12,15,11,22,26,39,22,68,37,64,20,41,69,47,31,18,32,22,28,47,32,18,88,34,58,57,15,49,65,39,35,13,17,36,60,51,20,27,29,20,24,3,76,52,76,37,35,59,27,47,22,74,39,91,43,16,36,43,26,66,35,31,42,25,40,58,18,38,22,66,83,37,65,49,33,27,27,77,30,30,29,33,92,43,52,46,47,53,52,12,44,37,36,37,65,73,40,70,30,84,22,39,70,62,52,53,75,56,72,77,78,80,62,38,55,32,26,62,57,35,71,53,67,64,38,34,0,62,40,89,21,62,23,53,73,53,15,105,94,78],"Years":[2,3,2,5,8,1,3,2,1,3,4,2,3,1,4,4,9,3,2,2,1,10,5,3,3,1,2,1,3,1,2,2,1,3,3,3,3,2,1,5,1,4,1,1,6,2,2,3,1,1,13,7,6,3,6,4,12,16,4,4,17,4,16,3,5,3,8,20,5,5,5,18,4,14,15,10,14,6,7,3,2,4,4,5,2,5,5,6,12,4,4,4,8,4,7,7,6,17,5,6,3,11,11,10,9,4,6,6,12,18,15,5,7,14,16,9,11,8,5,7,15,6,11,5,10,4,10,15,5,13,6,9,6,4,14,24,6,12,20,10,9,6,6,8,5,19,7,7,7,5,13,15,18,6,14,6,17,9,6,17,14,5,11,14,4,14,10,14,13,7,17,5,11,13,13,14,6,9,7,7,10,7,2,7,9,8,7,13,18,6,8,7,10,5,12,8],"CAtBat":[214,509,341,479,727,426,591,350,416,514,815,428,592,215,793,618,639,524,696,288,278,2964,670,196,630,181,342,279,682,216,216,969,209,1085,638,498,580,1038,540,1257,312,239,382,549,1750,680,507,1399,408,593,3231,1309,999,932,950,1335,3742,6631,1115,926,8247,1258,5409,711,1506,985,2140,8716,1469,1516,1185,7186,1447,2128,4040,2744,3910,1354,911,1928,667,822,1644,1258,978,1394,1770,912,5134,1089,730,1716,2658,1518,1337,854,1136,4061,1546,1700,1624,5628,4408,4631,1876,1512,1941,1924,5150,7761,6311,1457,2130,6100,6840,3573,5562,3118,2358,2954,4338,3053,3327,1689,3919,1789,3423,4291,1696,3400,1416,2815,1928,1556,5885,14053,1966,4933,9528,2288,3368,3146,1619,3181,2364,8396,3031,2268,1775,2703,5206,8068,8424,2695,6207,2648,6521,4478,3210,7546,5347,2223,5017,6727,1810,7287,5624,6675,6063,3754,7472,2482,3871,7127,5590,6126,2816,3082,3006,3558,4273,2051,41,1968,4139,4071,3358,7037,8759,2765,3162,2872,4086,2778,5511,3198],"CHits":[42,108,86,102,180,109,149,78,113,120,205,113,164,51,187,129,151,125,173,68,86,808,167,44,151,58,94,64,185,54,58,230,54,259,170,116,160,271,135,329,68,49,101,149,412,160,123,357,117,172,825,308,236,273,231,333,968,1634,270,210,2198,353,1338,184,351,260,568,2172,369,376,299,2081,404,543,1130,730,979,325,214,587,187,232,408,323,249,344,408,234,1323,267,185,403,657,448,339,219,256,1145,397,433,457,1575,1133,1300,467,392,510,489,1429,1947,1661,405,544,1583,1910,866,1578,900,636,822,1193,880,890,462,1062,470,970,1240,476,1000,398,698,516,470,1543,4256,566,1358,2510,614,895,902,426,841,770,2402,771,566,506,806,1332,2273,2464,747,1906,715,1767,1307,927,1982,1397,737,1388,2024,471,2083,1679,2095,1646,1077,2147,715,1066,2163,1397,1839,815,880,844,928,1123,549,9,519,1203,1182,882,2019,2583,686,874,821,1150,978,1511,857],"CHmRun":[1,0,6,5,24,3,8,5,24,8,22,25,28,4,14,1,16,7,38,9,4,81,4,2,24,6,12,0,36,2,12,14,3,54,17,14,8,3,30,24,2,3,16,7,100,24,8,7,11,22,36,27,21,24,29,49,35,98,1,9,100,16,181,45,71,53,16,384,12,42,40,190,57,56,97,97,33,30,64,35,9,19,16,54,36,43,115,12,56,3,22,12,48,15,32,12,42,83,17,7,63,225,19,90,15,41,4,67,166,347,154,28,38,131,259,59,44,92,58,55,70,32,74,40,85,65,20,84,12,113,47,55,90,38,104,160,29,48,548,43,39,74,11,61,27,242,110,41,6,32,253,177,164,17,146,77,281,113,133,315,221,93,266,247,108,305,275,209,271,140,153,27,40,351,83,121,117,83,116,102,212,62,2,26,79,103,36,153,271,133,16,63,57,32,39,97],"CRuns":[30,41,32,65,67,55,80,34,58,57,99,61,87,19,102,72,80,58,101,45,33,379,89,18,68,34,51,31,88,27,24,121,25,150,80,59,71,129,82,166,32,16,50,73,204,76,63,149,66,82,376,126,108,113,99,164,409,698,116,118,950,196,746,156,195,148,216,1172,247,284,145,935,210,304,544,302,518,188,150,262,117,132,198,181,168,178,238,102,643,94,93,211,324,196,135,105,129,488,226,217,224,828,501,702,192,205,309,242,747,1175,1019,156,335,743,915,429,703,444,265,313,581,366,419,219,505,233,408,615,216,445,210,315,247,245,751,2165,250,630,1509,295,377,494,218,450,352,1048,338,279,272,379,784,1045,1008,442,859,352,1003,634,529,1141,712,349,813,978,292,1135,884,1072,847,492,980,330,450,1104,578,983,405,363,436,513,577,300,6,181,676,862,365,1043,1138,369,421,307,579,474,897,470],"CRBI":[9,37,34,23,82,43,46,29,69,40,103,70,110,18,80,31,97,37,130,39,38,428,48,10,94,23,44,26,112,25,37,69,14,167,75,55,33,80,88,125,22,13,55,47,276,75,39,161,41,100,290,132,117,121,138,179,321,661,64,69,909,110,805,119,219,173,208,1267,126,141,154,1088,222,268,462,351,324,135,156,201,64,83,120,177,91,192,299,96,445,71,106,146,300,137,163,99,139,491,149,93,266,838,336,504,186,204,103,251,666,1152,608,159,174,693,1067,365,519,419,316,377,421,337,382,195,456,260,303,430,163,491,203,325,288,167,714,1314,252,435,1659,273,284,345,149,342,230,1348,406,257,125,311,890,993,1072,198,803,342,977,563,472,1179,815,401,822,1093,343,1234,1015,1050,999,589,1032,326,367,1289,579,707,474,477,458,471,700,263,7,199,390,417,280,827,1299,384,349,340,363,322,451,420],"CWalks":[24,12,8,39,56,62,31,18,16,39,78,63,71,11,50,48,61,47,69,35,45,221,54,18,55,22,33,30,50,33,19,68,12,114,36,78,44,24,55,105,24,14,22,42,155,49,58,87,34,57,238,66,118,80,64,194,170,777,57,114,690,117,875,99,214,95,93,1057,198,219,128,643,68,298,551,174,382,63,187,91,88,79,113,157,101,136,157,80,459,76,86,155,179,89,128,71,106,244,191,146,263,354,194,488,161,203,207,240,526,1380,820,76,258,300,546,410,256,240,134,187,325,218,304,82,283,155,414,340,166,301,136,189,161,174,535,1566,178,403,1342,269,296,242,163,373,193,819,239,246,194,138,866,732,402,317,571,289,619,319,313,727,548,171,617,495,267,791,709,695,680,263,854,158,241,564,644,600,319,295,377,351,334,153,4,288,364,708,165,535,478,321,359,174,406,417,875,332],"League":["N","A","N","A","N","A","N","N","A","A","A","A","A","A","A","A","N","N","A","A","N","N","A","A","N","N","N","N","A","N","N","N","A","A","A","A","N","A","A","A","A","N","A","N","A","A","A","N","N","A","N","A","A","N","N","N","N","N","A","N","N","N","A","N","N","N","A","N","A","N","N","A","A","A","A","N","N","A","A","A","N","N","N","A","A","A","A","A","A","N","N","A","A","A","N","N","A","A","A","A","A","N","A","A","N","N","A","N","A","A","N","A","N","A","A","N","N","A","N","N","A","N","N","N","N","N","N","A","A","A","A","N","N","A","N","N","A","A","A","A","N","N","A","A","N","N","N","N","N","N","A","N","A","A","N","N","A","A","A","A","A","A","N","N","N","A","A","A","N","A","N","A","A","A","A","A","A","N","N","A","A","A","N","N","A","A","N","A","N","A","N","N","N","A","A","A"],"Division":["E","W","W","W","W","W","W","W","E","W","E","E","W","E","W","W","W","E","W","W","W","W","W","W","E","W","E","W","E","W","E","W","W","E","W","W","E","W","W","E","E","E","W","W","W","W","W","E","W","W","E","W","E","W","W","W","W","E","W","W","W","W","W","W","W","W","E","W","W","E","E","W","E","E","E","E","W","E","W","W","E","E","W","E","W","W","W","E","E","E","E","W","E","E","W","E","W","W","W","W","W","E","W","E","W","E","E","W","E","E","E","W","W","W","W","W","W","W","E","E","E","E","W","W","W","W","W","E","E","E","E","E","W","W","W","W","E","W","W","E","W","E","W","E","W","W","E","E","E","E","E","W","E","E","W","W","W","W","E","E","W","E","W","W","E","E","E","W","E","W","W","E","E","E","W","E","W","E","E","E","E","W","E","W","E","E","W","E","W","W","E","E","W","E","E","E"],"PutOuts":[76,121,143,102,202,361,226,442,203,152,107,148,157,116,228,278,138,97,319,28,102,158,211,332,498,88,145,107,0,317,201,172,102,103,358,463,212,261,157,172,86,190,200,255,1236,111,289,133,942,1222,80,419,359,73,161,142,106,53,125,73,153,226,165,274,726,1253,91,83,462,185,50,0,241,33,0,92,87,222,0,429,283,325,203,149,325,167,0,44,155,203,1320,209,106,294,92,131,299,178,160,37,880,200,282,238,304,211,121,518,316,808,51,533,292,316,144,282,207,237,331,116,211,280,49,303,145,332,65,239,303,0,233,259,149,250,58,523,846,62,0,60,367,309,196,351,337,167,94,170,186,325,0,105,1067,434,72,303,389,67,240,0,119,1377,303,278,226,292,1045,97,869,295,237,231,304,330,686,96,1218,181,1231,371,483,310,78,756,82,426,155,352,1160,315,352,810,65,121,313,1314],"Assists":[127,283,290,177,22,22,7,59,70,3,242,4,7,5,377,415,15,2,4,56,4,4,9,19,39,0,59,205,0,36,6,317,6,283,32,32,1,459,6,1,150,2,7,450,98,226,407,371,72,139,45,46,30,177,10,14,206,88,199,152,223,7,9,2,87,111,185,174,9,8,136,0,8,3,0,257,166,5,0,8,8,12,3,1,13,2,0,0,3,369,166,372,144,445,5,6,13,45,290,113,82,11,421,445,45,11,151,55,6,108,54,40,6,439,6,487,358,8,20,222,56,479,2,12,5,9,258,8,450,0,7,30,8,11,141,43,84,90,0,176,475,492,354,442,19,18,270,284,290,9,0,290,157,9,170,9,39,147,482,0,216,100,6,9,10,9,88,218,62,15,5,374,347,16,46,5,104,13,80,6,48,9,220,64,170,4,371,9,53,10,414,99,0,267,381,131],"Errors":[7,9,19,16,2,2,4,6,10,5,23,2,8,12,26,16,1,2,14,2,2,5,3,2,13,3,8,16,0,1,3,25,3,19,8,8,2,22,14,4,15,9,6,17,18,11,6,20,11,15,8,5,4,18,3,2,7,3,13,11,10,3,1,7,3,11,12,16,7,4,20,0,6,0,0,20,14,5,0,6,3,8,3,6,3,4,0,1,2,16,17,17,7,13,3,1,5,4,11,7,14,3,25,22,11,7,6,3,5,2,8,4,3,10,5,19,20,1,4,15,13,5,0,5,7,8,8,2,14,0,7,10,6,1,23,6,9,3,0,6,19,5,15,17,4,6,16,3,17,3,0,10,14,3,24,9,4,4,13,0,12,6,6,9,6,5,13,16,8,5,4,18,10,8,4,3,10,4,7,6,6,9,6,15,15,6,29,1,7,6,9,18,0,19,20,12],"NewLeague":["A","A","N","A","N","N","N","N","A","A","A","A","A","A","A","A","N","N","A","A","N","N","A","N","N","N","N","N","A","N","N","N","A","A","A","A","N","A","A","A","A","N","A","N","A","A","A","N","N","A","N","A","A","N","N","N","N","N","A","N","N","A","A","N","A","N","A","N","A","A","N","A","A","A","A","N","A","A","A","A","N","N","N","A","A","A","A","A","A","N","N","A","A","A","A","N","A","A","A","A","A","N","A","A","N","N","A","N","A","A","N","A","N","A","A","N","N","A","N","N","A","N","N","N","N","N","N","A","A","N","A","A","N","A","N","N","A","A","A","A","N","N","A","A","N","N","N","N","N","N","A","N","A","A","N","N","A","A","A","A","A","A","N","N","N","A","A","A","N","A","N","A","A","A","N","N","A","N","N","A","N","A","N","N","A","A","N","A","N","A","N","N","N","A","A","A"],"Salary":[70,100,75,175,135,115,110,90,90,75,105,110,145,70,155,87.5,175,90,165,95,110,100,80,75,155,86.5,125,75,145,75,90,150,68,175,137,120,140,175,172,190,70,190,97.5,140,100,135,105,160,120,165,240,300,305,215,415,340,416.667,275,230,225,320,210,260,300,385,215,362.5,200,400,400,297.5,325,250,275,365,277.5,250,300,300,365,202.5,210,240,350,200,300,425,250,400,250,200,350,341.667,350,425,286.667,245,235,425,385,480,500,750,517.143,512.5,550,700,600,675,535,450,431.5,490,750,700,535,737.5,600,662.5,750,430,657,450,630,737.5,625,725,525,575,700,550,650,670,750,450,750,580,450,487.5,450,750,740,475,530,740,500,750,525,550,700,1100,775,776.667,765,850,815,875,1200,1350,950,850,1975,1900,1041.667,1220,1861.46,2460,1500,1925.571,950,773.333,775,850,2412.5,825,1000,1310,1043.333,1183.333,787.5,800,780,2127.333,875,1260,1670,875,1000,1450,940,925,1150,900,1600,875,960]},"columns":[{"accessor":"AtBat","name":"AtBat","type":"numeric"},{"accessor":"Hits","name":"Hits","type":"numeric"},{"accessor":"HmRun","name":"HmRun","type":"numeric"},{"accessor":"Runs","name":"Runs","type":"numeric"},{"accessor":"RBI","name":"RBI","type":"numeric"},{"accessor":"Walks","name":"Walks","type":"numeric"},{"accessor":"Years","name":"Years","type":"numeric"},{"accessor":"CAtBat","name":"CAtBat","type":"numeric"},{"accessor":"CHits","name":"CHits","type":"numeric"},{"accessor":"CHmRun","name":"CHmRun","type":"numeric"},{"accessor":"CRuns","name":"CRuns","type":"numeric"},{"accessor":"CRBI","name":"CRBI","type":"numeric"},{"accessor":"CWalks","name":"CWalks","type":"numeric"},{"accessor":"League","name":"League","type":"factor"},{"accessor":"Division","name":"Division","type":"factor"},{"accessor":"PutOuts","name":"PutOuts","type":"numeric"},{"accessor":"Assists","name":"Assists","type":"numeric"},{"accessor":"Errors","name":"Errors","type":"numeric"},{"accessor":"NewLeague","name":"NewLeague","type":"factor"},{"accessor":"Salary","name":"Salary","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"674bb56a3786cd1fa3e30a4e13fd5ace","key":"674bb56a3786cd1fa3e30a4e13fd5ace"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>Do preprocessing on the factor variables.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>ridge_recipe <span class="ot">&lt;-</span> ridge_recipe <span class="sc">%&gt;%</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step Novel is important.</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If test set has a new factor not found in training, it will be treated as &quot;new&quot; and not NA</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This will prevent the model from giving an error</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># https://blog.datascienceheroes.com/how-to-use-recipes-package-for-one-hot-encoding/</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_novel</span>(recipes<span class="sc">::</span><span class="fu">all_nominal_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create Dummy variables</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_dummy</span>(recipes<span class="sc">::</span><span class="fu">all_nominal_predictors</span>())</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>rec <span class="ot">&lt;-</span> recipes<span class="sc">::</span><span class="fu">prep</span>(<span class="at">x =</span> ridge_recipe, <span class="at">training =</span> Hitters_train)</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>rec <span class="sc">%&gt;%</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>() <span class="sc">%&gt;%</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-bda0228a8cf6b1e43b59" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-bda0228a8cf6b1e43b59">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"variable":["AtBat","Hits","HmRun","Runs","RBI","Walks","Years","CAtBat","CHits","CHmRun","CRuns","CRBI","CWalks","PutOuts","Assists","Errors","Salary","League_N","League_new","Division_W","Division_new","NewLeague_N","NewLeague_new"],"type":["numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric"],"role":["predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","outcome","predictor","predictor","predictor","predictor","predictor","predictor"],"source":["original","original","original","original","original","original","original","original","original","original","original","original","original","original","original","original","original","derived","derived","derived","derived","derived","derived"]},"columns":[{"accessor":"variable","name":"variable","type":"character"},{"accessor":"type","name":"type","type":"character"},{"accessor":"role","name":"role","type":"character"},{"accessor":"source","name":"source","type":"character"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"93057f8a0965c428e362dbde37c87b5a","key":"93057f8a0965c428e362dbde37c87b5a"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>rec <span class="sc">%&gt;%</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">bake</span>(<span class="at">new_data =</span> Hitters_train) <span class="sc">%&gt;%</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-596fa7a1433718a550d7" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-596fa7a1433718a550d7">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"AtBat":[185,298,323,190,127,426,419,268,416,199,521,280,511,215,472,445,143,185,600,151,278,341,399,165,315,181,328,279,338,216,209,407,209,504,258,211,299,547,540,236,312,126,382,549,512,461,453,578,408,593,196,204,254,416,405,244,313,155,236,216,311,351,155,415,325,574,327,354,539,340,220,278,663,160,210,537,257,404,344,680,431,576,288,369,572,357,376,246,205,394,522,528,281,687,265,205,193,213,441,475,479,496,594,574,202,418,239,472,403,507,255,314,424,566,283,408,510,380,584,306,343,579,184,591,283,560,503,491,625,490,442,288,330,526,313,237,473,271,419,348,523,627,530,562,642,127,480,360,387,497,401,568,629,587,379,526,457,591,627,585,512,677,614,637,475,565,495,441,490,570,479,599,497,618,429,490,550,586,484,589,327,489,20,374,437,608,496,522,557,593,559,510,172,580,492,573],"Hits":[37,73,81,46,32,109,108,60,113,53,142,82,138,51,118,99,39,40,144,41,86,95,102,39,76,58,91,64,92,54,56,93,54,120,60,43,75,137,135,56,68,27,101,149,117,112,103,138,117,172,43,49,68,132,102,58,78,44,56,53,81,97,41,115,76,152,85,77,139,84,54,70,200,39,70,147,66,92,85,223,127,167,76,93,152,96,82,76,52,86,140,122,76,213,68,43,47,61,113,126,130,141,169,159,53,113,60,116,101,122,70,83,110,154,77,94,126,120,158,104,103,174,47,184,74,161,136,141,179,148,131,65,77,163,83,52,154,77,101,90,135,178,159,169,211,32,112,81,124,127,92,158,168,163,106,146,101,168,177,139,131,238,163,174,123,148,151,128,125,169,133,183,136,200,91,150,147,159,127,149,84,131,1,94,123,160,119,163,142,152,141,147,42,207,136,144],"HmRun":[1,0,6,2,8,3,6,5,24,5,20,16,25,4,12,1,5,4,33,4,4,6,3,2,13,6,12,0,18,2,12,8,3,28,8,10,6,2,30,6,2,3,16,7,29,18,8,1,11,22,7,6,2,7,18,9,6,6,0,1,3,4,12,27,16,31,3,16,5,11,10,7,29,8,13,23,5,11,24,31,8,8,7,9,18,7,21,5,8,1,16,1,3,10,8,2,10,4,5,3,18,20,4,21,4,13,0,16,12,29,7,13,15,22,14,4,2,5,15,14,6,7,5,20,4,26,5,11,4,14,18,8,19,12,9,0,6,5,18,11,8,14,3,17,14,4,18,5,1,7,17,20,18,4,10,13,14,19,25,31,26,31,29,31,27,24,17,16,24,21,10,10,7,20,12,21,29,12,20,21,22,19,0,5,9,28,8,9,21,23,2,10,3,8,5,9],"Runs":[23,24,26,24,16,55,55,24,58,29,67,44,76,19,63,46,18,23,85,26,33,48,56,13,35,34,51,31,42,27,22,47,25,71,28,26,38,58,82,41,32,8,50,73,54,54,53,56,66,82,29,23,28,57,49,28,32,21,27,31,42,55,21,97,33,91,30,36,93,62,30,22,108,18,32,58,31,54,69,119,77,89,34,43,105,50,42,35,31,38,73,67,42,91,26,24,21,17,76,61,66,65,74,107,31,48,30,60,45,78,49,39,70,76,45,42,42,54,70,50,48,67,20,83,34,89,62,77,94,64,68,30,47,88,43,15,61,35,65,50,52,68,82,88,107,14,50,37,67,65,49,89,73,92,38,71,42,80,98,93,69,117,89,89,76,90,61,70,81,72,48,80,58,98,41,69,85,72,66,89,53,77,0,36,62,130,57,82,58,69,48,56,17,107,76,85],"RBI":[8,24,32,8,22,43,36,25,69,22,86,45,96,18,54,24,30,11,117,21,38,42,34,9,60,23,43,26,60,25,36,30,14,71,33,35,23,47,88,19,22,10,55,47,88,54,33,59,41,100,27,25,26,49,85,25,41,23,15,15,30,29,29,71,52,101,44,55,58,33,39,37,121,31,51,88,26,49,64,96,45,49,37,42,49,45,60,39,27,28,77,45,25,65,30,17,29,22,52,43,72,78,51,75,26,61,11,62,53,85,35,46,47,84,47,36,44,51,84,58,36,78,28,79,29,96,48,47,60,78,77,36,53,50,41,25,48,29,58,45,44,76,50,73,59,25,71,44,27,48,66,75,102,51,60,70,63,72,81,94,96,113,83,116,93,104,84,73,105,88,72,74,38,110,42,58,91,79,65,86,62,55,0,26,55,74,33,46,81,75,61,52,14,71,50,60],"Walks":[21,7,8,15,14,62,22,15,16,21,45,47,61,11,30,29,15,18,65,19,45,20,34,16,25,22,33,30,21,33,19,30,12,54,18,39,26,12,55,21,24,5,22,42,43,35,52,34,34,57,30,12,22,33,20,35,12,15,11,22,26,39,22,68,37,64,20,41,69,47,31,18,32,22,28,47,32,18,88,34,58,57,15,49,65,39,35,13,17,36,60,51,20,27,29,20,24,3,76,52,76,37,35,59,27,47,22,74,39,91,43,16,36,43,26,66,35,31,42,25,40,58,18,38,22,66,83,37,65,49,33,27,27,77,30,30,29,33,92,43,52,46,47,53,52,12,44,37,36,37,65,73,40,70,30,84,22,39,70,62,52,53,75,56,72,77,78,80,62,38,55,32,26,62,57,35,71,53,67,64,38,34,0,62,40,89,21,62,23,53,73,53,15,105,94,78],"Years":[2,3,2,5,8,1,3,2,1,3,4,2,3,1,4,4,9,3,2,2,1,10,5,3,3,1,2,1,3,1,2,2,1,3,3,3,3,2,1,5,1,4,1,1,6,2,2,3,1,1,13,7,6,3,6,4,12,16,4,4,17,4,16,3,5,3,8,20,5,5,5,18,4,14,15,10,14,6,7,3,2,4,4,5,2,5,5,6,12,4,4,4,8,4,7,7,6,17,5,6,3,11,11,10,9,4,6,6,12,18,15,5,7,14,16,9,11,8,5,7,15,6,11,5,10,4,10,15,5,13,6,9,6,4,14,24,6,12,20,10,9,6,6,8,5,19,7,7,7,5,13,15,18,6,14,6,17,9,6,17,14,5,11,14,4,14,10,14,13,7,17,5,11,13,13,14,6,9,7,7,10,7,2,7,9,8,7,13,18,6,8,7,10,5,12,8],"CAtBat":[214,509,341,479,727,426,591,350,416,514,815,428,592,215,793,618,639,524,696,288,278,2964,670,196,630,181,342,279,682,216,216,969,209,1085,638,498,580,1038,540,1257,312,239,382,549,1750,680,507,1399,408,593,3231,1309,999,932,950,1335,3742,6631,1115,926,8247,1258,5409,711,1506,985,2140,8716,1469,1516,1185,7186,1447,2128,4040,2744,3910,1354,911,1928,667,822,1644,1258,978,1394,1770,912,5134,1089,730,1716,2658,1518,1337,854,1136,4061,1546,1700,1624,5628,4408,4631,1876,1512,1941,1924,5150,7761,6311,1457,2130,6100,6840,3573,5562,3118,2358,2954,4338,3053,3327,1689,3919,1789,3423,4291,1696,3400,1416,2815,1928,1556,5885,14053,1966,4933,9528,2288,3368,3146,1619,3181,2364,8396,3031,2268,1775,2703,5206,8068,8424,2695,6207,2648,6521,4478,3210,7546,5347,2223,5017,6727,1810,7287,5624,6675,6063,3754,7472,2482,3871,7127,5590,6126,2816,3082,3006,3558,4273,2051,41,1968,4139,4071,3358,7037,8759,2765,3162,2872,4086,2778,5511,3198],"CHits":[42,108,86,102,180,109,149,78,113,120,205,113,164,51,187,129,151,125,173,68,86,808,167,44,151,58,94,64,185,54,58,230,54,259,170,116,160,271,135,329,68,49,101,149,412,160,123,357,117,172,825,308,236,273,231,333,968,1634,270,210,2198,353,1338,184,351,260,568,2172,369,376,299,2081,404,543,1130,730,979,325,214,587,187,232,408,323,249,344,408,234,1323,267,185,403,657,448,339,219,256,1145,397,433,457,1575,1133,1300,467,392,510,489,1429,1947,1661,405,544,1583,1910,866,1578,900,636,822,1193,880,890,462,1062,470,970,1240,476,1000,398,698,516,470,1543,4256,566,1358,2510,614,895,902,426,841,770,2402,771,566,506,806,1332,2273,2464,747,1906,715,1767,1307,927,1982,1397,737,1388,2024,471,2083,1679,2095,1646,1077,2147,715,1066,2163,1397,1839,815,880,844,928,1123,549,9,519,1203,1182,882,2019,2583,686,874,821,1150,978,1511,857],"CHmRun":[1,0,6,5,24,3,8,5,24,8,22,25,28,4,14,1,16,7,38,9,4,81,4,2,24,6,12,0,36,2,12,14,3,54,17,14,8,3,30,24,2,3,16,7,100,24,8,7,11,22,36,27,21,24,29,49,35,98,1,9,100,16,181,45,71,53,16,384,12,42,40,190,57,56,97,97,33,30,64,35,9,19,16,54,36,43,115,12,56,3,22,12,48,15,32,12,42,83,17,7,63,225,19,90,15,41,4,67,166,347,154,28,38,131,259,59,44,92,58,55,70,32,74,40,85,65,20,84,12,113,47,55,90,38,104,160,29,48,548,43,39,74,11,61,27,242,110,41,6,32,253,177,164,17,146,77,281,113,133,315,221,93,266,247,108,305,275,209,271,140,153,27,40,351,83,121,117,83,116,102,212,62,2,26,79,103,36,153,271,133,16,63,57,32,39,97],"CRuns":[30,41,32,65,67,55,80,34,58,57,99,61,87,19,102,72,80,58,101,45,33,379,89,18,68,34,51,31,88,27,24,121,25,150,80,59,71,129,82,166,32,16,50,73,204,76,63,149,66,82,376,126,108,113,99,164,409,698,116,118,950,196,746,156,195,148,216,1172,247,284,145,935,210,304,544,302,518,188,150,262,117,132,198,181,168,178,238,102,643,94,93,211,324,196,135,105,129,488,226,217,224,828,501,702,192,205,309,242,747,1175,1019,156,335,743,915,429,703,444,265,313,581,366,419,219,505,233,408,615,216,445,210,315,247,245,751,2165,250,630,1509,295,377,494,218,450,352,1048,338,279,272,379,784,1045,1008,442,859,352,1003,634,529,1141,712,349,813,978,292,1135,884,1072,847,492,980,330,450,1104,578,983,405,363,436,513,577,300,6,181,676,862,365,1043,1138,369,421,307,579,474,897,470],"CRBI":[9,37,34,23,82,43,46,29,69,40,103,70,110,18,80,31,97,37,130,39,38,428,48,10,94,23,44,26,112,25,37,69,14,167,75,55,33,80,88,125,22,13,55,47,276,75,39,161,41,100,290,132,117,121,138,179,321,661,64,69,909,110,805,119,219,173,208,1267,126,141,154,1088,222,268,462,351,324,135,156,201,64,83,120,177,91,192,299,96,445,71,106,146,300,137,163,99,139,491,149,93,266,838,336,504,186,204,103,251,666,1152,608,159,174,693,1067,365,519,419,316,377,421,337,382,195,456,260,303,430,163,491,203,325,288,167,714,1314,252,435,1659,273,284,345,149,342,230,1348,406,257,125,311,890,993,1072,198,803,342,977,563,472,1179,815,401,822,1093,343,1234,1015,1050,999,589,1032,326,367,1289,579,707,474,477,458,471,700,263,7,199,390,417,280,827,1299,384,349,340,363,322,451,420],"CWalks":[24,12,8,39,56,62,31,18,16,39,78,63,71,11,50,48,61,47,69,35,45,221,54,18,55,22,33,30,50,33,19,68,12,114,36,78,44,24,55,105,24,14,22,42,155,49,58,87,34,57,238,66,118,80,64,194,170,777,57,114,690,117,875,99,214,95,93,1057,198,219,128,643,68,298,551,174,382,63,187,91,88,79,113,157,101,136,157,80,459,76,86,155,179,89,128,71,106,244,191,146,263,354,194,488,161,203,207,240,526,1380,820,76,258,300,546,410,256,240,134,187,325,218,304,82,283,155,414,340,166,301,136,189,161,174,535,1566,178,403,1342,269,296,242,163,373,193,819,239,246,194,138,866,732,402,317,571,289,619,319,313,727,548,171,617,495,267,791,709,695,680,263,854,158,241,564,644,600,319,295,377,351,334,153,4,288,364,708,165,535,478,321,359,174,406,417,875,332],"PutOuts":[76,121,143,102,202,361,226,442,203,152,107,148,157,116,228,278,138,97,319,28,102,158,211,332,498,88,145,107,0,317,201,172,102,103,358,463,212,261,157,172,86,190,200,255,1236,111,289,133,942,1222,80,419,359,73,161,142,106,53,125,73,153,226,165,274,726,1253,91,83,462,185,50,0,241,33,0,92,87,222,0,429,283,325,203,149,325,167,0,44,155,203,1320,209,106,294,92,131,299,178,160,37,880,200,282,238,304,211,121,518,316,808,51,533,292,316,144,282,207,237,331,116,211,280,49,303,145,332,65,239,303,0,233,259,149,250,58,523,846,62,0,60,367,309,196,351,337,167,94,170,186,325,0,105,1067,434,72,303,389,67,240,0,119,1377,303,278,226,292,1045,97,869,295,237,231,304,330,686,96,1218,181,1231,371,483,310,78,756,82,426,155,352,1160,315,352,810,65,121,313,1314],"Assists":[127,283,290,177,22,22,7,59,70,3,242,4,7,5,377,415,15,2,4,56,4,4,9,19,39,0,59,205,0,36,6,317,6,283,32,32,1,459,6,1,150,2,7,450,98,226,407,371,72,139,45,46,30,177,10,14,206,88,199,152,223,7,9,2,87,111,185,174,9,8,136,0,8,3,0,257,166,5,0,8,8,12,3,1,13,2,0,0,3,369,166,372,144,445,5,6,13,45,290,113,82,11,421,445,45,11,151,55,6,108,54,40,6,439,6,487,358,8,20,222,56,479,2,12,5,9,258,8,450,0,7,30,8,11,141,43,84,90,0,176,475,492,354,442,19,18,270,284,290,9,0,290,157,9,170,9,39,147,482,0,216,100,6,9,10,9,88,218,62,15,5,374,347,16,46,5,104,13,80,6,48,9,220,64,170,4,371,9,53,10,414,99,0,267,381,131],"Errors":[7,9,19,16,2,2,4,6,10,5,23,2,8,12,26,16,1,2,14,2,2,5,3,2,13,3,8,16,0,1,3,25,3,19,8,8,2,22,14,4,15,9,6,17,18,11,6,20,11,15,8,5,4,18,3,2,7,3,13,11,10,3,1,7,3,11,12,16,7,4,20,0,6,0,0,20,14,5,0,6,3,8,3,6,3,4,0,1,2,16,17,17,7,13,3,1,5,4,11,7,14,3,25,22,11,7,6,3,5,2,8,4,3,10,5,19,20,1,4,15,13,5,0,5,7,8,8,2,14,0,7,10,6,1,23,6,9,3,0,6,19,5,15,17,4,6,16,3,17,3,0,10,14,3,24,9,4,4,13,0,12,6,6,9,6,5,13,16,8,5,4,18,10,8,4,3,10,4,7,6,6,9,6,15,15,6,29,1,7,6,9,18,0,19,20,12],"Salary":[70,100,75,175,135,115,110,90,90,75,105,110,145,70,155,87.5,175,90,165,95,110,100,80,75,155,86.5,125,75,145,75,90,150,68,175,137,120,140,175,172,190,70,190,97.5,140,100,135,105,160,120,165,240,300,305,215,415,340,416.667,275,230,225,320,210,260,300,385,215,362.5,200,400,400,297.5,325,250,275,365,277.5,250,300,300,365,202.5,210,240,350,200,300,425,250,400,250,200,350,341.667,350,425,286.667,245,235,425,385,480,500,750,517.143,512.5,550,700,600,675,535,450,431.5,490,750,700,535,737.5,600,662.5,750,430,657,450,630,737.5,625,725,525,575,700,550,650,670,750,450,750,580,450,487.5,450,750,740,475,530,740,500,750,525,550,700,1100,775,776.667,765,850,815,875,1200,1350,950,850,1975,1900,1041.667,1220,1861.46,2460,1500,1925.571,950,773.333,775,850,2412.5,825,1000,1310,1043.333,1183.333,787.5,800,780,2127.333,875,1260,1670,875,1000,1450,940,925,1150,900,1600,875,960],"League_N":[1,0,1,0,1,0,1,1,0,0,0,0,0,0,0,0,1,1,0,0,1,1,0,0,1,1,1,1,0,1,1,1,0,0,0,0,1,0,0,0,0,1,0,1,0,0,0,1,1,0,1,0,0,1,1,1,1,1,0,1,1,1,0,1,1,1,0,1,0,1,1,0,0,0,0,1,1,0,0,0,1,1,1,0,0,0,0,0,0,1,1,0,0,0,1,1,0,0,0,0,0,1,0,0,1,1,0,1,0,0,1,0,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,0,0,0,0,1,1,0,1,1,0,0,0,0,1,1,0,0,1,1,1,1,1,1,0,1,0,0,1,1,0,0,0,0,0,0,1,1,1,0,0,0,1,0,1,0,0,0,0,0,0,1,1,0,0,0,1,1,0,0,1,0,1,0,1,1,1,0,0,0],"League_new":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"Division_W":[0,1,1,1,1,1,1,1,0,1,0,0,1,0,1,1,1,0,1,1,1,1,1,1,0,1,0,1,0,1,0,1,1,0,1,1,0,1,1,0,0,0,1,1,1,1,1,0,1,1,0,1,0,1,1,1,1,0,1,1,1,1,1,1,1,1,0,1,1,0,0,1,0,0,0,0,1,0,1,1,0,0,1,0,1,1,1,0,0,0,0,1,0,0,1,0,1,1,1,1,1,0,1,0,1,0,0,1,0,0,0,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,1,0,0,0,0,0,1,1,1,1,0,1,1,0,1,0,1,0,1,1,0,0,0,0,0,1,0,0,1,1,1,1,0,0,1,0,1,1,0,0,0,1,0,1,1,0,0,0,1,0,1,0,0,0,0,1,0,1,0,0,1,0,1,1,0,0,1,0,0,0],"Division_new":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"NewLeague_N":[0,0,1,0,1,1,1,1,0,0,0,0,0,0,0,0,1,1,0,0,1,1,0,1,1,1,1,1,0,1,1,1,0,0,0,0,1,0,0,0,0,1,0,1,0,0,0,1,1,0,1,0,0,1,1,1,1,1,0,1,1,0,0,1,0,1,0,1,0,0,1,0,0,0,0,1,0,0,0,0,1,1,1,0,0,0,0,0,0,1,1,0,0,0,0,1,0,0,0,0,0,1,0,0,1,1,0,1,0,0,1,0,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,0,0,1,0,0,1,0,1,1,0,0,0,0,1,1,0,0,1,1,1,1,1,1,0,1,0,0,1,1,0,0,0,0,0,0,1,1,1,0,0,0,1,0,1,0,0,0,1,1,0,1,1,0,1,0,1,1,0,0,1,0,1,0,1,1,1,0,0,0],"NewLeague_new":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},"columns":[{"accessor":"AtBat","name":"AtBat","type":"numeric"},{"accessor":"Hits","name":"Hits","type":"numeric"},{"accessor":"HmRun","name":"HmRun","type":"numeric"},{"accessor":"Runs","name":"Runs","type":"numeric"},{"accessor":"RBI","name":"RBI","type":"numeric"},{"accessor":"Walks","name":"Walks","type":"numeric"},{"accessor":"Years","name":"Years","type":"numeric"},{"accessor":"CAtBat","name":"CAtBat","type":"numeric"},{"accessor":"CHits","name":"CHits","type":"numeric"},{"accessor":"CHmRun","name":"CHmRun","type":"numeric"},{"accessor":"CRuns","name":"CRuns","type":"numeric"},{"accessor":"CRBI","name":"CRBI","type":"numeric"},{"accessor":"CWalks","name":"CWalks","type":"numeric"},{"accessor":"PutOuts","name":"PutOuts","type":"numeric"},{"accessor":"Assists","name":"Assists","type":"numeric"},{"accessor":"Errors","name":"Errors","type":"numeric"},{"accessor":"Salary","name":"Salary","type":"numeric"},{"accessor":"League_N","name":"League_N","type":"numeric"},{"accessor":"League_new","name":"League_new","type":"numeric"},{"accessor":"Division_W","name":"Division_W","type":"numeric"},{"accessor":"Division_new","name":"Division_new","type":"numeric"},{"accessor":"NewLeague_N","name":"NewLeague_N","type":"numeric"},{"accessor":"NewLeague_new","name":"NewLeague_new","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"91d83e4362f0de787eb993f4e0d30a53","key":"91d83e4362f0de787eb993f4e0d30a53"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>Do normalisation step.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>ridge_recipe <span class="ot">&lt;-</span> ridge_recipe <span class="sc">%&gt;%</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove predictors with zero variation</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_zv</span>(recipes<span class="sc">::</span><span class="fu">all_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Standardise all variable</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_normalize</span>(recipes<span class="sc">::</span><span class="fu">all_predictors</span>())</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>rec <span class="ot">&lt;-</span> recipes<span class="sc">::</span><span class="fu">prep</span>(<span class="at">x =</span> ridge_recipe, <span class="at">training =</span> Hitters_train)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>rec <span class="sc">%&gt;%</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">bake</span>(<span class="at">new_data =</span> Hitters_train) <span class="sc">%&gt;%</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-48aceddd48ca95df6702" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-48aceddd48ca95df6702">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"AtBat":[-1.48462564510093,-0.726218762830992,-0.558429629585431,-1.45106781845182,-1.87389643423063,0.132861599386281,0.0858806420775238,-0.927565722725665,0.0657459460880565,-1.39066373048341,0.770460305719413,-0.847026938767796,0.703344652421188,-1.28327868520625,0.441593604558113,0.260381340652907,-1.76651138895347,-1.48462564510093,1.30067396677539,-1.71281886631489,-0.86045006942744,-0.437621453648627,-0.048350664518925,-1.61885695169738,-0.61212215222401,-1.51147190642022,-0.524871802936318,-0.853738504097618,-0.457756149638094,-1.27656711987643,-1.32354807718519,0.00534185811965453,-1.32354807718519,0.656363695112431,-0.994681376023889,-1.31012494652554,-0.719507197501169,0.944961004294796,0.897980046986039,-1.14233581327998,-0.632256848213477,-1.88060799956045,-0.162447275125907,0.958384134954441,0.710056217751011,0.367766385930066,0.314073863291487,1.15301952951929,0.012053423449477,1.25369300946663,-1.41079842647288,-1.3571059038343,-1.02152763734318,0.0657459460880565,-0.00808127253999036,-1.0886432906414,-0.625545282883655,-1.6859726049956,-1.14233581327998,-1.27656711987643,-0.6389684135433,-0.370505800350402,-1.6859726049956,0.0590343807582341,-0.545006498925786,1.1261732682,-0.531583368266141,-0.350371104360935,0.891268481656217,-0.444333018978449,-1.24972085855714,-0.86045006942744,1.7235025825542,-1.65241477834649,-1.31683651185537,0.877845350996572,-1.00139294135371,-0.0147928378698128,-0.417486757659159,1.83759919316118,0.166419426035393,1.13959639885965,-0.793334416129216,-0.249697624413598,1.11275013754036,-0.330236408371468,-0.202716667104841,-1.07522015998176,-1.35039433850448,-0.0819084911680372,0.777171871049235,0.81744126302817,-0.840315373437973,1.88458015046994,-0.947700418715132,-1.35039433850448,-1.43093312246235,-1.2967018158659,0.233535079333618,0.461728300547581,0.48857456186687,0.602671172473852,1.26040457479645,1.1261732682,-1.37052903449395,0.0791690767477014,-1.12220111729052,0.441593604558113,-0.0215044031996352,0.676498391101899,-1.01481607201336,-0.618833717553833,0.119438468726636,1.07248074556142,-0.826892242778328,0.012053423449477,0.696633087091366,-0.175870405785551,1.19328892149823,-0.672526240192412,-0.424198322988982,1.15973109484911,-1.49133721043075,1.24026987880698,-0.826892242778328,1.03221135358249,0.649652129782609,0.56911334582474,1.46846310002095,0.562401780494917,0.24024664466344,-0.793334416129216,-0.511448672276673,0.804018132368525,-0.625545282883655,-1.13562424795016,0.448305169887936,-0.907431026736197,0.0858806420775238,-0.39064049633987,0.783883436379058,1.48188623068059,0.830864393687815,1.04563448424213,1.58255971062793,-1.87389643423063,0.495286127196693,-0.310101712382,-0.128889448476794,0.609382737803674,-0.0349275338592801,1.08590387622107,1.49530936134024,1.21342361748769,-0.182581971115374,0.804018132368525,0.340920124610777,1.24026987880698,1.48188623068059,1.20000048682805,0.710056217751011,1.81746449717171,1.3946358813929,1.54900188397882,0.461728300547581,1.0657691802316,0.595959607144029,0.233535079333618,0.562401780494917,1.09932700688071,0.48857456186687,1.29396240144556,0.609382737803674,1.42148214271219,0.152996295375748,0.562401780494917,0.965095700284264,1.20671205215787,0.522132388515983,1.22684674814734,-0.531583368266141,0.555690215165095,-2.59203392452163,-0.216139797764486,0.206688818014328,1.35436648941397,0.602671172473852,0.777171871049235,1.01207665759302,1.25369300946663,1.02549978825267,0.696633087091366,-1.57187599438862,1.16644266017894,0.575824911154562,1.11946170287018],"Hits":[-1.57139373465562,-0.784637600991384,-0.609802904621555,-1.37470470123956,-1.68066541988676,0.00211853267284884,-0.0197358043733799,-1.06874398259236,0.0895358808577636,-1.22172434191596,0.723311655198396,-0.587948567575326,0.635894307013481,-1.26543301600842,0.198807566088907,-0.216424837789438,-1.52768506056316,-1.50583072351693,0.767020329290853,-1.4839763864707,-0.500531219390411,-0.303842185974353,-0.150861826650752,-1.52768506056316,-0.719074589852698,-1.11245265668481,-0.391259534159268,-0.981326634407442,-0.369405197113039,-1.19987000486973,-1.15616133077727,-0.34755086006681,-1.19987000486973,0.242516240181364,-1.06874398259236,-1.44026771237824,-0.740928926898927,0.614039969967252,0.570331295874795,-1.15616133077727,-0.893909286222528,-1.7899371051179,-0.172716163696981,0.876292014521996,0.176953229042678,0.0676815438115349,-0.129007489604523,0.635894307013481,0.176953229042678,1.37894176658526,-1.44026771237824,-1.30914169010087,-0.893909286222528,0.504768284736109,-0.150861826650752,-1.11245265668481,-0.675365915760241,-1.41841337533202,-1.15616133077727,-1.22172434191596,-0.609802904621555,-0.260133511881895,-1.4839763864707,0.133244554950221,-0.719074589852698,0.941855025660683,-0.52238555643664,-0.697220252806469,0.65774864405971,-0.544239893482868,-1.19987000486973,-0.85020061213007,1.99086320387966,-1.52768506056316,-0.85020061213007,0.832583340429539,-0.937617960314985,-0.369405197113039,-0.52238555643664,2.49351295594292,0.395496599504965,1.26967008135411,-0.719074589852698,-0.34755086006681,0.941855025660683,-0.281987848928124,-0.587948567575326,-0.719074589852698,-1.24357867896219,-0.500531219390411,0.679602981105938,0.286224914273822,-0.719074589852698,2.27496958548063,-0.893909286222528,-1.44026771237824,-1.35285036419333,-1.04688964554613,0.0895358808577636,0.373642262458737,0.461059610643651,0.701457318152167,1.31337875544657,1.09483538498428,-1.22172434191596,0.0895358808577636,-1.06874398259236,0.15509889199645,-0.172716163696981,0.286224914273822,-0.85020061213007,-0.566094230529097,0.0239728697190775,0.98556369975314,-0.697220252806469,-0.325696523020581,0.373642262458737,0.242516240181364,1.07298104793805,-0.107153152558295,-0.129007489604523,1.42265044067771,-1.35285036419333,1.64119381114,-0.762783263945155,1.13854405907674,0.592185632921023,0.701457318152167,1.53192212590886,0.854437677475768,0.48291394768988,-0.959472297361214,-0.697220252806469,1.1822527331692,-0.566094230529097,-1.24357867896219,0.98556369975314,-0.697220252806469,-0.172716163696981,-0.413113871205496,0.570331295874795,1.51006778886263,1.09483538498428,1.31337875544657,2.23126091138818,-1.68066541988676,0.0676815438115349,-0.609802904621555,0.329933588366279,0.395496599504965,-0.369405197113039,1.07298104793805,1.29152441840034,1.1822527331692,-0.0634444784658372,0.81072900338331,-0.172716163696981,1.29152441840034,1.4882134518164,0.65774864405971,0.48291394768988,2.82132801163635,1.1822527331692,1.42265044067771,0.30807925132005,0.854437677475768,0.920000688614454,0.417350936551194,0.351787925412508,1.31337875544657,0.526622621782337,1.61933947409377,0.592185632921023,1.99086320387966,-0.391259534159268,0.898146351568225,0.832583340429539,1.09483538498428,0.395496599504965,0.876292014521996,-0.544239893482868,0.48291394768988,-2.35814986831985,-0.325696523020581,0.30807925132005,1.11668972203051,0.220661903135136,1.1822527331692,0.723311655198396,0.941855025660683,0.701457318152167,0.832583340429539,-1.46212204942447,2.14384356320326,0.592185632921023,0.767020329290853],"HmRun":[-1.25027916596267,-1.36719458415384,-0.665702075006842,-1.13336374777151,-0.431871238624511,-1.01644832958034,-0.665702075006842,-0.782617493198008,1.43877545243414,-0.782617493198008,0.97111377966948,0.503452106904816,1.55569087062531,-0.899532911389174,0.0357904341401528,-1.25027916596267,-0.782617493198008,-0.899532911389174,2.49101421615464,-0.899532911389174,-0.899532911389174,-0.665702075006842,-1.01644832958034,-1.13336374777151,0.152705852331319,-0.665702075006842,0.0357904341401528,-1.36719458415384,0.737282943287148,-1.13336374777151,0.0357904341401528,-0.431871238624511,-1.01644832958034,1.90643712519881,-0.431871238624511,-0.198040402242179,-0.665702075006842,-1.13336374777151,2.14026796158114,-0.665702075006842,-1.13336374777151,-1.01644832958034,0.503452106904816,-0.548786656815677,2.02335254338997,0.737282943287148,-0.431871238624511,-1.25027916596267,-0.0811249840510131,1.20494461605181,-0.548786656815677,-0.665702075006842,-1.13336374777151,-0.548786656815677,0.737282943287148,-0.314955820433345,-0.665702075006842,-0.665702075006842,-1.36719458415384,-1.25027916596267,-1.01644832958034,-0.899532911389174,0.0357904341401528,1.78952170700764,0.503452106904816,2.2571833797723,-1.01644832958034,0.503452106904816,-0.782617493198008,-0.0811249840510131,-0.198040402242179,-0.548786656815677,2.02335254338997,-0.431871238624511,0.152705852331319,1.32186003424298,-0.782617493198008,-0.0811249840510131,1.43877545243414,2.2571833797723,-0.431871238624511,-0.431871238624511,-0.548786656815677,-0.314955820433345,0.737282943287148,-0.548786656815677,1.08802919786065,-0.782617493198008,-0.431871238624511,-1.25027916596267,0.503452106904816,-1.25027916596267,-1.01644832958034,-0.198040402242179,-0.431871238624511,-1.13336374777151,-0.198040402242179,-0.899532911389174,-0.782617493198008,-1.01644832958034,0.737282943287148,0.97111377966948,-0.899532911389174,1.08802919786065,-0.899532911389174,0.152705852331319,-1.36719458415384,0.503452106904816,0.0357904341401528,2.02335254338997,-0.548786656815677,0.152705852331319,0.38653668871365,1.20494461605181,0.269621270522485,-0.899532911389174,-1.13336374777151,-0.782617493198008,0.38653668871365,0.269621270522485,-0.665702075006842,-0.548786656815677,-0.782617493198008,0.97111377966948,-0.899532911389174,1.67260628881647,-0.782617493198008,-0.0811249840510131,-0.899532911389174,0.269621270522485,0.737282943287148,-0.431871238624511,0.854198361478314,0.0357904341401528,-0.314955820433345,-1.36719458415384,-0.665702075006842,-0.782617493198008,0.737282943287148,-0.0811249840510131,-0.431871238624511,0.269621270522485,-1.01644832958034,0.620367525095982,0.269621270522485,-0.899532911389174,0.737282943287148,-0.782617493198008,-1.25027916596267,-0.548786656815677,0.620367525095982,0.97111377966948,0.737282943287148,-0.899532911389174,-0.198040402242179,0.152705852331319,0.269621270522485,0.854198361478314,1.55569087062531,2.2571833797723,1.67260628881647,2.2571833797723,2.02335254338997,2.2571833797723,1.78952170700764,1.43877545243414,0.620367525095982,0.503452106904816,1.43877545243414,1.08802919786065,-0.198040402242179,-0.198040402242179,-0.548786656815677,0.97111377966948,0.0357904341401528,1.08802919786065,2.02335254338997,0.0357904341401528,0.97111377966948,1.08802919786065,1.20494461605181,0.854198361478314,-1.36719458415384,-0.782617493198008,-0.314955820433345,1.90643712519881,-0.431871238624511,-0.314955820433345,1.08802919786065,1.32186003424298,-1.13336374777151,-0.198040402242179,-1.01644832958034,-0.431871238624511,-0.782617493198008,-0.314955820433345],"Runs":[-1.25259030674188,-1.21340937790029,-1.1350475202171,-1.21340937790029,-1.52685680863301,0.0011994161890283,0.0011994161890283,-1.21340937790029,0.118742202713801,-1.01750473369233,0.471370562288118,-0.42979080106847,0.823998921862435,-1.40931402210824,0.314646846921755,-0.351428943385289,-1.44849495094983,-1.25259030674188,1.17662728143675,-1.1350475202171,-0.860781018325969,-0.273067085702107,0.0403803450306191,-1.64439959515778,-0.782419160642787,-0.821600089484378,-0.155524299177335,-0.939142876009151,-0.508152658751652,-1.09586659137551,-1.29177123558347,-0.312248014543698,-1.1742284490587,0.628094277654481,-1.05668566253392,-1.1350475202171,-0.664876374118015,0.118742202713801,1.05908449491198,-0.547333587593243,-0.89996194716756,-1.84030423936574,-0.194705228018926,0.706456135337662,-0.0379815126525625,-0.0379815126525625,-0.0771624414941533,0.0403803450306191,0.432189633446527,1.05908449491198,-1.01750473369233,-1.25259030674188,-1.05668566253392,0.0795612738722099,-0.233886156860516,-1.05668566253392,-0.89996194716756,-1.33095216442506,-1.09586659137551,-0.939142876009151,-0.508152658751652,0.0011994161890283,-1.33095216442506,1.64679842753584,-0.860781018325969,1.4117128544863,-0.978323804850741,-0.743238231801197,1.49007471216948,0.275465918080164,-0.978323804850741,-1.29177123558347,2.07778864479334,-1.44849495094983,-0.89996194716756,0.118742202713801,-0.939142876009151,-0.0379815126525625,0.549732419971299,2.50877886205084,0.863179850704026,1.33335099680312,-0.821600089484378,-0.468971729910061,1.96024585826857,-0.194705228018926,-0.508152658751652,-0.782419160642787,-0.939142876009151,-0.664876374118015,0.706456135337662,0.471370562288118,-0.508152658751652,1.4117128544863,-1.1350475202171,-1.21340937790029,-1.33095216442506,-1.48767587979142,0.823998921862435,0.236284989238573,0.432189633446527,0.393008704604936,0.745637064179253,2.03860771595175,-0.939142876009151,-0.273067085702107,-0.978323804850741,0.197104060396982,-0.39060987222688,0.902360779545616,-0.233886156860516,-0.625695445276424,0.58891334881289,0.823998921862435,-0.39060987222688,-0.508152658751652,-0.508152658751652,-0.0379815126525625,0.58891334881289,-0.194705228018926,-0.273067085702107,0.471370562288118,-1.37013309326665,1.09826542375357,-0.821600089484378,1.33335099680312,0.275465918080164,0.863179850704026,1.52925564101107,0.353827775763345,0.510551491129709,-0.978323804850741,-0.312248014543698,1.29417006796152,-0.468971729910061,-1.5660377374746,0.236284989238573,-0.782419160642787,0.393008704604936,-0.194705228018926,-0.116343370335744,0.510551491129709,1.05908449491198,1.29417006796152,2.03860771595175,-1.60521866631619,-0.194705228018926,-0.704057302959606,0.471370562288118,0.393008704604936,-0.233886156860516,1.33335099680312,0.706456135337662,1.45089378332789,-0.664876374118015,0.628094277654481,-0.508152658751652,0.980722637228798,1.68597935637743,1.49007471216948,0.549732419971299,2.43041700436766,1.33335099680312,1.33335099680312,0.823998921862435,1.37253192564471,0.236284989238573,0.58891334881289,1.01990356607039,0.667275206496072,-0.273067085702107,0.980722637228798,0.118742202713801,1.68597935637743,-0.547333587593243,0.549732419971299,1.17662728143675,0.667275206496072,0.432189633446527,1.33335099680312,-0.0771624414941533,0.863179850704026,-2.15375167009847,-0.743238231801197,0.275465918080164,2.93976907930834,0.0795612738722099,1.05908449491198,0.118742202713801,0.549732419971299,-0.273067085702107,0.0403803450306191,-1.48767587979142,2.03860771595175,0.823998921862435,1.17662728143675],"RBI":[-1.70856316657107,-1.08784327658417,-0.777483331590727,-1.70856316657107,-1.16543326283254,-0.350738407224737,-0.622303359094003,-1.04904828345999,0.657931414003965,-1.16543326283254,1.31744629711504,-0.273148420976375,1.70539622835685,-1.32061323532926,0.0760065171412524,-1.08784327658417,-0.855073317839088,-1.59217818719852,2.52009108396465,-1.20422825595672,-0.544713372845641,-0.389533400348918,-0.699893345342365,-1.66976817344689,0.308776475886338,-1.12663826970835,-0.350738407224737,-1.01025329033581,0.308776475886338,-1.04904828345999,-0.622303359094003,-0.855073317839088,-1.47579320782598,0.735521400252327,-0.738688338466546,-0.661098352218184,-1.12663826970835,-0.195558434728014,1.3950362833634,-1.28181824220508,-1.16543326283254,-1.63097318032271,0.114801510265433,-0.195558434728014,1.3950362833634,0.0760065171412524,-0.738688338466546,0.269981482762157,-0.428328393473099,1.86057620085357,-0.971458297211631,-1.04904828345999,-1.01025329033581,-0.117968448479652,1.27865130399086,-1.04904828345999,-0.428328393473099,-1.12663826970835,-1.4369982147018,-1.4369982147018,-0.855073317839088,-0.893868310963269,-0.893868310963269,0.735521400252327,-0.00158346910710934,1.89937119397775,-0.311943414100556,0.114801510265433,0.231186489637976,-0.738688338466546,-0.505918379721461,-0.583508365969822,2.67527105646137,-0.816278324714907,-0.0403784622312902,1.3950362833634,-1.01025329033581,-0.117968448479652,0.463956448383061,1.70539622835685,-0.273148420976375,-0.117968448479652,-0.583508365969822,-0.389533400348918,-0.117968448479652,-0.273148420976375,0.308776475886338,-0.505918379721461,-0.971458297211631,-0.93266330408745,0.968291358997412,-0.273148420976375,-1.04904828345999,0.502751441507242,-0.855073317839088,-1.35940822845344,-0.893868310963269,-1.16543326283254,-0.00158346910710934,-0.350738407224737,0.774316393376508,1.00708635212159,-0.0403784622312902,0.89070137274905,-1.01025329033581,0.347571469010518,-1.59217818719852,0.386366462134699,0.0372115240170715,1.27865130399086,-0.661098352218184,-0.234353427852195,-0.195558434728014,1.23985631086668,-0.195558434728014,-0.622303359094003,-0.311943414100556,-0.0403784622312902,1.23985631086668,0.231186489637976,-0.622303359094003,1.00708635212159,-0.93266330408745,1.04588134524577,-0.893868310963269,1.70539622835685,-0.156763441603833,-0.195558434728014,0.308776475886338,1.00708635212159,0.968291358997412,-0.622303359094003,0.0372115240170715,-0.0791734553554711,-0.428328393473099,-1.04904828345999,-0.156763441603833,-0.893868310963269,0.231186489637976,-0.273148420976375,-0.311943414100556,0.929496365873231,-0.0791734553554711,0.813111386500689,0.269981482762157,-1.04904828345999,0.735521400252327,-0.311943414100556,-0.971458297211631,-0.156763441603833,0.541546434631423,0.89070137274905,1.93816618710193,-0.0403784622312902,0.308776475886338,0.696726407128146,0.42516145525888,0.774316393376508,1.12347133149414,1.62780624210849,1.70539622835685,2.36491111146792,1.2010613177425,2.48129609084047,1.58901124898431,2.0157561733503,1.23985631086668,0.813111386500689,2.05455116647448,1.3950362833634,0.774316393376508,0.85190637962487,-0.544713372845641,2.24852613209538,-0.389533400348918,0.231186489637976,1.51142126273594,1.04588134524577,0.502751441507242,1.31744629711504,0.386366462134699,0.114801510265433,-2.01892311156451,-1.01025329033581,0.114801510265433,0.85190637962487,-0.738688338466546,-0.234353427852195,1.12347133149414,0.89070137274905,0.347571469010518,-0.00158346910710934,-1.47579320782598,0.735521400252327,-0.0791734553554711,0.308776475886338],"Walks":[-0.908711113837888,-1.56111909300355,-1.51451852306315,-1.18831453348032,-1.23491510342072,1.0019122537187,-0.862110543897484,-1.18831453348032,-1.14171396353991,-0.908711113837888,0.20970256473182,0.302903704612629,0.955311683778293,-1.37471681324193,-0.489305984374247,-0.535906554314652,-1.18831453348032,-1.0485128236591,1.14171396353991,-1.0019122537187,0.20970256473182,-0.955311683778293,-0.302903704612629,-1.14171396353991,-0.72230883407627,-0.862110543897484,-0.349504274553034,-0.489305984374247,-0.908711113837888,-0.349504274553034,-1.0019122537187,-0.489305984374247,-1.32811624330153,0.629107694195461,-1.0485128236591,-0.0699008549106068,-0.675708264135865,-1.32811624330153,0.675708264135865,-0.908711113837888,-0.768909404016675,-1.65432023288436,-0.862110543897484,0.0699008549106068,0.116501424851011,-0.256303134672225,0.535906554314652,-0.302903704612629,-0.302903704612629,0.768909404016675,-0.489305984374247,-1.32811624330153,-0.862110543897484,-0.349504274553034,-0.955311683778293,-0.256303134672225,-1.32811624330153,-1.18831453348032,-1.37471681324193,-0.862110543897484,-0.675708264135865,-0.0699008549106068,-0.862110543897484,1.28151567336112,-0.163101994791416,1.09511339359951,-0.955311683778293,0.0233002849702023,1.32811624330153,0.302903704612629,-0.442705414433843,-1.0485128236591,-0.396104844493438,-0.862110543897484,-0.582507124255056,0.302903704612629,-0.396104844493438,-1.0485128236591,2.21352707216921,-0.302903704612629,0.815509973957079,0.768909404016675,-1.18831453348032,0.396104844493438,1.14171396353991,-0.0699008549106068,-0.256303134672225,-1.28151567336112,-1.09511339359951,-0.20970256473182,0.908711113837888,0.489305984374247,-0.955311683778293,-0.629107694195461,-0.535906554314652,-0.955311683778293,-0.768909404016675,-1.74752137276517,1.65432023288436,0.535906554314652,1.65432023288436,-0.163101994791416,-0.256303134672225,0.862110543897484,-0.629107694195461,0.302903704612629,-0.862110543897484,1.56111909300355,-0.0699008549106068,2.35332878199043,0.116501424851011,-1.14171396353991,-0.20970256473182,0.116501424851011,-0.675708264135865,1.18831453348032,-0.256303134672225,-0.442705414433843,0.0699008549106068,-0.72230883407627,-0.0233002849702023,0.815509973957079,-1.0485128236591,-0.116501424851011,-0.862110543897484,1.18831453348032,1.98052422246719,-0.163101994791416,1.14171396353991,0.396104844493438,-0.349504274553034,-0.629107694195461,-0.629107694195461,1.70092080282476,-0.489305984374247,-0.489305984374247,-0.535906554314652,-0.349504274553034,2.39992935193083,0.116501424851011,0.535906554314652,0.256303134672225,0.302903704612629,0.582507124255056,0.535906554314652,-1.32811624330153,0.163101994791416,-0.163101994791416,-0.20970256473182,-0.163101994791416,1.14171396353991,1.51451852306315,-0.0233002849702023,1.37471681324193,-0.489305984374247,2.0271247924076,-0.862110543897484,-0.0699008549106068,1.37471681324193,1.0019122537187,0.535906554314652,0.582507124255056,1.60771966294396,0.72230883407627,1.46791795312274,1.70092080282476,1.74752137276517,1.84072251264598,1.0019122537187,-0.116501424851011,0.675708264135865,-0.396104844493438,-0.675708264135865,1.0019122537187,0.768909404016675,-0.256303134672225,1.42131738318234,0.582507124255056,1.23491510342072,1.09511339359951,-0.116501424851011,-0.302903704612629,-1.88732308258638,1.0019122537187,-0.0233002849702023,2.26012764210962,-0.908711113837888,1.0019122537187,-0.815509973957079,0.582507124255056,1.51451852306315,0.582507124255056,-1.18831453348032,3.00573676115609,2.49313049181164,1.74752137276517],"Years":[-1.08921688912025,-0.887814520943301,-1.08921688912025,-0.485009784589396,0.119197319941462,-1.29061925729721,-0.887814520943301,-1.08921688912025,-1.29061925729721,-0.887814520943301,-0.686412152766349,-1.08921688912025,-0.887814520943301,-1.29061925729721,-0.686412152766349,-0.686412152766349,0.320599688118414,-0.887814520943301,-1.08921688912025,-1.08921688912025,-1.29061925729721,0.522002056295367,-0.485009784589396,-0.887814520943301,-0.887814520943301,-1.29061925729721,-1.08921688912025,-1.29061925729721,-0.887814520943301,-1.29061925729721,-1.08921688912025,-1.08921688912025,-1.29061925729721,-0.887814520943301,-0.887814520943301,-0.887814520943301,-0.887814520943301,-1.08921688912025,-1.29061925729721,-0.485009784589396,-1.29061925729721,-0.686412152766349,-1.29061925729721,-1.29061925729721,-0.283607416412443,-1.08921688912025,-1.08921688912025,-0.887814520943301,-1.29061925729721,-1.29061925729721,1.12620916082622,-0.0822050482354908,-0.283607416412443,-0.887814520943301,-0.283607416412443,-0.686412152766349,0.924806792649272,1.73041626535708,-0.686412152766349,-0.686412152766349,1.93181863353404,-0.686412152766349,1.73041626535708,-0.887814520943301,-0.485009784589396,-0.887814520943301,0.119197319941462,2.53602573806489,-0.485009784589396,-0.485009784589396,-0.485009784589396,2.13322100171099,-0.686412152766349,1.32761152900318,1.52901389718013,0.522002056295367,1.32761152900318,-0.283607416412443,-0.0822050482354908,-0.887814520943301,-1.08921688912025,-0.686412152766349,-0.686412152766349,-0.485009784589396,-1.08921688912025,-0.485009784589396,-0.485009784589396,-0.283607416412443,0.924806792649272,-0.686412152766349,-0.686412152766349,-0.686412152766349,0.119197319941462,-0.686412152766349,-0.0822050482354908,-0.0822050482354908,-0.283607416412443,1.93181863353404,-0.485009784589396,-0.283607416412443,-0.887814520943301,0.72340442447232,0.72340442447232,0.522002056295367,0.320599688118414,-0.686412152766349,-0.283607416412443,-0.283607416412443,0.924806792649272,2.13322100171099,1.52901389718013,-0.485009784589396,-0.0822050482354908,1.32761152900318,1.73041626535708,0.320599688118414,0.72340442447232,0.119197319941462,-0.485009784589396,-0.0822050482354908,1.52901389718013,-0.283607416412443,0.72340442447232,-0.485009784589396,0.522002056295367,-0.686412152766349,0.522002056295367,1.52901389718013,-0.485009784589396,1.12620916082622,-0.283607416412443,0.320599688118414,-0.283607416412443,-0.686412152766349,1.32761152900318,3.3416352107727,-0.283607416412443,0.924806792649272,2.53602573806489,0.522002056295367,0.320599688118414,-0.283607416412443,-0.283607416412443,0.119197319941462,-0.485009784589396,2.33462336988794,-0.0822050482354908,-0.0822050482354908,-0.0822050482354908,-0.485009784589396,1.12620916082622,1.52901389718013,2.13322100171099,-0.283607416412443,1.32761152900318,-0.283607416412443,1.93181863353404,0.320599688118414,-0.283607416412443,1.93181863353404,1.32761152900318,-0.485009784589396,0.72340442447232,1.32761152900318,-0.686412152766349,1.32761152900318,0.522002056295367,1.32761152900318,1.12620916082622,-0.0822050482354908,1.93181863353404,-0.485009784589396,0.72340442447232,1.12620916082622,1.12620916082622,1.32761152900318,-0.283607416412443,0.320599688118414,-0.0822050482354908,-0.0822050482354908,0.522002056295367,-0.0822050482354908,-1.08921688912025,-0.0822050482354908,0.320599688118414,0.119197319941462,-0.0822050482354908,1.12620916082622,2.13322100171099,-0.283607416412443,0.119197319941462,-0.0822050482354908,0.522002056295367,-0.485009784589396,0.924806792649272,0.119197319941462],"CAtBat":[-1.05481858549541,-0.932382186755829,-1.00210867824142,-0.944833345949685,-0.841903763280476,-0.96683039385883,-0.898349018292623,-0.998373330483265,-0.970980780256782,-0.930306993556853,-0.805380362978499,-0.96600031657924,-0.897933979652828,-1.05440354685562,-0.814511213053993,-0.887142975018153,-0.878427163582453,-0.926156607158901,-0.854769961114127,-1.02410572615057,-1.02825611254852,0.0865376739413792,-0.865560965748802,-1.06228928101173,-0.88216251134061,-1.06851486060865,-1.00169363960163,-1.02784107390872,-0.86058050207126,-1.05398850821582,-1.05398850821582,-0.741464412450038,-1.05689377869439,-0.693319930233796,-0.878842202222249,-0.936947611793576,-0.90291444333037,-0.71282674630417,-0.919515988922178,-0.621933284189022,-1.01414479879548,-1.04444261950053,-0.985092094009819,-0.915780641164021,-0.41731923476999,-0.86141057935085,-0.933212264035419,-0.562997797338104,-0.974301089375144,-0.897518941013033,0.197352990766697,-0.600351274919672,-0.729013253256183,-0.756820842122461,-0.749350146606147,-0.589560270284996,0.409437735702042,1.60848436607037,-0.68086877103994,-0.759311073961232,2.2791868079794,-0.621518245549227,1.10130714824064,-0.848544381517199,-0.518588662880018,-0.734823794213315,-0.255454165249863,2.47383993004335,-0.53394509255244,-0.514438276482066,-0.651816066254276,1.8388308111567,-0.543075942627934,-0.260434628927405,0.533119250361011,-0.00477082681356415,0.479164227187635,-0.581674536128888,-0.76553665355816,-0.343442356886445,-0.866806081668188,-0.802475092499932,-0.461313330588281,-0.621518245549227,-0.737729064691882,-0.56507299053708,-0.409018461974086,-0.765121614918365,0.987171522296956,-0.691659775674615,-0.840658647361091,-0.431430548523026,-0.0404641498359511,-0.513608199202475,-0.588730193005406,-0.789193856026486,-0.672152959604241,0.54183506179671,-0.50198711728821,-0.43807116675975,-0.469614103384185,1.19220061035578,0.685853469805643,0.778407086479972,-0.365024366155795,-0.516098431041247,-0.338046854569107,-0.345102511445626,0.993812140533679,2.07747802903894,1.4756720013359,-0.538925556229983,-0.259604551647815,1.38809884833912,1.69522744178756,0.339296205576654,1.1648080601293,0.150453624469839,-0.16497574177451,0.0823872875434272,0.65680076501998,0.123476112883152,0.237196700187036,-0.442636591797497,0.482899574945792,-0.401132727817977,0.277040409607374,0.637293948949605,-0.43973132131893,0.267494520892085,-0.555942140461586,0.0246969166118948,-0.343442356886445,-0.497836730890258,1.29886554078315,4.68890115063032,-0.327670888574227,0.903748755698122,2.81085130555705,-0.194028446560174,0.254213284418639,0.162074706384105,-0.471689296583161,0.176601058776937,-0.162485509935739,2.34102756530889,0.114345262807657,-0.202329219356078,-0.40694326877511,-0.0217874110451672,1.01705430436221,2.20489489145606,2.35264864722315,-0.0251077201635288,1.4325079827972,-0.044614536233903,1.56283011569289,0.714906174591307,0.188637179330998,1.98824472148297,1.07557475257333,-0.221005958146862,0.938612001440918,1.6483280754907,-0.392416916382278,1.88074971377601,1.1905404557966,1.62674606622135,1.37274241866669,0.414418199379585,1.95753186213813,-0.113510950439906,0.462977720235623,1.81434353140878,1.17642914204357,1.39888985297379,0.02511195525169,0.135512233437212,0.103969296812777,0.333070625979726,0.629823253433292,-0.292392604191636,-1.12662027017998,-0.326840811294637,0.574208075700735,0.545985448194662,0.250062898020687,1.77699005382722,2.49168659155454,0.00394498462213498,0.168715324620828,0.048354119080221,0.55221102779159,0.00934048693947254,1.14364108949975,0.183656715653455],"CHits":[-1.03787202416862,-0.941591653956167,-0.97368511069365,-0.950344414884572,-0.836558522815313,-0.9401328604681,-0.881781120945403,-0.98535545859819,-0.93429768651583,-0.924086132099358,-0.800088685613628,-0.93429768651583,-0.859899218624392,-1.02474288277601,-0.826346968398841,-0.910956990706752,-0.878863533969269,-0.916792164659021,-0.846770077231785,-0.999943393478864,-0.97368511069365,0.0795637876910238,-0.85552283816019,-1.03495443719248,-0.878863533969269,-1.01453132835954,-0.962014762789111,-1.00577856743113,-0.829264555374976,-1.02036650231181,-1.01453132835954,-0.763618848411943,-1.02036650231181,-0.721313837257988,-0.851146457695988,-0.929921306051628,-0.865734392576662,-0.703808315401179,-0.902204229778347,-0.619198293093268,-0.999943393478864,-1.02766046975214,-0.951803208372639,-0.881781120945403,-0.498118433583673,-0.865734392576662,-0.919709751635156,-0.578352075427381,-0.928462512563561,-0.848228870719853,0.10436327698817,-0.649832956342684,-0.754866087483538,-0.700890728425044,-0.762160054923875,-0.613363119140999,0.31297074578181,1.28452720883471,-0.705267108889246,-0.792794718173291,2.10728673610473,-0.58418724937965,0.852724336366754,-0.830723348863044,-0.587104836355785,-0.71985504376992,-0.270546649445156,2.06935810541498,-0.560846553570572,-0.5506349991541,-0.662962097735291,1.93660789800084,-0.509788781488212,-0.307016486646841,0.549295290848732,-0.0342221043782346,0.329017474150552,-0.625033467045538,-0.786959544221021,-0.242829573171875,-0.826346968398841,-0.760701261435808,-0.503953607535943,-0.627951054021673,-0.735901772138662,-0.597316390772257,-0.503953607535943,-0.757783674459673,0.830842434045743,-0.709643489353448,-0.829264555374976,-0.51124757497628,-0.140714029007156,-0.445601868013246,-0.604610358212594,-0.779665576780684,-0.72569021772219,0.571177193169743,-0.520000335904684,-0.467483770334257,-0.432472726620639,1.19845839303873,0.553671671312934,0.797290183820193,-0.417884791739965,-0.527294303345021,-0.355156671753066,-0.385791335002482,0.985474543780889,1.74112957059981,1.32391463301253,-0.508329988000145,-0.305557693158774,1.21012874094327,1.68715421154132,0.164173809998934,1.20283477350293,0.213772788593226,-0.171348692256572,0.0999868965239677,0.641199280596979,0.184596918831878,0.199184853712552,-0.425178759180302,0.450097333660148,-0.413508411275763,0.315888332757945,0.709762574536148,-0.404755650347358,0.359652137399968,-0.518541542416617,-0.0809034959963919,-0.346403910824662,-0.413508411275763,1.15177700142057,5.10948373454747,-0.273464236421291,0.881900206128103,2.56243030438177,-0.203442148994055,0.206478821152889,0.216690375569361,-0.477695324750729,0.127703972797249,0.024129635144462,2.40488060767048,0.0255884286325295,-0.273464236421291,-0.360991845705336,0.076646200714889,0.84397157543835,2.21669624770979,2.49532580393066,-0.00942261508108853,1.68131903758905,-0.0561040066992458,1.47854674274768,0.807501738236664,0.253160212771046,1.79218734268217,0.938793152162732,-0.0240105499617627,0.925664010770125,1.853456669181,-0.412049617787695,1.93952548497698,1.35017291579774,1.95703100683379,1.30203273069152,0.471979235981159,2.03288826821329,-0.0561040066992458,0.455932507612417,2.05622896402237,0.938793152162732,1.58357987388853,0.0897753421074958,0.184596918831878,0.132080353261451,0.254619006259114,0.53908373643226,-0.298263725718437,-1.08601220927484,-0.342027530360459,0.655787215477653,0.625152552228237,0.187514505808013,1.84616270174066,2.66892222901069,-0.0984090178532009,0.175844157903473,0.0985281030359003,0.57847116061008,0.327558680662485,1.10509560980242,0.151044668606327],"CHmRun":[-0.824168192105625,-0.835753716429852,-0.766240570484488,-0.777826094808715,-0.557701132648395,-0.80099714345717,-0.743069521836033,-0.777826094808715,-0.557701132648395,-0.743069521836033,-0.58087218129685,-0.546115608324168,-0.511359035351486,-0.789411619132943,-0.673556375890669,-0.824168192105625,-0.650385327242214,-0.754655046160261,-0.395503792109212,-0.731483997511806,-0.789411619132943,0.102673753832566,-0.789411619132943,-0.812582667781398,-0.557701132648395,-0.766240570484488,-0.696727424539124,-0.835753716429852,-0.418674840757666,-0.812582667781398,-0.696727424539124,-0.673556375890669,-0.80099714345717,-0.210135402921573,-0.638799802917987,-0.673556375890669,-0.743069521836033,-0.80099714345717,-0.488187986703031,-0.557701132648395,-0.812582667781398,-0.80099714345717,-0.650385327242214,-0.754655046160261,0.322798715992887,-0.557701132648395,-0.743069521836033,-0.754655046160261,-0.708312948863351,-0.58087218129685,-0.418674840757666,-0.522944559675713,-0.592457705621077,-0.557701132648395,-0.499773511027258,-0.26806302454271,-0.430260365081894,0.299627667344432,-0.824168192105625,-0.731483997511806,0.322798715992887,-0.650385327242214,1.26122618625531,-0.31440512183962,-0.0131814894097077,-0.221720927245801,-0.650385327242214,3.61308762407347,-0.696727424539124,-0.349161694812302,-0.372332743460757,1.36549590517335,-0.175378829948891,-0.186964354273119,0.288042143020205,0.288042143020205,-0.453431413730349,-0.488187986703031,-0.0942801596792994,-0.430260365081894,-0.731483997511806,-0.615628754269532,-0.650385327242214,-0.210135402921573,-0.418674840757666,-0.337576170488075,0.496581580856298,-0.696727424539124,-0.186964354273119,-0.80099714345717,-0.58087218129685,-0.696727424539124,-0.279648548866938,-0.661970851566442,-0.465016938054576,-0.696727424539124,-0.349161694812302,0.125844802481021,-0.638799802917987,-0.754655046160261,-0.105865684003527,1.77098925652131,-0.615628754269532,0.206943472750613,-0.661970851566442,-0.360747219136529,-0.789411619132943,-0.0595235867066172,1.08744332139189,3.18442322407705,0.948417029501166,-0.511359035351486,-0.395503792109212,0.681949970043936,2.16489708354504,-0.152207781300436,-0.325990646163847,0.230114521399068,-0.163793305624664,-0.198549878597346,-0.0247670137339351,-0.465016938054576,0.0215750835629745,-0.372332743460757,0.149015851129476,-0.082694635355072,-0.604043229945305,0.137430326805248,-0.696727424539124,0.473410532207843,-0.291234073191165,-0.198549878597346,0.206943472750613,-0.395503792109212,0.369140813289796,1.01793017544653,-0.499773511027258,-0.279648548866938,5.51311361324676,-0.337576170488075,-0.383918267784984,0.0215750835629745,-0.708312948863351,-0.129036732651982,-0.522944559675713,1.96794317003318,0.438653959235161,-0.360747219136529,-0.766240570484488,-0.465016938054576,2.09538393759968,1.2148840889584,1.06427227274344,-0.638799802917987,0.855732834907347,0.0563316565356567,2.41977861867804,0.473410532207843,0.705121018692391,2.81368644570178,1.7246471592244,0.241700045723295,2.24599575381463,2.02587079165431,0.415482910586706,2.6978312024595,2.35026547273268,1.58562086733367,2.30392337543577,0.786219688961982,0.936831505176938,-0.522944559675713,-0.372332743460757,3.23076532137396,0.125844802481021,0.566094726801662,0.519752629504752,0.125844802481021,0.508167105180525,0.345969764641341,1.62037744030635,-0.117451208327754,-0.812582667781398,-0.53453008399994,0.0795027051841115,0.357555288965569,-0.418674840757666,0.936831505176938,2.30392337543577,0.705121018692391,-0.650385327242214,-0.105865684003527,-0.175378829948891,-0.465016938054576,-0.383918267784984,0.288042143020205],"CRuns":[-0.994319045893696,-0.96266527161615,-0.988563814206869,-0.893602491374231,-0.887847259687405,-0.922378649808364,-0.850438253723032,-0.982808582520043,-0.913745802278124,-0.916623418121537,-0.79576355269818,-0.905112954747884,-0.830294942819139,-1.02597282017124,-0.78713070516794,-0.873459180470338,-0.850438253723032,-0.913745802278124,-0.790008321011353,-0.951154808242497,-0.985686198363456,0.00996888345753889,-0.824539711132313,-1.02885043601466,-0.884969643843991,-0.982808582520043,-0.933889113182017,-0.991441430050283,-0.827417326975726,-1.00295189342394,-1.01158474095418,-0.732456004143088,-1.00870712511076,-0.649005144684102,-0.850438253723032,-0.910868186434711,-0.876336796313751,-0.709435077395781,-0.844683022036205,-0.60296329118949,-0.988563814206869,-1.03460566770148,-0.93676672902543,-0.870581564626925,-0.493613889139785,-0.861948717096685,-0.899357723061058,-0.651882760527516,-0.890724875530818,-0.844683022036205,0.00133603592729905,-0.718067924926021,-0.76986501010746,-0.755476930890394,-0.79576355269818,-0.608718522876316,0.0962973587599373,0.927928337506375,-0.746844083360154,-0.741088851673327,1.65308753004652,-0.516634815887091,1.06605389799021,-0.631739449623623,-0.519512431730505,-0.654760376370929,-0.459082499018826,2.29191824728427,-0.369876407873014,-0.263404621666723,-0.663393223901169,1.60992329239532,-0.476348194079306,-0.205852304798457,0.48477549762073,-0.211607536485284,0.409957485691985,-0.539655742634398,-0.649005144684102,-0.326712170221815,-0.743966467516741,-0.700802229865541,-0.510879584200265,-0.559799053538291,-0.597208059502663,-0.56843190106853,-0.395774950463734,-0.78713070516794,0.769659466118645,-0.810151631915246,-0.813029247758659,-0.473470578235892,-0.148299987930192,-0.516634815887091,-0.692169382335302,-0.7784978576377,-0.709435077395781,0.323629010389586,-0.430306340584693,-0.456204883175413,-0.43606157227152,1.3020183971501,0.361038016353959,0.939438800880029,-0.528145279260745,-0.490736273296372,-0.191464225581391,-0.384264487090081,1.06893151383363,2.30055109481451,1.85164302324204,-0.631739449623623,-0.116646213652645,1.05742105045997,1.55237097552706,0.153849675628203,0.942316416723442,0.197013913279402,-0.318079322691575,-0.179953762207738,0.591247283827022,-0.0274401225068338,0.12507351719407,-0.450449651488586,0.372548479727612,-0.4101630296808,0.093419742916524,0.689086222503073,-0.459082499018826,0.199891529122815,-0.476348194079306,-0.174198530520911,-0.369876407873014,-0.375631639559841,1.08044197720728,5.14939077979366,-0.361243560342774,0.732250460154272,3.26167478651455,-0.231750847389177,0.00421365177071233,0.340894705450066,-0.453327267331999,0.214279608339882,-0.0677267443146197,1.93509388270102,-0.108013366122406,-0.277792700883789,-0.297936011787682,0.00996888345753889,1.17540330003992,1.92646103517078,1.81998924896449,0.191258681592576,1.39122448829591,-0.0677267443146197,1.80560116974743,0.743760923527925,0.441611259969531,2.20271215613846,0.968214959314161,-0.0763595918448595,1.2588541594989,1.73366077366209,-0.240383694919417,2.18544646107798,1.46316488438125,2.00415666294294,1.35669309817495,0.33513947376324,1.73941600534892,-0.131034292869712,0.214279608339882,2.09624036993217,0.582614436296782,1.74804885287916,0.0847868953862842,-0.0360729700370736,0.173992986532096,0.395569406474918,0.579736820453368,-0.21736276817211,-1.06338182613561,-0.559799053538291,0.864620788951283,1.39985733582615,-0.030317738350247,1.92070580348396,2.19407930860822,-0.0188072749765939,0.130828748880897,-0.197219457268217,0.585492052140195,0.283342388581801,1.50057389034562,0.271831925208147],"CRBI":[-0.985176895045393,-0.903112465678043,-0.911905083110259,-0.944144680361718,-0.771223204194802,-0.885527230813611,-0.876734613381395,-0.926559445497286,-0.809324546401072,-0.894319848245827,-0.70967488216929,-0.806393673923666,-0.689158774827452,-0.958799042748745,-0.777084949149613,-0.920697700542475,-0.727260117033722,-0.903112465678043,-0.630541325279345,-0.897250720723232,-0.900181593200638,0.242858672987451,-0.870872868426584,-0.982246022567988,-0.736052734465938,-0.944144680361718,-0.882596358336206,-0.935352062929502,-0.683297029872642,-0.938282935406907,-0.903112465678043,-0.809324546401072,-0.970522532658366,-0.522099043615347,-0.79173931153664,-0.850356761084747,-0.914835955587665,-0.777084949149613,-0.75363796933037,-0.645195687666372,-0.947075552839123,-0.973453405135772,-0.850356761084747,-0.87380374090399,-0.202633943578163,-0.79173931153664,-0.897250720723232,-0.539684278479779,-0.891388975768422,-0.718467499601506,-0.161601728894488,-0.624679580324534,-0.668642667485615,-0.656919177575993,-0.607094345460102,-0.486928573886483,-0.0707446820949222,0.925751960222899,-0.823978908788099,-0.809324546401072,1.65260833461943,-0.689158774827452,1.34779759696927,-0.662780922530804,-0.369693674790268,-0.504513808750915,-0.401933272041727,2.70186068153054,-0.642264815188966,-0.598301728027886,-0.560200385821617,2.17723450807499,-0.360901057358052,-0.226080923397406,0.342508337219233,0.0171814922272385,-0.0619520646627061,-0.615886962892318,-0.554338640866806,-0.422449379383565,-0.823978908788099,-0.768292331717397,-0.659850050053399,-0.492790318841293,-0.744845351898154,-0.448827231680213,-0.13522387659784,-0.730190989511127,0.292683505103342,-0.803462801446261,-0.700882264737074,-0.583647365640859,-0.132293004120435,-0.610025217937508,-0.533822533524968,-0.721398372078911,-0.604163472982697,0.427503639063988,-0.574854748208643,-0.738983606943343,-0.231942668352217,1.44451638872365,-0.0267815949338419,0.465604981270258,-0.466412466544645,-0.413656761951349,-0.70967488216929,-0.275905755513297,0.940406322609925,2.36481034662893,0.770415718920415,-0.54554602343459,-0.501582936273509,1.01953987949987,2.11568618604947,0.0582137069109134,0.509568068431338,0.216480820690803,-0.085399044481949,0.0933841766397777,0.222342565645613,-0.0238507224564365,0.108038539026804,-0.440034614247997,0.324923102354801,-0.249527903216649,-0.123500386688219,0.248720417942262,-0.533822533524968,0.427503639063988,-0.416587634428754,-0.0590211921853008,-0.167463473849299,-0.522099043615347,1.08108820152538,2.8396116879686,-0.272974883035892,0.263374780329288,3.85076269267344,-0.211426561010379,-0.17918696375892,-0.00040374263719367,-0.574854748208643,-0.00919636006940974,-0.33745407753881,2.93926135220038,0.178379478484533,-0.258320520648865,-0.645195687666372,-0.100053406868976,1.59692175754873,1.89880162272148,2.1303405484365,-0.431241996815781,1.34193585201446,-0.00919636006940974,1.85190766308299,0.638526457437174,0.371817061993286,2.44394390351887,1.37710632174332,0.163725116097506,1.39762242908516,2.19188887046201,-0.00626548759200438,2.60514188977617,1.96328081722439,2.06586135393358,1.91638685758591,0.714729141849713,2.01310564934029,-0.0560903197078954,0.0640754518657242,2.76633987603346,0.685420417075659,1.06057209418355,0.377678806948097,0.386471424380313,0.330784847309611,0.368886189515881,1.04005598684171,-0.240735285784433,-0.991038640000204,-0.428311124338376,0.131485518846047,0.210619075735992,-0.190910453668542,1.41227679147219,2.79564860080752,0.113900283981615,0.0113197472724278,-0.0150581050242204,0.0523519619561027,-0.0678138096175168,0.310268739967774,0.219411693168208],"CWalks":[-0.897170696534012,-0.941927425026769,-0.956846334524354,-0.841224785918066,-0.777819420553328,-0.75544105630695,-0.871062604913238,-0.919549060780391,-0.927008515529183,-0.841224785918066,-0.695765418316607,-0.751711328932553,-0.721873509937382,-0.945657152401165,-0.800197784799706,-0.807657239548499,-0.759170783681346,-0.811386966922895,-0.729332964686175,-0.856143695415652,-0.818846421671688,-0.162414403777924,-0.785278875302121,-0.919549060780391,-0.781549147927724,-0.904630151282805,-0.863603150164445,-0.874792332287634,-0.800197784799706,-0.863603150164445,-0.915819333405994,-0.733062692060571,-0.941927425026769,-0.561495232838337,-0.852413968041256,-0.695765418316607,-0.822576149046085,-0.897170696534012,-0.781549147927724,-0.595062779207905,-0.897170696534012,-0.934467970277976,-0.904630151282805,-0.830035603794877,-0.408576410488086,-0.803927512174103,-0.770359965804535,-0.66219787194704,-0.859873422790048,-0.774089693178932,-0.0990090384131857,-0.740522146809364,-0.546576323340752,-0.688305963567815,-0.747981601558157,-0.263117042886627,-0.35263049987214,1.91131401638647,-0.774089693178932,-0.561495232838337,1.58682773481398,-0.550306050715148,2.27682729907731,-0.617441143454283,-0.188522495398699,-0.632360052951869,-0.639819507700662,2.95563768121745,-0.248198133389041,-0.169873858526717,-0.509279049596788,1.41153054821735,-0.733062692060571,0.124774604050597,1.06839562977288,-0.337711590374554,0.438071703499894,-0.751711328932553,-0.289225134507401,-0.647278962449454,-0.658468144572644,-0.692035690942211,-0.565224960212734,-0.401116955739293,-0.609981688705491,-0.479441230601617,-0.401116955739293,-0.688305963567815,0.725260711328416,-0.7032248730654,-0.665927599321436,-0.408576410488086,-0.319062953502572,-0.654738417198247,-0.509279049596788,-0.721873509937382,-0.591333051833509,-0.0766306741668073,-0.274306225009816,-0.442143956857653,-0.00576585405327601,0.333639337016795,-0.263117042886627,0.833422805185911,-0.386198046241707,-0.229549496517059,-0.214630587019474,-0.0915495836643929,0.975152445412974,4.16033962314749,2.07169229348551,-0.7032248730654,-0.0244144909252579,0.13223405879939,1.0497469929009,0.542504069982993,-0.0318739456740507,-0.0915495836643929,-0.48690068535041,-0.289225134507401,0.2254772431593,-0.173603585901113,0.147152968296976,-0.680846508819022,0.0688286934346517,-0.408576410488086,0.557422979480578,0.281423153775246,-0.367549409369725,0.135963786173787,-0.479441230601617,-0.281765679758609,-0.386198046241707,-0.337711590374554,1.00871999178254,4.85406891478521,-0.322792680876969,0.516395978362218,4.01860998292042,0.0166125101931023,0.117315149301805,-0.0840901289156001,-0.378738591492915,0.404504157130326,-0.266846770261023,2.06796256611111,-0.0952793110387893,-0.0691712194180146,-0.263117042886627,-0.471981775852824,2.24325975270774,1.74347628453863,0.512666250987822,0.195639424164129,1.14299017726081,0.09120705768103,1.32201709123184,0.203098878912922,0.180720514666543,1.72482764766665,1.05720644764969,-0.348900772497743,1.31455763648304,0.859530896806685,0.00915305544430954,1.96353019962802,1.65769255492751,1.60547637168596,1.54953046107002,-0.00576585405327601,2.19850302421499,-0.397387228364897,-0.0878198562899965,1.11688208564004,1.41526027559175,1.25115227111831,0.203098878912922,0.113585421927408,0.419423066627912,0.322450154893606,0.259044789528867,-0.416035865236878,-0.97176524402194,0.0874773303066336,0.370936610760759,1.65396282755312,-0.371279136744122,1.00871999178254,0.796125531441947,0.210558333661714,0.352287973888777,-0.337711590374554,0.527585160485407,0.568612161603767,2.27682729907731,0.251585334780075],"PutOuts":[-0.733312073137102,-0.577179001680995,-0.500847277858009,-0.643101854073573,-0.296139473060002,0.255530712751577,-0.212868501616745,0.53657024137257,-0.292669849249866,-0.469620663566788,-0.625753735022895,-0.48349915880733,-0.452272544516109,-0.594527120731673,-0.205929253996473,-0.0324480634896875,-0.518195396908688,-0.660449973124252,0.109806512725877,-0.899854016023616,-0.643101854073573,-0.448802920705973,-0.26491285876878,0.154911622257641,0.73086917474017,-0.691676587415473,-0.493908030237738,-0.625753735022895,-0.997003482707416,0.102867265105605,-0.299609096870138,-0.400228187364073,-0.643101854073573,-0.639632230263438,0.24512184132117,0.60943234138542,-0.261443234958645,-0.0914316682619946,-0.452272544516109,-0.400228187364073,-0.698615835035745,-0.33777495878163,-0.303078720680273,-0.112249411122809,3.29145154662033,-0.611875239782352,0.00571779842180537,-0.535543515959366,2.27138214644043,3.24287681327843,-0.719433577896559,0.456768893739448,0.248591465131305,-0.743720944567509,-0.438394049275566,-0.504316901668145,-0.62922335883303,-0.813113420770223,-0.563300506440452,-0.743720944567509,-0.466151039756652,-0.212868501616745,-0.424515554035023,-0.0463265587302304,1.52194340345111,3.35043515139263,-0.681267715985066,-0.709024706466152,0.605962717575284,-0.355123077832309,-0.82352229220063,-0.997003482707416,-0.160824144464709,-0.882505896972938,-0.997003482707416,-0.67779809217493,-0.695146211225609,-0.226746996857288,-0.997003482707416,0.491465131840805,-0.0150999444390089,0.130624255586691,-0.292669849249866,-0.480029534997195,0.130624255586691,-0.417576306414752,-0.997003482707416,-0.844340035061445,-0.45921179213638,-0.292669849249866,3.58289994667173,-0.271852106389052,-0.62922335883303,0.0230659174724839,-0.67779809217493,-0.542482763579638,0.0404140365231625,-0.379410444503259,-0.441863673085702,-0.868627401732395,2.05626547021201,-0.303078720680273,-0.0185695682491446,-0.171233015895116,0.0577621555738411,-0.26491285876878,-0.577179001680995,0.800261650942884,0.0993976412954697,1.80645255588224,-0.820052668390495,0.85230600809492,0.0161266698522125,0.0993976412954697,-0.497377654047873,-0.0185695682491446,-0.278791354009323,-0.174702639705252,0.151441998447505,-0.594527120731673,-0.26491285876878,-0.0255088158694161,-0.826991916010766,0.0542925317637054,-0.493908030237738,0.154911622257641,-0.771477935048595,-0.16776339208498,0.0542925317637054,-0.997003482707416,-0.188581134945795,-0.0983709158822661,-0.480029534997195,-0.129597530173488,-0.795765301719545,0.817609769993563,1.9382982606674,-0.781886806479002,-0.997003482707416,-0.788826054099273,0.276348455612391,0.0751102746245197,-0.316957215920816,0.22083447465022,0.17225974130832,-0.417576306414752,-0.670858844554659,-0.407167434984345,-0.351653454022173,0.130624255586691,-0.997003482707416,-0.632692982643166,2.70508512270739,0.508813250891484,-0.747190568377645,0.0542925317637054,0.352680179435377,-0.764538687428323,-0.164293768274845,-0.997003482707416,-0.584118249301266,3.78066850384946,0.0542925317637054,-0.0324480634896875,-0.212868501616745,0.0161266698522125,2.62875339888441,-0.660449973124252,2.01809960830052,0.0265355412826197,-0.174702639705252,-0.195520382566066,0.0577621555738411,0.14797237463737,1.38315845104568,-0.663919596934388,3.22899831803788,-0.369001573072852,3.27410342756965,0.290226950852934,0.678824817588134,0.0785798984346554,-0.72637282551683,1.62603211775518,-0.712494330276288,0.481056260410398,-0.45921179213638,0.224304098460355,3.02776013705001,0.0959280174853339,0.224304098460355,1.81339180350251,-0.771477935048595,-0.577179001680995,0.0889887698650625,3.56208220381091],"Assists":[0.0744338686565573,1.15254375403927,1.20092047966541,0.419981908843323,-0.65121701573565,-0.65121701573565,-0.75488142779168,-0.395511465997444,-0.319490897156355,-0.782525271006621,0.869194361086118,-0.775614310202886,-0.75488142779168,-0.768703349399151,1.80217406959038,2.06479058013233,-0.699593741361797,-0.789436231810356,-0.775614310202886,-0.41624434840865,-0.775614310202886,-0.775614310202886,-0.741059506184209,-0.671949898146856,-0.53373068207215,-0.803258153417827,-0.395511465997444,0.613488811347911,-0.803258153417827,-0.554463564483356,-0.761792388595415,1.38751642136627,-0.761792388595415,1.15254375403927,-0.582107407698297,-0.582107407698297,-0.796347192614092,2.36887285549668,-0.761792388595415,-0.796347192614092,0.233385967142469,-0.789436231810356,-0.75488142779168,2.30667420826306,-0.125983994651767,0.758618988226353,2.00950289370244,1.76070830476797,-0.305668975548885,0.157365398301381,-0.492264917249738,-0.485353956446003,-0.595929329305768,0.419981908843323,-0.734148545380474,-0.706504702165533,0.620399772151647,-0.19509360268912,0.5720230465255,0.24720788874994,0.737886105815147,-0.75488142779168,-0.741059506184209,-0.789436231810356,-0.202004563492855,-0.0361415042032077,0.475269595273205,0.399249026432117,-0.741059506184209,-0.747970466987945,0.136632515890175,-0.803258153417827,-0.747970466987945,-0.782525271006621,-0.803258153417827,0.972858773142148,0.343961340002234,-0.768703349399151,-0.803258153417827,-0.747970466987945,-0.747970466987945,-0.720326623773003,-0.782525271006621,-0.796347192614092,-0.713415662969268,-0.789436231810356,-0.803258153417827,-0.803258153417827,-0.782525271006621,1.7468863831605,0.343961340002234,1.76761926557171,0.191920202320058,2.27211940424439,-0.768703349399151,-0.761792388595415,-0.713415662969268,-0.492264917249738,1.20092047966541,-0.022319582595737,-0.236559367511532,-0.727237584576739,2.10625634495474,2.27211940424439,-0.492264917249738,-0.727237584576739,0.240296927946205,-0.423155309212385,-0.761792388595415,-0.0568743866144136,-0.43006627001612,-0.526819721268415,-0.761792388595415,2.23065363942197,-0.761792388595415,2.56237975800127,1.67086581431941,-0.747970466987945,-0.665038937343121,0.730975145011412,-0.41624434840865,2.50709207157139,-0.789436231810356,-0.720326623773003,-0.768703349399151,-0.741059506184209,0.979769733945883,-0.747970466987945,2.30667420826306,-0.803258153417827,-0.75488142779168,-0.595929329305768,-0.747970466987945,-0.727237584576739,0.171187319908852,-0.506086838857209,-0.222737445904061,-0.181271681081649,-0.803258153417827,0.413070948039587,2.47944822835644,2.59693456201995,1.64322197110447,2.25138652183318,-0.671949898146856,-0.678860858950591,1.06270126359071,1.159454714843,1.20092047966541,-0.741059506184209,-0.803258153417827,1.20092047966541,0.281762692768617,-0.741059506184209,0.371605183217176,-0.741059506184209,-0.53373068207215,0.212653084731264,2.52782495398259,-0.803258153417827,0.689509380189,-0.112162073044296,-0.761792388595415,-0.741059506184209,-0.734148545380474,-0.741059506184209,-0.19509360268912,0.703331301796471,-0.374778583586238,-0.699593741361797,-0.768703349399151,1.78144118717918,1.59484524547833,-0.692682780558062,-0.485353956446003,-0.768703349399151,-0.0845182298293548,-0.713415662969268,-0.250381289119002,-0.761792388595415,-0.471532034838532,-0.741059506184209,0.717153223403941,-0.360956661978767,0.371605183217176,-0.775614310202886,1.76070830476797,-0.741059506184209,-0.436977230819856,-0.734148545380474,2.05787961932859,-0.119073033848031,-0.803258153417827,1.0419683811795,1.82981791280533,0.102077711871499],"Errors":[-0.232388925933805,0.0743331581269745,1.60794357843087,1.1478604523397,-0.999194136085753,-0.999194136085753,-0.692472052024974,-0.385749967964194,0.227694200157364,-0.539111009994584,2.22138774655243,-0.999194136085753,-0.0790278839034151,0.534416284218143,2.6814708726436,1.1478604523397,-1.15255517811614,-0.999194136085753,0.841138368278923,-0.999194136085753,-0.999194136085753,-0.539111009994584,-0.845833094055363,-0.999194136085753,0.687777326248533,-0.845833094055363,-0.0790278839034151,1.1478604523397,-1.30591622014653,-1.15255517811614,-0.845833094055363,2.52810983061321,-0.845833094055363,1.60794357843087,-0.0790278839034151,-0.0790278839034151,-0.999194136085753,2.06802670452204,0.841138368278923,-0.692472052024974,0.994499410309312,0.0743331581269745,-0.385749967964194,1.30122149437009,1.45458253640048,0.381055242187754,-0.385749967964194,1.76130462046126,0.381055242187754,0.994499410309312,-0.0790278839034151,-0.539111009994584,-0.692472052024974,1.45458253640048,-0.845833094055363,-0.999194136085753,-0.232388925933805,-0.845833094055363,0.687777326248533,0.381055242187754,0.227694200157364,-0.845833094055363,-1.15255517811614,-0.232388925933805,-0.845833094055363,0.381055242187754,0.534416284218143,1.1478604523397,-0.232388925933805,-0.692472052024974,1.76130462046126,-1.30591622014653,-0.385749967964194,-1.30591622014653,-1.30591622014653,1.76130462046126,0.841138368278923,-0.539111009994584,-1.30591622014653,-0.385749967964194,-0.845833094055363,-0.0790278839034151,-0.845833094055363,-0.385749967964194,-0.845833094055363,-0.692472052024974,-1.30591622014653,-1.15255517811614,-0.999194136085753,1.1478604523397,1.30122149437009,1.30122149437009,-0.232388925933805,0.687777326248533,-0.845833094055363,-1.15255517811614,-0.539111009994584,-0.692472052024974,0.381055242187754,-0.232388925933805,0.841138368278923,-0.845833094055363,2.52810983061321,2.06802670452204,0.381055242187754,-0.232388925933805,-0.385749967964194,-0.845833094055363,-0.539111009994584,-0.999194136085753,-0.0790278839034151,-0.692472052024974,-0.845833094055363,0.227694200157364,-0.539111009994584,1.60794357843087,1.76130462046126,-1.15255517811614,-0.692472052024974,0.994499410309312,0.687777326248533,-0.539111009994584,-1.30591622014653,-0.539111009994584,-0.232388925933805,-0.0790278839034151,-0.0790278839034151,-0.999194136085753,0.841138368278923,-1.30591622014653,-0.232388925933805,0.227694200157364,-0.385749967964194,-1.15255517811614,2.22138774655243,-0.385749967964194,0.0743331581269745,-0.845833094055363,-1.30591622014653,-0.385749967964194,1.60794357843087,-0.539111009994584,0.994499410309312,1.30122149437009,-0.692472052024974,-0.385749967964194,1.1478604523397,-0.845833094055363,1.30122149437009,-0.845833094055363,-1.30591622014653,0.227694200157364,0.841138368278923,-0.845833094055363,2.37474878858282,0.0743331581269745,-0.692472052024974,-0.692472052024974,0.687777326248533,-1.30591622014653,0.534416284218143,-0.385749967964194,-0.385749967964194,0.0743331581269745,-0.385749967964194,-0.539111009994584,0.687777326248533,1.1478604523397,-0.0790278839034151,-0.539111009994584,-0.692472052024974,1.45458253640048,0.227694200157364,-0.0790278839034151,-0.692472052024974,-0.845833094055363,0.227694200157364,-0.692472052024974,-0.232388925933805,-0.385749967964194,-0.385749967964194,0.0743331581269745,-0.385749967964194,0.994499410309312,0.994499410309312,-0.385749967964194,3.14155399873477,-1.15255517811614,-0.232388925933805,-0.385749967964194,0.0743331581269745,1.45458253640048,-1.30591622014653,1.60794357843087,1.76130462046126,0.534416284218143],"Salary":[70,100,75,175,135,115,110,90,90,75,105,110,145,70,155,87.5,175,90,165,95,110,100,80,75,155,86.5,125,75,145,75,90,150,68,175,137,120,140,175,172,190,70,190,97.5,140,100,135,105,160,120,165,240,300,305,215,415,340,416.667,275,230,225,320,210,260,300,385,215,362.5,200,400,400,297.5,325,250,275,365,277.5,250,300,300,365,202.5,210,240,350,200,300,425,250,400,250,200,350,341.667,350,425,286.667,245,235,425,385,480,500,750,517.143,512.5,550,700,600,675,535,450,431.5,490,750,700,535,737.5,600,662.5,750,430,657,450,630,737.5,625,725,525,575,700,550,650,670,750,450,750,580,450,487.5,450,750,740,475,530,740,500,750,525,550,700,1100,775,776.667,765,850,815,875,1200,1350,950,850,1975,1900,1041.667,1220,1861.46,2460,1500,1925.571,950,773.333,775,850,2412.5,825,1000,1310,1043.333,1183.333,787.5,800,780,2127.333,875,1260,1670,875,1000,1450,940,925,1150,900,1600,875,960],"League_N":[1.0824826592066,-0.919089050269755,1.0824826592066,-0.919089050269755,1.0824826592066,-0.919089050269755,1.0824826592066,1.0824826592066,-0.919089050269755,-0.919089050269755,-0.919089050269755,-0.919089050269755,-0.919089050269755,-0.919089050269755,-0.919089050269755,-0.919089050269755,1.0824826592066,1.0824826592066,-0.919089050269755,-0.919089050269755,1.0824826592066,1.0824826592066,-0.919089050269755,-0.919089050269755,1.0824826592066,1.0824826592066,1.0824826592066,1.0824826592066,-0.919089050269755,1.0824826592066,1.0824826592066,1.0824826592066,-0.919089050269755,-0.919089050269755,-0.919089050269755,-0.919089050269755,1.0824826592066,-0.919089050269755,-0.919089050269755,-0.919089050269755,-0.919089050269755,1.0824826592066,-0.919089050269755,1.0824826592066,-0.919089050269755,-0.919089050269755,-0.919089050269755,1.0824826592066,1.0824826592066,-0.919089050269755,1.0824826592066,-0.919089050269755,-0.919089050269755,1.0824826592066,1.0824826592066,1.0824826592066,1.0824826592066,1.0824826592066,-0.919089050269755,1.0824826592066,1.0824826592066,1.0824826592066,-0.919089050269755,1.0824826592066,1.0824826592066,1.0824826592066,-0.919089050269755,1.0824826592066,-0.919089050269755,1.0824826592066,1.0824826592066,-0.919089050269755,-0.919089050269755,-0.919089050269755,-0.919089050269755,1.0824826592066,1.0824826592066,-0.919089050269755,-0.919089050269755,-0.919089050269755,1.0824826592066,1.0824826592066,1.0824826592066,-0.919089050269755,-0.919089050269755,-0.919089050269755,-0.919089050269755,-0.919089050269755,-0.919089050269755,1.0824826592066,1.0824826592066,-0.919089050269755,-0.919089050269755,-0.919089050269755,1.0824826592066,1.0824826592066,-0.919089050269755,-0.919089050269755,-0.919089050269755,-0.919089050269755,-0.919089050269755,1.0824826592066,-0.919089050269755,-0.919089050269755,1.0824826592066,1.0824826592066,-0.919089050269755,1.0824826592066,-0.919089050269755,-0.919089050269755,1.0824826592066,-0.919089050269755,1.0824826592066,-0.919089050269755,-0.919089050269755,1.0824826592066,1.0824826592066,-0.919089050269755,1.0824826592066,1.0824826592066,-0.919089050269755,1.0824826592066,1.0824826592066,1.0824826592066,1.0824826592066,1.0824826592066,1.0824826592066,-0.919089050269755,-0.919089050269755,-0.919089050269755,-0.919089050269755,1.0824826592066,1.0824826592066,-0.919089050269755,1.0824826592066,1.0824826592066,-0.919089050269755,-0.919089050269755,-0.919089050269755,-0.919089050269755,1.0824826592066,1.0824826592066,-0.919089050269755,-0.919089050269755,1.0824826592066,1.0824826592066,1.0824826592066,1.0824826592066,1.0824826592066,1.0824826592066,-0.919089050269755,1.0824826592066,-0.919089050269755,-0.919089050269755,1.0824826592066,1.0824826592066,-0.919089050269755,-0.919089050269755,-0.919089050269755,-0.919089050269755,-0.919089050269755,-0.919089050269755,1.0824826592066,1.0824826592066,1.0824826592066,-0.919089050269755,-0.919089050269755,-0.919089050269755,1.0824826592066,-0.919089050269755,1.0824826592066,-0.919089050269755,-0.919089050269755,-0.919089050269755,-0.919089050269755,-0.919089050269755,-0.919089050269755,1.0824826592066,1.0824826592066,-0.919089050269755,-0.919089050269755,-0.919089050269755,1.0824826592066,1.0824826592066,-0.919089050269755,-0.919089050269755,1.0824826592066,-0.919089050269755,1.0824826592066,-0.919089050269755,1.0824826592066,1.0824826592066,1.0824826592066,-0.919089050269755,-0.919089050269755,-0.919089050269755],"Division_W":[-1.10499372474481,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,-1.10499372474481,0.900365257199478,-1.10499372474481,-1.10499372474481,0.900365257199478,-1.10499372474481,0.900365257199478,0.900365257199478,0.900365257199478,-1.10499372474481,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,-1.10499372474481,0.900365257199478,-1.10499372474481,0.900365257199478,-1.10499372474481,0.900365257199478,-1.10499372474481,0.900365257199478,0.900365257199478,-1.10499372474481,0.900365257199478,0.900365257199478,-1.10499372474481,0.900365257199478,0.900365257199478,-1.10499372474481,-1.10499372474481,-1.10499372474481,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,-1.10499372474481,0.900365257199478,0.900365257199478,-1.10499372474481,0.900365257199478,-1.10499372474481,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,-1.10499372474481,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,-1.10499372474481,0.900365257199478,0.900365257199478,-1.10499372474481,-1.10499372474481,0.900365257199478,-1.10499372474481,-1.10499372474481,-1.10499372474481,-1.10499372474481,0.900365257199478,-1.10499372474481,0.900365257199478,0.900365257199478,-1.10499372474481,-1.10499372474481,0.900365257199478,-1.10499372474481,0.900365257199478,0.900365257199478,0.900365257199478,-1.10499372474481,-1.10499372474481,-1.10499372474481,-1.10499372474481,0.900365257199478,-1.10499372474481,-1.10499372474481,0.900365257199478,-1.10499372474481,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,-1.10499372474481,0.900365257199478,-1.10499372474481,0.900365257199478,-1.10499372474481,-1.10499372474481,0.900365257199478,-1.10499372474481,-1.10499372474481,-1.10499372474481,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,-1.10499372474481,-1.10499372474481,-1.10499372474481,-1.10499372474481,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,-1.10499372474481,-1.10499372474481,-1.10499372474481,-1.10499372474481,-1.10499372474481,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,-1.10499372474481,0.900365257199478,0.900365257199478,-1.10499372474481,0.900365257199478,-1.10499372474481,0.900365257199478,-1.10499372474481,0.900365257199478,0.900365257199478,-1.10499372474481,-1.10499372474481,-1.10499372474481,-1.10499372474481,-1.10499372474481,0.900365257199478,-1.10499372474481,-1.10499372474481,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,-1.10499372474481,-1.10499372474481,0.900365257199478,-1.10499372474481,0.900365257199478,0.900365257199478,-1.10499372474481,-1.10499372474481,-1.10499372474481,0.900365257199478,-1.10499372474481,0.900365257199478,0.900365257199478,-1.10499372474481,-1.10499372474481,-1.10499372474481,0.900365257199478,-1.10499372474481,0.900365257199478,-1.10499372474481,-1.10499372474481,-1.10499372474481,-1.10499372474481,0.900365257199478,-1.10499372474481,0.900365257199478,-1.10499372474481,-1.10499372474481,0.900365257199478,-1.10499372474481,0.900365257199478,0.900365257199478,-1.10499372474481,-1.10499372474481,0.900365257199478,-1.10499372474481,-1.10499372474481,-1.10499372474481],"NewLeague_N":[-0.9096878296198,-0.9096878296198,1.09366963785751,-0.9096878296198,1.09366963785751,1.09366963785751,1.09366963785751,1.09366963785751,-0.9096878296198,-0.9096878296198,-0.9096878296198,-0.9096878296198,-0.9096878296198,-0.9096878296198,-0.9096878296198,-0.9096878296198,1.09366963785751,1.09366963785751,-0.9096878296198,-0.9096878296198,1.09366963785751,1.09366963785751,-0.9096878296198,1.09366963785751,1.09366963785751,1.09366963785751,1.09366963785751,1.09366963785751,-0.9096878296198,1.09366963785751,1.09366963785751,1.09366963785751,-0.9096878296198,-0.9096878296198,-0.9096878296198,-0.9096878296198,1.09366963785751,-0.9096878296198,-0.9096878296198,-0.9096878296198,-0.9096878296198,1.09366963785751,-0.9096878296198,1.09366963785751,-0.9096878296198,-0.9096878296198,-0.9096878296198,1.09366963785751,1.09366963785751,-0.9096878296198,1.09366963785751,-0.9096878296198,-0.9096878296198,1.09366963785751,1.09366963785751,1.09366963785751,1.09366963785751,1.09366963785751,-0.9096878296198,1.09366963785751,1.09366963785751,-0.9096878296198,-0.9096878296198,1.09366963785751,-0.9096878296198,1.09366963785751,-0.9096878296198,1.09366963785751,-0.9096878296198,-0.9096878296198,1.09366963785751,-0.9096878296198,-0.9096878296198,-0.9096878296198,-0.9096878296198,1.09366963785751,-0.9096878296198,-0.9096878296198,-0.9096878296198,-0.9096878296198,1.09366963785751,1.09366963785751,1.09366963785751,-0.9096878296198,-0.9096878296198,-0.9096878296198,-0.9096878296198,-0.9096878296198,-0.9096878296198,1.09366963785751,1.09366963785751,-0.9096878296198,-0.9096878296198,-0.9096878296198,-0.9096878296198,1.09366963785751,-0.9096878296198,-0.9096878296198,-0.9096878296198,-0.9096878296198,-0.9096878296198,1.09366963785751,-0.9096878296198,-0.9096878296198,1.09366963785751,1.09366963785751,-0.9096878296198,1.09366963785751,-0.9096878296198,-0.9096878296198,1.09366963785751,-0.9096878296198,1.09366963785751,-0.9096878296198,-0.9096878296198,1.09366963785751,1.09366963785751,-0.9096878296198,1.09366963785751,1.09366963785751,-0.9096878296198,1.09366963785751,1.09366963785751,1.09366963785751,1.09366963785751,1.09366963785751,1.09366963785751,-0.9096878296198,-0.9096878296198,1.09366963785751,-0.9096878296198,-0.9096878296198,1.09366963785751,-0.9096878296198,1.09366963785751,1.09366963785751,-0.9096878296198,-0.9096878296198,-0.9096878296198,-0.9096878296198,1.09366963785751,1.09366963785751,-0.9096878296198,-0.9096878296198,1.09366963785751,1.09366963785751,1.09366963785751,1.09366963785751,1.09366963785751,1.09366963785751,-0.9096878296198,1.09366963785751,-0.9096878296198,-0.9096878296198,1.09366963785751,1.09366963785751,-0.9096878296198,-0.9096878296198,-0.9096878296198,-0.9096878296198,-0.9096878296198,-0.9096878296198,1.09366963785751,1.09366963785751,1.09366963785751,-0.9096878296198,-0.9096878296198,-0.9096878296198,1.09366963785751,-0.9096878296198,1.09366963785751,-0.9096878296198,-0.9096878296198,-0.9096878296198,1.09366963785751,1.09366963785751,-0.9096878296198,1.09366963785751,1.09366963785751,-0.9096878296198,1.09366963785751,-0.9096878296198,1.09366963785751,1.09366963785751,-0.9096878296198,-0.9096878296198,1.09366963785751,-0.9096878296198,1.09366963785751,-0.9096878296198,1.09366963785751,1.09366963785751,1.09366963785751,-0.9096878296198,-0.9096878296198,-0.9096878296198]},"columns":[{"accessor":"AtBat","name":"AtBat","type":"numeric"},{"accessor":"Hits","name":"Hits","type":"numeric"},{"accessor":"HmRun","name":"HmRun","type":"numeric"},{"accessor":"Runs","name":"Runs","type":"numeric"},{"accessor":"RBI","name":"RBI","type":"numeric"},{"accessor":"Walks","name":"Walks","type":"numeric"},{"accessor":"Years","name":"Years","type":"numeric"},{"accessor":"CAtBat","name":"CAtBat","type":"numeric"},{"accessor":"CHits","name":"CHits","type":"numeric"},{"accessor":"CHmRun","name":"CHmRun","type":"numeric"},{"accessor":"CRuns","name":"CRuns","type":"numeric"},{"accessor":"CRBI","name":"CRBI","type":"numeric"},{"accessor":"CWalks","name":"CWalks","type":"numeric"},{"accessor":"PutOuts","name":"PutOuts","type":"numeric"},{"accessor":"Assists","name":"Assists","type":"numeric"},{"accessor":"Errors","name":"Errors","type":"numeric"},{"accessor":"Salary","name":"Salary","type":"numeric"},{"accessor":"League_N","name":"League_N","type":"numeric"},{"accessor":"Division_W","name":"Division_W","type":"numeric"},{"accessor":"NewLeague_N","name":"NewLeague_N","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"c4aab1aadb172c8d202f50e8123a9a22","key":"c4aab1aadb172c8d202f50e8123a9a22"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="specify-the-model" class="section level2">
<h2>Specify the model</h2>
<p>The model specification will look very similar to what we have seen earlier, but we will set <code>penalty = tune::tune()</code>. This tells <code>tune::tune_grid()</code> that the penalty parameter should be tuned.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>ridge_spec <span class="ot">&lt;-</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">linear_reg</span>(<span class="at">penalty =</span> tune<span class="sc">::</span><span class="fu">tune</span>(), <span class="at">mixture =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_mode</span>(<span class="st">&quot;regression&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">&quot;glmnet&quot;</span>)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>ridge_spec <span class="sc">%&gt;%</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">translate</span>()</span></code></pre></div>
<pre><code>&gt; Linear Regression Model Specification (regression)
&gt; 
&gt; Main Arguments:
&gt;   penalty = tune()
&gt;   mixture = 0
&gt; 
&gt; Computational engine: glmnet 
&gt; 
&gt; Model fit template:
&gt; glmnet::glmnet(x = missing_arg(), y = missing_arg(), weights = missing_arg(), 
&gt;     alpha = 0, family = &quot;gaussian&quot;)</code></pre>
</div>
<div id="create-the-workflow" class="section level2">
<h2>Create the workflow</h2>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>ridge_workflow <span class="ot">&lt;-</span> workflows<span class="sc">::</span><span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  workflows<span class="sc">::</span><span class="fu">add_recipe</span>(ridge_recipe) <span class="sc">%&gt;%</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  workflows<span class="sc">::</span><span class="fu">add_model</span>(ridge_spec)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>ridge_workflow</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; == Workflow ====================================================================
&gt; Preprocessor: Recipe
&gt; Model: linear_reg()
&gt; 
&gt; -- Preprocessor ----------------------------------------------------------------
&gt; 4 Recipe Steps
&gt; 
&gt; * step_novel()
&gt; * step_dummy()
&gt; * step_zv()
&gt; * step_normalize()
&gt; 
&gt; -- Model -----------------------------------------------------------------------
&gt; Linear Regression Model Specification (regression)
&gt; 
&gt; Main Arguments:
&gt;   penalty = tune::tune()
&gt;   mixture = 0
&gt; 
&gt; Computational engine: glmnet</code></pre>
</div>
<div id="create-the-penaltylambda-grid" class="section level2">
<h2>Create the penalty/lambda grid</h2>
<p>A penalty/lambda grid of <span class="math inline">\(50\)</span> numbers from <span class="math inline">\(0.00001\)</span> (<span class="math inline">\(10^{-5}\)</span>) to <span class="math inline">\(10000\)</span> (<span class="math inline">\(10^5\)</span>) is created.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a range from 10</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>penalty_grid <span class="ot">&lt;-</span> dials<span class="sc">::</span><span class="fu">grid_regular</span>(dials<span class="sc">::</span><span class="fu">penalty</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>)), <span class="at">levels =</span> <span class="dv">50</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>penalty_grid <span class="sc">%&gt;%</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-b292a07fb37e03cc3b40" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-b292a07fb37e03cc3b40">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"penalty":[1e-05,1.59985871960606e-05,2.55954792269953e-05,4.09491506238043e-05,6.55128556859551e-05,0.000104811313415469,0.000167683293681101,0.000268269579527973,0.000429193426012878,0.0006866488450043,0.00109854114198756,0.00175751062485479,0.00281176869797423,0.00449843266896944,0.00719685673001152,0.0115139539932645,0.0184206996932672,0.0294705170255181,0.0471486636345739,0.0754312006335462,0.120679264063933,0.193069772888325,0.308884359647748,0.494171336132384,0.79060432109077,1.2648552168553,2.02358964772516,3.23745754281765,5.17947467923121,8.28642772854684,13.2571136559011,21.2095088792019,33.9322177189533,54.2867543932386,86.8511373751352,138.949549437314,222.29964825262,355.648030622313,568.98660290183,910.298177991523,1456.34847750124,2329.95181051537,3727.59372031494,5963.62331659464,9540.95476349996,15264.1796717524,24420.5309454865,39069.3993705462,62505.5192527398,100000]},"columns":[{"accessor":"penalty","name":"penalty","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"a517c5b31a00344b54493cefbf8d691c","key":"a517c5b31a00344b54493cefbf8d691c"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="ridge-regression-model-fitting-on-cross-validated-data" class="section level2">
<h2>Ridge regression model fitting on cross validated data</h2>
<p>Now we have everything we need and we can fit all the models on the cross validated data. Note that this process may take some time.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>doParallel<span class="sc">::</span><span class="fu">registerDoParallel</span>()</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>tune_res <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">tune_grid</span>(</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">object =</span> ridge_workflow,</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">resamples =</span> Hitters_fold,</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">grid =</span> penalty_grid</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>tune_res</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; # Tuning results
&gt; # 10-fold cross-validation 
&gt; # A tibble: 10 x 4
&gt;    splits           id     .metrics           .notes          
&gt;    &lt;list&gt;           &lt;chr&gt;  &lt;list&gt;             &lt;list&gt;          
&gt;  1 &lt;split [176/20]&gt; Fold01 &lt;tibble [100 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  2 &lt;split [176/20]&gt; Fold02 &lt;tibble [100 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  3 &lt;split [176/20]&gt; Fold03 &lt;tibble [100 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  4 &lt;split [176/20]&gt; Fold04 &lt;tibble [100 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  5 &lt;split [176/20]&gt; Fold05 &lt;tibble [100 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  6 &lt;split [176/20]&gt; Fold06 &lt;tibble [100 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  7 &lt;split [177/19]&gt; Fold07 &lt;tibble [100 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  8 &lt;split [177/19]&gt; Fold08 &lt;tibble [100 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  9 &lt;split [177/19]&gt; Fold09 &lt;tibble [100 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt; 10 &lt;split [177/19]&gt; Fold10 &lt;tibble [100 x 5]&gt; &lt;tibble [0 x 3]&gt;</code></pre>
<p>Here we see that the amount of regularization affects the performance metrics differently. Do note that using a different seed will give a different plot</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that a different seed will give different plots</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>tune<span class="sc">::</span><span class="fu">autoplot</span>(tune_res)</span></code></pre></div>
<p><img src="img/unnamed-chunk-33-1.png" width="3883.2" style="display: block; margin: auto;" /></p>
<p>We can also see the raw metrics that created this chart by calling <code>tune::collect_metrics()</code>.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>tune<span class="sc">::</span><span class="fu">collect_metrics</span>(tune_res) <span class="sc">%&gt;%</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-bfe7b4fd8469ab227816" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-bfe7b4fd8469ab227816">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"penalty":[1e-05,1e-05,1.59985871960606e-05,1.59985871960606e-05,2.55954792269953e-05,2.55954792269953e-05,4.09491506238043e-05,4.09491506238043e-05,6.55128556859551e-05,6.55128556859551e-05,0.000104811313415469,0.000104811313415469,0.000167683293681101,0.000167683293681101,0.000268269579527973,0.000268269579527973,0.000429193426012878,0.000429193426012878,0.0006866488450043,0.0006866488450043,0.00109854114198756,0.00109854114198756,0.00175751062485479,0.00175751062485479,0.00281176869797423,0.00281176869797423,0.00449843266896944,0.00449843266896944,0.00719685673001152,0.00719685673001152,0.0115139539932645,0.0115139539932645,0.0184206996932672,0.0184206996932672,0.0294705170255181,0.0294705170255181,0.0471486636345739,0.0471486636345739,0.0754312006335462,0.0754312006335462,0.120679264063933,0.120679264063933,0.193069772888325,0.193069772888325,0.308884359647748,0.308884359647748,0.494171336132384,0.494171336132384,0.79060432109077,0.79060432109077,1.2648552168553,1.2648552168553,2.02358964772516,2.02358964772516,3.23745754281765,3.23745754281765,5.17947467923121,5.17947467923121,8.28642772854684,8.28642772854684,13.2571136559011,13.2571136559011,21.2095088792019,21.2095088792019,33.9322177189533,33.9322177189533,54.2867543932386,54.2867543932386,86.8511373751352,86.8511373751352,138.949549437314,138.949549437314,222.29964825262,222.29964825262,355.648030622313,355.648030622313,568.98660290183,568.98660290183,910.298177991523,910.298177991523,1456.34847750124,1456.34847750124,2329.95181051537,2329.95181051537,3727.59372031494,3727.59372031494,5963.62331659464,5963.62331659464,9540.95476349996,9540.95476349996,15264.1796717524,15264.1796717524,24420.5309454865,24420.5309454865,39069.3993705462,39069.3993705462,62505.5192527398,62505.5192527398,100000,100000],".metric":["rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq"],".estimator":["standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard"],"mean":[340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.05770501505,0.474617001030473,339.266724142445,0.477591009307966,338.328013808896,0.480476012610295,337.375135298378,0.48338327472483,336.718850451287,0.486056772181424,336.815760342224,0.488042712895722,338.275532954339,0.488920443371489,341.839822523134,0.488684208282016,348.39858124587,0.487589829203652,358.622923796184,0.486083826407259,372.271600779018,0.484547735891463,387.826852578379,0.483212151974514,403.082465896531,0.482165741597226,416.237355032377,0.481404716260143,426.492774998186,0.480876663528723,433.918604234715,0.480523857631574,439.027214858191,0.480293842709345,442.423067809252,0.480145747972536],"n":[10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10],"std_err":[32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,33.1158812148573,0.0528128210685976,33.7218356692893,0.0528795069509566,34.3401526813556,0.0530275455899041,34.9277930596862,0.0534268980010174,35.4244640760661,0.0541106041727805,35.7722541531859,0.0549567426363266,35.9277772810866,0.0557733011495091,35.8834959662472,0.0564277967724679,35.6670256763311,0.0568795703760463,35.3282860553273,0.0571568910684208,34.9228664303816,0.057307804424252,34.5088009570341,0.0573857506416078,34.1384895630914,0.0574237257152366,33.842970368351,0.0574416506537327,33.6267370706939,0.0574502141322647,33.4775673512221,0.0574543333445088,33.3785372438439,0.0574564190752509,33.3143590183283,0.0574574482413304],".config":["Preprocessor1_Model01","Preprocessor1_Model01","Preprocessor1_Model02","Preprocessor1_Model02","Preprocessor1_Model03","Preprocessor1_Model03","Preprocessor1_Model04","Preprocessor1_Model04","Preprocessor1_Model05","Preprocessor1_Model05","Preprocessor1_Model06","Preprocessor1_Model06","Preprocessor1_Model07","Preprocessor1_Model07","Preprocessor1_Model08","Preprocessor1_Model08","Preprocessor1_Model09","Preprocessor1_Model09","Preprocessor1_Model10","Preprocessor1_Model10","Preprocessor1_Model11","Preprocessor1_Model11","Preprocessor1_Model12","Preprocessor1_Model12","Preprocessor1_Model13","Preprocessor1_Model13","Preprocessor1_Model14","Preprocessor1_Model14","Preprocessor1_Model15","Preprocessor1_Model15","Preprocessor1_Model16","Preprocessor1_Model16","Preprocessor1_Model17","Preprocessor1_Model17","Preprocessor1_Model18","Preprocessor1_Model18","Preprocessor1_Model19","Preprocessor1_Model19","Preprocessor1_Model20","Preprocessor1_Model20","Preprocessor1_Model21","Preprocessor1_Model21","Preprocessor1_Model22","Preprocessor1_Model22","Preprocessor1_Model23","Preprocessor1_Model23","Preprocessor1_Model24","Preprocessor1_Model24","Preprocessor1_Model25","Preprocessor1_Model25","Preprocessor1_Model26","Preprocessor1_Model26","Preprocessor1_Model27","Preprocessor1_Model27","Preprocessor1_Model28","Preprocessor1_Model28","Preprocessor1_Model29","Preprocessor1_Model29","Preprocessor1_Model30","Preprocessor1_Model30","Preprocessor1_Model31","Preprocessor1_Model31","Preprocessor1_Model32","Preprocessor1_Model32","Preprocessor1_Model33","Preprocessor1_Model33","Preprocessor1_Model34","Preprocessor1_Model34","Preprocessor1_Model35","Preprocessor1_Model35","Preprocessor1_Model36","Preprocessor1_Model36","Preprocessor1_Model37","Preprocessor1_Model37","Preprocessor1_Model38","Preprocessor1_Model38","Preprocessor1_Model39","Preprocessor1_Model39","Preprocessor1_Model40","Preprocessor1_Model40","Preprocessor1_Model41","Preprocessor1_Model41","Preprocessor1_Model42","Preprocessor1_Model42","Preprocessor1_Model43","Preprocessor1_Model43","Preprocessor1_Model44","Preprocessor1_Model44","Preprocessor1_Model45","Preprocessor1_Model45","Preprocessor1_Model46","Preprocessor1_Model46","Preprocessor1_Model47","Preprocessor1_Model47","Preprocessor1_Model48","Preprocessor1_Model48","Preprocessor1_Model49","Preprocessor1_Model49","Preprocessor1_Model50","Preprocessor1_Model50"]},"columns":[{"accessor":"penalty","name":"penalty","type":"numeric"},{"accessor":".metric","name":".metric","type":"character"},{"accessor":".estimator","name":".estimator","type":"character"},{"accessor":"mean","name":"mean","type":"numeric"},{"accessor":"n","name":"n","type":"numeric"},{"accessor":"std_err","name":"std_err","type":"numeric"},{"accessor":".config","name":".config","type":"character"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"e60bd4c2f0c506d828b03ba1649f46e1","key":"e60bd4c2f0c506d828b03ba1649f46e1"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>Here is the <code>ggplot</code> way should <code>tune::autoplot</code> fails</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>tune_res <span class="sc">%&gt;%</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  tune<span class="sc">::</span><span class="fu">collect_metrics</span>() <span class="sc">%&gt;%</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> .data[[<span class="st">&quot;penalty&quot;</span>]],</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> .data[[<span class="st">&quot;mean&quot;</span>]],</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> .data[[<span class="st">&quot;.metric&quot;</span>]]</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_errorbar</span>(</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymin =</span> .data[[<span class="st">&quot;mean&quot;</span>]] <span class="sc">-</span> .data[[<span class="st">&quot;std_err&quot;</span>]],</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymax =</span> .data[[<span class="st">&quot;mean&quot;</span>]] <span class="sc">+</span> .data[[<span class="st">&quot;std_err&quot;</span>]]</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">facet_wrap</span>(</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">facets =</span> ggplot2<span class="sc">::</span><span class="fu">vars</span>(.data[[<span class="st">&quot;.metric&quot;</span>]]),</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>,</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">2</span></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="img/unnamed-chunk-35-1.png" width="3883.2" style="display: block; margin: auto;" /></p>
<p>The “best” values of this can be selected using <code>tune::select_best()</code>, this function requires you to specify a metric that it should select against. The penalty/lambda value is 569 for metric <code>rsq</code> since it gives the highest value. Do note that using a different seed will give a different best penalty/lambda value.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>top_penalty <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">show_best</span>(tune_res, <span class="at">metric =</span> <span class="st">&quot;rsq&quot;</span>, <span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>top_penalty</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; # A tibble: 5 x 7
&gt;   penalty .metric .estimator  mean     n std_err .config              
&gt;     &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;                
&gt; 1    569. rsq     standard   0.489    10  0.0558 Preprocessor1_Model39
&gt; 2    910. rsq     standard   0.489    10  0.0564 Preprocessor1_Model40
&gt; 3    356. rsq     standard   0.488    10  0.0550 Preprocessor1_Model38
&gt; 4   1456. rsq     standard   0.488    10  0.0569 Preprocessor1_Model41
&gt; 5   2330. rsq     standard   0.486    10  0.0572 Preprocessor1_Model42</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>best_penalty <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">select_best</span>(tune_res, <span class="at">metric =</span> <span class="st">&quot;rsq&quot;</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>best_penalty</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; # A tibble: 1 x 2
&gt;   penalty .config              
&gt;     &lt;dbl&gt; &lt;chr&gt;                
&gt; 1    569. Preprocessor1_Model39</code></pre>
</div>
<div id="ridge-regression-model-with-optimised-penaltylambda-value" class="section level2">
<h2>Ridge regression model with optimised penalty/lambda value</h2>
<p>We create the ridge regression workflow with the best penalty score.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>ridge_final <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">finalize_workflow</span>(</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> ridge_workflow,</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">parameters =</span> best_penalty</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>ridge_final</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; == Workflow ====================================================================
&gt; Preprocessor: Recipe
&gt; Model: linear_reg()
&gt; 
&gt; -- Preprocessor ----------------------------------------------------------------
&gt; 4 Recipe Steps
&gt; 
&gt; * step_novel()
&gt; * step_dummy()
&gt; * step_zv()
&gt; * step_normalize()
&gt; 
&gt; -- Model -----------------------------------------------------------------------
&gt; Linear Regression Model Specification (regression)
&gt; 
&gt; Main Arguments:
&gt;   penalty = 568.98660290183
&gt;   mixture = 0
&gt; 
&gt; Computational engine: glmnet</code></pre>
<p>We now train the ridge regression model with the training data</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>ridge_final_fit <span class="ot">&lt;-</span> parsnip<span class="sc">::</span><span class="fu">fit</span>(<span class="at">object =</span> ridge_final, <span class="at">data =</span> Hitters_train)</span></code></pre></div>
</div>
<div id="variable-importance" class="section level2">
<h2>Variable Importance</h2>
<p>While we’re at it, let’s see what the most important variables are using the <code>vip</code> package.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>vip_table <span class="ot">&lt;-</span> ridge_final_fit <span class="sc">%&gt;%</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  workflows<span class="sc">::</span><span class="fu">extract_fit_parsnip</span>() <span class="sc">%&gt;%</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  vip<span class="sc">::</span><span class="fu">vi</span>(<span class="at">lambda =</span> best_penalty<span class="sc">$</span>penalty)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>vip_table <span class="sc">%&gt;%</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-9c7422a3c87662a29395" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-9c7422a3c87662a29395">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Variable":["CRBI","Division_W","Walks","Hits","CHmRun","CHits","CRuns","PutOuts","CAtBat","Runs","RBI","AtBat","CWalks","Years","HmRun","NewLeague_N","League_N","Errors","Assists"],"Importance":[35.5966673811665,35.3763172824557,34.8754405233867,34.1890995185971,33.6386661437702,33.1269057978843,32.9541786641792,30.2624787532278,24.4103571527999,23.8577455673031,21.004093706964,18.9572547370078,15.2157280518985,8.84750935887093,7.29522053918317,6.19721803024467,4.68935152880114,2.95895197700093,2.42564517786294],"Sign":["POS","NEG","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","NEG","POS"]},"columns":[{"accessor":"Variable","name":"Variable","type":"character"},{"accessor":"Importance","name":"Importance","type":"numeric"},{"accessor":"Sign","name":"Sign","type":"character"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"d75fe5b6262f43613469e407445696cd","key":"d75fe5b6262f43613469e407445696cd"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>vip_table <span class="sc">%&gt;%</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Importance =</span> <span class="fu">abs</span>(.data[[<span class="st">&quot;Importance&quot;</span>]]),</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> forcats<span class="sc">::</span><span class="fu">fct_reorder</span>(</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">.f =</span> .data[[<span class="st">&quot;Variable&quot;</span>]],</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">.x =</span> .data[[<span class="st">&quot;Importance&quot;</span>]]</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> .data[[<span class="st">&quot;Importance&quot;</span>]],</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> .data[[<span class="st">&quot;Variable&quot;</span>]],</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> .data[[<span class="st">&quot;Sign&quot;</span>]]</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<p><img src="img/unnamed-chunk-40-1.png" width="3883.2" style="display: block; margin: auto;" /></p>
</div>
<div id="ridge-regression-model-on-test-data" class="section level2">
<h2>Ridge regression model on test data</h2>
<p>This ridge regression model can now be applied on our testing data set to validate its performance. For regression models, a <code>.pred</code> column is added.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>test_results <span class="ot">&lt;-</span> parsnip<span class="sc">::</span><span class="fu">augment</span>(<span class="at">x =</span> ridge_final_fit, <span class="at">new_data =</span> Hitters_test)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>test_results <span class="sc">%&gt;%</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-78a855d26bfe112ba61c" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-78a855d26bfe112ba61c">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"AtBat":[315,321,413,324,474,550,513,583,181,217,205,214,529,424,388,339,329,458,317,382,233,641,596,370,282,589,438,232,528,309,616,591,315,453,441,551,283,199,464,584,303,381,514,359,309,216,256,466,327,341,486,275,208,459,288,220,581,439,633,368,263,520,19,279,600,610,631],"Hits":[81,87,92,73,129,152,137,168,41,46,57,53,137,119,103,96,83,114,78,119,49,198,171,96,78,170,103,55,132,94,163,157,73,101,118,171,70,52,128,157,71,110,144,80,72,56,70,108,68,110,145,68,57,113,63,66,145,96,210,103,70,120,4,69,139,186,170],"HmRun":[7,10,16,4,10,6,20,17,1,7,8,2,26,6,15,4,9,13,7,13,2,31,34,21,13,40,2,9,21,5,27,16,5,3,28,13,8,9,28,20,3,9,0,15,0,4,13,33,13,9,11,5,8,20,3,5,17,0,6,3,1,17,1,4,0,19,9],"Runs":[24,39,72,32,50,92,90,83,15,32,34,30,86,57,59,37,50,67,35,54,41,101,91,49,37,107,65,34,61,37,83,90,23,46,84,94,33,26,67,95,18,61,67,45,33,22,42,75,42,45,51,42,32,59,25,20,66,44,91,48,26,53,2,35,94,107,77],"RBI":[38,42,48,18,56,37,95,80,21,19,32,29,97,46,47,29,39,57,35,58,23,108,108,46,51,108,32,23,74,32,107,78,37,43,86,83,37,28,94,73,30,45,54,48,31,18,36,86,29,49,76,42,25,57,33,28,68,36,56,28,23,44,3,31,29,98,44],"Walks":[39,30,65,22,40,81,90,56,33,9,9,23,97,13,39,23,56,48,32,36,18,41,52,60,29,69,71,45,41,26,32,26,16,61,68,94,27,21,52,63,36,32,79,63,26,15,44,72,45,46,40,61,18,68,16,13,21,65,59,54,30,21,1,32,60,74,31],"Years":[14,2,1,7,10,5,14,5,2,4,5,2,15,9,6,4,9,4,1,12,8,5,6,15,5,6,2,12,6,13,3,4,4,3,8,13,12,6,13,10,3,7,9,7,5,12,16,3,18,9,11,6,3,12,10,3,2,4,6,8,4,4,1,4,2,6,11],"CAtBat":[3449,396,413,1931,2331,2308,5201,1646,232,694,756,226,6661,3651,2174,1064,3828,1350,317,2133,1350,2129,2862,6986,1649,2325,440,4405,2641,4618,1437,2020,450,948,2723,6090,4479,805,5829,4704,344,3015,4739,1493,354,2796,7058,652,3949,2331,3967,961,653,5348,2682,290,831,711,3070,1897,888,927,19,1359,1236,2728,4908],"CHits":[835,101,92,491,604,633,1382,452,50,160,192,59,1785,1046,555,290,948,298,78,594,336,610,728,1972,453,634,103,1213,671,1330,377,541,108,218,750,1840,1222,191,1552,1320,76,834,1169,359,82,665,1845,142,939,658,1102,238,170,1369,667,80,210,148,872,493,220,227,4,355,309,753,1457],"CHmRun":[69,12,16,13,61,32,166,44,4,32,32,2,291,32,80,11,145,28,7,41,7,92,107,231,73,128,2,194,97,57,65,52,6,6,126,128,94,30,210,93,3,40,13,61,0,43,312,44,78,50,67,16,17,155,38,5,21,1,19,9,9,22,1,31,1,69,30],"CRuns":[321,48,72,291,246,349,763,219,20,86,117,32,1082,461,285,123,575,160,35,287,166,297,361,1070,211,371,67,702,273,616,181,310,38,96,433,969,557,113,740,724,20,451,583,176,41,266,965,102,438,249,410,128,98,713,315,27,106,68,420,207,83,106,2,180,201,399,775],"CRBI":[414,46,48,108,327,182,734,208,29,76,107,32,949,301,274,108,528,123,35,294,122,319,401,955,280,376,32,705,383,522,227,226,46,72,420,900,483,119,840,522,36,249,374,202,32,304,1128,109,380,322,497,104,54,660,259,31,86,56,230,162,82,80,3,148,69,366,357],"CWalks":[375,33,65,180,166,308,784,136,45,32,51,27,989,112,186,55,635,122,32,227,106,117,224,921,138,238,71,625,226,436,82,91,28,91,309,917,307,87,452,576,45,168,528,175,26,198,990,102,466,274,284,172,62,735,204,15,40,99,274,198,86,52,1,158,110,286,249],"League":["N","N","N","N","N","N","A","A","A","A","A","N","A","A","A","A","A","A","A","N","A","A","A","N","A","A","A","N","N","N","A","N","A","N","A","N","A","N","A","A","N","N","N","N","N","A","N","A","A","A","N","N","N","A","A","A","N","N","N","N","N","A","N","N","N","N","A"],"Division":["W","E","E","E","W","W","W","E","E","E","E","E","E","E","W","W","W","W","E","W","E","E","W","E","W","E","W","E","E","E","W","E","W","W","E","E","E","W","W","E","E","E","E","W","E","E","E","E","E","E","E","E","E","W","W","W","E","E","W","W","E","W","W","E","E","E","W"],"PutOuts":[632,805,280,222,732,262,267,109,326,307,58,109,280,224,182,104,276,246,45,59,102,269,118,137,670,368,276,623,885,161,110,290,227,249,190,1199,156,235,0,276,468,228,229,682,117,391,41,286,659,251,88,181,42,0,135,281,320,229,367,209,81,70,692,133,300,1182,408],"Assists":[43,40,9,3,83,329,5,292,29,25,4,7,10,286,9,213,6,389,122,156,132,17,334,5,57,20,7,35,105,3,308,440,15,444,2,149,2,22,0,421,47,7,453,93,269,44,118,8,53,9,204,3,94,0,257,21,465,406,432,246,147,144,70,173,12,96,4],"Errors":[10,4,5,3,13,16,3,25,5,1,4,3,5,8,4,9,2,18,26,9,10,10,21,9,5,3,9,3,8,3,15,25,3,16,2,5,2,5,0,11,6,5,15,13,12,4,8,8,7,4,16,2,13,0,7,3,32,22,16,3,4,11,8,9,9,13,3],"Salary":[475,91.5,100,708.333,750,625,900,612.5,67.5,180,247.5,70,933.333,850,325,275,600,475,70,595,375,1175,900,733.333,500,1237.5,100,1300,1008.333,600,200,640,110,195,1300,1800,225,265,587.5,420,100,800,1940,700,130,250,1050,215,400,560,500,191,140,740,341.667,90,155,150,90,326.667,250,185,920,277.5,160,1300,1000],"NewLeague":["N","N","N","N","N","N","A","A","A","A","A","N","A","N","A","A","A","A","A","N","A","A","A","N","A","A","N","N","N","N","A","N","A","N","A","N","A","N","A","A","N","N","N","N","N","A","A","A","A","A","A","N","N","A","A","A","N","N","N","N","N","A","A","N","N","N","A"],".pred":[502.348230840265,410.898232879066,471.792835663583,376.771051772521,550.622353913178,601.545337292235,894.409038155699,611.294652650369,232.642378641607,255.982408887601,259.340539293363,250.527702968649,1131.39197235418,538.040057729062,442.887312438972,259.143777349907,584.651295687981,419.460916725712,276.624168384832,462.433175561056,287.600044176272,736.425169341082,676.592242642479,929.4486083644,403.174734017526,820.089103689534,374.153009455836,707.764166167591,710.425217796921,591.730783271634,531.444148752241,620.064572118563,201.106424090948,383.174052042758,719.502212807095,1170.19828767641,542.146113137895,238.117363779318,797.423600740117,855.253981703107,328.372511901817,548.367045387545,748.073315526524,479.904435814541,293.334289496033,382.653386662541,867.800658950476,558.208963909969,605.466287564181,521.936899744398,658.50869786855,417.095174576725,266.098342187659,724.919528406761,310.952610319212,166.054398252659,491.829998954669,429.686889575251,672.782871093133,409.474663708078,304.492861074245,324.638577199522,67.5098190035784,370.189073529272,546.086184389891,911.964993862117,663.640577569905]},"columns":[{"accessor":"AtBat","name":"AtBat","type":"numeric"},{"accessor":"Hits","name":"Hits","type":"numeric"},{"accessor":"HmRun","name":"HmRun","type":"numeric"},{"accessor":"Runs","name":"Runs","type":"numeric"},{"accessor":"RBI","name":"RBI","type":"numeric"},{"accessor":"Walks","name":"Walks","type":"numeric"},{"accessor":"Years","name":"Years","type":"numeric"},{"accessor":"CAtBat","name":"CAtBat","type":"numeric"},{"accessor":"CHits","name":"CHits","type":"numeric"},{"accessor":"CHmRun","name":"CHmRun","type":"numeric"},{"accessor":"CRuns","name":"CRuns","type":"numeric"},{"accessor":"CRBI","name":"CRBI","type":"numeric"},{"accessor":"CWalks","name":"CWalks","type":"numeric"},{"accessor":"League","name":"League","type":"factor"},{"accessor":"Division","name":"Division","type":"factor"},{"accessor":"PutOuts","name":"PutOuts","type":"numeric"},{"accessor":"Assists","name":"Assists","type":"numeric"},{"accessor":"Errors","name":"Errors","type":"numeric"},{"accessor":"Salary","name":"Salary","type":"numeric"},{"accessor":"NewLeague","name":"NewLeague","type":"factor"},{"accessor":".pred","name":".pred","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"c74db9dac4a0c4b570eb32f6ea164c67","key":"c74db9dac4a0c4b570eb32f6ea164c67"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>test_results <span class="sc">%&gt;%</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  yardstick<span class="sc">::</span><span class="fu">rsq</span>(<span class="at">truth =</span> .data[[<span class="st">&quot;Salary&quot;</span>]], <span class="at">estimate =</span> .data[[<span class="st">&quot;.pred&quot;</span>]]) <span class="sc">%&gt;%</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-5aa31fde3276d0e432f6" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-5aa31fde3276d0e432f6">{"x":{"tag":{"name":"Reactable","attribs":{"data":{".metric":["rsq"],".estimator":["standard"],".estimate":[0.487714810035057]},"columns":[{"accessor":".metric","name":".metric","type":"character"},{"accessor":".estimator","name":".estimator","type":"character"},{"accessor":".estimate","name":".estimate","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"ce106a638c59a3c30113f3197a0107ec","key":"ce106a638c59a3c30113f3197a0107ec"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>Alternatively, we can use <code>tune::last_fit</code> and <code>tune::collect_metrics</code></p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>test_results <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">last_fit</span>(</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">object =</span> ridge_final_fit,</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">split =</span> Hitters_split</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  tune<span class="sc">::</span><span class="fu">collect_metrics</span>()</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>test_results <span class="sc">%&gt;%</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-7cb358c894144e72fb64" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-7cb358c894144e72fb64">{"x":{"tag":{"name":"Reactable","attribs":{"data":{".metric":["rmse","rsq"],".estimator":["standard","standard"],".estimate":[311.754563118934,0.487714810035057],".config":["Preprocessor1_Model1","Preprocessor1_Model1"]},"columns":[{"accessor":".metric","name":".metric","type":"character"},{"accessor":".estimator","name":".estimator","type":"character"},{"accessor":".estimate","name":".estimate","type":"numeric"},{"accessor":".config","name":".config","type":"character"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"9abf38a49a764e98954a783b855196ae","key":"9abf38a49a764e98954a783b855196ae"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="the-lasso" class="section level1">
<h1>The Lasso</h1>
<p>The following procedure will be very similar to what we saw in the ridge regression section. The resampling step is the same</p>
<div id="create-the-resample-object-1" class="section level2">
<h2>Create the resample object</h2>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>Hitters <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(ISLR<span class="sc">::</span>Hitters) <span class="sc">%&gt;%</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">drop_na</span>()</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>Hitters_split <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">initial_split</span>(Hitters, <span class="at">strata =</span> <span class="st">&quot;Salary&quot;</span>)</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>Hitters_train <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">training</span>(Hitters_split)</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>Hitters_test <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">testing</span>(Hitters_split)</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>Hitters_fold <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">vfold_cv</span>(Hitters_train, <span class="at">v =</span> <span class="dv">10</span>)</span></code></pre></div>
</div>
<div id="create-the-preprocessor-1" class="section level2">
<h2>Create the preprocessor</h2>
<p>The following procedure will be very similar to what we saw in the ridge regression section. The preprocessing needed is the same.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>lasso_recipe <span class="ot">&lt;-</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">recipe</span>(<span class="at">formula =</span> Salary <span class="sc">~</span> ., <span class="at">data =</span> Hitters_train) <span class="sc">%&gt;%</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_novel</span>(recipes<span class="sc">::</span><span class="fu">all_nominal_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_dummy</span>(recipes<span class="sc">::</span><span class="fu">all_nominal_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_zv</span>(recipes<span class="sc">::</span><span class="fu">all_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_normalize</span>(recipes<span class="sc">::</span><span class="fu">all_predictors</span>())</span></code></pre></div>
</div>
<div id="specify-the-model-1" class="section level2">
<h2>Specify the model</h2>
<p>This time, it is <code>mixture=1</code></p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>lasso_spec <span class="ot">&lt;-</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">linear_reg</span>(<span class="at">penalty =</span> tune<span class="sc">::</span><span class="fu">tune</span>(), <span class="at">mixture =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_mode</span>(<span class="st">&quot;regression&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">&quot;glmnet&quot;</span>)</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>lasso_spec <span class="sc">%&gt;%</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">translate</span>()</span></code></pre></div>
<pre><code>&gt; Linear Regression Model Specification (regression)
&gt; 
&gt; Main Arguments:
&gt;   penalty = tune()
&gt;   mixture = 1
&gt; 
&gt; Computational engine: glmnet 
&gt; 
&gt; Model fit template:
&gt; glmnet::glmnet(x = missing_arg(), y = missing_arg(), weights = missing_arg(), 
&gt;     alpha = 1, family = &quot;gaussian&quot;)</code></pre>
</div>
<div id="create-the-workflow-1" class="section level2">
<h2>Create the workflow</h2>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>lasso_workflow <span class="ot">&lt;-</span> workflows<span class="sc">::</span><span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  workflows<span class="sc">::</span><span class="fu">add_recipe</span>(lasso_recipe) <span class="sc">%&gt;%</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  workflows<span class="sc">::</span><span class="fu">add_model</span>(lasso_spec)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>lasso_workflow</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; == Workflow ====================================================================
&gt; Preprocessor: Recipe
&gt; Model: linear_reg()
&gt; 
&gt; -- Preprocessor ----------------------------------------------------------------
&gt; 4 Recipe Steps
&gt; 
&gt; * step_novel()
&gt; * step_dummy()
&gt; * step_zv()
&gt; * step_normalize()
&gt; 
&gt; -- Model -----------------------------------------------------------------------
&gt; Linear Regression Model Specification (regression)
&gt; 
&gt; Main Arguments:
&gt;   penalty = tune::tune()
&gt;   mixture = 1
&gt; 
&gt; Computational engine: glmnet</code></pre>
</div>
<div id="create-the-penaltylambda-grid-1" class="section level2">
<h2>Create the penalty/lambda grid</h2>
<p>A penalty/lambda grid of <span class="math inline">\(50\)</span> numbers from <span class="math inline">\(0.01\)</span> (<span class="math inline">\(10^{-2}\)</span>) to <span class="math inline">\(100\)</span> (<span class="math inline">\(10^2\)</span>) is created.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>doParallel<span class="sc">::</span><span class="fu">registerDoParallel</span>()</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a range from 10</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>penalty_grid <span class="ot">&lt;-</span> dials<span class="sc">::</span><span class="fu">grid_regular</span>(dials<span class="sc">::</span><span class="fu">penalty</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>)), <span class="at">levels =</span> <span class="dv">50</span>)</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>penalty_grid <span class="sc">%&gt;%</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-bfd74d467f3ada599dec" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-bfd74d467f3ada599dec">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"penalty":[0.01,0.0120679264063933,0.0145634847750124,0.0175751062485479,0.0212095088792019,0.0255954792269954,0.0308884359647748,0.0372759372031494,0.0449843266896944,0.0542867543932386,0.0655128556859551,0.079060432109077,0.0954095476349994,0.115139539932645,0.138949549437314,0.167683293681101,0.202358964772516,0.244205309454865,0.294705170255181,0.355648030622313,0.429193426012878,0.517947467923121,0.625055192527397,0.754312006335461,0.910298177991522,1.09854114198756,1.32571136559011,1.59985871960606,1.93069772888325,2.32995181051537,2.81176869797423,3.39322177189533,4.09491506238042,4.94171336132383,5.96362331659464,7.19685673001151,8.68511373751352,10.4811313415469,12.648552168553,15.2641796717523,18.4206996932671,22.2299648252619,26.8269579527972,32.3745754281764,39.0693993705461,47.1486636345739,56.8986602901829,68.66488450043,82.8642772854684,100]},"columns":[{"accessor":"penalty","name":"penalty","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"8bfb7efc2b2a01977b799ddfecc3b9ec","key":"8bfb7efc2b2a01977b799ddfecc3b9ec"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="lasso-model-fitting-on-cross-validated-data" class="section level2">
<h2>Lasso model fitting on cross validated data</h2>
<p>Now we have everything we need and we can fit all the models on the cross validated data. Note that this process may take some time.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>tune_res <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">tune_grid</span>(</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">object =</span> lasso_workflow,</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">resamples =</span> Hitters_fold,</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">grid =</span> penalty_grid</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>tune_res</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; # Tuning results
&gt; # 10-fold cross-validation 
&gt; # A tibble: 10 x 4
&gt;    splits           id     .metrics           .notes          
&gt;    &lt;list&gt;           &lt;chr&gt;  &lt;list&gt;             &lt;list&gt;          
&gt;  1 &lt;split [176/20]&gt; Fold01 &lt;tibble [100 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  2 &lt;split [176/20]&gt; Fold02 &lt;tibble [100 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  3 &lt;split [176/20]&gt; Fold03 &lt;tibble [100 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  4 &lt;split [176/20]&gt; Fold04 &lt;tibble [100 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  5 &lt;split [176/20]&gt; Fold05 &lt;tibble [100 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  6 &lt;split [176/20]&gt; Fold06 &lt;tibble [100 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  7 &lt;split [177/19]&gt; Fold07 &lt;tibble [100 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  8 &lt;split [177/19]&gt; Fold08 &lt;tibble [100 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  9 &lt;split [177/19]&gt; Fold09 &lt;tibble [100 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt; 10 &lt;split [177/19]&gt; Fold10 &lt;tibble [100 x 5]&gt; &lt;tibble [0 x 3]&gt;</code></pre>
<p>Here we see that the amount of regularization affects the performance metrics differently. Do note that using a different seed will give a different plot</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that a different seed will give different plots</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>tune<span class="sc">::</span><span class="fu">autoplot</span>(tune_res)</span></code></pre></div>
<p><img src="img/unnamed-chunk-50-1.png" width="3883.2" style="display: block; margin: auto;" /></p>
<p>We can also see the raw metrics that created this chart by calling <code>tune::collect_metrics()</code>.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>tune<span class="sc">::</span><span class="fu">collect_metrics</span>(tune_res) <span class="sc">%&gt;%</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-390e713f8521140010cc" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-390e713f8521140010cc">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"penalty":[0.01,0.01,0.0120679264063933,0.0120679264063933,0.0145634847750124,0.0145634847750124,0.0175751062485479,0.0175751062485479,0.0212095088792019,0.0212095088792019,0.0255954792269954,0.0255954792269954,0.0308884359647748,0.0308884359647748,0.0372759372031494,0.0372759372031494,0.0449843266896944,0.0449843266896944,0.0542867543932386,0.0542867543932386,0.0655128556859551,0.0655128556859551,0.079060432109077,0.079060432109077,0.0954095476349994,0.0954095476349994,0.115139539932645,0.115139539932645,0.138949549437314,0.138949549437314,0.167683293681101,0.167683293681101,0.202358964772516,0.202358964772516,0.244205309454865,0.244205309454865,0.294705170255181,0.294705170255181,0.355648030622313,0.355648030622313,0.429193426012878,0.429193426012878,0.517947467923121,0.517947467923121,0.625055192527397,0.625055192527397,0.754312006335461,0.754312006335461,0.910298177991522,0.910298177991522,1.09854114198756,1.09854114198756,1.32571136559011,1.32571136559011,1.59985871960606,1.59985871960606,1.93069772888325,1.93069772888325,2.32995181051537,2.32995181051537,2.81176869797423,2.81176869797423,3.39322177189533,3.39322177189533,4.09491506238042,4.09491506238042,4.94171336132383,4.94171336132383,5.96362331659464,5.96362331659464,7.19685673001151,7.19685673001151,8.68511373751352,8.68511373751352,10.4811313415469,10.4811313415469,12.648552168553,12.648552168553,15.2641796717523,15.2641796717523,18.4206996932671,18.4206996932671,22.2299648252619,22.2299648252619,26.8269579527972,26.8269579527972,32.3745754281764,32.3745754281764,39.0693993705461,39.0693993705461,47.1486636345739,47.1486636345739,56.8986602901829,56.8986602901829,68.66488450043,68.66488450043,82.8642772854684,82.8642772854684,100,100],".metric":["rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq"],".estimator":["standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard"],"mean":[352.912438452656,0.434088503359711,352.912438452656,0.434088503359711,352.912438452656,0.434088503359711,352.912438452656,0.434088503359711,352.912438452656,0.434088503359711,352.912438452656,0.434088503359711,352.912438452656,0.434088503359711,352.912438452656,0.434088503359711,352.868962637827,0.434137430087858,352.799426209138,0.434218649320816,352.715618532113,0.434319066648511,352.618722338376,0.434435680655989,352.513289114707,0.434552198350541,352.401479404639,0.434666553337121,352.275742688755,0.434794813232089,352.143687877041,0.434920609945402,351.979483310065,0.43508953755991,351.819035199137,0.435238772023992,351.747514834188,0.435258187945783,351.582729035066,0.435609946693216,351.412313863061,0.435953006329445,351.201233996491,0.436368079093587,350.985681364623,0.436794621602386,350.712842673623,0.437418627444478,350.440859048934,0.438101527566587,350.240970284762,0.438762059971222,349.986486128784,0.439739937444608,349.733294993313,0.440827006233394,349.589158343607,0.441753894263852,349.248184574502,0.443346851471585,348.30407970463,0.446575424931007,347.253544018853,0.449940162460046,346.71893344709,0.452488362143266,346.712925360387,0.454559512212306,346.914251186033,0.456366999605236,346.778978985055,0.458008357055923,345.449449821114,0.462690063868837,343.065784392851,0.468866107864747,340.97300357519,0.473607149179875,339.65163688516,0.476429079904563,338.688062959372,0.478682779061053,338.511785597481,0.479364099526682,339.09355506506,0.478548452909738,340.375611084037,0.476811907169586,342.327863391534,0.474409306070985,345.109146335965,0.471108538167535,348.974233508327,0.46643646900435,354.368283282973,0.458748479475574,360.367439101646,0.451343059699564,367.452578097241,0.44478836292045],"n":[10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10],"std_err":[32.4105453004296,0.050384102094505,32.4105453004296,0.050384102094505,32.4105453004296,0.050384102094505,32.4105453004296,0.050384102094505,32.4105453004296,0.050384102094505,32.4105453004296,0.050384102094505,32.4105453004296,0.050384102094505,32.4105453004296,0.050384102094505,32.391554500456,0.0503705417712658,32.3643877544758,0.0503413312120746,32.3343007960794,0.0503084121751063,32.3078362914617,0.0502810889299532,32.2765467629081,0.0502435248909878,32.2383330656667,0.0502024681666691,32.1943857013154,0.0501580358065248,32.1469961431734,0.0501202963046556,32.0963401390195,0.0500833393342676,32.0424955429901,0.0500214501548207,32.0230742045902,0.04997326109903,32.0023700718471,0.0500515566441791,31.9841803796557,0.0501609263765434,31.9556436751794,0.0502999601075935,31.9177693254536,0.0504631016833151,31.8856905257693,0.0507255073601971,31.8595808561368,0.0510754330238275,31.9127289043529,0.0516633600566315,31.9838016642292,0.0523767213571651,32.0687924699731,0.0532051914986062,32.2355956506871,0.0541713354520514,32.4564661153688,0.0550173309832302,32.7133464988743,0.055329196587009,32.8750543836382,0.0555454146415092,33.2109223618848,0.0557989179911886,33.7919118714969,0.0560170187312302,34.2989140177036,0.0559129051780005,34.4654711271458,0.0553481332078744,34.592318459808,0.0554188992775882,34.7175208491847,0.0554186558204733,34.8158533818202,0.0558670031394637,34.7723538398625,0.0560583682317538,34.8627112960617,0.0561828908690587,34.9556287340465,0.0568580660329015,35.057192216441,0.0578301811042253,35.1620859850422,0.0591480210825597,35.2834092440256,0.0607559372960523,35.3843770654893,0.0626521560795519,35.366527232852,0.0647172154153091,35.3080085698977,0.0670618129426653,34.8867028201003,0.0690258793469475,34.4033161399529,0.0707200637978501],".config":["Preprocessor1_Model01","Preprocessor1_Model01","Preprocessor1_Model02","Preprocessor1_Model02","Preprocessor1_Model03","Preprocessor1_Model03","Preprocessor1_Model04","Preprocessor1_Model04","Preprocessor1_Model05","Preprocessor1_Model05","Preprocessor1_Model06","Preprocessor1_Model06","Preprocessor1_Model07","Preprocessor1_Model07","Preprocessor1_Model08","Preprocessor1_Model08","Preprocessor1_Model09","Preprocessor1_Model09","Preprocessor1_Model10","Preprocessor1_Model10","Preprocessor1_Model11","Preprocessor1_Model11","Preprocessor1_Model12","Preprocessor1_Model12","Preprocessor1_Model13","Preprocessor1_Model13","Preprocessor1_Model14","Preprocessor1_Model14","Preprocessor1_Model15","Preprocessor1_Model15","Preprocessor1_Model16","Preprocessor1_Model16","Preprocessor1_Model17","Preprocessor1_Model17","Preprocessor1_Model18","Preprocessor1_Model18","Preprocessor1_Model19","Preprocessor1_Model19","Preprocessor1_Model20","Preprocessor1_Model20","Preprocessor1_Model21","Preprocessor1_Model21","Preprocessor1_Model22","Preprocessor1_Model22","Preprocessor1_Model23","Preprocessor1_Model23","Preprocessor1_Model24","Preprocessor1_Model24","Preprocessor1_Model25","Preprocessor1_Model25","Preprocessor1_Model26","Preprocessor1_Model26","Preprocessor1_Model27","Preprocessor1_Model27","Preprocessor1_Model28","Preprocessor1_Model28","Preprocessor1_Model29","Preprocessor1_Model29","Preprocessor1_Model30","Preprocessor1_Model30","Preprocessor1_Model31","Preprocessor1_Model31","Preprocessor1_Model32","Preprocessor1_Model32","Preprocessor1_Model33","Preprocessor1_Model33","Preprocessor1_Model34","Preprocessor1_Model34","Preprocessor1_Model35","Preprocessor1_Model35","Preprocessor1_Model36","Preprocessor1_Model36","Preprocessor1_Model37","Preprocessor1_Model37","Preprocessor1_Model38","Preprocessor1_Model38","Preprocessor1_Model39","Preprocessor1_Model39","Preprocessor1_Model40","Preprocessor1_Model40","Preprocessor1_Model41","Preprocessor1_Model41","Preprocessor1_Model42","Preprocessor1_Model42","Preprocessor1_Model43","Preprocessor1_Model43","Preprocessor1_Model44","Preprocessor1_Model44","Preprocessor1_Model45","Preprocessor1_Model45","Preprocessor1_Model46","Preprocessor1_Model46","Preprocessor1_Model47","Preprocessor1_Model47","Preprocessor1_Model48","Preprocessor1_Model48","Preprocessor1_Model49","Preprocessor1_Model49","Preprocessor1_Model50","Preprocessor1_Model50"]},"columns":[{"accessor":"penalty","name":"penalty","type":"numeric"},{"accessor":".metric","name":".metric","type":"character"},{"accessor":".estimator","name":".estimator","type":"character"},{"accessor":"mean","name":"mean","type":"numeric"},{"accessor":"n","name":"n","type":"numeric"},{"accessor":"std_err","name":"std_err","type":"numeric"},{"accessor":".config","name":".config","type":"character"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"9e5b93b288b20f9a6cfd7681d29ffdeb","key":"9e5b93b288b20f9a6cfd7681d29ffdeb"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>Here is the <code>ggplot</code> way should <code>tune::autoplot</code> fails</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>tune_res <span class="sc">%&gt;%</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  tune<span class="sc">::</span><span class="fu">collect_metrics</span>() <span class="sc">%&gt;%</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> .data[[<span class="st">&quot;penalty&quot;</span>]],</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> .data[[<span class="st">&quot;mean&quot;</span>]],</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> .data[[<span class="st">&quot;.metric&quot;</span>]]</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_errorbar</span>(</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymin =</span> .data[[<span class="st">&quot;mean&quot;</span>]] <span class="sc">-</span> .data[[<span class="st">&quot;std_err&quot;</span>]],</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymax =</span> .data[[<span class="st">&quot;mean&quot;</span>]] <span class="sc">+</span> .data[[<span class="st">&quot;std_err&quot;</span>]]</span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">facet_wrap</span>(</span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">facets =</span> ggplot2<span class="sc">::</span><span class="fu">vars</span>(.data[[<span class="st">&quot;.metric&quot;</span>]]),</span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>,</span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">2</span></span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb83-21"><a href="#cb83-21" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb83-22"><a href="#cb83-22" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="img/unnamed-chunk-52-1.png" width="3883.2" style="display: block; margin: auto;" /></p>
<p>The “best” values of this can be selected using <code>tune::select_best()</code>, this function requires you to specify a metric that it should select against. The penalty/lambda value is 22.2 for metric <code>rsq</code> since it gives the highest value. Do note that using a different seed will give a different best penalty/lambda value.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>top_penalty <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">show_best</span>(tune_res, <span class="at">metric =</span> <span class="st">&quot;rsq&quot;</span>, <span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>top_penalty</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; # A tibble: 5 x 7
&gt;   penalty .metric .estimator  mean     n std_err .config              
&gt;     &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;                
&gt; 1    22.2 rsq     standard   0.479    10  0.0569 Preprocessor1_Model42
&gt; 2    18.4 rsq     standard   0.479    10  0.0562 Preprocessor1_Model41
&gt; 3    26.8 rsq     standard   0.479    10  0.0578 Preprocessor1_Model43
&gt; 4    32.4 rsq     standard   0.477    10  0.0591 Preprocessor1_Model44
&gt; 5    15.3 rsq     standard   0.476    10  0.0561 Preprocessor1_Model40</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>best_penalty <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">select_best</span>(tune_res, <span class="at">metric =</span> <span class="st">&quot;rsq&quot;</span>)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>best_penalty</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; # A tibble: 1 x 2
&gt;   penalty .config              
&gt;     &lt;dbl&gt; &lt;chr&gt;                
&gt; 1    22.2 Preprocessor1_Model42</code></pre>
</div>
<div id="lasso-model-with-optimised-penaltylambda-value" class="section level2">
<h2>Lasso model with optimised penalty/lambda value</h2>
<p>We create the lasso regression workflow with the best penalty score.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>lasso_final <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">finalize_workflow</span>(</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> lasso_workflow,</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">parameters =</span> best_penalty</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>lasso_final</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; == Workflow ====================================================================
&gt; Preprocessor: Recipe
&gt; Model: linear_reg()
&gt; 
&gt; -- Preprocessor ----------------------------------------------------------------
&gt; 4 Recipe Steps
&gt; 
&gt; * step_novel()
&gt; * step_dummy()
&gt; * step_zv()
&gt; * step_normalize()
&gt; 
&gt; -- Model -----------------------------------------------------------------------
&gt; Linear Regression Model Specification (regression)
&gt; 
&gt; Main Arguments:
&gt;   penalty = 22.2299648252619
&gt;   mixture = 1
&gt; 
&gt; Computational engine: glmnet</code></pre>
<p>We now train the lasso regression model with the training data</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>lasso_final_fit <span class="ot">&lt;-</span> parsnip<span class="sc">::</span><span class="fu">fit</span>(<span class="at">object =</span> lasso_final, <span class="at">data =</span> Hitters_train)</span></code></pre></div>
</div>
<div id="variable-importance-1" class="section level2">
<h2>Variable Importance</h2>
<p>While we’re at it, let’s see what the most important variables are using the <code>vip</code> package.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>vip_table <span class="ot">&lt;-</span> lasso_final_fit <span class="sc">%&gt;%</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  workflows<span class="sc">::</span><span class="fu">extract_fit_parsnip</span>() <span class="sc">%&gt;%</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  vip<span class="sc">::</span><span class="fu">vi</span>(<span class="at">lambda =</span> best_penalty<span class="sc">$</span>penalty)</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>vip_table <span class="sc">%&gt;%</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-3d742cd9a741287887f7" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-3d742cd9a741287887f7">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Variable":["CRBI","Hits","Walks","Division_W","PutOuts","CRuns","CHmRun","CHits","AtBat","HmRun","Runs","RBI","Years","CAtBat","CWalks","Assists","Errors","League_N","NewLeague_N"],"Importance":[161.145536665532,84.7448549343025,59.1977262875019,55.6176594062202,39.4075686731142,35.7532390826939,0.350597589729928,0.25854356444712,0,0,0,0,0,0,0,0,0,0,0],"Sign":["POS","POS","POS","NEG","POS","POS","POS","POS","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG"]},"columns":[{"accessor":"Variable","name":"Variable","type":"character"},{"accessor":"Importance","name":"Importance","type":"numeric"},{"accessor":"Sign","name":"Sign","type":"character"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"2e8d52d95450e8e41317accfb7f5b6d7","key":"2e8d52d95450e8e41317accfb7f5b6d7"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>vip_table <span class="sc">%&gt;%</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Importance =</span> <span class="fu">abs</span>(.data[[<span class="st">&quot;Importance&quot;</span>]]),</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> forcats<span class="sc">::</span><span class="fu">fct_reorder</span>(</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">.f =</span> .data[[<span class="st">&quot;Variable&quot;</span>]],</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">.x =</span> .data[[<span class="st">&quot;Importance&quot;</span>]]</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> .data[[<span class="st">&quot;Importance&quot;</span>]],</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> .data[[<span class="st">&quot;Variable&quot;</span>]],</span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> .data[[<span class="st">&quot;Sign&quot;</span>]]</span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<p><img src="img/unnamed-chunk-57-1.png" width="3883.2" style="display: block; margin: auto;" /></p>
</div>
<div id="lasso-regression-model-on-test-data" class="section level2">
<h2>Lasso regression model on test data</h2>
<p>This lasso regression model can now be applied on our testing data set to validate its performance. For regression models, a .pred column is added.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>test_results <span class="ot">&lt;-</span> parsnip<span class="sc">::</span><span class="fu">augment</span>(<span class="at">x =</span> lasso_final_fit, <span class="at">new_data =</span> Hitters_test)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>test_results <span class="sc">%&gt;%</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-18de93ed79d30449eb13" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-18de93ed79d30449eb13">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"AtBat":[315,321,413,324,474,550,513,583,181,217,205,214,529,424,388,339,329,458,317,382,233,641,596,370,282,589,438,232,528,309,616,591,315,453,441,551,283,199,464,584,303,381,514,359,309,216,256,466,327,341,486,275,208,459,288,220,581,439,633,368,263,520,19,279,600,610,631],"Hits":[81,87,92,73,129,152,137,168,41,46,57,53,137,119,103,96,83,114,78,119,49,198,171,96,78,170,103,55,132,94,163,157,73,101,118,171,70,52,128,157,71,110,144,80,72,56,70,108,68,110,145,68,57,113,63,66,145,96,210,103,70,120,4,69,139,186,170],"HmRun":[7,10,16,4,10,6,20,17,1,7,8,2,26,6,15,4,9,13,7,13,2,31,34,21,13,40,2,9,21,5,27,16,5,3,28,13,8,9,28,20,3,9,0,15,0,4,13,33,13,9,11,5,8,20,3,5,17,0,6,3,1,17,1,4,0,19,9],"Runs":[24,39,72,32,50,92,90,83,15,32,34,30,86,57,59,37,50,67,35,54,41,101,91,49,37,107,65,34,61,37,83,90,23,46,84,94,33,26,67,95,18,61,67,45,33,22,42,75,42,45,51,42,32,59,25,20,66,44,91,48,26,53,2,35,94,107,77],"RBI":[38,42,48,18,56,37,95,80,21,19,32,29,97,46,47,29,39,57,35,58,23,108,108,46,51,108,32,23,74,32,107,78,37,43,86,83,37,28,94,73,30,45,54,48,31,18,36,86,29,49,76,42,25,57,33,28,68,36,56,28,23,44,3,31,29,98,44],"Walks":[39,30,65,22,40,81,90,56,33,9,9,23,97,13,39,23,56,48,32,36,18,41,52,60,29,69,71,45,41,26,32,26,16,61,68,94,27,21,52,63,36,32,79,63,26,15,44,72,45,46,40,61,18,68,16,13,21,65,59,54,30,21,1,32,60,74,31],"Years":[14,2,1,7,10,5,14,5,2,4,5,2,15,9,6,4,9,4,1,12,8,5,6,15,5,6,2,12,6,13,3,4,4,3,8,13,12,6,13,10,3,7,9,7,5,12,16,3,18,9,11,6,3,12,10,3,2,4,6,8,4,4,1,4,2,6,11],"CAtBat":[3449,396,413,1931,2331,2308,5201,1646,232,694,756,226,6661,3651,2174,1064,3828,1350,317,2133,1350,2129,2862,6986,1649,2325,440,4405,2641,4618,1437,2020,450,948,2723,6090,4479,805,5829,4704,344,3015,4739,1493,354,2796,7058,652,3949,2331,3967,961,653,5348,2682,290,831,711,3070,1897,888,927,19,1359,1236,2728,4908],"CHits":[835,101,92,491,604,633,1382,452,50,160,192,59,1785,1046,555,290,948,298,78,594,336,610,728,1972,453,634,103,1213,671,1330,377,541,108,218,750,1840,1222,191,1552,1320,76,834,1169,359,82,665,1845,142,939,658,1102,238,170,1369,667,80,210,148,872,493,220,227,4,355,309,753,1457],"CHmRun":[69,12,16,13,61,32,166,44,4,32,32,2,291,32,80,11,145,28,7,41,7,92,107,231,73,128,2,194,97,57,65,52,6,6,126,128,94,30,210,93,3,40,13,61,0,43,312,44,78,50,67,16,17,155,38,5,21,1,19,9,9,22,1,31,1,69,30],"CRuns":[321,48,72,291,246,349,763,219,20,86,117,32,1082,461,285,123,575,160,35,287,166,297,361,1070,211,371,67,702,273,616,181,310,38,96,433,969,557,113,740,724,20,451,583,176,41,266,965,102,438,249,410,128,98,713,315,27,106,68,420,207,83,106,2,180,201,399,775],"CRBI":[414,46,48,108,327,182,734,208,29,76,107,32,949,301,274,108,528,123,35,294,122,319,401,955,280,376,32,705,383,522,227,226,46,72,420,900,483,119,840,522,36,249,374,202,32,304,1128,109,380,322,497,104,54,660,259,31,86,56,230,162,82,80,3,148,69,366,357],"CWalks":[375,33,65,180,166,308,784,136,45,32,51,27,989,112,186,55,635,122,32,227,106,117,224,921,138,238,71,625,226,436,82,91,28,91,309,917,307,87,452,576,45,168,528,175,26,198,990,102,466,274,284,172,62,735,204,15,40,99,274,198,86,52,1,158,110,286,249],"League":["N","N","N","N","N","N","A","A","A","A","A","N","A","A","A","A","A","A","A","N","A","A","A","N","A","A","A","N","N","N","A","N","A","N","A","N","A","N","A","A","N","N","N","N","N","A","N","A","A","A","N","N","N","A","A","A","N","N","N","N","N","A","N","N","N","N","A"],"Division":["W","E","E","E","W","W","W","E","E","E","E","E","E","E","W","W","W","W","E","W","E","E","W","E","W","E","W","E","E","E","W","E","W","W","E","E","E","W","W","E","E","E","E","W","E","E","E","E","E","E","E","E","E","W","W","W","E","E","W","W","E","W","W","E","E","E","W"],"PutOuts":[632,805,280,222,732,262,267,109,326,307,58,109,280,224,182,104,276,246,45,59,102,269,118,137,670,368,276,623,885,161,110,290,227,249,190,1199,156,235,0,276,468,228,229,682,117,391,41,286,659,251,88,181,42,0,135,281,320,229,367,209,81,70,692,133,300,1182,408],"Assists":[43,40,9,3,83,329,5,292,29,25,4,7,10,286,9,213,6,389,122,156,132,17,334,5,57,20,7,35,105,3,308,440,15,444,2,149,2,22,0,421,47,7,453,93,269,44,118,8,53,9,204,3,94,0,257,21,465,406,432,246,147,144,70,173,12,96,4],"Errors":[10,4,5,3,13,16,3,25,5,1,4,3,5,8,4,9,2,18,26,9,10,10,21,9,5,3,9,3,8,3,15,25,3,16,2,5,2,5,0,11,6,5,15,13,12,4,8,8,7,4,16,2,13,0,7,3,32,22,16,3,4,11,8,9,9,13,3],"Salary":[475,91.5,100,708.333,750,625,900,612.5,67.5,180,247.5,70,933.333,850,325,275,600,475,70,595,375,1175,900,733.333,500,1237.5,100,1300,1008.333,600,200,640,110,195,1300,1800,225,265,587.5,420,100,800,1940,700,130,250,1050,215,400,560,500,191,140,740,341.667,90,155,150,90,326.667,250,185,920,277.5,160,1300,1000],"NewLeague":["N","N","N","N","N","N","A","A","A","A","A","N","A","N","A","A","A","A","A","N","A","A","A","N","A","A","N","N","N","N","A","N","A","N","A","N","A","N","A","A","N","N","N","N","N","A","A","A","A","A","A","N","N","A","A","A","N","N","N","N","N","A","A","N","N","N","A"],".pred":[505.735436455634,424.806406804163,462.263002218335,351.529768367383,562.139307651773,595.585148171933,897.444735198205,645.750671429403,271.433454586433,241.031790939991,245.201313030071,239.047970890368,1165.08973625586,521.099477193172,415.06579225935,251.849490011889,587.98659253611,384.531267463433,303.179201119029,429.112815351359,273.30743780959,742.513432025125,636.092258782015,968.959701877345,403.055671037543,816.124222191034,378.983177226664,761.724591646792,732.305060308636,622.580213086775,464.007327991439,585.296657946803,168.64318088909,365.936059578401,719.917027215365,1310.02780158121,555.826001119811,186.960138103142,787.380964815479,868.306688418109,357.998080369978,531.756570001901,797.153700288878,461.670228249582,284.533067371824,414.027379648073,934.727868916743,544.055826109946,609.490957863572,587.191750894501,712.627285086805,425.508381231369,240.785707034479,715.654933663278,266.982616163912,146.55552624328,466.020096280508,466.025004339118,686.682324654249,398.903203148935,314.965901074557,271.179989722521,38.9795790722504,367.032722170712,561.461556199988,968.810923009924,637.735281063423]},"columns":[{"accessor":"AtBat","name":"AtBat","type":"numeric"},{"accessor":"Hits","name":"Hits","type":"numeric"},{"accessor":"HmRun","name":"HmRun","type":"numeric"},{"accessor":"Runs","name":"Runs","type":"numeric"},{"accessor":"RBI","name":"RBI","type":"numeric"},{"accessor":"Walks","name":"Walks","type":"numeric"},{"accessor":"Years","name":"Years","type":"numeric"},{"accessor":"CAtBat","name":"CAtBat","type":"numeric"},{"accessor":"CHits","name":"CHits","type":"numeric"},{"accessor":"CHmRun","name":"CHmRun","type":"numeric"},{"accessor":"CRuns","name":"CRuns","type":"numeric"},{"accessor":"CRBI","name":"CRBI","type":"numeric"},{"accessor":"CWalks","name":"CWalks","type":"numeric"},{"accessor":"League","name":"League","type":"factor"},{"accessor":"Division","name":"Division","type":"factor"},{"accessor":"PutOuts","name":"PutOuts","type":"numeric"},{"accessor":"Assists","name":"Assists","type":"numeric"},{"accessor":"Errors","name":"Errors","type":"numeric"},{"accessor":"Salary","name":"Salary","type":"numeric"},{"accessor":"NewLeague","name":"NewLeague","type":"factor"},{"accessor":".pred","name":".pred","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"f653f49d6af2f6933b04294ea0e12c7f","key":"f653f49d6af2f6933b04294ea0e12c7f"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>test_results <span class="sc">%&gt;%</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>  yardstick<span class="sc">::</span><span class="fu">rsq</span>(<span class="at">truth =</span> .data[[<span class="st">&quot;Salary&quot;</span>]], <span class="at">estimate =</span> .data[[<span class="st">&quot;.pred&quot;</span>]]) <span class="sc">%&gt;%</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-b6374e9c01803b4439d8" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-b6374e9c01803b4439d8">{"x":{"tag":{"name":"Reactable","attribs":{"data":{".metric":["rsq"],".estimator":["standard"],".estimate":[0.490544949390221]},"columns":[{"accessor":".metric","name":".metric","type":"character"},{"accessor":".estimator","name":".estimator","type":"character"},{"accessor":".estimate","name":".estimate","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"1329fdb9c03bfbfe085093d49c8b25b6","key":"1329fdb9c03bfbfe085093d49c8b25b6"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>Alternatively, we can use <code>tune::last_fit</code> and <code>tune::collect_metrics</code></p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>test_results <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">last_fit</span>(</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">object =</span> lasso_final_fit,</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">split =</span> Hitters_split</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  tune<span class="sc">::</span><span class="fu">collect_metrics</span>()</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>test_results <span class="sc">%&gt;%</span></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-e4df278c188329e57af1" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-e4df278c188329e57af1">{"x":{"tag":{"name":"Reactable","attribs":{"data":{".metric":["rmse","rsq"],".estimator":["standard","standard"],".estimate":[307.338143256555,0.490544949390221],".config":["Preprocessor1_Model1","Preprocessor1_Model1"]},"columns":[{"accessor":".metric","name":".metric","type":"character"},{"accessor":".estimator","name":".estimator","type":"character"},{"accessor":".estimate","name":".estimate","type":"numeric"},{"accessor":".config","name":".config","type":"character"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"89fb6b59a10c02e65c6ba446435adfd1","key":"89fb6b59a10c02e65c6ba446435adfd1"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="principal-components-regression" class="section level1">
<h1>Principal Components Regression</h1>
<p>The principal component regression is a linear model with pca transformed data. Hence, the major changes will be on the preprocessing steps.</p>
<div id="create-the-resample-object-2" class="section level2">
<h2>Create the resample object</h2>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>Hitters <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(ISLR<span class="sc">::</span>Hitters) <span class="sc">%&gt;%</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">drop_na</span>()</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>Hitters_split <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">initial_split</span>(Hitters, <span class="at">strata =</span> <span class="st">&quot;Salary&quot;</span>)</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>Hitters_train <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">training</span>(Hitters_split)</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>Hitters_test <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">testing</span>(Hitters_split)</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>Hitters_fold <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">vfold_cv</span>(Hitters_train, <span class="at">v =</span> <span class="dv">10</span>)</span></code></pre></div>
</div>
<div id="create-the-preprocessor-2" class="section level2">
<h2>Create the preprocessor</h2>
<p>We add <a href="https://recipes.tidymodels.org/reference/step_pca.html"><code>recipes::step_pca</code></a> this time to perfrom principal component analysis on all the predictors. Threshold is the fraction of the total variance that should be covered by the components.</p>
<p>For the below example, <code>threshold = .75</code> means that step_pca should generate enough components to capture 75 percent of the variability in the variables. Note: using this argument will override and reset any value given to <code>num_comp</code>.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>pca_recipe <span class="ot">&lt;-</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">recipe</span>(<span class="at">formula =</span> Salary <span class="sc">~</span> ., <span class="at">data =</span> Hitters_train) <span class="sc">%&gt;%</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_novel</span>(recipes<span class="sc">::</span><span class="fu">all_nominal_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_dummy</span>(recipes<span class="sc">::</span><span class="fu">all_nominal_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_zv</span>(recipes<span class="sc">::</span><span class="fu">all_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_normalize</span>(recipes<span class="sc">::</span><span class="fu">all_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_pca</span>(recipes<span class="sc">::</span><span class="fu">all_predictors</span>(), <span class="at">threshold =</span> <span class="fl">0.75</span>)</span></code></pre></div>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>rec <span class="ot">&lt;-</span> recipes<span class="sc">::</span><span class="fu">prep</span>(<span class="at">x =</span> pca_recipe, <span class="at">training =</span> Hitters_train)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>rec <span class="sc">%&gt;%</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>() <span class="sc">%&gt;%</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-84b3c025ed8c07b052af" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-84b3c025ed8c07b052af">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"variable":["Salary","PC1","PC2","PC3","PC4"],"type":["numeric","numeric","numeric","numeric","numeric"],"role":["outcome","predictor","predictor","predictor","predictor"],"source":["original","derived","derived","derived","derived"]},"columns":[{"accessor":"variable","name":"variable","type":"character"},{"accessor":"type","name":"type","type":"character"},{"accessor":"role","name":"role","type":"character"},{"accessor":"source","name":"source","type":"character"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"5164cec062145dece6acdb4df42f6720","key":"5164cec062145dece6acdb4df42f6720"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>rec <span class="sc">%&gt;%</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">bake</span>(<span class="at">new_data =</span> Hitters_train) <span class="sc">%&gt;%</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-2e5b6fb0322de58a07d6" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-2e5b6fb0322de58a07d6">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Salary":[70,100,75,175,135,115,110,90,90,75,105,110,145,70,155,87.5,175,90,165,95,110,100,80,75,155,86.5,125,75,145,75,90,150,68,175,137,120,140,175,172,190,70,190,97.5,140,100,135,105,160,120,165,240,300,305,215,415,340,416.667,275,230,225,320,210,260,300,385,215,362.5,200,400,400,297.5,325,250,275,365,277.5,250,300,300,365,202.5,210,240,350,200,300,425,250,400,250,200,350,341.667,350,425,286.667,245,235,425,385,480,500,750,517.143,512.5,550,700,600,675,535,450,431.5,490,750,700,535,737.5,600,662.5,750,430,657,450,630,737.5,625,725,525,575,700,550,650,670,750,450,750,580,450,487.5,450,750,740,475,530,740,500,750,525,550,700,1100,775,776.667,765,850,815,875,1200,1350,950,850,1975,1900,1041.667,1220,1861.46,2460,1500,1925.571,950,773.333,775,850,2412.5,825,1000,1310,1043.333,1183.333,787.5,800,780,2127.333,875,1260,1670,875,1000,1450,940,925,1150,900,1600,875,960],"PC1":[-3.94936291570364,-3.44832316474186,-3.39773617327447,-3.56555435184881,-3.25975339545356,-2.16918288810179,-2.53967377437542,-3.50431227054158,-1.71178707085248,-3.3041551224216,-0.660520240431698,-2.1303935011809,-0.426322968005356,-3.75567881768636,-1.60059811513426,-2.5453820533035,-3.16663560854435,-3.68518705873106,0.278037649931169,-3.65636570063591,-3.070367855849,-0.510383335455067,-2.22971507343869,-3.96767014941176,-2.26063723609541,-3.68131052535488,-2.53632258471978,-3.57009464175496,-1.91491229440418,-3.60628715532925,-3.31961464691246,-2.45477486711452,-3.83405332878633,-0.329037442808071,-2.86962471304846,-2.76843367379213,-2.97717721732576,-2.001181174702,-0.544247245979557,-2.43118854351683,-3.30682839580285,-4.19218365429862,-2.25168061143223,-1.84941974325833,0.612191910497019,-1.69887371984232,-2.0977212749581,-1.48032920431843,-2.09704157496286,-0.0366022227781362,-1.09987803722011,-2.61597755225221,-2.49842815325986,-1.89317980778684,-1.45141017813548,-2.30084386488829,-0.843765688785429,1.17091827838351,-3.24579158692874,-3.26982909816822,2.70100623347741,-2.00047284967781,1.86028341666333,-0.547499964217356,-1.14049126748275,0.551117161187305,-1.64505684984415,5.64374215904005,-0.300824988221808,-1.24362072845684,-2.30894722157569,2.96686773564834,1.04127316884758,-1.28105373566639,0.849754050506571,0.950347777873304,-0.387986542525131,-1.51337385763403,-0.348231542941208,1.13679885733523,-1.62581971443815,-0.919258183492396,-2.39820050660983,-1.3108224398167,-0.411375886057845,-1.46802110111738,-0.645970831995506,-2.53814610510526,0.258613109946897,-2.51587000830609,-0.472332528387543,-1.10359347840897,-1.29035509543258,-0.170972539520479,-2.24013658394143,-3.12397531196264,-2.44152623160375,-0.336103870588938,-0.702606206867681,-1.17196002302799,0.34354950111349,3.25292393708575,0.902619104865593,3.01056840903855,-2.19011846743034,-0.966935829507016,-2.30384221469219,0.00774918197105767,2.28397823881559,7.63665780372707,2.44800450982032,-1.76015895199382,-0.558793570441652,3.38473003518987,3.40358143384408,0.0961067165015936,0.989032224454881,0.119547807435154,0.293232449327394,-0.482378980980667,0.862103657388996,0.629841558206341,-1.11636186960489,-0.0129299268578161,-0.433464612690883,0.682501971102112,0.629356678396783,1.75351070950154,0.0281972360646473,1.61353668268418,-0.350365363140566,-1.04265016599878,-0.963547415639888,-0.0443366244013654,1.59245890175069,7.37165619738004,-0.427040163826823,0.351620489418153,8.69480009059291,-0.435725014813603,0.1954806037586,1.0989523332591,-0.657893009425072,1.57098775568206,0.656770924447626,3.3461063718112,0.473527699503533,-1.16306113800209,-1.40586021956363,-0.406817912736086,3.66373357618881,5.35693325833659,5.70655144455936,0.672706799346065,2.55423822851225,0.820211809187725,4.00399862607991,2.27800558303805,2.48643613868345,6.55401209401128,3.91650081486463,2.70799742617248,4.51252983973848,5.68256133469429,0.845378915995726,6.63233142597011,4.90726174621174,4.87383385725944,5.02843037040728,2.04083577876588,4.43870547661726,0.382584767947741,0.46934205611466,6.69646771360241,1.97477914718499,3.50270204992272,2.29861336655702,1.24806432693602,1.58184678726942,2.19758292209239,1.89106743229861,0.00583069845348599,-4.93188760198835,-1.14298226092579,1.15098380908497,3.84408402460366,-0.635935748922225,4.08548016765223,5.83757608865087,1.38812159401384,0.519132048507543,0.301038367056004,-1.00540450244071,1.87057676143256,3.07582285685666,1.8773067724381],"PC2":[-1.51200203199781,-0.672957102563078,-0.373692088450115,-1.28335496634881,-2.49865934710503,0.93499887782411,0.0253259868157111,-1.0775743335684,1.83365509295716,-1.10784928521407,3.00675401005554,0.491768380229364,2.95182537967722,-0.956645040432106,2.04709110052658,0.801898807702,-2.46449276639182,-2.00226107922522,4.14404472760468,-1.4460345895536,-0.56516062578227,-1.66912821859511,0.275438873565777,-1.90908498460705,0.204748763976033,-1.36542177933592,0.282341834193718,-0.651019259723575,0.347995984270232,-1.24457937114091,-1.06478252828243,0.514865890209259,-1.26507144020916,2.82154692663408,-0.563798774123037,-0.440155422376464,-0.856768217323612,1.82462672050267,3.34839926443398,-1.10434615932665,-0.081765821835995,-2.38801140874944,0.956296996813495,2.18622501881092,2.67159466671216,1.61507745257586,1.38959068134271,1.47985450133908,1.39812110290337,4.55029061797031,-2.67122267038324,-1.49490849126383,-1.00170941347509,0.775137318479234,0.379604526372863,-1.66330076008223,-2.09915249595284,-4.70532481769968,-1.195239924377,-1.67477048566202,-3.85811398544706,-0.302850933777503,-4.19577023260381,2.14814465265767,-0.144350367352547,3.94866405624002,-0.63025549806051,-4.09772638086963,2.13497031349559,-0.127613257243003,-0.925158806339554,-4.39440725713396,4.17981061147948,-2.67226316585195,-2.48026842687973,1.53795829597496,-2.31325004619761,0.282343571244768,1.15370102422615,4.31810269122777,1.21332156891821,2.1183785552048,-1.33651446534361,0.171949560286957,2.86026999571171,-0.0104290103644072,-0.113299185150907,-0.958153396326369,-2.9655929080727,0.00252982903180458,3.14389024798703,1.57457540774617,-1.28958359909705,3.49664376658425,-1.45037422393027,-2.21273299135318,-1.35000821176573,-3.38083115961096,1.57096068077396,0.764765828497068,2.52900856091849,-0.717525310743568,1.42254830857069,2.36240779515753,-1.92935338280352,0.426917368035494,-1.59687155741238,0.931844104257475,-1.38490109476647,-0.638260201979618,-3.41361219628215,-0.130527889080987,0.00408328629810638,0.994479141617288,-3.17638925205543,-0.454457179597842,-0.938717699752471,-0.630894065477255,1.58413099873628,-0.377249100777421,-1.2186053522282,1.68891979446,-3.43905572645988,2.17044630864877,-2.61956022348504,2.6957114485066,0.202307628838833,-0.214517332647601,3.19965235031526,0.0942990594712984,1.52515096743827,-1.46102359260083,-0.715277232962622,2.11957471285256,-2.4658674354137,-7.73052698191716,1.327220972696,-2.41599427997496,-3.6988054379067,-0.273076773448743,0.595689095579002,1.76817135760396,1.98953694343792,2.55290092407105,2.34469711246174,-6.32503196852563,0.539038133658609,-0.926112466717444,0.170160133951,0.18368211184986,-1.65765844017032,-0.411535344969508,0.658997101140736,1.85644631122327,-2.17463078086504,1.29635220916474,-2.34445053999837,0.98393386977941,3.24044285302418,-0.33975692366137,0.413679190303435,5.19510632561896,0.758305156183288,0.627927938374469,1.82877581019584,0.146232442644515,0.677759495822704,-0.614281592247892,0.155708420564308,1.4002206379752,-2.35704078494398,2.61703992892204,0.209271044143703,0.84746427061106,-1.40303513001175,-0.987993173764571,3.09667881697996,0.891478505597023,1.30640813105818,2.0851170055444,-0.868005443647767,1.28289766904635,-3.04752966295402,-0.271502653294001,0.0272154514688386,2.63363337753689,0.205645251423405,-0.587877083191167,-1.54612473680399,1.74956141063363,0.770961244339003,1.15226066655539,-4.00897183212363,3.40831492852178,0.580326312818655,2.38556050916075],"PC3":[0.218971342150585,0.381477069229517,-2.229781304736,0.36696869365447,-0.0147174831045598,0.508637170668943,-0.487137564393924,-0.613790574442072,1.51152502208198,1.72636198433848,-0.183642258399881,2.16291478256739,1.63487417836456,1.32400230216992,-1.02712390953534,-0.700887431397135,-0.00631103826160473,-0.0162053402985852,1.35643541055765,1.83871916714307,-0.233159346253629,-0.589761123843065,1.52951121877006,0.840606713924063,-0.806765752700032,-0.0970878845185317,-0.579344271636511,-1.86003954653357,2.35683783505829,-0.21857841823816,0.0917508745868735,-2.83928548163985,1.82850000710643,0.17675557543008,1.43907598297988,1.52321104614868,-0.128089583338013,-1.33460110785719,1.33438293177197,1.81121072137189,0.504922490568987,-0.429022784337135,1.73480599063673,-2.90404581615094,0.683647464533811,0.649805622659587,0.154104245846947,-2.95169529310231,-1.11640306267557,0.468362701270763,-0.719832754035441,1.5576755482795,1.60131757209959,-1.98900757266162,-0.0664553053572143,-0.134615940595839,-1.39100013690287,-0.702132750492134,0.375825284106662,-1.32069770239534,-2.08554500209006,0.527298682597315,1.91311019208126,-0.201246465358137,0.635661038086839,-0.964469114482314,0.465303600811697,-1.81151945693608,1.03477055203393,0.723294714593899,-1.57888684772787,1.63328286470496,1.74367833362701,2.15605219197695,2.08001787295497,-2.10635398544102,-0.786913319241984,1.69534935415834,2.32901178165874,1.5256391985856,-0.386948407132261,-0.932745195951967,-0.291269128598902,1.59637881800474,1.62115789561411,1.61289129304314,2.31064264837288,2.01843722938983,1.7278510823199,-2.47754238734203,-1.79509065646714,-0.802718384481044,0.950488855830857,-0.702149961229428,0.77177056312186,-0.0602564925193114,1.78995510034068,1.36585660481755,0.0223948114867377,0.751708468786868,0.690890014539935,-0.333006350330237,-1.78053300797755,-1.12021195150313,-1.00965471112621,-0.524678266898287,0.963236566691728,-0.518163933767942,1.44980635762766,1.47498109035392,-1.01663592416057,1.66158835843851,-0.347534318889368,-0.346794580080306,1.53383569866721,-3.28778243604655,-3.27165400231091,1.59402732126258,-0.519552119618024,-1.66948654679618,0.600419241639996,-2.34002730757746,-0.110418955197719,-0.556601498316185,-0.789368503675677,-0.540497252755106,-1.98906034230278,1.46228564392989,-0.887375285398632,0.837925541148977,1.63079111061203,0.186254237216093,-0.219331755491357,1.56792863140631,-2.37487853418628,-1.83496638715405,0.754783943846036,1.13363566739145,1.81708659761092,1.02565615299183,-3.31025215900044,-2.2338933748038,-0.631450065118964,-0.769076922738855,-0.875114418383829,-0.815584489611052,-1.89040123067193,-1.24448894316272,-2.4474658977104,-0.592235089929932,2.03470683423897,-2.15871257197371,-0.0622208413596378,1.16067677955038,-2.59725382183087,-0.983781823077089,1.3630145427985,0.960902100107943,-0.432211560047271,2.04586900366193,0.539382749160977,1.22071079622321,-0.511770750413353,-0.811781089866747,-0.138398327627617,1.48175184543282,0.582653571712712,-0.162367564650121,-0.755137994649924,1.4701186662974,-0.977005254938991,-0.760316864068579,-0.204608132275374,1.12150726219055,0.128680420977832,0.487827643379553,1.00935020651022,-0.637944948895125,-0.837953354628747,1.46776275972535,0.709744155826192,1.31469299098344,-0.812580109834451,-1.61816031477653,0.143770533921075,1.43798255988564,-3.55896982912445,1.21892668384992,-1.14903027152111,1.51532377889482,-2.54943444171839,-1.92312010296189,-0.243456820699461,-0.728209121169146,-1.29973914386579,0.291526203717869],"PC4":[0.506159540116044,1.94415426904393,0.406128227243187,2.03255839550475,-1.4590750563153,-0.924446507206077,-1.53983190189159,-1.29004002228195,0.166668759215759,0.512571221455154,1.59343923488764,-0.170114956894086,-0.579088664296521,1.12644861503881,2.54139411713037,2.61968952030285,-1.43394597166905,-1.23656484474556,-0.774669219623475,0.602717134305926,-1.67056162005864,-1.19960279357015,0.380013868196959,-0.48125835618374,-1.36258569453865,-1.5341201676431,-1.28702098803083,0.086199020977541,-0.23216969536421,-1.5830295878915,-1.70019872190444,0.737635757957711,0.537503654426372,1.2730944200318,0.510223898187175,0.274011484976802,-1.47540710177616,3.01518904246553,-0.370198538492082,0.631647895624005,1.81682391901341,-0.800286000020465,-0.066311055175888,0.497416963779563,-0.291921627144955,0.966912065340214,1.57525525285237,0.883903243496862,-1.68031320658395,-0.34939452171225,-0.576922229717533,0.589770311799361,0.707302666575121,-0.176353982062181,-2.18138046397612,-1.58984019832178,-0.191005974577971,-0.252029101748498,1.99135224193474,-0.195390131103349,0.599287851001892,-0.527348979184358,0.629871690545375,-2.55286402604482,-1.1049311734391,-2.84911523156718,1.87412177328543,0.0912277489327027,0.170559160264867,-0.575552437586466,-0.0519583176204041,0.953462448754011,-0.752544837878387,0.604924418102484,0.484121355170011,-0.269050169070771,1.19098237311016,0.352532934523434,-0.77140446506262,-0.860712666805701,-1.78490938576352,-1.47502493594303,-1.50233627559149,0.42189190485015,-0.452974561375345,0.256417026809626,-0.440063768412638,0.475412012901768,0.909772979058747,0.768593342679769,-1.5380152395552,2.44345700388993,1.55890956236629,2.18897878905639,-0.495933959877582,-1.18257698638567,0.320325912784397,1.21371965783274,1.56650837417562,1.08231433520993,-0.0225615079524084,-1.79037320613589,3.30950369534066,2.54126312708279,-0.735651536955082,-1.59641774448111,1.67526332717073,-2.16856485744379,0.565489644579658,-0.272041737818084,-0.316415316661586,0.0456203010387399,-1.86000771264781,1.73683366349435,0.667467630908807,1.20386922343466,1.23777087800769,0.300340237379601,-1.9581352889694,-0.156558850039917,1.59719837290488,0.0646812690125125,-1.22593005699126,-2.19404196339688,-0.835217911583331,-2.50075275940377,-0.191304965215428,0.539583409619691,2.36861032019322,-0.878566345254316,0.00950235159166291,0.119297440318208,-1.82438356048184,-0.26130990404262,0.59754079469339,0.492388023128258,0.670124973207009,1.23077138753747,0.181006097044722,1.20253970457884,0.980248781855614,-0.0797070186215521,2.220034895462,2.19003310677469,-1.88561712806637,-0.332127828805292,-0.220382982902589,-0.354307975458449,0.69684627973979,-1.47458355544383,0.0930791492623633,-0.25174729608638,0.957418802079804,0.317514433253789,0.644672983055036,-1.75968520333909,0.510206117631516,0.578827859108365,1.69443779961252,-0.358168368748351,0.881065665679248,-1.18488682185589,-2.3338552087435,-2.13476910011907,-2.4739511956929,-0.149718009078779,0.284143938322245,1.71312871174394,-2.11909230525669,-0.264251053790641,-1.17372842375033,2.29786779316962,2.26311331180138,0.0762350044092214,-0.556790684496482,-0.462518648626333,-0.757331784639966,-1.6560261736697,-2.21832517135936,-0.236112390855944,-0.903268561638765,0.121174964300286,-0.0432756302295672,-0.881293872843296,1.86469611483655,-0.382854434799833,1.46058288035574,0.569064713680109,-1.7817336924605,-0.362195569646662,0.353450013404907,-0.763535006883585,-0.976385771218572,1.95018242233786,2.97709551092107,0.427493892038205]},"columns":[{"accessor":"Salary","name":"Salary","type":"numeric"},{"accessor":"PC1","name":"PC1","type":"numeric"},{"accessor":"PC2","name":"PC2","type":"numeric"},{"accessor":"PC3","name":"PC3","type":"numeric"},{"accessor":"PC4","name":"PC4","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"afca8f1e213fb664311890f5b73cf90c","key":"afca8f1e213fb664311890f5b73cf90c"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>We will now try to find the best threshold value using the <code>tune::tune()</code></p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>pca_recipe <span class="ot">&lt;-</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">recipe</span>(<span class="at">formula =</span> Salary <span class="sc">~</span> ., <span class="at">data =</span> Hitters_train) <span class="sc">%&gt;%</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_novel</span>(recipes<span class="sc">::</span><span class="fu">all_nominal_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_dummy</span>(recipes<span class="sc">::</span><span class="fu">all_nominal_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_zv</span>(recipes<span class="sc">::</span><span class="fu">all_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_normalize</span>(recipes<span class="sc">::</span><span class="fu">all_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_pca</span>(recipes<span class="sc">::</span><span class="fu">all_predictors</span>(), <span class="at">threshold =</span> tune<span class="sc">::</span><span class="fu">tune</span>())</span></code></pre></div>
</div>
<div id="specify-the-model-2" class="section level2">
<h2>Specify the model</h2>
<p>We use a linear model</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>lm_spec <span class="ot">&lt;-</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_mode</span>(<span class="st">&quot;regression&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">&quot;lm&quot;</span>)</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>lm_spec <span class="sc">%&gt;%</span></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">translate</span>()</span></code></pre></div>
<pre><code>&gt; Linear Regression Model Specification (regression)
&gt; 
&gt; Computational engine: lm 
&gt; 
&gt; Model fit template:
&gt; stats::lm(formula = missing_arg(), data = missing_arg(), weights = missing_arg())</code></pre>
</div>
<div id="create-the-workflow-2" class="section level2">
<h2>Create the workflow</h2>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>pca_workflow <span class="ot">&lt;-</span> workflows<span class="sc">::</span><span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  workflows<span class="sc">::</span><span class="fu">add_recipe</span>(pca_recipe) <span class="sc">%&gt;%</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>  workflows<span class="sc">::</span><span class="fu">add_model</span>(lm_spec)</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>pca_workflow</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; == Workflow ====================================================================
&gt; Preprocessor: Recipe
&gt; Model: linear_reg()
&gt; 
&gt; -- Preprocessor ----------------------------------------------------------------
&gt; 5 Recipe Steps
&gt; 
&gt; * step_novel()
&gt; * step_dummy()
&gt; * step_zv()
&gt; * step_normalize()
&gt; * step_pca()
&gt; 
&gt; -- Model -----------------------------------------------------------------------
&gt; Linear Regression Model Specification (regression)
&gt; 
&gt; Computational engine: lm</code></pre>
</div>
<div id="create-the-threshold-grid" class="section level2">
<h2>Create the threshold grid</h2>
<p>A threshold grid of <span class="math inline">\(10\)</span> numbers from <span class="math inline">\(0\)</span> to <span class="math inline">\(1\)</span> is created.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>doParallel<span class="sc">::</span><span class="fu">registerDoParallel</span>()</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a range from 10</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>threshold_grid <span class="ot">&lt;-</span> dials<span class="sc">::</span><span class="fu">grid_regular</span>(dials<span class="sc">::</span><span class="fu">threshold</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)), <span class="at">levels =</span> <span class="dv">10</span>)</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>threshold_grid <span class="sc">%&gt;%</span></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-bc3f5372c4c1f4c48bc2" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-bc3f5372c4c1f4c48bc2">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"threshold":[0,0.111111111111111,0.222222222222222,0.333333333333333,0.444444444444444,0.555555555555556,0.666666666666667,0.777777777777778,0.888888888888889,1]},"columns":[{"accessor":"threshold","name":"threshold","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"e43a94363d88e7d1c0f859ac0e73872b","key":"e43a94363d88e7d1c0f859ac0e73872b"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="principal-component-regression-model-fitting-on-cross-validated-data" class="section level2">
<h2>Principal component regression model fitting on cross validated data</h2>
<p>Now we have everything we need and we can fit all the models on the cross validated data. Note that this process may take some time.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>tune_res <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">tune_grid</span>(</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">object =</span> pca_workflow,</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">resamples =</span> Hitters_fold,</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">grid =</span> threshold_grid</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>tune_res</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; # Tuning results
&gt; # 10-fold cross-validation 
&gt; # A tibble: 10 x 4
&gt;    splits           id     .metrics          .notes          
&gt;    &lt;list&gt;           &lt;chr&gt;  &lt;list&gt;            &lt;list&gt;          
&gt;  1 &lt;split [176/20]&gt; Fold01 &lt;tibble [20 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  2 &lt;split [176/20]&gt; Fold02 &lt;tibble [20 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  3 &lt;split [176/20]&gt; Fold03 &lt;tibble [20 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  4 &lt;split [176/20]&gt; Fold04 &lt;tibble [20 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  5 &lt;split [176/20]&gt; Fold05 &lt;tibble [20 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  6 &lt;split [176/20]&gt; Fold06 &lt;tibble [20 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  7 &lt;split [177/19]&gt; Fold07 &lt;tibble [20 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  8 &lt;split [177/19]&gt; Fold08 &lt;tibble [20 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  9 &lt;split [177/19]&gt; Fold09 &lt;tibble [20 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt; 10 &lt;split [177/19]&gt; Fold10 &lt;tibble [20 x 5]&gt; &lt;tibble [0 x 3]&gt;</code></pre>
<p>Here we see how different threshold (Variance coverage) affects the performance metrics differently. Do note that using a different seed will give a different plot</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that a different seed will give different plots</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>tune<span class="sc">::</span><span class="fu">autoplot</span>(tune_res)</span></code></pre></div>
<p><img src="img/unnamed-chunk-69-1.png" width="3883.2" style="display: block; margin: auto;" /></p>
<p>The “best” values of this can be selected using <code>tune::select_best()</code>, this function requires you to specify a metric that it should select against. The threshold value is 0.889 for metric <code>rsme</code> since it gives the lowest value. Do note that using a different seed will give a different best number of threshold value.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>top_threshold <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">show_best</span>(tune_res, <span class="at">metric =</span> <span class="st">&quot;rmse&quot;</span>, <span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>top_threshold</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; # A tibble: 5 x 7
&gt;   threshold .metric .estimator  mean     n std_err .config              
&gt;       &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;                
&gt; 1     0.889 rmse    standard    338.    10    36.1 Preprocessor09_Model1
&gt; 2     0.667 rmse    standard    340.    10    37.9 Preprocessor07_Model1
&gt; 3     0.444 rmse    standard    340.    10    37.5 Preprocessor05_Model1
&gt; 4     0.556 rmse    standard    340.    10    37.5 Preprocessor06_Model1
&gt; 5     0.778 rmse    standard    340.    10    38.0 Preprocessor08_Model1</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>best_threshold <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">select_best</span>(tune_res, <span class="at">metric =</span> <span class="st">&quot;rmse&quot;</span>)</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>best_threshold</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; # A tibble: 1 x 2
&gt;   threshold .config              
&gt;       &lt;dbl&gt; &lt;chr&gt;                
&gt; 1     0.889 Preprocessor09_Model1</code></pre>
</div>
<div id="principal-component-regression-model-with-optimised-threshold-value" class="section level2">
<h2>Principal component regression model with optimised threshold value</h2>
<p>We create the principal component regression workflow with the best threshold.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>pca_final <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">finalize_workflow</span>(</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> pca_workflow,</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">parameters =</span> best_threshold</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>pca_final</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; == Workflow ====================================================================
&gt; Preprocessor: Recipe
&gt; Model: linear_reg()
&gt; 
&gt; -- Preprocessor ----------------------------------------------------------------
&gt; 5 Recipe Steps
&gt; 
&gt; * step_novel()
&gt; * step_dummy()
&gt; * step_zv()
&gt; * step_normalize()
&gt; * step_pca()
&gt; 
&gt; -- Model -----------------------------------------------------------------------
&gt; Linear Regression Model Specification (regression)
&gt; 
&gt; Computational engine: lm</code></pre>
<p>We now train the principal component regression model with the training data</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>pca_final_fit <span class="ot">&lt;-</span> parsnip<span class="sc">::</span><span class="fu">fit</span>(<span class="at">object =</span> pca_final, <span class="at">data =</span> Hitters_train)</span></code></pre></div>
</div>
<div id="principal-component-regression-model-on-test-data" class="section level2">
<h2>Principal component regression model on test data</h2>
<p>This principal component regression model can now be applied on our testing data set to validate its performance. For regression models, a .pred column is added.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>test_results <span class="ot">&lt;-</span> parsnip<span class="sc">::</span><span class="fu">augment</span>(<span class="at">x =</span> pca_final_fit, <span class="at">new_data =</span> Hitters_test)</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>test_results <span class="sc">%&gt;%</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-d9714d4c9e76eef7e11d" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-d9714d4c9e76eef7e11d">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"AtBat":[315,321,413,324,474,550,513,583,181,217,205,214,529,424,388,339,329,458,317,382,233,641,596,370,282,589,438,232,528,309,616,591,315,453,441,551,283,199,464,584,303,381,514,359,309,216,256,466,327,341,486,275,208,459,288,220,581,439,633,368,263,520,19,279,600,610,631],"Hits":[81,87,92,73,129,152,137,168,41,46,57,53,137,119,103,96,83,114,78,119,49,198,171,96,78,170,103,55,132,94,163,157,73,101,118,171,70,52,128,157,71,110,144,80,72,56,70,108,68,110,145,68,57,113,63,66,145,96,210,103,70,120,4,69,139,186,170],"HmRun":[7,10,16,4,10,6,20,17,1,7,8,2,26,6,15,4,9,13,7,13,2,31,34,21,13,40,2,9,21,5,27,16,5,3,28,13,8,9,28,20,3,9,0,15,0,4,13,33,13,9,11,5,8,20,3,5,17,0,6,3,1,17,1,4,0,19,9],"Runs":[24,39,72,32,50,92,90,83,15,32,34,30,86,57,59,37,50,67,35,54,41,101,91,49,37,107,65,34,61,37,83,90,23,46,84,94,33,26,67,95,18,61,67,45,33,22,42,75,42,45,51,42,32,59,25,20,66,44,91,48,26,53,2,35,94,107,77],"RBI":[38,42,48,18,56,37,95,80,21,19,32,29,97,46,47,29,39,57,35,58,23,108,108,46,51,108,32,23,74,32,107,78,37,43,86,83,37,28,94,73,30,45,54,48,31,18,36,86,29,49,76,42,25,57,33,28,68,36,56,28,23,44,3,31,29,98,44],"Walks":[39,30,65,22,40,81,90,56,33,9,9,23,97,13,39,23,56,48,32,36,18,41,52,60,29,69,71,45,41,26,32,26,16,61,68,94,27,21,52,63,36,32,79,63,26,15,44,72,45,46,40,61,18,68,16,13,21,65,59,54,30,21,1,32,60,74,31],"Years":[14,2,1,7,10,5,14,5,2,4,5,2,15,9,6,4,9,4,1,12,8,5,6,15,5,6,2,12,6,13,3,4,4,3,8,13,12,6,13,10,3,7,9,7,5,12,16,3,18,9,11,6,3,12,10,3,2,4,6,8,4,4,1,4,2,6,11],"CAtBat":[3449,396,413,1931,2331,2308,5201,1646,232,694,756,226,6661,3651,2174,1064,3828,1350,317,2133,1350,2129,2862,6986,1649,2325,440,4405,2641,4618,1437,2020,450,948,2723,6090,4479,805,5829,4704,344,3015,4739,1493,354,2796,7058,652,3949,2331,3967,961,653,5348,2682,290,831,711,3070,1897,888,927,19,1359,1236,2728,4908],"CHits":[835,101,92,491,604,633,1382,452,50,160,192,59,1785,1046,555,290,948,298,78,594,336,610,728,1972,453,634,103,1213,671,1330,377,541,108,218,750,1840,1222,191,1552,1320,76,834,1169,359,82,665,1845,142,939,658,1102,238,170,1369,667,80,210,148,872,493,220,227,4,355,309,753,1457],"CHmRun":[69,12,16,13,61,32,166,44,4,32,32,2,291,32,80,11,145,28,7,41,7,92,107,231,73,128,2,194,97,57,65,52,6,6,126,128,94,30,210,93,3,40,13,61,0,43,312,44,78,50,67,16,17,155,38,5,21,1,19,9,9,22,1,31,1,69,30],"CRuns":[321,48,72,291,246,349,763,219,20,86,117,32,1082,461,285,123,575,160,35,287,166,297,361,1070,211,371,67,702,273,616,181,310,38,96,433,969,557,113,740,724,20,451,583,176,41,266,965,102,438,249,410,128,98,713,315,27,106,68,420,207,83,106,2,180,201,399,775],"CRBI":[414,46,48,108,327,182,734,208,29,76,107,32,949,301,274,108,528,123,35,294,122,319,401,955,280,376,32,705,383,522,227,226,46,72,420,900,483,119,840,522,36,249,374,202,32,304,1128,109,380,322,497,104,54,660,259,31,86,56,230,162,82,80,3,148,69,366,357],"CWalks":[375,33,65,180,166,308,784,136,45,32,51,27,989,112,186,55,635,122,32,227,106,117,224,921,138,238,71,625,226,436,82,91,28,91,309,917,307,87,452,576,45,168,528,175,26,198,990,102,466,274,284,172,62,735,204,15,40,99,274,198,86,52,1,158,110,286,249],"League":["N","N","N","N","N","N","A","A","A","A","A","N","A","A","A","A","A","A","A","N","A","A","A","N","A","A","A","N","N","N","A","N","A","N","A","N","A","N","A","A","N","N","N","N","N","A","N","A","A","A","N","N","N","A","A","A","N","N","N","N","N","A","N","N","N","N","A"],"Division":["W","E","E","E","W","W","W","E","E","E","E","E","E","E","W","W","W","W","E","W","E","E","W","E","W","E","W","E","E","E","W","E","W","W","E","E","E","W","W","E","E","E","E","W","E","E","E","E","E","E","E","E","E","W","W","W","E","E","W","W","E","W","W","E","E","E","W"],"PutOuts":[632,805,280,222,732,262,267,109,326,307,58,109,280,224,182,104,276,246,45,59,102,269,118,137,670,368,276,623,885,161,110,290,227,249,190,1199,156,235,0,276,468,228,229,682,117,391,41,286,659,251,88,181,42,0,135,281,320,229,367,209,81,70,692,133,300,1182,408],"Assists":[43,40,9,3,83,329,5,292,29,25,4,7,10,286,9,213,6,389,122,156,132,17,334,5,57,20,7,35,105,3,308,440,15,444,2,149,2,22,0,421,47,7,453,93,269,44,118,8,53,9,204,3,94,0,257,21,465,406,432,246,147,144,70,173,12,96,4],"Errors":[10,4,5,3,13,16,3,25,5,1,4,3,5,8,4,9,2,18,26,9,10,10,21,9,5,3,9,3,8,3,15,25,3,16,2,5,2,5,0,11,6,5,15,13,12,4,8,8,7,4,16,2,13,0,7,3,32,22,16,3,4,11,8,9,9,13,3],"Salary":[475,91.5,100,708.333,750,625,900,612.5,67.5,180,247.5,70,933.333,850,325,275,600,475,70,595,375,1175,900,733.333,500,1237.5,100,1300,1008.333,600,200,640,110,195,1300,1800,225,265,587.5,420,100,800,1940,700,130,250,1050,215,400,560,500,191,140,740,341.667,90,155,150,90,326.667,250,185,920,277.5,160,1300,1000],"NewLeague":["N","N","N","N","N","N","A","A","A","A","A","N","A","N","A","A","A","A","A","N","A","A","A","N","A","A","N","N","N","N","A","N","A","N","A","N","A","N","A","A","N","N","N","N","N","A","A","A","A","A","A","N","N","A","A","A","N","N","N","N","N","A","A","N","N","N","A"],".pred":[537.961260728539,487.933176449342,529.280744132435,425.515447292061,576.759591409139,631.589470974026,949.396632993558,608.361592832004,226.194139907648,237.191389605008,211.443763189415,247.78030440152,1266.08517427277,563.464514563441,373.885352348202,153.558300781957,580.791235422017,344.663053714979,214.571633294176,422.287299998319,272.512993585622,746.431475642404,580.761158670152,1034.54931345629,355.554279716133,869.395186386563,360.177463495872,826.91497864964,821.579013911809,668.231677568443,416.980101696334,635.635439700984,104.884366776633,350.378127408055,759.839081985815,1458.70413754216,565.183762394671,169.1777910741,737.792315292937,944.514376295539,376.462069703534,603.474813824322,883.218330840795,497.259502252443,296.196253540107,411.987879813515,922.053994966483,578.060801531538,727.59445616882,563.458880712393,683.629993204259,481.217445858107,237.310385492124,721.386794601218,227.648674743146,61.9418648443724,482.286777620891,476.54005576662,700.997369127649,408.604858264539,315.012046556728,215.166396124787,-16.52332955019,384.756084898132,646.854137352415,1106.04981351353,681.739321505725]},"columns":[{"accessor":"AtBat","name":"AtBat","type":"numeric"},{"accessor":"Hits","name":"Hits","type":"numeric"},{"accessor":"HmRun","name":"HmRun","type":"numeric"},{"accessor":"Runs","name":"Runs","type":"numeric"},{"accessor":"RBI","name":"RBI","type":"numeric"},{"accessor":"Walks","name":"Walks","type":"numeric"},{"accessor":"Years","name":"Years","type":"numeric"},{"accessor":"CAtBat","name":"CAtBat","type":"numeric"},{"accessor":"CHits","name":"CHits","type":"numeric"},{"accessor":"CHmRun","name":"CHmRun","type":"numeric"},{"accessor":"CRuns","name":"CRuns","type":"numeric"},{"accessor":"CRBI","name":"CRBI","type":"numeric"},{"accessor":"CWalks","name":"CWalks","type":"numeric"},{"accessor":"League","name":"League","type":"factor"},{"accessor":"Division","name":"Division","type":"factor"},{"accessor":"PutOuts","name":"PutOuts","type":"numeric"},{"accessor":"Assists","name":"Assists","type":"numeric"},{"accessor":"Errors","name":"Errors","type":"numeric"},{"accessor":"Salary","name":"Salary","type":"numeric"},{"accessor":"NewLeague","name":"NewLeague","type":"factor"},{"accessor":".pred","name":".pred","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"79390458e58fe31eae3a1ced0ba5eabb","key":"79390458e58fe31eae3a1ced0ba5eabb"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>test_results <span class="sc">%&gt;%</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>  yardstick<span class="sc">::</span><span class="fu">rsq</span>(<span class="at">truth =</span> .data[[<span class="st">&quot;Salary&quot;</span>]], <span class="at">estimate =</span> .data[[<span class="st">&quot;.pred&quot;</span>]]) <span class="sc">%&gt;%</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-196caf066f1af02afe88" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-196caf066f1af02afe88">{"x":{"tag":{"name":"Reactable","attribs":{"data":{".metric":["rsq"],".estimator":["standard"],".estimate":[0.491469225827072]},"columns":[{"accessor":".metric","name":".metric","type":"character"},{"accessor":".estimator","name":".estimator","type":"character"},{"accessor":".estimate","name":".estimate","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"3f783f50a17c8bd697c9a6a0c4af9bb6","key":"3f783f50a17c8bd697c9a6a0c4af9bb6"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>Alternatively, we can use <code>tune::last_fit</code> and <code>tune::collect_metrics</code></p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>test_results <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">last_fit</span>(</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">object =</span> pca_final_fit,</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">split =</span> Hitters_split</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>  tune<span class="sc">::</span><span class="fu">collect_metrics</span>()</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>test_results <span class="sc">%&gt;%</span></span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-87552c85f26f1aabdd09" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-87552c85f26f1aabdd09">{"x":{"tag":{"name":"Reactable","attribs":{"data":{".metric":["rmse","rsq"],".estimator":["standard","standard"],".estimate":[303.24034707145,0.491469225827072],".config":["Preprocessor1_Model1","Preprocessor1_Model1"]},"columns":[{"accessor":".metric","name":".metric","type":"character"},{"accessor":".estimator","name":".estimator","type":"character"},{"accessor":".estimate","name":".estimate","type":"numeric"},{"accessor":".config","name":".config","type":"character"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"7b070092a68fa9d4a36f2b9ffc4d7a47","key":"7b070092a68fa9d4a36f2b9ffc4d7a47"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="partial-least-square" class="section level1">
<h1>Partial Least Square</h1>
<p>The partial least square regression is a linear model with pls transformed data. Hence, the major changes will be on the preprocessing steps.</p>
<div id="create-the-resample-object-3" class="section level2">
<h2>Create the resample object</h2>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>Hitters <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(ISLR<span class="sc">::</span>Hitters) <span class="sc">%&gt;%</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">drop_na</span>()</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>Hitters_split <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">initial_split</span>(Hitters, <span class="at">strata =</span> <span class="st">&quot;Salary&quot;</span>)</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>Hitters_train <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">training</span>(Hitters_split)</span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>Hitters_test <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">testing</span>(Hitters_split)</span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a>Hitters_fold <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">vfold_cv</span>(Hitters_train, <span class="at">v =</span> <span class="dv">10</span>)</span></code></pre></div>
</div>
<div id="create-the-preprocessor-3" class="section level2">
<h2>Create the preprocessor</h2>
<p>We add <a href="https://recipes.tidymodels.org/reference/step_pls.html"><code>recipes::step_pls</code></a> this time to perform partial least square calculation on all the predictors. <code>num_comp</code> is the number of partial least square components to retain as new predictors. <code>outcome</code> is the response variable for partial least square regression to use.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>pls_recipe <span class="ot">&lt;-</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">recipe</span>(<span class="at">formula =</span> Salary <span class="sc">~</span> ., <span class="at">data =</span> Hitters_train) <span class="sc">%&gt;%</span></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_novel</span>(recipes<span class="sc">::</span><span class="fu">all_nominal_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_dummy</span>(recipes<span class="sc">::</span><span class="fu">all_nominal_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_zv</span>(recipes<span class="sc">::</span><span class="fu">all_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_normalize</span>(recipes<span class="sc">::</span><span class="fu">all_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_pls</span>(recipes<span class="sc">::</span><span class="fu">all_predictors</span>(), <span class="at">num_comp =</span> <span class="dv">4</span>, <span class="at">outcome =</span> <span class="st">&quot;Salary&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>rec <span class="ot">&lt;-</span> recipes<span class="sc">::</span><span class="fu">prep</span>(<span class="at">x =</span> pls_recipe, <span class="at">training =</span> Hitters_train)</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>rec <span class="sc">%&gt;%</span></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>() <span class="sc">%&gt;%</span></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-9d8005903bccb5d981df" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-9d8005903bccb5d981df">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"variable":["Salary","PLS1","PLS2","PLS3","PLS4"],"type":["numeric","numeric","numeric","numeric","numeric"],"role":["outcome","predictor","predictor","predictor","predictor"],"source":["original","derived","derived","derived","derived"]},"columns":[{"accessor":"variable","name":"variable","type":"character"},{"accessor":"type","name":"type","type":"character"},{"accessor":"role","name":"role","type":"character"},{"accessor":"source","name":"source","type":"character"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"eebe372533e673fa29040fa95cffebee","key":"eebe372533e673fa29040fa95cffebee"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>rec <span class="sc">%&gt;%</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">bake</span>(<span class="at">new_data =</span> Hitters_train) <span class="sc">%&gt;%</span></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-ae632b04d6a572535b9b" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ae632b04d6a572535b9b">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Salary":[70,100,75,175,135,115,110,90,90,75,105,110,145,70,155,87.5,175,90,165,95,110,100,80,75,155,86.5,125,75,145,75,90,150,68,175,137,120,140,175,172,190,70,190,97.5,140,100,135,105,160,120,165,240,300,305,215,415,340,416.667,275,230,225,320,210,260,300,385,215,362.5,200,400,400,297.5,325,250,275,365,277.5,250,300,300,365,202.5,210,240,350,200,300,425,250,400,250,200,350,341.667,350,425,286.667,245,235,425,385,480,500,750,517.143,512.5,550,700,600,675,535,450,431.5,490,750,700,535,737.5,600,662.5,750,430,657,450,630,737.5,625,725,525,575,700,550,650,670,750,450,750,580,450,487.5,450,750,740,475,530,740,500,750,525,550,700,1100,775,776.667,765,850,815,875,1200,1350,950,850,1975,1900,1041.667,1220,1861.46,2460,1500,1925.571,950,773.333,775,850,2412.5,825,1000,1310,1043.333,1183.333,787.5,800,780,2127.333,875,1260,1670,875,1000,1450,940,925,1150,900,1600,875,960],"PLS1":[-3.98206908795157,-3.64739536446023,-3.41165115971321,-3.8697414991072,-3.55887988157085,-1.96290125642006,-2.45260658094123,-3.52752135021332,-1.49857297416104,-3.55755734480858,-0.312008720707891,-2.01903306829542,-0.223904850996183,-3.82741039439326,-1.50160361875729,-2.52498192442536,-3.46517420984148,-3.70650833893291,0.61418332913327,-3.96136520175762,-3.03188193213604,-0.730349321810094,-2.27911451878467,-4.18655117930934,-1.99809087328362,-3.78115559549739,-2.27726035682265,-3.56686870190615,-1.89554248558666,-3.62424603173778,-3.23529927019196,-2.34859489919831,-4.09426993103614,-0.0194680002042178,-3.04558591348008,-2.903763238227,-2.82863312941545,-1.87482264835272,-0.313584907840749,-2.53250344499422,-3.25372279375555,-4.2743270799747,-2.27131929336263,-1.4646104020334,0.871581879625446,-1.65883269593665,-1.9771581662131,-1.05776018468816,-1.71613523966393,0.570226992531367,-1.31712133142743,-2.9226390289698,-2.54282282611528,-1.75236836988133,-1.43278221727224,-2.4684497211697,-1.15711601822232,0.608676469940585,-3.52549669132302,-3.43348646850952,2.10767892597284,-2.02814360747836,1.01102238817725,-0.241957505683954,-1.15165751672632,1.21639240778084,-1.72792972723445,4.88948956016769,-0.063591764272402,-1.13035982312915,-2.27339238585685,2.08617703795871,1.53490705852933,-1.69464719431076,0.405036766462324,1.22813395346081,-0.83159929420193,-1.46743846088861,-0.387197135056456,1.52777964435534,-1.16664915594491,-0.351630253366903,-2.52574195071974,-1.24391954886934,-0.119102647089644,-1.59049312897752,-0.885547948876416,-2.64814075493415,-0.189405805430383,-2.26215300465517,0.326698011220754,-0.991411410771076,-1.44751941415319,0.340599072707075,-2.4950690661778,-3.18551289695484,-2.7520033439275,-1.00857479200038,-0.588792541831064,-1.19085361673843,0.64233302334687,3.26128891174329,0.917807673626151,3.23558520942279,-2.39899216502926,-0.701668422314335,-2.46585904415466,0.22517346823676,2.06130846536884,7.45106234626893,2.07390141586884,-1.88689422595639,-0.540043747243157,3.25259208511523,2.6943892894859,0.079129018329334,0.864732715291875,-0.0949602464015327,0.712998309660654,-0.398012912188669,0.670534181366179,1.10101794840826,-1.59185431401123,0.299078933214468,-0.778641308199492,1.05142578610547,0.693744684391891,1.69100648954365,0.549097159785904,1.6500019931519,-0.165384936743172,-1.1431550228294,-1.09004991036935,0.168300003084117,1.15493038962524,6.21810239582946,-0.102240635189738,-0.170497539363419,7.85471627339993,-0.502778069882114,0.312192957566178,1.53916269034526,-0.504302568568675,1.89188989782602,1.04806314230693,2.39324228050121,0.657517822457843,-1.07539214746488,-1.1502510058123,-0.128777788712402,3.32358694514222,5.18614883071238,5.78654542988477,1.04232222302465,2.14307798632971,1.06063138495044,3.42040628947379,2.16715194383789,2.88381087769422,6.29383265527882,3.63408379523481,3.54332127233649,4.53774743189481,5.62317773659973,1.24240635367597,6.53749005800643,5.08019317064985,4.52245672208918,5.20293898958865,2.02371877249101,4.04603457212677,0.739081275316478,0.50203041342817,6.73594434397909,1.73464608631589,3.3341094441524,2.6474369036608,1.5404540844208,2.08804878026196,2.46484334051248,1.83216939220993,-0.00540665034796515,-5.09049305284009,-1.02297385544749,1.11038462540703,4.16093998757537,-0.633940482919976,4.02743944271912,5.63423684560551,1.42914496481222,0.886967513017047,0.755527619384662,-1.5462060698618,2.39069831069242,3.15358903380737,2.41014724689756],"PLS2":[0.325131951623137,-1.17277015188103,-0.255138440429181,-1.58366584967971,-1.03147948623341,0.784740328444725,0.31862024963429,0.0915447342398265,0.407776905689304,-1.28369405173591,0.748643526509339,0.446533916497603,-0.179334171768243,-0.154830093806893,-0.512334814029218,-0.413157546930721,-1.04061076821799,0.602559624369771,0.12251812200656,-1.47336817287603,0.289634104516838,-0.73205418893937,-0.556137712416851,-0.738295242443957,1.42778884550831,-0.279301835580156,1.35726447802903,0.0262961594085086,-0.110399055950384,0.233965350637474,0.836795098374901,0.150902935578507,-1.27382378728606,0.614497695203475,-1.024794504692,-0.803434182878102,1.20015402492739,-0.211929001383076,-0.221261752073049,-0.176620490990727,0.255416318937536,0.340233387496817,-0.737273999992525,1.22291712832693,0.428235448826438,-0.662575466150205,0.0123482857318675,1.88204924611523,1.63323321520474,1.7768417791288,-0.237099135083503,-1.40199183056871,0.154989341564108,0.307907715771379,-0.303067412559277,-0.492422654175368,-1.19498812890739,-1.35107881285484,-1.43252696036691,-0.546110343402493,-1.90615903909048,-0.149971391137217,-3.36616135271855,0.798734932127774,-0.0781893130838838,2.3670737658708,-0.279759045920292,-2.67117053848845,0.544693624541653,0.766565050467296,0.464405729809142,-3.36527912606581,1.2598564390399,-1.42272932694041,-1.59304538305063,1.00112757518979,-1.86825964690401,0.128676342831608,-0.838392195187187,0.495063582155148,2.32073869210705,2.61220463930022,-0.41144351163471,0.368541451736006,0.52901111728235,-0.846496025840171,-1.54646748647891,-0.331062648644111,-1.37968201044149,1.45845958724536,3.65712929205978,-0.0940832342262326,-0.384970441751759,1.67500016774069,-1.12928583582631,0.472053302023836,-1.49313560427907,-2.74462038634658,-0.0374491619077235,-0.547123241326865,0.795372080430952,0.619199238575156,-0.564380797511357,0.515143918099728,-0.652527798822895,1.43206902673775,-0.325620792823773,0.908247080674019,-0.52330577130766,-0.310998878457156,-0.650622090833,-0.844279730789722,-0.0172845040571296,-1.15118036747784,-2.80358397654772,0.0185783590107091,-0.389124237996401,-1.01261120546,1.96211271435265,0.640070337034029,-0.527610204472235,2.2840127663027,-1.57332461548898,0.869113227645944,-1.06820878771909,1.02228706718792,0.273070480699131,-0.11056367857941,1.92681616208214,0.30919705547908,0.488736907742637,0.0170704980599587,-0.65194464727212,0.424780036553856,-1.69197732444089,-3.32420821676563,1.5814648966541,-2.17522606283016,-2.99940867720941,-0.280039260092797,0.365616043596634,2.0542722027865,-0.00226929078882399,0.981218142193603,1.38932520408246,-2.95512804528074,0.887669554513339,0.928429920540234,1.45988906375594,1.71538717971393,-1.08610447805425,-0.672942633676902,0.679558747711729,1.68929359917391,-1.59354468887439,0.929182576771643,-2.36461960009065,-1.05229864588672,1.22741557901604,-1.04603200745555,-1.83716294187727,3.22175308644214,0.00444301406707304,-0.435977553253161,1.70592932339695,-0.14525161105848,1.30381154405637,-1.64542704277345,1.39625463842226,-0.637993500736014,-1.20436310477623,1.12113374877001,0.209601170284264,0.436240176045941,-0.771743743737661,-0.390659447061569,0.968901654741916,1.52660691722586,2.81503240151635,0.946981385768163,0.216016328821867,-0.70476540038466,0.13136688353805,0.796854544004694,-0.142382520637755,1.09472818038641,-0.285818440395819,0.344726198629671,-0.20554786714561,-0.489451115303248,2.0511605434295,2.43647427324744,-1.70261786525791,1.95374254225947,0.482475052974587,2.61493067999773],"PLS3":[1.82263548183891,-0.805919796617591,-0.638914005231139,-0.750992006576364,0.69215715212464,-0.00208669050798868,-0.119086974148485,0.715506755604544,-1.38956166116684,-0.419960570225568,-2.22140913496834,0.263788104780028,-3.27687132915176,0.867806023102607,-2.91161208232148,-1.36513743300546,0.642220938761681,2.41024144078473,-4.20251286383771,-0.304925224559062,0.548187205389423,0.457700735938994,-0.873736059889841,0.836231560110297,1.10713883164765,0.566128608941486,0.969030102149978,0.136228186554442,-0.397981773072264,1.17859658397108,1.69125027350802,-0.99807500347293,-0.23621330762978,-2.13758835190005,-0.666601777588406,-0.488749455596562,2.02508850919645,-2.20072591153676,-3.82323276865517,1.11743719056012,0.490682264330022,2.37010985182209,-1.92307725437527,-1.24237932717296,-2.10075846010819,-2.55723611915837,-1.30595405904907,0.382364615620503,0.238274249574529,-2.26523719600549,2.03791835555494,-0.154589362484302,1.45251600896531,-0.95187350622526,-1.42885978942379,0.675670676781566,0.152649629289331,2.89036308334432,-0.584050262003714,0.481315633565651,1.42891792413622,0.0563696510819126,0.395932808346727,-1.68778935964242,-0.0302193408182462,-1.46923733427318,0.420533179372495,0.899499037383387,-1.25531376726116,1.08517129064285,0.999703075904757,0.851598623050015,-2.59091161636743,1.08080319756017,0.791293463178519,-0.812768555527897,-0.210562971670799,-0.00250651614102963,-2.12830357402784,-3.70236144201963,1.43950658355204,0.847044148423616,0.3765947973083,0.559169660248755,-2.04935562925189,-0.87817829217976,-1.69487807081467,0.701862364619676,1.637523387735,1.37498521357383,1.09251345378831,-1.64327282721226,1.11604532347137,-1.30589312902285,-0.134193308761962,2.46695960229053,-0.417587662211959,0.21056839583848,-1.48037973651172,-1.34563767570822,-1.30020187970989,1.65437063994248,-2.06699583654457,-1.51941868539968,0.642589062216272,1.02558429229938,1.44086630054552,-0.098330150294593,1.32729381765329,1.11426540051216,2.60954915397402,-0.8255030940772,-0.487408670858355,-2.14429097728051,0.379031921262552,0.109048036206332,0.179606922175627,-0.224789426419471,0.601197171601435,0.81454425572505,0.922573161387074,0.984755902679779,1.18981737739627,-1.57162604681513,1.06916496224709,-1.89276647132093,-0.192833233486685,0.484882558695244,-0.570145773678691,0.389849466952992,-0.797945825167443,1.48018375865299,-0.568686547522363,-1.28228342883218,0.0250766616866091,4.08814142158647,1.02938895715027,0.0291412015917728,1.28443958191165,0.101215936766906,-0.603828091839061,0.591085331778976,-1.94018568602556,-1.16103407035361,-0.90853595935811,2.91622970346293,0.188624419288349,1.80239192437379,1.2773515815554,1.82102592560847,0.953371629724683,-0.415113042472184,0.958422861720237,0.706276497409188,-0.0459787408827861,-0.379168091630341,0.0331427249073868,-1.9945207438582,-1.37885515432277,-0.202979588187173,-2.43446449548908,-0.714798010698603,-0.759514027732831,-1.16482714023311,0.000394675238323081,0.601756803040147,1.94758826090794,-0.781972611848346,1.80610898937985,-1.8558544006802,0.908867758817995,-1.06253342629544,0.332253587470224,0.796161624917739,0.53701222038278,0.725933269804619,-1.54960681945099,0.826050498845004,2.22858194429514,-0.52543470591134,1.44202238468145,-2.09771469186398,2.81294430774263,0.937164055885352,0.131191191422578,-0.865661508939514,-1.17695348046607,1.95280714071318,1.66475829689414,-2.16258896533654,1.60562316641714,1.74387305481609,1.65838725727278,-0.550121291857224,0.413391635177527,1.51152523814004],"PLS4":[0.751697747208581,0.795518186984946,-1.02316912555698,0.603402075728603,-0.907542807068101,0.676458019119564,-0.696272534854155,-0.409253500773532,0.148355917143183,0.922503753466893,-0.230518679384573,1.08557875556259,-0.226240249933028,1.18350295033421,-0.168765623519586,0.621757764802981,-0.963514595053711,-0.0958238975303113,-0.711324514809061,1.05051460229936,-0.124286948118184,-0.814363724780383,0.780926771975327,0.504623705275535,-0.701875681016311,-0.310277618635142,-0.519194643024283,-0.464012570320227,0.537044020904364,0.0366091395829706,-0.378894262056052,-1.09019442159971,1.13304709717012,-0.136689829216766,0.77237387452516,0.842196668179388,-0.138459949063327,0.402752691125747,-0.474217476502573,1.12628101959684,1.15009536253225,-0.302773387198787,0.353304658449077,-0.762507131369384,0.00977797083331063,0.0800789791232347,0.918672755484394,-0.688492763672661,-0.251512384447353,0.599902091480309,-0.992947353894222,0.735920942137535,1.26337221450189,-0.895418506880353,-1.75344455136766,-0.530563770611928,-1.3054462508209,-1.245103154645,0.761337277682701,-0.634170097487123,-1.08937854780962,0.412750179627711,-0.0242350358639221,-1.28380017274691,0.0673383835099159,-1.1355663279445,0.69378485770336,-1.36462014288851,0.789504377826669,0.292956417857498,-0.865066175083371,0.669228726022835,-0.227703619981903,0.270844736134197,0.0323950867346811,-1.70502807135473,-0.803615123405531,0.536646342110202,0.108097778494277,-0.209535868309877,0.0142129001941878,-0.278175514442963,-0.735971760700769,1.08565819750942,0.697021570020401,0.796001033691482,0.288119787738331,0.857241181689812,0.58933495682228,-0.401223985416296,-0.339787669591881,0.616466010603503,1.08968108787213,0.632878192868618,-0.115627385215763,-0.300322381045602,0.673311197523824,0.33508600644138,0.74815468786718,0.586106191979027,0.865945312152174,-0.212393608457586,0.0571822847077901,-0.150371639257178,-0.927429129123452,-0.629193879617287,1.15316431968096,-0.697917987835812,0.946292067781058,0.174489660530842,-0.932625618072029,0.601077059617474,-1.29995164515618,-0.0609369677913136,0.901708263798814,-0.897939334802452,-0.8532388603097,1.1292986796939,-0.641465668311761,-0.847280058771072,0.599595424808434,-0.238074319366318,-0.833409005397695,-1.24409355455504,-0.608569151363403,-1.34284909906246,-1.01477483209219,0.472597332499577,1.02179694882232,-0.279727325872265,0.315547010550456,0.127171431812039,-1.22313309114971,1.10985524286491,-1.55450588155789,-1.05976486225668,1.41497847038792,0.529335745440255,1.45194115255724,0.38260809426824,-1.18135137415035,-0.503241037146161,0.503219792219825,0.192837586574916,-0.71099203334059,-0.378896805686027,-1.12022996179224,-0.492298497565445,-0.514851057850717,-0.081720129445658,0.58681877466568,-1.27653988866824,0.886871158026318,1.30269851060338,-1.40946375368803,-0.630259672885171,0.522783611083516,0.246754290736484,0.622704014264504,0.239006787800719,-0.445799497601597,1.10997893792743,-1.06233733075669,-1.34344920901049,-0.949573129841349,1.00836715538059,2.03357862275553,0.718273365319515,-0.502037871127557,0.511887473619786,-1.19495371187691,0.595718851451203,0.647967791521807,1.84368183797328,-0.497151284905017,-0.528283377409353,0.628168664391299,-0.767012632709249,0.011892711960946,0.543273283904248,0.399010214775337,0.0704215814707917,0.093634366744933,-0.472497619517512,0.62977224900245,0.0785736534975794,-1.46687636376304,1.78377318325054,-0.211812861462539,0.172647827648078,-0.353765972763265,-0.0827017509234188,-0.702914231142575,1.21783948399054,0.301148356332413,1.76927082130019]},"columns":[{"accessor":"Salary","name":"Salary","type":"numeric"},{"accessor":"PLS1","name":"PLS1","type":"numeric"},{"accessor":"PLS2","name":"PLS2","type":"numeric"},{"accessor":"PLS3","name":"PLS3","type":"numeric"},{"accessor":"PLS4","name":"PLS4","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"03e76277e8ad9838214c524a354f5fff","key":"03e76277e8ad9838214c524a354f5fff"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>We will now try to find the best threshold value using the <code>tune::tune()</code></p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>pls_recipe <span class="ot">&lt;-</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">recipe</span>(<span class="at">formula =</span> Salary <span class="sc">~</span> ., <span class="at">data =</span> Hitters_train) <span class="sc">%&gt;%</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_novel</span>(recipes<span class="sc">::</span><span class="fu">all_nominal_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_dummy</span>(recipes<span class="sc">::</span><span class="fu">all_nominal_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_zv</span>(recipes<span class="sc">::</span><span class="fu">all_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_normalize</span>(recipes<span class="sc">::</span><span class="fu">all_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_pls</span>(recipes<span class="sc">::</span><span class="fu">all_predictors</span>(), <span class="at">num_comp =</span> tune<span class="sc">::</span><span class="fu">tune</span>(), <span class="at">outcome =</span> <span class="st">&quot;Salary&quot;</span>)</span></code></pre></div>
</div>
<div id="specify-the-model-3" class="section level2">
<h2>Specify the model</h2>
<p>We use a linear model</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>lm_spec <span class="ot">&lt;-</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_mode</span>(<span class="st">&quot;regression&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">&quot;lm&quot;</span>)</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>lm_spec <span class="sc">%&gt;%</span></span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">translate</span>()</span></code></pre></div>
<pre><code>&gt; Linear Regression Model Specification (regression)
&gt; 
&gt; Computational engine: lm 
&gt; 
&gt; Model fit template:
&gt; stats::lm(formula = missing_arg(), data = missing_arg(), weights = missing_arg())</code></pre>
</div>
<div id="create-the-workflow-3" class="section level2">
<h2>Create the workflow</h2>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>pls_workflow <span class="ot">&lt;-</span> workflows<span class="sc">::</span><span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>  workflows<span class="sc">::</span><span class="fu">add_recipe</span>(pls_recipe) <span class="sc">%&gt;%</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>  workflows<span class="sc">::</span><span class="fu">add_model</span>(lm_spec)</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>pls_workflow</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; == Workflow ====================================================================
&gt; Preprocessor: Recipe
&gt; Model: linear_reg()
&gt; 
&gt; -- Preprocessor ----------------------------------------------------------------
&gt; 5 Recipe Steps
&gt; 
&gt; * step_novel()
&gt; * step_dummy()
&gt; * step_zv()
&gt; * step_normalize()
&gt; * step_pls()
&gt; 
&gt; -- Model -----------------------------------------------------------------------
&gt; Linear Regression Model Specification (regression)
&gt; 
&gt; Computational engine: lm</code></pre>
</div>
<div id="create-the-threshold-grid-1" class="section level2">
<h2>Create the threshold grid</h2>
<p>A number of components grid of <span class="math inline">\(10\)</span> numbers from <span class="math inline">\(1\)</span> to <span class="math inline">\(20\)</span> is created.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>doParallel<span class="sc">::</span><span class="fu">registerDoParallel</span>()</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a range from 10</span></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>num_comp_grid <span class="ot">&lt;-</span> dials<span class="sc">::</span><span class="fu">grid_regular</span>(dials<span class="sc">::</span><span class="fu">num_comp</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">20</span>)), <span class="at">levels =</span> <span class="dv">10</span>)</span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>num_comp_grid <span class="sc">%&gt;%</span></span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-8b62032e7fed994c82ed" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-8b62032e7fed994c82ed">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"num_comp":[1,3,5,7,9,11,13,15,17,20]},"columns":[{"accessor":"num_comp","name":"num_comp","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"626850a1bd9082aebf54f5c5b811d6d4","key":"626850a1bd9082aebf54f5c5b811d6d4"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="partial-least-square-regression-model-fitting-on-cross-validated-data" class="section level2">
<h2>Partial least square regression model fitting on cross validated data</h2>
<p>Now we have everything we need and we can fit all the models on the cross validated data. Note that this process may take some time.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>tune_res <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">tune_grid</span>(</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">object =</span> pls_workflow,</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">resamples =</span> Hitters_fold,</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">grid =</span> num_comp_grid</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>tune_res</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; # Tuning results
&gt; # 10-fold cross-validation 
&gt; # A tibble: 10 x 4
&gt;    splits           id     .metrics          .notes          
&gt;    &lt;list&gt;           &lt;chr&gt;  &lt;list&gt;            &lt;list&gt;          
&gt;  1 &lt;split [176/20]&gt; Fold01 &lt;tibble [20 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  2 &lt;split [176/20]&gt; Fold02 &lt;tibble [20 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  3 &lt;split [176/20]&gt; Fold03 &lt;tibble [20 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  4 &lt;split [176/20]&gt; Fold04 &lt;tibble [20 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  5 &lt;split [176/20]&gt; Fold05 &lt;tibble [20 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  6 &lt;split [176/20]&gt; Fold06 &lt;tibble [20 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  7 &lt;split [177/19]&gt; Fold07 &lt;tibble [20 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  8 &lt;split [177/19]&gt; Fold08 &lt;tibble [20 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  9 &lt;split [177/19]&gt; Fold09 &lt;tibble [20 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt; 10 &lt;split [177/19]&gt; Fold10 &lt;tibble [20 x 5]&gt; &lt;tibble [0 x 3]&gt;</code></pre>
<p>Here we see how different number of components affects the performance metrics differently. Do note that using a different seed will give a different plot</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that a different seed will give different plots</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>tune<span class="sc">::</span><span class="fu">autoplot</span>(tune_res)</span></code></pre></div>
<p><img src="img/unnamed-chunk-84-1.png" width="3883.2" style="display: block; margin: auto;" /></p>
<p>The “best” values of this can be selected using <code>tune::select_best()</code>, this function requires you to specify a metric that it should select against. The number of components value is 0.889 for metric <code>rsme</code> since it gives the lowest value. Do note that using a different seed will give a different best number of components value.</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>top_num_comp <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">show_best</span>(tune_res, <span class="at">metric =</span> <span class="st">&quot;rmse&quot;</span>, <span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>top_num_comp</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; # A tibble: 5 x 7
&gt;   num_comp .metric .estimator  mean     n std_err .config              
&gt;      &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;                
&gt; 1        1 rmse    standard    338.    10    36.6 Preprocessor01_Model1
&gt; 2        3 rmse    standard    344.    10    34.7 Preprocessor02_Model1
&gt; 3       11 rmse    standard    346.    10    30.3 Preprocessor06_Model1
&gt; 4        9 rmse    standard    349.    10    30.8 Preprocessor05_Model1
&gt; 5       17 rmse    standard    350.    10    30.9 Preprocessor09_Model1</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>best_num_comp <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">select_best</span>(tune_res, <span class="at">metric =</span> <span class="st">&quot;rmse&quot;</span>)</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>best_num_comp</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; # A tibble: 1 x 2
&gt;   num_comp .config              
&gt;      &lt;int&gt; &lt;chr&gt;                
&gt; 1        1 Preprocessor01_Model1</code></pre>
</div>
<div id="partial-least-square-model-with-optimised-threshold-value" class="section level2">
<h2>Partial least square model with optimised threshold value</h2>
<p>We create the partial least square regression workflow with the best threshold.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>pls_final <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">finalize_workflow</span>(</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> pls_workflow,</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">parameters =</span> best_num_comp</span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>pls_final</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; == Workflow ====================================================================
&gt; Preprocessor: Recipe
&gt; Model: linear_reg()
&gt; 
&gt; -- Preprocessor ----------------------------------------------------------------
&gt; 5 Recipe Steps
&gt; 
&gt; * step_novel()
&gt; * step_dummy()
&gt; * step_zv()
&gt; * step_normalize()
&gt; * step_pls()
&gt; 
&gt; -- Model -----------------------------------------------------------------------
&gt; Linear Regression Model Specification (regression)
&gt; 
&gt; Computational engine: lm</code></pre>
<p>We now train the partial least square regression model with the training data.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>pls_final_fit <span class="ot">&lt;-</span> parsnip<span class="sc">::</span><span class="fu">fit</span>(<span class="at">object =</span> pls_final, <span class="at">data =</span> Hitters_train)</span></code></pre></div>
</div>
<div id="partial-least-square-regression-model-on-test-data" class="section level2">
<h2>Partial least square regression model on test data</h2>
<p>This partial least square regression model can now be applied on our testing data set to validate its performance. For regression models, a .pred column is added.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>test_results <span class="ot">&lt;-</span> parsnip<span class="sc">::</span><span class="fu">augment</span>(<span class="at">x =</span> pls_final_fit, <span class="at">new_data =</span> Hitters_test)</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>test_results <span class="sc">%&gt;%</span></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-0e7ce1a5b2fcef7383bf" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-0e7ce1a5b2fcef7383bf">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"AtBat":[315,321,413,324,474,550,513,583,181,217,205,214,529,424,388,339,329,458,317,382,233,641,596,370,282,589,438,232,528,309,616,591,315,453,441,551,283,199,464,584,303,381,514,359,309,216,256,466,327,341,486,275,208,459,288,220,581,439,633,368,263,520,19,279,600,610,631],"Hits":[81,87,92,73,129,152,137,168,41,46,57,53,137,119,103,96,83,114,78,119,49,198,171,96,78,170,103,55,132,94,163,157,73,101,118,171,70,52,128,157,71,110,144,80,72,56,70,108,68,110,145,68,57,113,63,66,145,96,210,103,70,120,4,69,139,186,170],"HmRun":[7,10,16,4,10,6,20,17,1,7,8,2,26,6,15,4,9,13,7,13,2,31,34,21,13,40,2,9,21,5,27,16,5,3,28,13,8,9,28,20,3,9,0,15,0,4,13,33,13,9,11,5,8,20,3,5,17,0,6,3,1,17,1,4,0,19,9],"Runs":[24,39,72,32,50,92,90,83,15,32,34,30,86,57,59,37,50,67,35,54,41,101,91,49,37,107,65,34,61,37,83,90,23,46,84,94,33,26,67,95,18,61,67,45,33,22,42,75,42,45,51,42,32,59,25,20,66,44,91,48,26,53,2,35,94,107,77],"RBI":[38,42,48,18,56,37,95,80,21,19,32,29,97,46,47,29,39,57,35,58,23,108,108,46,51,108,32,23,74,32,107,78,37,43,86,83,37,28,94,73,30,45,54,48,31,18,36,86,29,49,76,42,25,57,33,28,68,36,56,28,23,44,3,31,29,98,44],"Walks":[39,30,65,22,40,81,90,56,33,9,9,23,97,13,39,23,56,48,32,36,18,41,52,60,29,69,71,45,41,26,32,26,16,61,68,94,27,21,52,63,36,32,79,63,26,15,44,72,45,46,40,61,18,68,16,13,21,65,59,54,30,21,1,32,60,74,31],"Years":[14,2,1,7,10,5,14,5,2,4,5,2,15,9,6,4,9,4,1,12,8,5,6,15,5,6,2,12,6,13,3,4,4,3,8,13,12,6,13,10,3,7,9,7,5,12,16,3,18,9,11,6,3,12,10,3,2,4,6,8,4,4,1,4,2,6,11],"CAtBat":[3449,396,413,1931,2331,2308,5201,1646,232,694,756,226,6661,3651,2174,1064,3828,1350,317,2133,1350,2129,2862,6986,1649,2325,440,4405,2641,4618,1437,2020,450,948,2723,6090,4479,805,5829,4704,344,3015,4739,1493,354,2796,7058,652,3949,2331,3967,961,653,5348,2682,290,831,711,3070,1897,888,927,19,1359,1236,2728,4908],"CHits":[835,101,92,491,604,633,1382,452,50,160,192,59,1785,1046,555,290,948,298,78,594,336,610,728,1972,453,634,103,1213,671,1330,377,541,108,218,750,1840,1222,191,1552,1320,76,834,1169,359,82,665,1845,142,939,658,1102,238,170,1369,667,80,210,148,872,493,220,227,4,355,309,753,1457],"CHmRun":[69,12,16,13,61,32,166,44,4,32,32,2,291,32,80,11,145,28,7,41,7,92,107,231,73,128,2,194,97,57,65,52,6,6,126,128,94,30,210,93,3,40,13,61,0,43,312,44,78,50,67,16,17,155,38,5,21,1,19,9,9,22,1,31,1,69,30],"CRuns":[321,48,72,291,246,349,763,219,20,86,117,32,1082,461,285,123,575,160,35,287,166,297,361,1070,211,371,67,702,273,616,181,310,38,96,433,969,557,113,740,724,20,451,583,176,41,266,965,102,438,249,410,128,98,713,315,27,106,68,420,207,83,106,2,180,201,399,775],"CRBI":[414,46,48,108,327,182,734,208,29,76,107,32,949,301,274,108,528,123,35,294,122,319,401,955,280,376,32,705,383,522,227,226,46,72,420,900,483,119,840,522,36,249,374,202,32,304,1128,109,380,322,497,104,54,660,259,31,86,56,230,162,82,80,3,148,69,366,357],"CWalks":[375,33,65,180,166,308,784,136,45,32,51,27,989,112,186,55,635,122,32,227,106,117,224,921,138,238,71,625,226,436,82,91,28,91,309,917,307,87,452,576,45,168,528,175,26,198,990,102,466,274,284,172,62,735,204,15,40,99,274,198,86,52,1,158,110,286,249],"League":["N","N","N","N","N","N","A","A","A","A","A","N","A","A","A","A","A","A","A","N","A","A","A","N","A","A","A","N","N","N","A","N","A","N","A","N","A","N","A","A","N","N","N","N","N","A","N","A","A","A","N","N","N","A","A","A","N","N","N","N","N","A","N","N","N","N","A"],"Division":["W","E","E","E","W","W","W","E","E","E","E","E","E","E","W","W","W","W","E","W","E","E","W","E","W","E","W","E","E","E","W","E","W","W","E","E","E","W","W","E","E","E","E","W","E","E","E","E","E","E","E","E","E","W","W","W","E","E","W","W","E","W","W","E","E","E","W"],"PutOuts":[632,805,280,222,732,262,267,109,326,307,58,109,280,224,182,104,276,246,45,59,102,269,118,137,670,368,276,623,885,161,110,290,227,249,190,1199,156,235,0,276,468,228,229,682,117,391,41,286,659,251,88,181,42,0,135,281,320,229,367,209,81,70,692,133,300,1182,408],"Assists":[43,40,9,3,83,329,5,292,29,25,4,7,10,286,9,213,6,389,122,156,132,17,334,5,57,20,7,35,105,3,308,440,15,444,2,149,2,22,0,421,47,7,453,93,269,44,118,8,53,9,204,3,94,0,257,21,465,406,432,246,147,144,70,173,12,96,4],"Errors":[10,4,5,3,13,16,3,25,5,1,4,3,5,8,4,9,2,18,26,9,10,10,21,9,5,3,9,3,8,3,15,25,3,16,2,5,2,5,0,11,6,5,15,13,12,4,8,8,7,4,16,2,13,0,7,3,32,22,16,3,4,11,8,9,9,13,3],"Salary":[475,91.5,100,708.333,750,625,900,612.5,67.5,180,247.5,70,933.333,850,325,275,600,475,70,595,375,1175,900,733.333,500,1237.5,100,1300,1008.333,600,200,640,110,195,1300,1800,225,265,587.5,420,100,800,1940,700,130,250,1050,215,400,560,500,191,140,740,341.667,90,155,150,90,326.667,250,185,920,277.5,160,1300,1000],"NewLeague":["N","N","N","N","N","N","A","A","A","A","A","N","A","N","A","A","A","A","A","N","A","A","A","N","A","A","N","N","N","N","A","N","A","N","A","N","A","N","A","A","N","N","N","N","N","A","A","A","A","A","A","N","N","A","A","A","N","N","N","N","N","A","A","N","N","N","A"],".pred":[505.150612379126,295.007978861202,388.843590792347,302.929045774006,537.452810284664,584.403140579847,1013.59942346079,616.995814125002,136.63535954536,186.172162880393,211.115759104698,142.308468317998,1245.40113309643,512.937429751822,468.00359897179,243.745454334772,632.032545421541,435.276674449978,222.454830244022,487.300668377266,244.605635324734,767.931461773619,777.805595623829,996.451881767754,394.631758706139,864.672681694599,322.715602272862,679.380847403598,666.811264850626,574.203576708669,596.325354611778,594.404659514144,177.440610068194,335.485580561323,751.508470247324,1174.47927069632,548.055357527596,198.941636336747,925.718313376008,909.873642283439,211.911934098216,499.211662226833,719.986074547853,453.530422825809,200.340340957091,349.040087873086,942.03267578186,556.600721781911,623.005680505971,501.28432835675,671.812036266573,333.874647013673,184.425884941223,832.841328097713,331.386110386507,128.460654923125,449.57840381296,338.276427346027,666.286805698464,375.801656239198,206.233112330441,347.537639911788,-25.9771181313033,289.641432939703,450.353504566328,863.817442835731,713.570880351703]},"columns":[{"accessor":"AtBat","name":"AtBat","type":"numeric"},{"accessor":"Hits","name":"Hits","type":"numeric"},{"accessor":"HmRun","name":"HmRun","type":"numeric"},{"accessor":"Runs","name":"Runs","type":"numeric"},{"accessor":"RBI","name":"RBI","type":"numeric"},{"accessor":"Walks","name":"Walks","type":"numeric"},{"accessor":"Years","name":"Years","type":"numeric"},{"accessor":"CAtBat","name":"CAtBat","type":"numeric"},{"accessor":"CHits","name":"CHits","type":"numeric"},{"accessor":"CHmRun","name":"CHmRun","type":"numeric"},{"accessor":"CRuns","name":"CRuns","type":"numeric"},{"accessor":"CRBI","name":"CRBI","type":"numeric"},{"accessor":"CWalks","name":"CWalks","type":"numeric"},{"accessor":"League","name":"League","type":"factor"},{"accessor":"Division","name":"Division","type":"factor"},{"accessor":"PutOuts","name":"PutOuts","type":"numeric"},{"accessor":"Assists","name":"Assists","type":"numeric"},{"accessor":"Errors","name":"Errors","type":"numeric"},{"accessor":"Salary","name":"Salary","type":"numeric"},{"accessor":"NewLeague","name":"NewLeague","type":"factor"},{"accessor":".pred","name":".pred","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"a6558260cdb0d3938d678ea60ea438dd","key":"a6558260cdb0d3938d678ea60ea438dd"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>test_results <span class="sc">%&gt;%</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>  yardstick<span class="sc">::</span><span class="fu">rsq</span>(<span class="at">truth =</span> .data[[<span class="st">&quot;Salary&quot;</span>]], <span class="at">estimate =</span> .data[[<span class="st">&quot;.pred&quot;</span>]]) <span class="sc">%&gt;%</span></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-9954d42d36cff9e47ed7" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-9954d42d36cff9e47ed7">{"x":{"tag":{"name":"Reactable","attribs":{"data":{".metric":["rsq"],".estimator":["standard"],".estimate":[0.460310144571116]},"columns":[{"accessor":".metric","name":".metric","type":"character"},{"accessor":".estimator","name":".estimator","type":"character"},{"accessor":".estimate","name":".estimate","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"3a91c93c7df454b6a5594a3ebd58bc2f","key":"3a91c93c7df454b6a5594a3ebd58bc2f"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>Alternatively, we can use <code>tune::last_fit</code> and <code>tune::collect_metrics</code></p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>test_results <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">last_fit</span>(</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">object =</span> pls_final_fit,</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">split =</span> Hitters_split</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>  tune<span class="sc">::</span><span class="fu">collect_metrics</span>()</span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a>test_results <span class="sc">%&gt;%</span></span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-14025956e3f630952e02" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-14025956e3f630952e02">{"x":{"tag":{"name":"Reactable","attribs":{"data":{".metric":["rmse","rsq"],".estimator":["standard","standard"],".estimate":[313.527614655955,0.460310144571116],".config":["Preprocessor1_Model1","Preprocessor1_Model1"]},"columns":[{"accessor":".metric","name":".metric","type":"character"},{"accessor":".estimator","name":".estimator","type":"character"},{"accessor":".estimate","name":".estimate","type":"numeric"},{"accessor":".config","name":".config","type":"character"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"456a91b9360253e801d6e26645aef21f","key":"456a91b9360253e801d6e26645aef21f"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="rmarkdown-template" class="section level1">
<h1>Rmarkdown Template</h1>
<p>This Rmarkdown template is created by the <a href="https://realitybending.github.io/">Reality Bending Lab</a>. The template can be download from the lab’s <a href="https://github.com/RealityBending/TemplateResults">github</a> repository. For more information about the motivation behind creating this template, check out <a href="https://dominiquemakowski.github.io/post/2021-02-10-template_results/">Dr. Dominique Makowski’s blog post</a></p>
</div>
<div id="package-references" class="section level1">
<h1>Package References</h1>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">cite_packages</span>(<span class="fu">sessionInfo</span>())</span></code></pre></div>
<ul>
<li>Brandon M. Greenwell and Bradley C. Boehmke (2020). Variable Importance Plots—An Introduction to the vip Package. The R Journal, 12(1), 343–366. URL <a href="https://doi.org/10.32614/RJ-2020-013" class="uri">https://doi.org/10.32614/RJ-2020-013</a>.</li>
<li>Davis Vaughan (2022). workflows: Modeling Workflows. R package version 0.2.6. <a href="https://CRAN.R-project.org/package=workflows" class="uri">https://CRAN.R-project.org/package=workflows</a></li>
<li>Douglas Bates and Martin Maechler (2021). Matrix: Sparse and Dense Matrix Classes and Methods. R package version 1.4-0. <a href="https://CRAN.R-project.org/package=Matrix" class="uri">https://CRAN.R-project.org/package=Matrix</a></li>
<li>Gareth James, Daniela Witten, Trevor Hastie and Rob Tibshirani (2021). ISLR: Data for an Introduction to Statistical Learning with Applications in R. R package version 1.4. <a href="https://CRAN.R-project.org/package=ISLR" class="uri">https://CRAN.R-project.org/package=ISLR</a></li>
<li>Greg Lin (2020). reactable: Interactive Data Tables Based on ‘React Table.’ R package version 0.2.3. <a href="https://CRAN.R-project.org/package=reactable" class="uri">https://CRAN.R-project.org/package=reactable</a></li>
<li>H. Wickham. ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York, 2016.</li>
<li>Hadley Wickham (2021). forcats: Tools for Working with Categorical Variables (Factors). R package version 0.5.1. <a href="https://CRAN.R-project.org/package=forcats" class="uri">https://CRAN.R-project.org/package=forcats</a></li>
<li>Hadley Wickham and Dana Seidel (2020). scales: Scale Functions for Visualization. R package version 1.1.1. <a href="https://CRAN.R-project.org/package=scales" class="uri">https://CRAN.R-project.org/package=scales</a></li>
<li>Hadley Wickham and Maximilian Girlich (2022). tidyr: Tidy Messy Data. R package version 1.2.0. <a href="https://CRAN.R-project.org/package=tidyr" class="uri">https://CRAN.R-project.org/package=tidyr</a></li>
<li>Hadley Wickham, Romain François, Lionel Henry and Kirill Müller (2022). dplyr: A Grammar of Data Manipulation. R package version 1.0.8. <a href="https://CRAN.R-project.org/package=dplyr" class="uri">https://CRAN.R-project.org/package=dplyr</a></li>
<li>Jerome Friedman, Trevor Hastie, Robert Tibshirani (2010). Regularization Paths for Generalized Linear Models via Coordinate Descent. Journal of Statistical Software, 33(1), 1-22. URL <a href="https://www.jstatsoft.org/v33/i01/" class="uri">https://www.jstatsoft.org/v33/i01/</a>.</li>
<li>Julia Silge, Fanny Chow, Max Kuhn and Hadley Wickham (2021). rsample: General Resampling Infrastructure. R package version 0.1.1. <a href="https://CRAN.R-project.org/package=rsample" class="uri">https://CRAN.R-project.org/package=rsample</a></li>
<li>Kirill Müller and Hadley Wickham (2021). tibble: Simple Data Frames. R package version 3.1.6. <a href="https://CRAN.R-project.org/package=tibble" class="uri">https://CRAN.R-project.org/package=tibble</a></li>
<li>Makowski, D., Ben-Shachar, M.S., Patil, I. &amp; Lüdecke, D. (2020). Automated Results Reporting as a Practical Tool to Improve Reproducibility and Methodological Best Practices Adoption. CRAN. Available from <a href="https://github.com/easystats/report" class="uri">https://github.com/easystats/report</a>. doi: .</li>
<li>Max Kuhn (2022). tune: Tidy Tuning Tools. R package version 0.2.0. <a href="https://CRAN.R-project.org/package=tune" class="uri">https://CRAN.R-project.org/package=tune</a></li>
<li>Max Kuhn and Davis Vaughan (2021). yardstick: Tidy Characterizations of Model Performance. R package version 0.0.9. <a href="https://CRAN.R-project.org/package=yardstick" class="uri">https://CRAN.R-project.org/package=yardstick</a></li>
<li>Max Kuhn and Davis Vaughan (2022). parsnip: A Common API to Modeling and Analysis Functions. R package version 0.2.1. <a href="https://CRAN.R-project.org/package=parsnip" class="uri">https://CRAN.R-project.org/package=parsnip</a></li>
<li>Max Kuhn and Hadley Wickham (2022). recipes: Preprocessing and Feature Engineering Steps for Modeling. R package version 0.2.0. <a href="https://CRAN.R-project.org/package=recipes" class="uri">https://CRAN.R-project.org/package=recipes</a></li>
<li>Max Kuhn and Hannah Frick (2022). dials: Tools for Creating Tuning Parameter Values. R package version 0.1.0. <a href="https://CRAN.R-project.org/package=dials" class="uri">https://CRAN.R-project.org/package=dials</a></li>
<li>Microsoft and Steve Weston (2022). foreach: Provides Foreach Looping Construct. R package version 1.5.2. <a href="https://CRAN.R-project.org/package=foreach" class="uri">https://CRAN.R-project.org/package=foreach</a></li>
<li>Microsoft Corporation and Steve Weston (2022). doParallel: Foreach Parallel Adaptor for the ‘parallel’ Package. R package version 1.0.17. <a href="https://CRAN.R-project.org/package=doParallel" class="uri">https://CRAN.R-project.org/package=doParallel</a></li>
<li>R Core Team (2022). R: A language and environment for statistical computing. R Foundation for Statistical Computing, Vienna, Austria. URL <a href="https://www.R-project.org/" class="uri">https://www.R-project.org/</a>.</li>
<li>Revolution Analytics and Steve Weston (2022). iterators: Provides Iterator Construct. R package version 1.0.14. <a href="https://CRAN.R-project.org/package=iterators" class="uri">https://CRAN.R-project.org/package=iterators</a></li>
<li>Rohart F, Gautier B, Singh A, and Le Cao K-A (2017) mixOmics: An R package for ’omics feature selection and multiple data integration. PLoS computational biology 13(11):e1005752</li>
<li>Sarkar, Deepayan (2008) Lattice: Multivariate Data Visualization with R. Springer, New York. ISBN 978-0-387-75968-5</li>
<li>Stefan Milton Bache and Hadley Wickham (2022). magrittr: A Forward-Pipe Operator for R. R package version 2.0.2. <a href="https://CRAN.R-project.org/package=magrittr" class="uri">https://CRAN.R-project.org/package=magrittr</a></li>
<li>Thomas Lumley based on Fortran code by Alan Miller (2020). leaps: Regression Subset Selection. R package version 3.1. <a href="https://CRAN.R-project.org/package=leaps" class="uri">https://CRAN.R-project.org/package=leaps</a></li>
<li>Venables, W. N. &amp; Ripley, B. D. (2002) Modern Applied Statistics with S. Fourth Edition. Springer, New York. ISBN 0-387-95457-0</li>
</ul>
</div>

<div id="rmd-source-code">LS0tDQp0aXRsZTogJyoqQ2hhcHRlciA2IExhYioqJw0KYXV0aG9yOiAiSmVyZW15IFNlbHZhIg0Kc3VidGl0bGU6IFRoaXMgZG9jdW1lbnQgd2FzIHByZXBhcmVkIG9uIGByIGZvcm1hdChTeXMuRGF0ZSgpKWAuDQpvdXRwdXQ6DQogIGh0bWxfZG9jdW1lbnQ6DQogICAgdGhlbWU6IGNlcnVsZWFuDQogICAgaGlnaGxpZ2h0OiBweWdtZW50cw0KICAgIHRvYzogeWVzDQogICAgdG9jX2RlcHRoOiAzDQogICAgdG9jX2Zsb2F0Og0KICAgICAgY29sbGFwc2VkOiB0cnVlDQogICAgICBzbW9vdGhfc2Nyb2xsOiB0cnVlDQogICAgbnVtYmVyX3NlY3Rpb25zOiBubw0KICAgIGNvZGVfZm9sZGluZzogc2hvdw0KICAgIGNvZGVfZG93bmxvYWQ6IHllcw0KICAgIHNlbGZfY29udGFpbmVkOiBmYWxzZQ0KICAgIGxpYl9kaXI6ICJybWFya2Rvd25fbGlicyINCiAgcm1hcmtkb3duOjpodG1sX3ZpZ25ldHRlOg0KICAgIHRvYzogeWVzDQogICAgdG9jX2RlcHRoOiAyDQpiaWJsaW9ncmFwaHk6IHV0aWxzL2JpYmxpb2dyYXBoeS5iaWINCmNzbDogdXRpbHMvZjEwMDByZXNlYXJjaC5jc2wNCmVkaXRvcl9vcHRpb25zOg0KICBjaHVua19vdXRwdXRfdHlwZTogY29uc29sZQ0KICBtYXJrZG93bjogDQogICAgd3JhcDogNzINCi0tLQ0KDQpgYGB7ciBzZXR1cCwgd2FybmluZz1GQUxTRSwgbWVzc2FnZT1UUlVFLCBpbmNsdWRlPUZBTFNFfQ0KIyBTZXQgdXAgdGhlIGVudmlyb25tZW50DQoNCiMgT3B0aW9ucyByZWxhdGl2ZSB0byBmaWd1cmUgc2l6ZQ0KIyAxLjYxOCBpcyB0aGUgZ29sZGVuIHJhdGlvDQpmaWdoZWlnaHQgPC0gNA0KZmlnd2lkdGggPC0gNCAqIDEuNjE4IA0KDQojIEdlbmVyYWwgb3B0aW9ucw0Kb3B0aW9ucyhrbml0ci5rYWJsZS5OQSA9ICIiLA0KICAgICAgICBuc21hbGwgPSAzLA0KICAgICAgICB0aWR5dmVyc2UucXVpZXQgPSBUUlVFDQogICAgICAgICkNCmhvb2tfb3V0cHV0IDwtIGtuaXRyOjprbml0X2hvb2tzJGdldCgnb3V0cHV0JykNCg0Ka25pdHI6OmtuaXRfaG9va3Mkc2V0KA0KICBvdXRwdXQgPSBmdW5jdGlvbih4LCBvcHRpb25zKSB7DQogICAgaWYgKCFpcy5udWxsKG9wdGlvbnMkbWF4LmhlaWdodCkpIHsNCiAgICAgIG9wdGlvbnMkYXR0ci5vdXRwdXQgPC0gYyhvcHRpb25zJGF0dHIub3V0cHV0LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwcmludGYoJ3N0eWxlPSJtYXgtaGVpZ2h0OiAlczsiJywgb3B0aW9ucyRtYXguaGVpZ2h0KSkNCiAgICB9DQogICAgaG9va19vdXRwdXQoeCwgb3B0aW9ucykNCiAgICB9DQogICkNCg0KIyBDaHVuayBvcHRpb25zIChzZWUgaHR0cHM6Ly95aWh1aS5vcmcva25pdHIvb3B0aW9ucy8jY2h1bmtfb3B0aW9ucykNCmtuaXRyOjpvcHRzX2NodW5rJHNldCgNCiAgY29tbWVudCA9ICI+IiwgICMgVGhlIHByZWZpeCB0byBiZSBhZGRlZCBiZWZvcmUgZWFjaCBsaW5lIG9mIHRoZSB0ZXh0IG91dHB1dC4NCiAgZHBpID0gNjAwLA0KICBmaWcucGF0aCA9ICJpbWcvIiwNCiAgZmlnLmhlaWdodCA9IGZpZ2hlaWdodCwNCiAgZmlnLndpZHRoID0gZmlnd2lkdGgsDQogIGZpZy5hbGlnbiA9ICJjZW50ZXIiLA0KICAjIFNlZSBodHRwczovL2NvbW11bml0eS5yc3R1ZGlvLmNvbS90L2NlbnRlcmluZy1pbWFnZXMtaW4tYmxvZ2Rvd24tcG9zdC8yMDk2Mg0KICAjIHRvIGxlYXJuIGhvdyB0byBjZW50ZXIgaW1hZ2VzDQogICMgU2VlIGh0dHBzOi8vYm9va2Rvd24ub3JnL3lpaHVpL3JtYXJrZG93bi1jb29rYm9vay9vcHRzLXRpZHkuaHRtbA0KICAjIFNlZSBodHRwczovL3d3dy56b3Rlcm8ub3JnL3N0eWxlcyBmb3IgY2l0YXRpb24gc3R5bGUgcmVzcG9zaXRvcnkNCiAgdGlkeT0nc3R5bGVyJywNCiAgdGlkeS5vcHRzPWxpc3Qoc3RyaWN0PVRSVUUpDQopDQpgYGANCg0KYGBge3Igd2FybmluZz1GQUxTRSwgbWVzc2FnZT1GQUxTRSwgcmVzdWx0cz0nYXNpcyd9DQpsaWJyYXJ5KGxlYXBzKQ0KbGlicmFyeSh0aWJibGUpDQpsaWJyYXJ5KG1hZ3JpdHRyKQ0KbGlicmFyeShkcGx5cikNCmxpYnJhcnkodGlkeXIpDQpsaWJyYXJ5KGZvcmNhdHMpDQpsaWJyYXJ5KHJlcG9ydCkNCmxpYnJhcnkoSVNMUikNCg0KbGlicmFyeShyZWFjdGFibGUpDQpsaWJyYXJ5KGdncGxvdDIpDQpsaWJyYXJ5KHZpcCkNCg0KbGlicmFyeShkb1BhcmFsbGVsKQ0KDQpsaWJyYXJ5KHBhcnNuaXApDQpsaWJyYXJ5KGdsbW5ldCkNCmxpYnJhcnkocnNhbXBsZSkNCmxpYnJhcnkocmVjaXBlcykNCmxpYnJhcnkodHVuZSkNCmxpYnJhcnkod29ya2Zsb3dzKQ0KbGlicmFyeShkaWFscykNCmxpYnJhcnkoeWFyZHN0aWNrKQ0KDQojIEZvciByZWNpcGVzOjpzdGVwX3Bscw0KIyBXYXJuaW5nIG1lc3NhZ2U6DQojICBgc3RlcF9wbHMoKWAgZmFpbGVkOiBFcnJvciBpbiBsb2FkTmFtZXNwYWNlKHgpIDogdGhlcmUgaXMgbm8gcGFja2FnZSBjYWxsZWQg4oCYbWl4T21pY3PigJkNCiMgSW5zdGFsbCBmcm9tIEJpb2NvbmR1Y3Rvcg0KbGlicmFyeShtaXhPbWljcykNCg0KDQpzdW1tYXJ5KHJlcG9ydDo6cmVwb3J0KHNlc3Npb25JbmZvKCkpKQ0KYGBgDQoNCiMgU3Vic2V0IFNlbGVjdGlvbiBNZXRob2RzDQoNCiMjIEJlc3QgU3Vic2V0IFNlbGVjdGlvbg0KDQpgYGB7ciwgZWNobz1GQUxTRX0NCnNldC5zZWVkKDEyMzQpDQpgYGANCg0KV2Ugd2lsbCBiZSB1c2luZyB0aGUgYEhpdHRlcnNgIGRhdGEgc2V0IGZyb20gdGhlIGBJU0xSYCBwYWNrYWdlLiBXZSB3aXNoDQp0byBwcmVkaWN0IHRoZSBiYXNlYmFsbCBwbGF5ZXJzIGBTYWxhcnlgIGJhc2VkIG9uIHNldmVyYWwgZGlmZmVyZW50DQpjaGFyYWN0ZXJpc3RpY3Mgd2hpY2ggYXJlIGluY2x1ZGVkIGluIHRoZSBkYXRhIHNldC4NCg0KUmVtb3ZlIGFsbCByb3dzIHdpdGggbWlzc2luZyBkYXRhIGZyb20gdGhhdCBjb2x1bW4uDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KDQpIaXR0ZXJzIDwtIGFzX3RpYmJsZShJU0xSOjpIaXR0ZXJzKSAlPiUNCiAgdGlkeXI6OmRyb3BfbmEoKQ0KYGBgDQoNClVzZSBgcmVnc3Vic2V0cygpYCBmdW5jdGlvbiB0byBwZXJmb3JtcyBiZXN0IHN1YnNldCBzZWxlY3Rpb24uDQoNCkFuIGFzdGVyaXNrIGluZGljYXRlcyB0aGF0IGEgZ2l2ZW4gdmFyaWFibGUgaXMgaW5jbHVkZWQgaW4gdGhlDQpjb3JyZXNwb25kaW5nIG1vZGVsLiBGb3IgaW5zdGFuY2UsIHRoaXMgb3V0cHV0IGluZGljYXRlcyB0aGF0IHRoZSBiZXN0DQp0d28tdmFyaWFibGUgbW9kZWwgY29udGFpbnMgb25seSBIaXRzIGFuZCBDUkJJLg0KDQpgYGB7ciwgbWVzc2FnZSA9IEZBTFNFLCBtYXguaGVpZ2h0ID0gJzE1MHB4J30NCg0KcmVnZml0LmZ1bGwgPC0gbGVhcHM6OnJlZ3N1YnNldHMoDQogIHggPSBTYWxhcnkgfiAuLCANCiAgZGF0YSA9IEhpdHRlcnMsDQogIG52bWF4ID0gOCAjZGVmYXVsdA0KICApDQoNCnN1bW1hcnkocmVnZml0LmZ1bGwpDQpgYGANCg0KSGVyZSB3ZSBmaXQgdXAgdG8gYSAxOS12YXJpYWJsZSBtb2RlbC4NCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQoNCnJlZ2ZpdC5mdWxsIDwtIGxlYXBzOjpyZWdzdWJzZXRzKA0KICB4ID0gU2FsYXJ5IH4gLiwgDQogIGRhdGEgPSBIaXR0ZXJzLA0KICBudm1heCA9IDE5ICNkZWZhdWx0DQogICkNCmBgYA0KDQpUaGUgYHN1bW1hcnkoKWAgZnVuY3Rpb24gYWxzbyByZXR1cm5zICRSXjIkLCAkUlNTJCwgYWRqdXN0ZWQgJFJeMiQsDQokQ19wJCwgYW5kICRCSUMkLiBXZSBjYW4gZXhhbWluZSB0aGVzZSB0byB0cnkgdG8gc2VsZWN0IHRoZSBiZXN0IG92ZXJhbGwNCm1vZGVsLg0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCg0KcmVnLnN1bW1hcnkgPC0gcmVnZml0LmZ1bGwgJT4lDQogIHN1bW1hcnkoKQ0KDQpuYW1lcyhyZWcuc3VtbWFyeSkNCmBgYA0KDQpGb3IgaW5zdGFuY2UsIHdlIHNlZSB0aGF0IHRoZSAkUl4yJCBzdGF0aXN0aWMgaW5jcmVhc2VzIGZyb20gMzIgJSwgd2hlbg0Kb25seSBvbmUgdmFyaWFibGUgaXMgaW5jbHVkZWQgaW4gdGhlIG1vZGVsLCB0byBhbG1vc3QgNTUgJSwgd2hlbiBhbGwNCnZhcmlhYmxlcyBhcmUgaW5jbHVkZWQuIEFzIGV4cGVjdGVkLCB0aGUgJFJeMiQgc3RhdGlzdGljIGluY3JlYXNlcw0KbW9ub3RvbmljYWxseSBhcyBtb3JlIHZhcmlhYmxlcyBhcmUgaW5jbHVkZWQuDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KDQpyZWcuc3VtbWFyeSRyc3ENCmBgYA0KDQpUaGUgYHJlZ3N1YnNldHMoKWAgZnVuY3Rpb24gaGFzIGEgYnVpbHQtaW4gYHBsb3QoKWAgY29tbWFuZCB3aGljaCBjYW4gYmUNCnVzZWQgdG8gZGlzcGxheSB0aGUgc2VsZWN0ZWQgdmFyaWFibGVzIGZvciB0aGUgYmVzdCBtb2RlbCB3aXRoIGEgZ2l2ZW4NCm51bWJlciBvZiBwcmVkaWN0b3JzLCByYW5rZWQgYWNjb3JkaW5nIHRvIHRoZSAkQklDJCwgJENfcCQsIGFkanVzdGVkDQokUl4yJCwgb3IgJEFJQyQuIFRvIGZpbmQgb3V0IG1vcmUgYWJvdXQgdGhpcyBmdW5jdGlvbiwgdHlwZQ0KYD9wbG90LnJlZ3N1YnNldHNgLg0KDQpUaGUgdG9wIHJvdyBvZiBlYWNoIHBsb3QgY29udGFpbnMgYSBibGFjayBzcXVhcmUgZm9yIGVhY2ggdmFyaWFibGUNCnNlbGVjdGVkIGFjY29yZGluZyB0byB0aGUgb3B0aW1hbCBtb2RlbCBhc3NvY2lhdGVkIHdpdGggdGhhdCBzdGF0aXN0aWMuDQpGb3IgaW5zdGFuY2UsIHdlIHNlZSB0aGF0IHNldmVyYWwgbW9kZWxzIHNoYXJlIGEgJEJJQyQgY2xvc2UgdG8gJOKIkjE1MCQuDQpIb3dldmVyLCB0aGUgbW9kZWwgd2l0aCB0aGUgbG93ZXN0ICRCSUMkIGlzIHRoZSBzaXgtdmFyaWFibGUgbW9kZWwgdGhhdA0KY29udGFpbnMgb25seSBgQXRCYXRgLCBgSGl0c2AsIGBXYWxrc2AsIGBDUkJJYCwgYERpdmlzaW9uV2AsIGFuZA0KYFB1dE91dHNgLg0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCnBsb3QocmVnZml0LmZ1bGwgLCBzY2FsZSA9ICJiaWMiKQ0KYGBgDQoNCldlIGNhbiB1c2UgdGhlIGBjb2VmKClgIGZ1bmN0aW9uIHRvIHNlZSB0aGUgY29lZmZpY2llbnQgZXN0aW1hdGVzDQphc3NvY2lhdGVkIHdpdGggdGhpcyBtb2RlbC4NCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQpjb2VmKHJlZ2ZpdC5mdWxsICwgNikNCmBgYA0KDQojIyBGb3J3YXJkIGFuZCBCYWNrd2FyZCBTdGVwd2lzZSBTZWxlY3Rpb24NCg0KV2UgY2FuIGFsc28gdXNlIHRoZSBgcmVnc3Vic2V0cygpYCBmdW5jdGlvbiB0byBwZXJmb3JtIGZvcndhcmQgc3RlcHdpc2UNCnNlbGVjdGlvbiB1c2luZyB0aGUgYXJndW1lbnQgYG1ldGhvZCA9ICJmb3J3YXJkImANCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0UsIG1heC5oZWlnaHQ9JzE1MHB4J30NCnJlZ2ZpdC5md2QgPC0gbGVhcHM6OnJlZ3N1YnNldHMoDQogIHggPSBTYWxhcnkgfiAuLCANCiAgZGF0YSA9IEhpdHRlcnMgLA0KICBudm1heCA9IDE5LCANCiAgbWV0aG9kID0gImZvcndhcmQiDQopDQoNCnN1bW1hcnkocmVnZml0LmZ3ZCkNCmBgYA0KDQpUbyBwZXJmb3JtIGJhY2t3YXJkIHN0ZXB3aXNlIHNlbGVjdGlvbiwgdXNlIHRoZSBhcmd1bWVudA0KYG1ldGhvZCA9ICJiYWNrd2FyZCJgDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFLCBtYXguaGVpZ2h0PScxNTBweCd9DQpyZWdmaXQuYndkIDwtIGxlYXBzOjpyZWdzdWJzZXRzKA0KICB4ID0gU2FsYXJ5IH4gLiwgDQogIGRhdGEgPSBIaXR0ZXJzICwNCiAgbnZtYXggPSAxOSwgDQogIG1ldGhvZCA9ICJiYWNrd2FyZCINCikNCg0Kc3VtbWFyeShyZWdmaXQuYndkKQ0KYGBgDQoNCkZvciB0aGlzIGRhdGEsIHRoZSBiZXN0IHNldmVuLXZhcmlhYmxlIG1vZGVscyBpZGVudGlmaWVkIGJ5IGZvcndhcmQNCnN0ZXB3aXNlIHNlbGVjdGlvbiwgYmFja3dhcmQgc3RlcHdpc2Ugc2VsZWN0aW9uLCBhbmQgYmVzdCBzdWJzZXQNCnNlbGVjdGlvbiBhcmUgZGlmZmVyZW50Lg0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCg0KY29lZihyZWdmaXQuZnVsbCw3KQ0KY29lZihyZWdmaXQuZndkLDcpDQpjb2VmKHJlZ2ZpdC5id2QsNykNCg0KYGBgDQoNCiMjIENob29zaW5nIEFtb25nIE1vZGVscyBVc2luZyB0aGUgVmFsaWRhdGlvbi1TZXQgQXBwcm9hY2gNCg0KV2Ugc3BsaXQgdGhlIHNhbXBsZXMgaW50byB0cmFpbmluZyBzZXQgYW5kIGEgdGVzdCBzZXQNCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQoNCnNldC5zZWVkKDEyMzQpDQoNCkhpdHRlcnMgPC0gSGl0dGVycyAlPiUNCiAgZHBseXI6Om11dGF0ZSgNCiAgICBpc1RyYWluaW5nU2V0ID0gc2FtcGxlKHggPSBjKFRSVUUgLCBGQUxTRSksDQogICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplID0gbnJvdyhIaXR0ZXJzKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcGxhY2UgPSBUUlVFKQ0KICApICU+JQ0KICBkcGx5cjo6cmVsb2NhdGUoLmRhdGFbWyJpc1RyYWluaW5nU2V0Il1dKQ0KDQp0cmFpbiA8LSBIaXR0ZXJzICU+JQ0KICBkcGx5cjo6ZmlsdGVyKC5kYXRhW1siaXNUcmFpbmluZ1NldCJdXSA9PSBUUlVFKSAlPiUNCiAgZHBseXI6OnNlbGVjdCgtYygiaXNUcmFpbmluZ1NldCIpKQ0KDQp0ZXN0IDwtIEhpdHRlcnMgJT4lDQogIGRwbHlyOjpmaWx0ZXIoLmRhdGFbWyJpc1RyYWluaW5nU2V0Il1dPT0gRkFMU0UpICU+JQ0KICBkcGx5cjo6c2VsZWN0KC1jKCJpc1RyYWluaW5nU2V0IikpDQoNCmBgYA0KDQpOb3csIHdlIGFwcGx5IGByZWdzdWJzZXRzKClgIHRvIHRoZSB0cmFpbmluZyBzZXQgaW4gb3JkZXIgdG8gcGVyZm9ybQ0KYmVzdCBzdWJzZXQgc2VsZWN0aW9uIGFuZCBjb21wdXRlIHRoZSB0aGUgdmFsaWRhdGlvbiBzZXQgZXJyb3IgZm9yIHRoZQ0KYmVzdCBtb2RlbCBvZiBlYWNoIG1vZGVsIHNpemUuDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KDQpyZWdmaXQuYmVzdCA8LSBsZWFwczo6cmVnc3Vic2V0cyhTYWxhcnkgfiAuLCBkYXRhID0gdHJhaW4sIG52bWF4ID0gMTkpDQoNCnRlc3QubWF0IDwtIHN0YXRzOjptb2RlbC5tYXRyaXgoU2FsYXJ5IH4gLiwgZGF0YSA9IHRlc3QpDQoNCnZhbC5lcnJvcnMgPC0gcmVwKE5BLCAxOSkNCg0KZm9yIChpIGluIDE6MTkpIHsNCiAgY29lZmkgPC0gc3RhdHM6OmNvZWYocmVnZml0LmJlc3QgLCBpZCA9IGkpDQogIHByZWQgPC0gdGVzdC5tYXRbLCBuYW1lcyhjb2VmaSldICUqJSBjb2VmaQ0KICB2YWwuZXJyb3JzW2ldIDwtIG1lYW4gKCggdGVzdCRTYWxhcnkgLSBwcmVkKV4yKQ0KfQ0KDQp2YWwuZXJyb3JzDQpgYGANCg0KV2UgZmluZCB0aGF0IHRoZSBiZXN0IG1vZGVsIGlzIHRoZSBvbmUgdGhhdCBjb250YWlucyBzZXZlbiB2YXJpYWJsZXMuDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0Kd2hpY2gubWluKHZhbC5lcnJvcnMpDQoNCmNvZWYocmVnZml0LmJlc3QgLCA3KQ0KYGBgDQoNCkhvd2V2ZXIsIHRoZSBiZXN0IHNldmVuLXZhcmlhYmxlIG1vZGVsIG9uIHRoZSBmdWxsIGRhdGEgc2V0IGhhcyBhDQpkaWZmZXJlbnQgc2V0IG9mIHZhcmlhYmxlcyB0aGFuIHRoZSBiZXN0IHNldmVuLXZhcmlhYmxlIG1vZGVsIG9uIHRoZQ0KdHJhaW5pbmcgc2V0Lg0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCnJlZ2ZpdC5iZXN0IDwtIGxlYXBzOjpyZWdzdWJzZXRzKFNhbGFyeSB+IC4sIGRhdGEgPSBIaXR0ZXJzICwgbnZtYXggPSAxOSkNCmNvZWYocmVnZml0LmJlc3QgLCA3KQ0KYGBgDQoNCiMjIENob29zaW5nIEFtb25nIE1vZGVscyBVc2luZyBDcm9zcy1WYWxpZGF0aW9uDQoNCldlIG5vdyB0cnkgdG8gY2hvb3NlIGFtb25nIHRoZSBtb2RlbHMgb2YgZGlmZmVyZW50IHNpemVzIHVzaW5nIGNyb3NzDQp2YWxpZGF0aW9uLiBDcmVhdGUgYSB2ZWN0b3IgdGhhdCBhbGxvY2F0ZXMgZWFjaCBvYnNlcnZhdGlvbiB0byBvbmUgb2Ygaw0KPSAxMCBmb2xkcy4NCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQpzZXQuc2VlZCAoMSkNCg0KayA8LSAxMA0KbiA8LSBucm93KEhpdHRlcnMpDQpmb2xkcyA8LSBzYW1wbGUocmVwICgxOmssIGxlbmd0aCA9IG4pKQ0KDQpgYGANCg0KV2Ugd3JpdGUgYSBmb3IgbG9vcCB0aGF0IHBlcmZvcm1zIGNyb3NzLXZhbGlkYXRpb24NCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQoNCiMgQSBwcmVkaWN0IG1ldGhvZCBmb3IgcmVnc3Vic2V0cw0KcHJlZGljdC5yZWdzdWJzZXRzIDwtIGZ1bmN0aW9uKG9iamVjdCAsIG5ld2RhdGEgLCBpZCwgLi4uKSB7DQogIGZvcm0gPC0gYXMuZm9ybXVsYShvYmplY3QkY2FsbCBbWzJdXSkNCiAgbWF0IDwtIG1vZGVsLm1hdHJpeChmb3JtICwgbmV3ZGF0YSkNCiAgY29lZmkgPC0gY29lZihvYmplY3QgLCBpZCA9IGlkKQ0KICB4dmFycyA8LSBuYW1lcyhjb2VmaSkNCiAgbWF0WywgeHZhcnNdICUqJSBjb2VmaQ0KICB9DQoNCmN2LmVycm9ycyA8LSBtYXRyaXgoTkEsIGssIDE5LA0KICAgICAgICAgICAgICAgICAgICBkaW1uYW1lcyA9IGxpc3QoTlVMTCAsIHBhc3RlICgxOjE5KSkpDQpmb3IgKGogaW4gMTprKSB7DQogIGJlc3QuZml0IDwtIGxlYXBzOjpyZWdzdWJzZXRzKFNhbGFyeSB+IC4sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSBIaXR0ZXJzW2ZvbGRzICE9IGosXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnZtYXggPSAxOSkNCiAgZm9yIChpIGluIDE6MTkpIHsNCiAgICBwcmVkIDwtIHN0YXRzOjpwcmVkaWN0KGJlc3QuZml0LCBIaXR0ZXJzW2ZvbGRzID09IGosIF0sIGlkID0gaSkNCiAgICBjdi5lcnJvcnNbaiwgaV0gPC0gbWVhbigoIEhpdHRlcnMkU2FsYXJ5W2ZvbGRzID09IGpdIC0gcHJlZCleMikNCiAgfQ0KICB9DQoNCmBgYA0KDQpUaGlzIGhhcyBnaXZlbiB1cyBhICQxMCQgYnkgJDE5JCBtYXRyaXgsIG9mIHdoaWNoIHRoZSAkKGosIGkpJHRoIGVsZW1lbnQNCmNvcnJlc3BvbmRzIHRvIHRoZSB0ZXN0ICRNU0UkIGZvciB0aGUgJGokdGggY3Jvc3MtdmFsaWRhdGlvbiBmb2xkIGZvcg0KdGhlIGJlc3QgJGkkLXZhcmlhYmxlIG1vZGVsLg0KDQpXZSB1c2UgdGhlIGBhcHBseSgpYCBmdW5jdGlvbiB0byBhdmVyYWdlIG92ZXIgdGhlIGNvbHVtbnMgb2YgdGhpcw0KYGFwcGx5KClgIG1hdHJpeCBpbiBvcmRlciB0byBvYnRhaW4gYSB2ZWN0b3IgZm9yIHdoaWNoIHRoZSAkaSR0aCBlbGVtZW50DQppcyB0aGUgY3Jvc3MgdmFsaWRhdGlvbiBlcnJvciBmb3IgdGhlICRpJC12YXJpYWJsZSBtb2RlbC4NCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQoNCm1lYW4uY3YuZXJyb3JzIDwtIGFwcGx5KGN2LmVycm9ycyAsIDIsIG1lYW4pDQoNCnBsb3QobWVhbi5jdi5lcnJvcnMgLCB0eXBlID0gImIiKQ0KDQpgYGANCg0KV2Ugc2VlIHRoYXQgY3Jvc3MtdmFsaWRhdGlvbiBzZWxlY3RzIGEgMTAtdmFyaWFibGUgbW9kZWwuDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KcmVnZml0LmJlc3QgPC0gbGVhcHM6OnJlZ3N1YnNldHMoU2FsYXJ5IH4gLiwgZGF0YSA9IEhpdHRlcnMgLCBudm1heCA9IDE5KQ0KY29lZihyZWdmaXQuYmVzdCAsIDEwKQ0KYGBgDQoNCiMgUmlkZ2UgUmVncmVzc2lvbg0KDQojIyBJbnRyb2R1Y3Rpb24gdG8gcmlkZ2UgcmVncmVzc2lvbiANCg0KU2V0IG1peHR1cmUgdG8gMCB0byBpbmRpY2F0ZSBSaWRnZSBSZWdyZXNzaW9uLiBGb3Igbm93LCB3ZSBzZXQNCnBlbmFsdHkvbGFtYmRhIGFzIDANCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQpIaXR0ZXJzIDwtIGFzX3RpYmJsZShJU0xSOjpIaXR0ZXJzKSAlPiUNCiAgdGlkeXI6OmRyb3BfbmEoKQ0KDQpyaWRnZV9zcGVjIDwtIHBhcnNuaXA6OmxpbmVhcl9yZWcobWl4dHVyZSA9IDAsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVuYWx0eSA9IDApICU+JQ0KICBwYXJzbmlwOjpzZXRfbW9kZSgicmVncmVzc2lvbiIpICU+JQ0KICBwYXJzbmlwOjpzZXRfZW5naW5lKCJnbG1uZXQiKQ0KDQpyaWRnZV9zcGVjICU+JQ0KICBwYXJzbmlwOjp0cmFuc2xhdGUoKQ0KYGBgDQoNCk9uY2UgdGhlIHNwZWNpZmljYXRpb24gaXMgY3JlYXRlZCB3ZSBjYW4gZml0IGl0IHRvIG91ciBkYXRhLiBXZSB3aWxsIHVzZQ0KYWxsIHRoZSBwcmVkaWN0b3JzLg0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCnJpZGdlX2ZpdCA8LSByaWRnZV9zcGVjICU+JQ0KICBwYXJzbmlwOjpmaXQoZm9ybXVsYSA9IFNhbGFyeSB+IC4sIA0KICAgICAgICAgICAgICAgZGF0YSA9IEhpdHRlcnMpDQoNCmBgYA0KDQpXZSBjYW4gc2VlIHRoZSBwYXJhbWV0ZXIgZXN0aW1hdGUgZm9yIGRpZmZlcmVudCB2YWx1ZXMgb2YNCnBlbmFsdHkvbGFtYmRhLiBOb3RpY2UgaG93IHRoZSBlc3RpbWF0ZXMgYXJlIGRlY3JlYXNpbmcgd2hlbiB0aGUgYW1vdW50DQpvZiBwZW5hbHR5IGdvZXMgdXANCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0UsIG1heC5oZWlnaHQ9JzE1MHB4J30NCnBhcnNuaXA6OnRpZHkocmlkZ2VfZml0KSAlPiUNCiAgcmVhY3RhYmxlOjpyZWFjdGFibGUoZGVmYXVsdFBhZ2VTaXplID0gNSkNCnBhcnNuaXA6OnRpZHkocmlkZ2VfZml0LCBwZW5hbHR5ID0gNzA1KSAlPiUNCiAgcmVhY3RhYmxlOjpyZWFjdGFibGUoZGVmYXVsdFBhZ2VTaXplID0gNSkNCnBhcnNuaXA6OnRpZHkocmlkZ2VfZml0LCBwZW5hbHR5ID0gMTE0OTgpICU+JQ0KICByZWFjdGFibGU6OnJlYWN0YWJsZShkZWZhdWx0UGFnZVNpemUgPSA1KQ0KYGBgDQoNCldlIGNhbiB2aXN1YWxpemUgaG93IHRoZSBtYWduaXR1ZGUgb2YgdGhlIGNvZWZmaWNpZW50cyBhcmUgYmVpbmcNCnJlZ3VsYXJpemVkIHRvd2FyZHMgemVybyBhcyB0aGUgcGVuYWx0eSBnb2VzIHVwLg0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCiMgQXJyYW5nZSBmaWd1cmUgbWFyZ2luDQpwYXIobWFyPWMoNSw1LDUsMSkpDQpyaWRnZV9maXQgJT4lDQogIHBhcnNuaXA6OmV4dHJhY3RfZml0X2VuZ2luZSgpICU+JQ0KICBwbG90KHh2YXIgPSAibGFtYmRhIikNCmBgYA0KDQpJdCB3b3VsZCBiZSBuaWNlIGlmIHdlIGNvdWxkIGZpbmQgdGhlICJiZXN0IiB2YWx1ZSBvZiB0aGUNCnBlbmFsdHkvbGFtYmRhLiBXZSBjYW4gZG8gdGhpcyB1c2luZyB0aGUgYHR1bmU6OnR1bmVfZ3JpZCgpYA0KDQpOZWVkIHdlIG5lZWQgdGhyZWUgdGhpbmdzIGluIG9yZGVyIHRvIHVzZSB0aGUgYHR1bmU6OnR1bmVfZ3JpZCgpYA0KDQotICAgYSBgcmVzYW1wbGVgIG9iamVjdCBjb250YWluaW5nIHRoZSByZXNhbXBsZXMgdGhlIGB3b3JrZmxvd2Agc2hvdWxkIGJlDQogICAgZml0dGVkIHdpdGhpbiwNCiAgICANCi0gICBhIGB3b3JrZmxvd2Agb2JqZWN0IGNvbnRhaW5pbmcgdGhlIG1vZGVsIGFuZCBwcmVwcm9jZXNzb3IsYW5kDQoNCi0gICBhIHRpYmJsZSBgcGVuYWx0eV9ncmlkYCBjb250YWluaW5nIHRoZSBwYXJhbWV0ZXIgdmFsdWVzIHRvIGJlIGV2YWx1YXRlZC4NCg0KRmlyc3QsIHdlIGNyZWF0ZSBhIDEwLWZvbGQgY3Jvc3MtdmFsaWRhdGlvbiBkYXRhIHNldCBmcm9tIHRoZSB0cmFpbmluZw0KZGF0YSBzZXQuDQoNCiMjIENyZWF0ZSB0aGUgcmVzYW1wbGUgb2JqZWN0DQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0Kc2V0LnNlZWQoMTIzNCkNCkhpdHRlcnMgPC0gYXNfdGliYmxlKElTTFI6OkhpdHRlcnMpICU+JQ0KICB0aWR5cjo6ZHJvcF9uYSgpDQoNCkhpdHRlcnNfc3BsaXQgPC0gcnNhbXBsZTo6aW5pdGlhbF9zcGxpdChIaXR0ZXJzLCBzdHJhdGEgPSAiU2FsYXJ5IikNCg0KSGl0dGVyc190cmFpbiA8LSByc2FtcGxlOjp0cmFpbmluZyhIaXR0ZXJzX3NwbGl0KQ0KSGl0dGVyc190ZXN0IDwtIHJzYW1wbGU6OnRlc3RpbmcoSGl0dGVyc19zcGxpdCkNCg0KSGl0dGVyc19mb2xkIDwtIHJzYW1wbGU6OnZmb2xkX2N2KEhpdHRlcnNfdHJhaW4sIHYgPSAxMCkNCg0KYGBgDQoNCiMjIENyZWF0ZSB0aGUgcHJlcHJvY2Vzc29yDQoNCldlIHVzZSB0aGUgYHJlY2lwZXNgIHBhY2thZ2UgdG8gY3JlYXRlIHRoZSBwcmVwb3JjZXNzaW5nIHN0ZXBzLiBIb3dldmVyLCB0aGUgb3JkZXIgb2YgdGhlIHByZXByb2Nlc3Npbmcgc3RlcCBpcyBhY3R1YWxseSBpbXBvcnRhbnQuIFNlZSB0aGUgW09yZGVyaW5nIG9mIHN0ZXBzIHZpZ25ldHRlXShodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvcmVjaXBlcy92aWduZXR0ZXMvT3JkZXJpbmcuaHRtbCkgDQoNCldlIGNyZWF0ZSBhIGJhc2ljIHJlY2lwZS4NCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQoNCnJpZGdlX3JlY2lwZSA8LSByZWNpcGVzOjpyZWNpcGUoZm9ybXVsYSA9IFNhbGFyeSB+IC4sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSBIaXR0ZXJzX3RyYWluKQ0KDQpyZWMgPC0gcmVjaXBlczo6cHJlcCh4ID0gcmlkZ2VfcmVjaXBlLCB0cmFpbmluZyA9IEhpdHRlcnNfdHJhaW4pDQogIA0KcmVjICU+JQ0KICBzdW1tYXJ5KCkgJT4lDQogIHJlYWN0YWJsZTo6cmVhY3RhYmxlKGRlZmF1bHRQYWdlU2l6ZSA9IDUpDQoNCnJlYyAlPiUNCiAgcmVjaXBlczo6YmFrZShuZXdfZGF0YSA9IEhpdHRlcnNfdHJhaW4pICU+JQ0KICByZWFjdGFibGU6OnJlYWN0YWJsZShkZWZhdWx0UGFnZVNpemUgPSA1KQ0KDQpgYGANCg0KRG8gcHJlcHJvY2Vzc2luZyBvbiB0aGUgZmFjdG9yIHZhcmlhYmxlcy4NCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQoNCnJpZGdlX3JlY2lwZSA8LSByaWRnZV9yZWNpcGUgJT4lDQogICMgU3RlcCBOb3ZlbCBpcyBpbXBvcnRhbnQuDQogICMgSWYgdGVzdCBzZXQgaGFzIGEgbmV3IGZhY3RvciBub3QgZm91bmQgaW4gdHJhaW5pbmcsIGl0IHdpbGwgYmUgdHJlYXRlZCBhcyAibmV3IiBhbmQgbm90IE5BDQogICMgVGhpcyB3aWxsIHByZXZlbnQgdGhlIG1vZGVsIGZyb20gZ2l2aW5nIGFuIGVycm9yDQogICMgaHR0cHM6Ly9ibG9nLmRhdGFzY2llbmNlaGVyb2VzLmNvbS9ob3ctdG8tdXNlLXJlY2lwZXMtcGFja2FnZS1mb3Itb25lLWhvdC1lbmNvZGluZy8NCiAgcmVjaXBlczo6c3RlcF9ub3ZlbChyZWNpcGVzOjphbGxfbm9taW5hbF9wcmVkaWN0b3JzKCkpICU+JQ0KICAjIENyZWF0ZSBEdW1teSB2YXJpYWJsZXMNCiAgcmVjaXBlczo6c3RlcF9kdW1teShyZWNpcGVzOjphbGxfbm9taW5hbF9wcmVkaWN0b3JzKCkpDQoNCnJlYyA8LSByZWNpcGVzOjpwcmVwKHggPSByaWRnZV9yZWNpcGUsIHRyYWluaW5nID0gSGl0dGVyc190cmFpbikNCiAgDQpyZWMgJT4lDQogIHN1bW1hcnkoKSAlPiUNCiAgcmVhY3RhYmxlOjpyZWFjdGFibGUoZGVmYXVsdFBhZ2VTaXplID0gNSkNCg0KcmVjICU+JQ0KICByZWNpcGVzOjpiYWtlKG5ld19kYXRhID0gSGl0dGVyc190cmFpbikgJT4lDQogIHJlYWN0YWJsZTo6cmVhY3RhYmxlKGRlZmF1bHRQYWdlU2l6ZSA9IDUpDQoNCmBgYA0KDQpEbyBub3JtYWxpc2F0aW9uIHN0ZXAuDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KDQpyaWRnZV9yZWNpcGUgPC0gcmlkZ2VfcmVjaXBlICU+JQ0KICAjIFJlbW92ZSBwcmVkaWN0b3JzIHdpdGggemVybyB2YXJpYXRpb24NCiAgcmVjaXBlczo6c3RlcF96dihyZWNpcGVzOjphbGxfcHJlZGljdG9ycygpKSAlPiUNCiAgIyBTdGFuZGFyZGlzZSBhbGwgdmFyaWFibGUNCiAgcmVjaXBlczo6c3RlcF9ub3JtYWxpemUocmVjaXBlczo6YWxsX3ByZWRpY3RvcnMoKSkNCg0KcmVjIDwtIHJlY2lwZXM6OnByZXAoeCA9IHJpZGdlX3JlY2lwZSwgdHJhaW5pbmcgPSBIaXR0ZXJzX3RyYWluKQ0KICANCnJlYyAlPiUNCiAgcmVjaXBlczo6YmFrZShuZXdfZGF0YSA9IEhpdHRlcnNfdHJhaW4pICU+JQ0KICByZWFjdGFibGU6OnJlYWN0YWJsZShkZWZhdWx0UGFnZVNpemUgPSA1KQ0KDQoNCmBgYA0KDQojIyBTcGVjaWZ5IHRoZSBtb2RlbA0KDQpUaGUgbW9kZWwgc3BlY2lmaWNhdGlvbiB3aWxsIGxvb2sgdmVyeSBzaW1pbGFyIHRvIHdoYXQgd2UgaGF2ZSBzZWVuIGVhcmxpZXIsIGJ1dCB3ZSB3aWxsIHNldCBgcGVuYWx0eSA9IHR1bmU6OnR1bmUoKWAuIFRoaXMgdGVsbHMgYHR1bmU6OnR1bmVfZ3JpZCgpYCB0aGF0IHRoZSBwZW5hbHR5IHBhcmFtZXRlciBzaG91bGQgYmUgdHVuZWQuDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KDQpyaWRnZV9zcGVjIDwtIA0KICBwYXJzbmlwOjpsaW5lYXJfcmVnKHBlbmFsdHkgPSB0dW5lOjp0dW5lKCksIG1peHR1cmUgPSAwKSAlPiUgDQogIHBhcnNuaXA6OnNldF9tb2RlKCJyZWdyZXNzaW9uIikgJT4lIA0KICBwYXJzbmlwOjpzZXRfZW5naW5lKCJnbG1uZXQiKQ0KDQpyaWRnZV9zcGVjICU+JQ0KICBwYXJzbmlwOjp0cmFuc2xhdGUoKQ0KYGBgDQoNCiMjIENyZWF0ZSB0aGUgd29ya2Zsb3cNCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0UsIG1heC5oZWlnaHQ9JzE1MHB4J30NCg0KcmlkZ2Vfd29ya2Zsb3cgPC0gIHdvcmtmbG93czo6d29ya2Zsb3coKSAlPiUgDQogIHdvcmtmbG93czo6YWRkX3JlY2lwZShyaWRnZV9yZWNpcGUpICU+JSANCiAgd29ya2Zsb3dzOjphZGRfbW9kZWwocmlkZ2Vfc3BlYykNCg0KcmlkZ2Vfd29ya2Zsb3cNCmBgYA0KDQojIyBDcmVhdGUgdGhlIHBlbmFsdHkvbGFtYmRhIGdyaWQNCg0KQSBwZW5hbHR5L2xhbWJkYSBncmlkIG9mICQ1MCQgbnVtYmVycyBmcm9tICQwLjAwMDAxJCAoJDEwXnstNX0kKSB0byAkMTAwMDAkICgkMTBeNSQpIGlzIGNyZWF0ZWQuDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KDQojIENyZWF0ZSBhIHJhbmdlIGZyb20gMTANCnBlbmFsdHlfZ3JpZCA8LSBkaWFsczo6Z3JpZF9yZWd1bGFyKGRpYWxzOjpwZW5hbHR5KHJhbmdlID0gYygtNSwgNSkpLCBsZXZlbHMgPSA1MCkNCg0KcGVuYWx0eV9ncmlkICAlPiUgDQogIHJlYWN0YWJsZTo6cmVhY3RhYmxlKGRlZmF1bHRQYWdlU2l6ZSA9IDUpDQpgYGANCg0KIyMgUmlkZ2UgcmVncmVzc2lvbiBtb2RlbCBmaXR0aW5nIG9uIGNyb3NzIHZhbGlkYXRlZCBkYXRhDQoNCk5vdyB3ZSBoYXZlIGV2ZXJ5dGhpbmcgd2UgbmVlZCBhbmQgd2UgY2FuIGZpdCBhbGwgdGhlIG1vZGVscyBvbiB0aGUgY3Jvc3MgdmFsaWRhdGVkIGRhdGEuIE5vdGUgdGhhdCB0aGlzIHByb2Nlc3MgbWF5IHRha2Ugc29tZSB0aW1lLg0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRSwgbWF4LmhlaWdodD0nMTUwcHgnfQ0KZG9QYXJhbGxlbDo6cmVnaXN0ZXJEb1BhcmFsbGVsKCkNCg0KdHVuZV9yZXMgPC0gdHVuZTo6dHVuZV9ncmlkKA0KICBvYmplY3QgPSByaWRnZV93b3JrZmxvdywNCiAgcmVzYW1wbGVzID0gSGl0dGVyc19mb2xkLCANCiAgZ3JpZCA9IHBlbmFsdHlfZ3JpZA0KKQ0KDQp0dW5lX3Jlcw0KYGBgDQoNCkhlcmUgd2Ugc2VlIHRoYXQgdGhlIGFtb3VudCBvZiByZWd1bGFyaXphdGlvbiBhZmZlY3RzIHRoZSBwZXJmb3JtYW5jZSBtZXRyaWNzIGRpZmZlcmVudGx5LiBEbyBub3RlIHRoYXQgdXNpbmcgYSBkaWZmZXJlbnQgc2VlZCB3aWxsIGdpdmUgYSBkaWZmZXJlbnQgcGxvdA0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCiMgTm90ZSB0aGF0IGEgZGlmZmVyZW50IHNlZWQgd2lsbCBnaXZlIGRpZmZlcmVudCBwbG90cw0KdHVuZTo6YXV0b3Bsb3QodHVuZV9yZXMpDQpgYGANCg0KV2UgY2FuIGFsc28gc2VlIHRoZSByYXcgbWV0cmljcyB0aGF0IGNyZWF0ZWQgdGhpcyBjaGFydCBieSBjYWxsaW5nIGB0dW5lOjpjb2xsZWN0X21ldHJpY3MoKWAuDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFLCBtYXguaGVpZ2h0PScxNTBweCd9DQoNCnR1bmU6OmNvbGxlY3RfbWV0cmljcyh0dW5lX3JlcykgJT4lIA0KICByZWFjdGFibGU6OnJlYWN0YWJsZShkZWZhdWx0UGFnZVNpemUgPSA1KQ0KYGBgDQoNCkhlcmUgaXMgdGhlIGBnZ3Bsb3RgIHdheSBzaG91bGQgYHR1bmU6OmF1dG9wbG90YCBmYWlscw0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRSwgbWF4LmhlaWdodD0nMTUwcHgnfQ0KDQp0dW5lX3JlcyAlPiUNCiAgdHVuZTo6Y29sbGVjdF9tZXRyaWNzKCkgJT4lDQogIGdncGxvdDI6OmdncGxvdChtYXBwaW5nID0gZ2dwbG90Mjo6YWVzKHggPSAuZGF0YVtbInBlbmFsdHkiXV0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHkgPSAuZGF0YVtbIm1lYW4iXV0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG91ciA9IC5kYXRhW1siLm1ldHJpYyJdXSkpICsNCiAgZ2dwbG90Mjo6Z2VvbV9lcnJvcmJhcihtYXBwaW5nID0gZ2dwbG90Mjo6YWVzKHltaW4gPSAuZGF0YVtbIm1lYW4iXV0gLSAuZGF0YVtbInN0ZF9lcnIiXV0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5bWF4ID0gLmRhdGFbWyJtZWFuIl1dICsgLmRhdGFbWyJzdGRfZXJyIl1dKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICBhbHBoYSA9IDAuNSkgKw0KICBnZ3Bsb3QyOjpnZW9tX2xpbmUoc2l6ZSA9IDEuNSkgKw0KICBnZ3Bsb3QyOjpmYWNldF93cmFwKGZhY2V0cyA9IGdncGxvdDI6OnZhcnMoLmRhdGFbWyIubWV0cmljIl1dKSwgDQogICAgICAgICAgICAgICAgICAgICAgc2NhbGVzID0gImZyZWUiLCANCiAgICAgICAgICAgICAgICAgICAgICBucm93ID0gMikgKw0KICBnZ3Bsb3QyOjpzY2FsZV94X2xvZzEwKCkgKw0KICBnZ3Bsb3QyOjp0aGVtZShsZWdlbmQucG9zaXRpb24gPSAibm9uZSIpDQpgYGANCg0KVGhlIOKAnGJlc3TigJ0gdmFsdWVzIG9mIHRoaXMgY2FuIGJlIHNlbGVjdGVkIHVzaW5nIGB0dW5lOjpzZWxlY3RfYmVzdCgpYCwgdGhpcyBmdW5jdGlvbiByZXF1aXJlcyB5b3UgdG8gc3BlY2lmeSBhIG1ldHJpYyB0aGF0IGl0IHNob3VsZCBzZWxlY3QgYWdhaW5zdC4gVGhlIHBlbmFsdHkvbGFtYmRhIHZhbHVlIGlzIDU2OSBmb3IgbWV0cmljIGByc3FgIHNpbmNlIGl0IGdpdmVzIHRoZSBoaWdoZXN0IHZhbHVlLiBEbyBub3RlIHRoYXQgdXNpbmcgYSBkaWZmZXJlbnQgc2VlZCB3aWxsIGdpdmUgYSBkaWZmZXJlbnQgYmVzdCBwZW5hbHR5L2xhbWJkYSB2YWx1ZS4NCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0UsIG1heC5oZWlnaHQ9JzE1MHB4J30NCg0KdG9wX3BlbmFsdHkgPC0gdHVuZTo6c2hvd19iZXN0KHR1bmVfcmVzLCBtZXRyaWMgPSAicnNxIiwgbiA9IDUpDQp0b3BfcGVuYWx0eQ0KDQpiZXN0X3BlbmFsdHkgPC0gdHVuZTo6c2VsZWN0X2Jlc3QodHVuZV9yZXMsIG1ldHJpYyA9ICJyc3EiKQ0KYmVzdF9wZW5hbHR5DQoNCmBgYA0KDQojIyBSaWRnZSByZWdyZXNzaW9uIG1vZGVsIHdpdGggb3B0aW1pc2VkIHBlbmFsdHkvbGFtYmRhIHZhbHVlDQoNCldlIGNyZWF0ZSB0aGUgcmlkZ2UgcmVncmVzc2lvbiB3b3JrZmxvdyB3aXRoIHRoZSBiZXN0IHBlbmFsdHkgc2NvcmUuDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFLCBtYXguaGVpZ2h0PScxNTBweCd9DQoNCnJpZGdlX2ZpbmFsIDwtIHR1bmU6OmZpbmFsaXplX3dvcmtmbG93KHggPSByaWRnZV93b3JrZmxvdywgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbWV0ZXJzID0gYmVzdF9wZW5hbHR5KQ0KDQpyaWRnZV9maW5hbA0KYGBgDQoNCldlIG5vdyB0cmFpbiB0aGUgcmlkZ2UgcmVncmVzc2lvbiBtb2RlbCB3aXRoIHRoZSB0cmFpbmluZyBkYXRhDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KDQpyaWRnZV9maW5hbF9maXQgPC0gcGFyc25pcDo6Zml0KG9iamVjdCA9IHJpZGdlX2ZpbmFsLCBkYXRhID0gSGl0dGVyc190cmFpbikNCmBgYA0KDQojIyBWYXJpYWJsZSBJbXBvcnRhbmNlDQoNCldoaWxlIHdl4oCZcmUgYXQgaXQsIGxldOKAmXMgc2VlIHdoYXQgdGhlIG1vc3QgaW1wb3J0YW50IHZhcmlhYmxlcyBhcmUgdXNpbmcgdGhlIGB2aXBgIHBhY2thZ2UuDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KDQp2aXBfdGFibGUgPC0gcmlkZ2VfZmluYWxfZml0ICU+JQ0KICB3b3JrZmxvd3M6OmV4dHJhY3RfZml0X3BhcnNuaXAoKSAlPiUNCiAgdmlwOjp2aShsYW1iZGEgPSBiZXN0X3BlbmFsdHkkcGVuYWx0eSkgDQoNCnZpcF90YWJsZSAlPiUNCiAgcmVhY3RhYmxlOjpyZWFjdGFibGUoZGVmYXVsdFBhZ2VTaXplID0gNSkNCmBgYA0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCnZpcF90YWJsZSAlPiUgDQogIGRwbHlyOjptdXRhdGUoDQogICAgSW1wb3J0YW5jZSA9IGFicyguZGF0YVtbIkltcG9ydGFuY2UiXV0pLA0KICAgIFZhcmlhYmxlID0gZm9yY2F0czo6ZmN0X3Jlb3JkZXIoLmYgPSAuZGF0YVtbIlZhcmlhYmxlIl1dLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC54ID0gLmRhdGFbWyJJbXBvcnRhbmNlIl1dKQ0KICApICU+JQ0KICBnZ3Bsb3QyOjpnZ3Bsb3QobWFwcGluZyA9IGdncGxvdDI6OmFlcyh4ID0gLmRhdGFbWyJJbXBvcnRhbmNlIl1dLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeSA9IC5kYXRhW1siVmFyaWFibGUiXV0sIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxsID0gLmRhdGFbWyJTaWduIl1dKSkgKw0KICBnZ3Bsb3QyOjpnZW9tX2NvbCgpICsNCiAgZ2dwbG90Mjo6c2NhbGVfeF9jb250aW51b3VzKGV4cGFuZCA9IGMoMCwgMCkpICsNCiAgZ2dwbG90Mjo6bGFicyh5ID0gTlVMTCkNCmBgYA0KDQojIyBSaWRnZSByZWdyZXNzaW9uIG1vZGVsIG9uIHRlc3QgZGF0YQ0KDQpUaGlzIHJpZGdlIHJlZ3Jlc3Npb24gbW9kZWwgY2FuIG5vdyBiZSBhcHBsaWVkIG9uIG91ciB0ZXN0aW5nIGRhdGEgc2V0IHRvIHZhbGlkYXRlIGl0cyBwZXJmb3JtYW5jZS4gRm9yIHJlZ3Jlc3Npb24gbW9kZWxzLCBhIGAucHJlZGAgY29sdW1uIGlzIGFkZGVkLg0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCg0KdGVzdF9yZXN1bHRzIDwtIHBhcnNuaXA6OmF1Z21lbnQoeCA9IHJpZGdlX2ZpbmFsX2ZpdCwgbmV3X2RhdGEgPSBIaXR0ZXJzX3Rlc3QpDQogIA0KdGVzdF9yZXN1bHRzICU+JQ0KICByZWFjdGFibGU6OnJlYWN0YWJsZShkZWZhdWx0UGFnZVNpemUgPSA1KQ0KICANCmBgYA0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCnRlc3RfcmVzdWx0cyAlPiUNCiAgeWFyZHN0aWNrOjpyc3EodHJ1dGggPSAuZGF0YVtbIlNhbGFyeSJdXSwgZXN0aW1hdGUgPSAuZGF0YVtbIi5wcmVkIl1dKSAlPiUNCiAgcmVhY3RhYmxlOjpyZWFjdGFibGUoZGVmYXVsdFBhZ2VTaXplID0gNSkNCmBgYA0KDQpBbHRlcm5hdGl2ZWx5LCB3ZSBjYW4gdXNlIGB0dW5lOjpsYXN0X2ZpdGAgYW5kIGB0dW5lOjpjb2xsZWN0X21ldHJpY3NgDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KDQp0ZXN0X3Jlc3VsdHMgPC0gdHVuZTo6bGFzdF9maXQob2JqZWN0ID0gcmlkZ2VfZmluYWxfZml0LCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcGxpdCA9IEhpdHRlcnNfc3BsaXQpICU+JQ0KICB0dW5lOjpjb2xsZWN0X21ldHJpY3MoKQ0KICANCnRlc3RfcmVzdWx0cyAlPiUNCiAgcmVhY3RhYmxlOjpyZWFjdGFibGUoZGVmYXVsdFBhZ2VTaXplID0gNSkNCiAgDQpgYGANCg0KIyBUaGUgTGFzc28NCg0KVGhlIGZvbGxvd2luZyBwcm9jZWR1cmUgd2lsbCBiZSB2ZXJ5IHNpbWlsYXIgdG8gd2hhdCB3ZSBzYXcgaW4gdGhlIHJpZGdlIHJlZ3Jlc3Npb24gc2VjdGlvbi4gVGhlIHJlc2FtcGxpbmcgc3RlcCBpcyB0aGUgc2FtZQ0KDQojIyBDcmVhdGUgdGhlIHJlc2FtcGxlIG9iamVjdA0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCnNldC5zZWVkKDEyMzQpDQpIaXR0ZXJzIDwtIGFzX3RpYmJsZShJU0xSOjpIaXR0ZXJzKSAlPiUNCiAgdGlkeXI6OmRyb3BfbmEoKQ0KDQpIaXR0ZXJzX3NwbGl0IDwtIHJzYW1wbGU6OmluaXRpYWxfc3BsaXQoSGl0dGVycywgc3RyYXRhID0gIlNhbGFyeSIpDQoNCkhpdHRlcnNfdHJhaW4gPC0gcnNhbXBsZTo6dHJhaW5pbmcoSGl0dGVyc19zcGxpdCkNCkhpdHRlcnNfdGVzdCA8LSByc2FtcGxlOjp0ZXN0aW5nKEhpdHRlcnNfc3BsaXQpDQoNCkhpdHRlcnNfZm9sZCA8LSByc2FtcGxlOjp2Zm9sZF9jdihIaXR0ZXJzX3RyYWluLCB2ID0gMTApDQoNCmBgYA0KDQojIyBDcmVhdGUgdGhlIHByZXByb2Nlc3Nvcg0KDQpUaGUgZm9sbG93aW5nIHByb2NlZHVyZSB3aWxsIGJlIHZlcnkgc2ltaWxhciB0byB3aGF0IHdlIHNhdyBpbiB0aGUgcmlkZ2UgcmVncmVzc2lvbiBzZWN0aW9uLiBUaGUgcHJlcHJvY2Vzc2luZyBuZWVkZWQgaXMgdGhlIHNhbWUuDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KDQpsYXNzb19yZWNpcGUgPC0gDQogIHJlY2lwZXM6OnJlY2lwZShmb3JtdWxhID0gU2FsYXJ5IH4gLiwgZGF0YSA9IEhpdHRlcnNfdHJhaW4pICU+JSANCiAgcmVjaXBlczo6c3RlcF9ub3ZlbChyZWNpcGVzOjphbGxfbm9taW5hbF9wcmVkaWN0b3JzKCkpICU+JSANCiAgcmVjaXBlczo6c3RlcF9kdW1teShyZWNpcGVzOjphbGxfbm9taW5hbF9wcmVkaWN0b3JzKCkpICU+JSANCiAgcmVjaXBlczo6c3RlcF96dihyZWNpcGVzOjphbGxfcHJlZGljdG9ycygpKSAlPiUgDQogIHJlY2lwZXM6OnN0ZXBfbm9ybWFsaXplKHJlY2lwZXM6OmFsbF9wcmVkaWN0b3JzKCkpDQpgYGANCg0KIyMgU3BlY2lmeSB0aGUgbW9kZWwNCg0KVGhpcyB0aW1lLCBpdCBpcyBgbWl4dHVyZT0xYA0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCg0KbGFzc29fc3BlYyA8LSANCiAgcGFyc25pcDo6bGluZWFyX3JlZyhwZW5hbHR5ID0gdHVuZTo6dHVuZSgpLCBtaXh0dXJlID0gMSkgJT4lIA0KICBwYXJzbmlwOjpzZXRfbW9kZSgicmVncmVzc2lvbiIpICU+JSANCiAgcGFyc25pcDo6c2V0X2VuZ2luZSgiZ2xtbmV0IikNCg0KbGFzc29fc3BlYyAlPiUNCiAgcGFyc25pcDo6dHJhbnNsYXRlKCkNCg0KYGBgDQoNCiMjIENyZWF0ZSB0aGUgd29ya2Zsb3cNCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0UsIG1heC5oZWlnaHQ9JzE1MHB4J30NCg0KbGFzc29fd29ya2Zsb3cgPC0gIHdvcmtmbG93czo6d29ya2Zsb3coKSAlPiUgDQogIHdvcmtmbG93czo6YWRkX3JlY2lwZShsYXNzb19yZWNpcGUpICU+JSANCiAgd29ya2Zsb3dzOjphZGRfbW9kZWwobGFzc29fc3BlYykNCg0KbGFzc29fd29ya2Zsb3cNCmBgYA0KDQojIyBDcmVhdGUgdGhlIHBlbmFsdHkvbGFtYmRhIGdyaWQNCg0KQSBwZW5hbHR5L2xhbWJkYSBncmlkIG9mICQ1MCQgbnVtYmVycyBmcm9tICQwLjAxJCAoJDEwXnstMn0kKSB0byAkMTAwJCAoJDEwXjIkKSBpcyBjcmVhdGVkLg0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCmRvUGFyYWxsZWw6OnJlZ2lzdGVyRG9QYXJhbGxlbCgpDQoNCiMgQ3JlYXRlIGEgcmFuZ2UgZnJvbSAxMA0KcGVuYWx0eV9ncmlkIDwtIGRpYWxzOjpncmlkX3JlZ3VsYXIoZGlhbHM6OnBlbmFsdHkocmFuZ2UgPSBjKC0yLCAyKSksIGxldmVscyA9IDUwKQ0KDQpwZW5hbHR5X2dyaWQgICU+JSANCiAgcmVhY3RhYmxlOjpyZWFjdGFibGUoZGVmYXVsdFBhZ2VTaXplID0gNSkNCmBgYA0KDQojIyBMYXNzbyBtb2RlbCBmaXR0aW5nIG9uIGNyb3NzIHZhbGlkYXRlZCBkYXRhDQoNCk5vdyB3ZSBoYXZlIGV2ZXJ5dGhpbmcgd2UgbmVlZCBhbmQgd2UgY2FuIGZpdCBhbGwgdGhlIG1vZGVscyBvbiB0aGUgY3Jvc3MgdmFsaWRhdGVkIGRhdGEuIE5vdGUgdGhhdCB0aGlzIHByb2Nlc3MgbWF5IHRha2Ugc29tZSB0aW1lLg0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRSwgbWF4LmhlaWdodD0nMTUwcHgnfQ0KDQp0dW5lX3JlcyA8LSB0dW5lOjp0dW5lX2dyaWQoDQogIG9iamVjdCA9IGxhc3NvX3dvcmtmbG93LA0KICByZXNhbXBsZXMgPSBIaXR0ZXJzX2ZvbGQsIA0KICBncmlkID0gcGVuYWx0eV9ncmlkDQopDQoNCnR1bmVfcmVzDQpgYGANCg0KSGVyZSB3ZSBzZWUgdGhhdCB0aGUgYW1vdW50IG9mIHJlZ3VsYXJpemF0aW9uIGFmZmVjdHMgdGhlIHBlcmZvcm1hbmNlIG1ldHJpY3MgZGlmZmVyZW50bHkuIERvIG5vdGUgdGhhdCB1c2luZyBhIGRpZmZlcmVudCBzZWVkIHdpbGwgZ2l2ZSBhIGRpZmZlcmVudCBwbG90DQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KIyBOb3RlIHRoYXQgYSBkaWZmZXJlbnQgc2VlZCB3aWxsIGdpdmUgZGlmZmVyZW50IHBsb3RzDQp0dW5lOjphdXRvcGxvdCh0dW5lX3JlcykNCmBgYA0KDQpXZSBjYW4gYWxzbyBzZWUgdGhlIHJhdyBtZXRyaWNzIHRoYXQgY3JlYXRlZCB0aGlzIGNoYXJ0IGJ5IGNhbGxpbmcgYHR1bmU6OmNvbGxlY3RfbWV0cmljcygpYC4NCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0UsIG1heC5oZWlnaHQ9JzE1MHB4J30NCg0KdHVuZTo6Y29sbGVjdF9tZXRyaWNzKHR1bmVfcmVzKSAlPiUgDQogIHJlYWN0YWJsZTo6cmVhY3RhYmxlKGRlZmF1bHRQYWdlU2l6ZSA9IDUpDQpgYGANCg0KSGVyZSBpcyB0aGUgYGdncGxvdGAgd2F5IHNob3VsZCBgdHVuZTo6YXV0b3Bsb3RgIGZhaWxzDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFLCBtYXguaGVpZ2h0PScxNTBweCd9DQoNCnR1bmVfcmVzICU+JQ0KICB0dW5lOjpjb2xsZWN0X21ldHJpY3MoKSAlPiUNCiAgZ2dwbG90Mjo6Z2dwbG90KG1hcHBpbmcgPSBnZ3Bsb3QyOjphZXMoeCA9IC5kYXRhW1sicGVuYWx0eSJdXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeSA9IC5kYXRhW1sibWVhbiJdXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3VyID0gLmRhdGFbWyIubWV0cmljIl1dKSkgKw0KICBnZ3Bsb3QyOjpnZW9tX2Vycm9yYmFyKG1hcHBpbmcgPSBnZ3Bsb3QyOjphZXMoeW1pbiA9IC5kYXRhW1sibWVhbiJdXSAtIC5kYXRhW1sic3RkX2VyciJdXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHltYXggPSAuZGF0YVtbIm1lYW4iXV0gKyAuZGF0YVtbInN0ZF9lcnIiXV0pLA0KICAgICAgICAgICAgICAgICAgICAgICAgIGFscGhhID0gMC41KSArDQogIGdncGxvdDI6Omdlb21fbGluZShzaXplID0gMS41KSArDQogIGdncGxvdDI6OmZhY2V0X3dyYXAoZmFjZXRzID0gZ2dwbG90Mjo6dmFycyguZGF0YVtbIi5tZXRyaWMiXV0pLCANCiAgICAgICAgICAgICAgICAgICAgICBzY2FsZXMgPSAiZnJlZSIsIA0KICAgICAgICAgICAgICAgICAgICAgIG5yb3cgPSAyKSArDQogIGdncGxvdDI6OnNjYWxlX3hfbG9nMTAoKSArDQogIGdncGxvdDI6OnRoZW1lKGxlZ2VuZC5wb3NpdGlvbiA9ICJub25lIikNCmBgYA0KDQoNClRoZSDigJxiZXN04oCdIHZhbHVlcyBvZiB0aGlzIGNhbiBiZSBzZWxlY3RlZCB1c2luZyBgdHVuZTo6c2VsZWN0X2Jlc3QoKWAsIHRoaXMgZnVuY3Rpb24gcmVxdWlyZXMgeW91IHRvIHNwZWNpZnkgYSBtZXRyaWMgdGhhdCBpdCBzaG91bGQgc2VsZWN0IGFnYWluc3QuIFRoZSBwZW5hbHR5L2xhbWJkYSB2YWx1ZSBpcyAyMi4yIGZvciBtZXRyaWMgYHJzcWAgc2luY2UgaXQgZ2l2ZXMgdGhlIGhpZ2hlc3QgdmFsdWUuIERvIG5vdGUgdGhhdCB1c2luZyBhIGRpZmZlcmVudCBzZWVkIHdpbGwgZ2l2ZSBhIGRpZmZlcmVudCBiZXN0IHBlbmFsdHkvbGFtYmRhIHZhbHVlLg0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRSwgbWF4LmhlaWdodD0nMTUwcHgnfQ0KDQp0b3BfcGVuYWx0eSA8LSB0dW5lOjpzaG93X2Jlc3QodHVuZV9yZXMsIG1ldHJpYyA9ICJyc3EiLCBuID0gNSkNCnRvcF9wZW5hbHR5DQoNCmJlc3RfcGVuYWx0eSA8LSB0dW5lOjpzZWxlY3RfYmVzdCh0dW5lX3JlcywgbWV0cmljID0gInJzcSIpDQpiZXN0X3BlbmFsdHkNCg0KYGBgDQoNCiMjIExhc3NvIG1vZGVsIHdpdGggb3B0aW1pc2VkIHBlbmFsdHkvbGFtYmRhIHZhbHVlDQoNCldlIGNyZWF0ZSB0aGUgbGFzc28gcmVncmVzc2lvbiB3b3JrZmxvdyB3aXRoIHRoZSBiZXN0IHBlbmFsdHkgc2NvcmUuDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFLCBtYXguaGVpZ2h0PScxNTBweCd9DQoNCmxhc3NvX2ZpbmFsIDwtIHR1bmU6OmZpbmFsaXplX3dvcmtmbG93KHggPSBsYXNzb193b3JrZmxvdywgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbWV0ZXJzID0gYmVzdF9wZW5hbHR5KQ0KDQpsYXNzb19maW5hbA0KYGBgDQoNCldlIG5vdyB0cmFpbiB0aGUgbGFzc28gcmVncmVzc2lvbiBtb2RlbCB3aXRoIHRoZSB0cmFpbmluZyBkYXRhDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KDQpsYXNzb19maW5hbF9maXQgPC0gcGFyc25pcDo6Zml0KG9iamVjdCA9IGxhc3NvX2ZpbmFsLCBkYXRhID0gSGl0dGVyc190cmFpbikNCmBgYA0KDQojIyBWYXJpYWJsZSBJbXBvcnRhbmNlDQoNCldoaWxlIHdl4oCZcmUgYXQgaXQsIGxldOKAmXMgc2VlIHdoYXQgdGhlIG1vc3QgaW1wb3J0YW50IHZhcmlhYmxlcyBhcmUgdXNpbmcgdGhlIGB2aXBgIHBhY2thZ2UuDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KDQp2aXBfdGFibGUgPC0gbGFzc29fZmluYWxfZml0ICU+JQ0KICB3b3JrZmxvd3M6OmV4dHJhY3RfZml0X3BhcnNuaXAoKSAlPiUNCiAgdmlwOjp2aShsYW1iZGEgPSBiZXN0X3BlbmFsdHkkcGVuYWx0eSkgDQoNCnZpcF90YWJsZSAlPiUNCiAgcmVhY3RhYmxlOjpyZWFjdGFibGUoZGVmYXVsdFBhZ2VTaXplID0gNSkNCmBgYA0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCnZpcF90YWJsZSAlPiUgDQogIGRwbHlyOjptdXRhdGUoDQogICAgSW1wb3J0YW5jZSA9IGFicyguZGF0YVtbIkltcG9ydGFuY2UiXV0pLA0KICAgIFZhcmlhYmxlID0gZm9yY2F0czo6ZmN0X3Jlb3JkZXIoLmYgPSAuZGF0YVtbIlZhcmlhYmxlIl1dLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC54ID0gLmRhdGFbWyJJbXBvcnRhbmNlIl1dKQ0KICApICU+JQ0KICBnZ3Bsb3QyOjpnZ3Bsb3QobWFwcGluZyA9IGdncGxvdDI6OmFlcyh4ID0gLmRhdGFbWyJJbXBvcnRhbmNlIl1dLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeSA9IC5kYXRhW1siVmFyaWFibGUiXV0sIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxsID0gLmRhdGFbWyJTaWduIl1dKSkgKw0KICBnZ3Bsb3QyOjpnZW9tX2NvbCgpICsNCiAgZ2dwbG90Mjo6c2NhbGVfeF9jb250aW51b3VzKGV4cGFuZCA9IGMoMCwgMCkpICsNCiAgZ2dwbG90Mjo6bGFicyh5ID0gTlVMTCkNCmBgYA0KDQojIyBMYXNzbyByZWdyZXNzaW9uIG1vZGVsIG9uIHRlc3QgZGF0YQ0KDQpUaGlzIGxhc3NvIHJlZ3Jlc3Npb24gbW9kZWwgY2FuIG5vdyBiZSBhcHBsaWVkIG9uIG91ciB0ZXN0aW5nIGRhdGEgc2V0IHRvIHZhbGlkYXRlIGl0cyBwZXJmb3JtYW5jZS4gRm9yIHJlZ3Jlc3Npb24gbW9kZWxzLCBhIC5wcmVkIGNvbHVtbiBpcyBhZGRlZC4NCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQoNCnRlc3RfcmVzdWx0cyA8LSBwYXJzbmlwOjphdWdtZW50KHggPSBsYXNzb19maW5hbF9maXQsIG5ld19kYXRhID0gSGl0dGVyc190ZXN0KQ0KICANCnRlc3RfcmVzdWx0cyAlPiUNCiAgcmVhY3RhYmxlOjpyZWFjdGFibGUoZGVmYXVsdFBhZ2VTaXplID0gNSkNCiAgDQpgYGANCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQp0ZXN0X3Jlc3VsdHMgJT4lDQogIHlhcmRzdGljazo6cnNxKHRydXRoID0gLmRhdGFbWyJTYWxhcnkiXV0sIGVzdGltYXRlID0gLmRhdGFbWyIucHJlZCJdXSkgJT4lDQogIHJlYWN0YWJsZTo6cmVhY3RhYmxlKGRlZmF1bHRQYWdlU2l6ZSA9IDUpDQpgYGANCg0KQWx0ZXJuYXRpdmVseSwgd2UgY2FuIHVzZSBgdHVuZTo6bGFzdF9maXRgIGFuZCBgdHVuZTo6Y29sbGVjdF9tZXRyaWNzYA0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCg0KdGVzdF9yZXN1bHRzIDwtIHR1bmU6Omxhc3RfZml0KG9iamVjdCA9IGxhc3NvX2ZpbmFsX2ZpdCwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BsaXQgPSBIaXR0ZXJzX3NwbGl0KSAlPiUNCiAgdHVuZTo6Y29sbGVjdF9tZXRyaWNzKCkNCiAgDQp0ZXN0X3Jlc3VsdHMgJT4lDQogIHJlYWN0YWJsZTo6cmVhY3RhYmxlKGRlZmF1bHRQYWdlU2l6ZSA9IDUpDQogIA0KYGBgDQoNCiMgUHJpbmNpcGFsIENvbXBvbmVudHMgUmVncmVzc2lvbg0KDQpUaGUgcHJpbmNpcGFsIGNvbXBvbmVudCByZWdyZXNzaW9uIGlzIGEgbGluZWFyIG1vZGVsIHdpdGggcGNhIHRyYW5zZm9ybWVkIGRhdGEuIEhlbmNlLCB0aGUgbWFqb3IgY2hhbmdlcyB3aWxsIGJlIG9uIHRoZSBwcmVwcm9jZXNzaW5nIHN0ZXBzLg0KDQojIyBDcmVhdGUgdGhlIHJlc2FtcGxlIG9iamVjdA0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCnNldC5zZWVkKDEyMzQpDQpIaXR0ZXJzIDwtIGFzX3RpYmJsZShJU0xSOjpIaXR0ZXJzKSAlPiUNCiAgdGlkeXI6OmRyb3BfbmEoKQ0KDQpIaXR0ZXJzX3NwbGl0IDwtIHJzYW1wbGU6OmluaXRpYWxfc3BsaXQoSGl0dGVycywgc3RyYXRhID0gIlNhbGFyeSIpDQoNCkhpdHRlcnNfdHJhaW4gPC0gcnNhbXBsZTo6dHJhaW5pbmcoSGl0dGVyc19zcGxpdCkNCkhpdHRlcnNfdGVzdCA8LSByc2FtcGxlOjp0ZXN0aW5nKEhpdHRlcnNfc3BsaXQpDQoNCkhpdHRlcnNfZm9sZCA8LSByc2FtcGxlOjp2Zm9sZF9jdihIaXR0ZXJzX3RyYWluLCB2ID0gMTApDQoNCmBgYA0KDQojIyBDcmVhdGUgdGhlIHByZXByb2Nlc3Nvcg0KDQpXZSBhZGQgW2ByZWNpcGVzOjpzdGVwX3BjYWBdKGh0dHBzOi8vcmVjaXBlcy50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2Uvc3RlcF9wY2EuaHRtbCkgdGhpcyB0aW1lIHRvIHBlcmZyb20gcHJpbmNpcGFsIGNvbXBvbmVudCBhbmFseXNpcyBvbiBhbGwgdGhlIHByZWRpY3RvcnMuDQpUaHJlc2hvbGQgaXMgdGhlIGZyYWN0aW9uIG9mIHRoZSB0b3RhbCB2YXJpYW5jZSB0aGF0IHNob3VsZCBiZSBjb3ZlcmVkIGJ5IHRoZSBjb21wb25lbnRzLiANCg0KRm9yIHRoZSBiZWxvdyBleGFtcGxlLCBgdGhyZXNob2xkID0gLjc1YCBtZWFucyB0aGF0IHN0ZXBfcGNhIHNob3VsZCBnZW5lcmF0ZSBlbm91Z2ggY29tcG9uZW50cyB0byBjYXB0dXJlIDc1IHBlcmNlbnQgb2YgdGhlIHZhcmlhYmlsaXR5IGluIHRoZSB2YXJpYWJsZXMuIE5vdGU6IHVzaW5nIHRoaXMgYXJndW1lbnQgd2lsbCBvdmVycmlkZSBhbmQgcmVzZXQgYW55IHZhbHVlIGdpdmVuIHRvIGBudW1fY29tcGAuDQoNCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQoNCnBjYV9yZWNpcGUgPC0gDQogIHJlY2lwZXM6OnJlY2lwZShmb3JtdWxhID0gU2FsYXJ5IH4gLiwgZGF0YSA9IEhpdHRlcnNfdHJhaW4pICU+JSANCiAgcmVjaXBlczo6c3RlcF9ub3ZlbChyZWNpcGVzOjphbGxfbm9taW5hbF9wcmVkaWN0b3JzKCkpICU+JSANCiAgcmVjaXBlczo6c3RlcF9kdW1teShyZWNpcGVzOjphbGxfbm9taW5hbF9wcmVkaWN0b3JzKCkpICU+JSANCiAgcmVjaXBlczo6c3RlcF96dihyZWNpcGVzOjphbGxfcHJlZGljdG9ycygpKSAlPiUgDQogIHJlY2lwZXM6OnN0ZXBfbm9ybWFsaXplKHJlY2lwZXM6OmFsbF9wcmVkaWN0b3JzKCkpICU+JQ0KICByZWNpcGVzOjpzdGVwX3BjYShyZWNpcGVzOjphbGxfcHJlZGljdG9ycygpLCB0aHJlc2hvbGQgPSAwLjc1KQ0KYGBgDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KDQpyZWMgPC0gcmVjaXBlczo6cHJlcCh4ID0gcGNhX3JlY2lwZSwgdHJhaW5pbmcgPSBIaXR0ZXJzX3RyYWluKQ0KICANCnJlYyAlPiUNCiAgc3VtbWFyeSgpICU+JQ0KICByZWFjdGFibGU6OnJlYWN0YWJsZShkZWZhdWx0UGFnZVNpemUgPSA1KQ0KDQpyZWMgJT4lDQogIHJlY2lwZXM6OmJha2UobmV3X2RhdGEgPSBIaXR0ZXJzX3RyYWluKSAlPiUNCiAgcmVhY3RhYmxlOjpyZWFjdGFibGUoZGVmYXVsdFBhZ2VTaXplID0gNSkNCg0KYGBgDQoNCldlIHdpbGwgbm93IHRyeSB0byBmaW5kIHRoZSBiZXN0IHRocmVzaG9sZCB2YWx1ZSB1c2luZyB0aGUgYHR1bmU6OnR1bmUoKWANCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQoNCnBjYV9yZWNpcGUgPC0gDQogIHJlY2lwZXM6OnJlY2lwZShmb3JtdWxhID0gU2FsYXJ5IH4gLiwgZGF0YSA9IEhpdHRlcnNfdHJhaW4pICU+JSANCiAgcmVjaXBlczo6c3RlcF9ub3ZlbChyZWNpcGVzOjphbGxfbm9taW5hbF9wcmVkaWN0b3JzKCkpICU+JSANCiAgcmVjaXBlczo6c3RlcF9kdW1teShyZWNpcGVzOjphbGxfbm9taW5hbF9wcmVkaWN0b3JzKCkpICU+JSANCiAgcmVjaXBlczo6c3RlcF96dihyZWNpcGVzOjphbGxfcHJlZGljdG9ycygpKSAlPiUgDQogIHJlY2lwZXM6OnN0ZXBfbm9ybWFsaXplKHJlY2lwZXM6OmFsbF9wcmVkaWN0b3JzKCkpICU+JQ0KICByZWNpcGVzOjpzdGVwX3BjYShyZWNpcGVzOjphbGxfcHJlZGljdG9ycygpLCB0aHJlc2hvbGQgPSB0dW5lOjp0dW5lKCkpDQpgYGANCg0KIyMgU3BlY2lmeSB0aGUgbW9kZWwNCg0KV2UgdXNlIGEgbGluZWFyIG1vZGVsDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KDQpsbV9zcGVjIDwtIA0KICBwYXJzbmlwOjpsaW5lYXJfcmVnKCkgJT4lIA0KICBwYXJzbmlwOjpzZXRfbW9kZSgicmVncmVzc2lvbiIpICU+JSANCiAgcGFyc25pcDo6c2V0X2VuZ2luZSgibG0iKQ0KDQpsbV9zcGVjICU+JQ0KICBwYXJzbmlwOjp0cmFuc2xhdGUoKQ0KDQpgYGANCg0KIyMgQ3JlYXRlIHRoZSB3b3JrZmxvdw0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRSwgbWF4LmhlaWdodD0nMTUwcHgnfQ0KDQpwY2Ffd29ya2Zsb3cgPC0gIHdvcmtmbG93czo6d29ya2Zsb3coKSAlPiUgDQogIHdvcmtmbG93czo6YWRkX3JlY2lwZShwY2FfcmVjaXBlKSAlPiUgDQogIHdvcmtmbG93czo6YWRkX21vZGVsKGxtX3NwZWMpDQoNCnBjYV93b3JrZmxvdw0KYGBgDQoNCiMjIENyZWF0ZSB0aGUgdGhyZXNob2xkIGdyaWQNCg0KQSB0aHJlc2hvbGQgZ3JpZCBvZiAkMTAkIG51bWJlcnMgZnJvbSAkMCQgdG8gJDEkIGlzIGNyZWF0ZWQuDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KZG9QYXJhbGxlbDo6cmVnaXN0ZXJEb1BhcmFsbGVsKCkNCg0KIyBDcmVhdGUgYSByYW5nZSBmcm9tIDEwDQp0aHJlc2hvbGRfZ3JpZCAgPC0gZGlhbHM6OmdyaWRfcmVndWxhcihkaWFsczo6dGhyZXNob2xkKHJhbmdlID0gYygwLCAxKSksIGxldmVscyA9IDEwKQ0KDQp0aHJlc2hvbGRfZ3JpZCAlPiUgDQogIHJlYWN0YWJsZTo6cmVhY3RhYmxlKGRlZmF1bHRQYWdlU2l6ZSA9IDUpDQpgYGANCg0KIyMgUHJpbmNpcGFsIGNvbXBvbmVudCByZWdyZXNzaW9uIG1vZGVsIGZpdHRpbmcgb24gY3Jvc3MgdmFsaWRhdGVkIGRhdGENCg0KTm93IHdlIGhhdmUgZXZlcnl0aGluZyB3ZSBuZWVkIGFuZCB3ZSBjYW4gZml0IGFsbCB0aGUgbW9kZWxzIG9uIHRoZSBjcm9zcyB2YWxpZGF0ZWQgZGF0YS4gTm90ZSB0aGF0IHRoaXMgcHJvY2VzcyBtYXkgdGFrZSBzb21lIHRpbWUuDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFLCBtYXguaGVpZ2h0PScxNTBweCd9DQoNCnR1bmVfcmVzIDwtIHR1bmU6OnR1bmVfZ3JpZCgNCiAgb2JqZWN0ID0gcGNhX3dvcmtmbG93LA0KICByZXNhbXBsZXMgPSBIaXR0ZXJzX2ZvbGQsIA0KICBncmlkID0gdGhyZXNob2xkX2dyaWQNCikNCg0KdHVuZV9yZXMNCmBgYA0KDQpIZXJlIHdlIHNlZSBob3cgZGlmZmVyZW50IHRocmVzaG9sZCAoVmFyaWFuY2UgY292ZXJhZ2UpIGFmZmVjdHMgdGhlIHBlcmZvcm1hbmNlIG1ldHJpY3MgZGlmZmVyZW50bHkuIERvIG5vdGUgdGhhdCB1c2luZyBhIGRpZmZlcmVudCBzZWVkIHdpbGwgZ2l2ZSBhIGRpZmZlcmVudCBwbG90DQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KIyBOb3RlIHRoYXQgYSBkaWZmZXJlbnQgc2VlZCB3aWxsIGdpdmUgZGlmZmVyZW50IHBsb3RzDQp0dW5lOjphdXRvcGxvdCh0dW5lX3JlcykNCmBgYA0KDQpUaGUg4oCcYmVzdOKAnSB2YWx1ZXMgb2YgdGhpcyBjYW4gYmUgc2VsZWN0ZWQgdXNpbmcgYHR1bmU6OnNlbGVjdF9iZXN0KClgLCB0aGlzIGZ1bmN0aW9uIHJlcXVpcmVzIHlvdSB0byBzcGVjaWZ5IGEgbWV0cmljIHRoYXQgaXQgc2hvdWxkIHNlbGVjdCBhZ2FpbnN0LiBUaGUgdGhyZXNob2xkIHZhbHVlIGlzIDAuODg5IGZvciBtZXRyaWMgYHJzbWVgIHNpbmNlIGl0IGdpdmVzIHRoZSBsb3dlc3QgdmFsdWUuIERvIG5vdGUgdGhhdCB1c2luZyBhIGRpZmZlcmVudCBzZWVkIHdpbGwgZ2l2ZSBhIGRpZmZlcmVudCBiZXN0IG51bWJlciBvZiB0aHJlc2hvbGQgdmFsdWUuDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFLCBtYXguaGVpZ2h0PScxNTBweCd9DQoNCnRvcF90aHJlc2hvbGQgPC0gdHVuZTo6c2hvd19iZXN0KHR1bmVfcmVzLCBtZXRyaWMgPSAicm1zZSIsIG4gPSA1KQ0KdG9wX3RocmVzaG9sZA0KDQpiZXN0X3RocmVzaG9sZCA8LSB0dW5lOjpzZWxlY3RfYmVzdCh0dW5lX3JlcywgbWV0cmljID0gInJtc2UiKQ0KYmVzdF90aHJlc2hvbGQNCg0KYGBgDQoNCiMjIFByaW5jaXBhbCBjb21wb25lbnQgcmVncmVzc2lvbiBtb2RlbCB3aXRoIG9wdGltaXNlZCB0aHJlc2hvbGQgdmFsdWUNCg0KV2UgY3JlYXRlIHRoZSBwcmluY2lwYWwgY29tcG9uZW50IHJlZ3Jlc3Npb24gd29ya2Zsb3cgd2l0aCB0aGUgYmVzdCB0aHJlc2hvbGQuDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFLCBtYXguaGVpZ2h0PScxNTBweCd9DQoNCnBjYV9maW5hbCA8LSB0dW5lOjpmaW5hbGl6ZV93b3JrZmxvdyh4ID0gcGNhX3dvcmtmbG93LCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbWV0ZXJzID0gYmVzdF90aHJlc2hvbGQpDQoNCnBjYV9maW5hbA0KYGBgDQoNCldlIG5vdyB0cmFpbiB0aGUgcHJpbmNpcGFsIGNvbXBvbmVudCByZWdyZXNzaW9uIG1vZGVsIHdpdGggdGhlIHRyYWluaW5nIGRhdGENCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQoNCnBjYV9maW5hbF9maXQgPC0gcGFyc25pcDo6Zml0KG9iamVjdCA9IHBjYV9maW5hbCwgZGF0YSA9IEhpdHRlcnNfdHJhaW4pDQpgYGANCg0KIyMgUHJpbmNpcGFsIGNvbXBvbmVudCByZWdyZXNzaW9uIG1vZGVsIG9uIHRlc3QgZGF0YQ0KDQpUaGlzIHByaW5jaXBhbCBjb21wb25lbnQgcmVncmVzc2lvbiBtb2RlbCBjYW4gbm93IGJlIGFwcGxpZWQgb24gb3VyIHRlc3RpbmcgZGF0YSBzZXQgdG8gdmFsaWRhdGUgaXRzIHBlcmZvcm1hbmNlLiBGb3IgcmVncmVzc2lvbiBtb2RlbHMsIGEgLnByZWQgY29sdW1uIGlzIGFkZGVkLg0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCg0KdGVzdF9yZXN1bHRzIDwtIHBhcnNuaXA6OmF1Z21lbnQoeCA9IHBjYV9maW5hbF9maXQsIG5ld19kYXRhID0gSGl0dGVyc190ZXN0KQ0KICANCnRlc3RfcmVzdWx0cyAlPiUNCiAgcmVhY3RhYmxlOjpyZWFjdGFibGUoZGVmYXVsdFBhZ2VTaXplID0gNSkNCiAgDQpgYGANCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQp0ZXN0X3Jlc3VsdHMgJT4lDQogIHlhcmRzdGljazo6cnNxKHRydXRoID0gLmRhdGFbWyJTYWxhcnkiXV0sIGVzdGltYXRlID0gLmRhdGFbWyIucHJlZCJdXSkgJT4lDQogIHJlYWN0YWJsZTo6cmVhY3RhYmxlKGRlZmF1bHRQYWdlU2l6ZSA9IDUpDQpgYGANCg0KQWx0ZXJuYXRpdmVseSwgd2UgY2FuIHVzZSBgdHVuZTo6bGFzdF9maXRgIGFuZCBgdHVuZTo6Y29sbGVjdF9tZXRyaWNzYA0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCg0KdGVzdF9yZXN1bHRzIDwtIHR1bmU6Omxhc3RfZml0KG9iamVjdCA9IHBjYV9maW5hbF9maXQsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwbGl0ID0gSGl0dGVyc19zcGxpdCkgJT4lDQogIHR1bmU6OmNvbGxlY3RfbWV0cmljcygpDQogIA0KdGVzdF9yZXN1bHRzICU+JQ0KICByZWFjdGFibGU6OnJlYWN0YWJsZShkZWZhdWx0UGFnZVNpemUgPSA1KQ0KICANCmBgYA0KDQojIFBhcnRpYWwgTGVhc3QgU3F1YXJlDQoNClRoZSBwYXJ0aWFsIGxlYXN0IHNxdWFyZSByZWdyZXNzaW9uIGlzIGEgbGluZWFyIG1vZGVsIHdpdGggcGxzIHRyYW5zZm9ybWVkIGRhdGEuIEhlbmNlLCB0aGUgbWFqb3IgY2hhbmdlcyB3aWxsIGJlIG9uIHRoZSBwcmVwcm9jZXNzaW5nIHN0ZXBzLg0KDQojIyBDcmVhdGUgdGhlIHJlc2FtcGxlIG9iamVjdA0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCnNldC5zZWVkKDEyMzQpDQpIaXR0ZXJzIDwtIGFzX3RpYmJsZShJU0xSOjpIaXR0ZXJzKSAlPiUNCiAgdGlkeXI6OmRyb3BfbmEoKQ0KDQpIaXR0ZXJzX3NwbGl0IDwtIHJzYW1wbGU6OmluaXRpYWxfc3BsaXQoSGl0dGVycywgc3RyYXRhID0gIlNhbGFyeSIpDQoNCkhpdHRlcnNfdHJhaW4gPC0gcnNhbXBsZTo6dHJhaW5pbmcoSGl0dGVyc19zcGxpdCkNCkhpdHRlcnNfdGVzdCA8LSByc2FtcGxlOjp0ZXN0aW5nKEhpdHRlcnNfc3BsaXQpDQoNCkhpdHRlcnNfZm9sZCA8LSByc2FtcGxlOjp2Zm9sZF9jdihIaXR0ZXJzX3RyYWluLCB2ID0gMTApDQoNCmBgYA0KDQojIyBDcmVhdGUgdGhlIHByZXByb2Nlc3Nvcg0KDQpXZSBhZGQgW2ByZWNpcGVzOjpzdGVwX3Bsc2BdKGh0dHBzOi8vcmVjaXBlcy50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2Uvc3RlcF9wbHMuaHRtbCkgdGhpcyB0aW1lIHRvIHBlcmZvcm0gcGFydGlhbCBsZWFzdCBzcXVhcmUgY2FsY3VsYXRpb24gb24gYWxsIHRoZSBwcmVkaWN0b3JzLg0KYG51bV9jb21wYCBpcyB0aGUgbnVtYmVyIG9mIHBhcnRpYWwgbGVhc3Qgc3F1YXJlIGNvbXBvbmVudHMgdG8gcmV0YWluIGFzIG5ldyBwcmVkaWN0b3JzLg0KYG91dGNvbWVgIGlzIHRoZSByZXNwb25zZSB2YXJpYWJsZSBmb3IgcGFydGlhbCBsZWFzdCBzcXVhcmUgcmVncmVzc2lvbiB0byB1c2UuDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KDQpwbHNfcmVjaXBlIDwtIA0KICByZWNpcGVzOjpyZWNpcGUoZm9ybXVsYSA9IFNhbGFyeSB+IC4sIGRhdGEgPSBIaXR0ZXJzX3RyYWluKSAlPiUgDQogIHJlY2lwZXM6OnN0ZXBfbm92ZWwocmVjaXBlczo6YWxsX25vbWluYWxfcHJlZGljdG9ycygpKSAlPiUgDQogIHJlY2lwZXM6OnN0ZXBfZHVtbXkocmVjaXBlczo6YWxsX25vbWluYWxfcHJlZGljdG9ycygpKSAlPiUgDQogIHJlY2lwZXM6OnN0ZXBfenYocmVjaXBlczo6YWxsX3ByZWRpY3RvcnMoKSkgJT4lIA0KICByZWNpcGVzOjpzdGVwX25vcm1hbGl6ZShyZWNpcGVzOjphbGxfcHJlZGljdG9ycygpKSAlPiUNCiAgcmVjaXBlczo6c3RlcF9wbHMocmVjaXBlczo6YWxsX3ByZWRpY3RvcnMoKSwgbnVtX2NvbXAgPSA0LCBvdXRjb21lID0gIlNhbGFyeSIpDQpgYGANCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQoNCnJlYyA8LSByZWNpcGVzOjpwcmVwKHggPSBwbHNfcmVjaXBlLCB0cmFpbmluZyA9IEhpdHRlcnNfdHJhaW4pDQogIA0KcmVjICU+JQ0KICBzdW1tYXJ5KCkgJT4lDQogIHJlYWN0YWJsZTo6cmVhY3RhYmxlKGRlZmF1bHRQYWdlU2l6ZSA9IDUpDQoNCnJlYyAlPiUNCiAgcmVjaXBlczo6YmFrZShuZXdfZGF0YSA9IEhpdHRlcnNfdHJhaW4pICU+JQ0KICByZWFjdGFibGU6OnJlYWN0YWJsZShkZWZhdWx0UGFnZVNpemUgPSA1KQ0KDQpgYGANCg0KV2Ugd2lsbCBub3cgdHJ5IHRvIGZpbmQgdGhlIGJlc3QgdGhyZXNob2xkIHZhbHVlIHVzaW5nIHRoZSBgdHVuZTo6dHVuZSgpYA0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCg0KcGxzX3JlY2lwZSA8LSANCiAgcmVjaXBlczo6cmVjaXBlKGZvcm11bGEgPSBTYWxhcnkgfiAuLCBkYXRhID0gSGl0dGVyc190cmFpbikgJT4lIA0KICByZWNpcGVzOjpzdGVwX25vdmVsKHJlY2lwZXM6OmFsbF9ub21pbmFsX3ByZWRpY3RvcnMoKSkgJT4lIA0KICByZWNpcGVzOjpzdGVwX2R1bW15KHJlY2lwZXM6OmFsbF9ub21pbmFsX3ByZWRpY3RvcnMoKSkgJT4lIA0KICByZWNpcGVzOjpzdGVwX3p2KHJlY2lwZXM6OmFsbF9wcmVkaWN0b3JzKCkpICU+JSANCiAgcmVjaXBlczo6c3RlcF9ub3JtYWxpemUocmVjaXBlczo6YWxsX3ByZWRpY3RvcnMoKSkgJT4lDQogIHJlY2lwZXM6OnN0ZXBfcGxzKHJlY2lwZXM6OmFsbF9wcmVkaWN0b3JzKCksIG51bV9jb21wID0gdHVuZTo6dHVuZSgpICwgb3V0Y29tZSA9ICJTYWxhcnkiKQ0KYGBgDQoNCiMjIFNwZWNpZnkgdGhlIG1vZGVsDQoNCldlIHVzZSBhIGxpbmVhciBtb2RlbA0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCg0KbG1fc3BlYyA8LSANCiAgcGFyc25pcDo6bGluZWFyX3JlZygpICU+JSANCiAgcGFyc25pcDo6c2V0X21vZGUoInJlZ3Jlc3Npb24iKSAlPiUgDQogIHBhcnNuaXA6OnNldF9lbmdpbmUoImxtIikNCg0KbG1fc3BlYyAlPiUNCiAgcGFyc25pcDo6dHJhbnNsYXRlKCkNCg0KYGBgDQoNCiMjIENyZWF0ZSB0aGUgd29ya2Zsb3cNCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0UsIG1heC5oZWlnaHQ9JzE1MHB4J30NCg0KcGxzX3dvcmtmbG93IDwtICB3b3JrZmxvd3M6OndvcmtmbG93KCkgJT4lIA0KICB3b3JrZmxvd3M6OmFkZF9yZWNpcGUocGxzX3JlY2lwZSkgJT4lIA0KICB3b3JrZmxvd3M6OmFkZF9tb2RlbChsbV9zcGVjKQ0KDQpwbHNfd29ya2Zsb3cNCmBgYA0KDQojIyBDcmVhdGUgdGhlIHRocmVzaG9sZCBncmlkDQoNCkEgbnVtYmVyIG9mIGNvbXBvbmVudHMgZ3JpZCBvZiAkMTAkIG51bWJlcnMgZnJvbSAkMSQgdG8gJDIwJCBpcyBjcmVhdGVkLg0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCmRvUGFyYWxsZWw6OnJlZ2lzdGVyRG9QYXJhbGxlbCgpDQoNCiMgQ3JlYXRlIGEgcmFuZ2UgZnJvbSAxMA0KbnVtX2NvbXBfZ3JpZCAgPC0gZGlhbHM6OmdyaWRfcmVndWxhcihkaWFsczo6bnVtX2NvbXAocmFuZ2UgPSBjKDEsIDIwKSksIGxldmVscyA9IDEwKQ0KDQpudW1fY29tcF9ncmlkICU+JSANCiAgcmVhY3RhYmxlOjpyZWFjdGFibGUoZGVmYXVsdFBhZ2VTaXplID0gNSkNCmBgYA0KDQojIyBQYXJ0aWFsIGxlYXN0IHNxdWFyZSByZWdyZXNzaW9uIG1vZGVsIGZpdHRpbmcgb24gY3Jvc3MgdmFsaWRhdGVkIGRhdGENCg0KTm93IHdlIGhhdmUgZXZlcnl0aGluZyB3ZSBuZWVkIGFuZCB3ZSBjYW4gZml0IGFsbCB0aGUgbW9kZWxzIG9uIHRoZSBjcm9zcyB2YWxpZGF0ZWQgZGF0YS4gTm90ZSB0aGF0IHRoaXMgcHJvY2VzcyBtYXkgdGFrZSBzb21lIHRpbWUuDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFLCBtYXguaGVpZ2h0PScxNTBweCd9DQoNCnR1bmVfcmVzIDwtIHR1bmU6OnR1bmVfZ3JpZCgNCiAgb2JqZWN0ID0gcGxzX3dvcmtmbG93LA0KICByZXNhbXBsZXMgPSBIaXR0ZXJzX2ZvbGQsIA0KICBncmlkID0gbnVtX2NvbXBfZ3JpZA0KKQ0KDQp0dW5lX3Jlcw0KYGBgDQoNCkhlcmUgd2Ugc2VlIGhvdyBkaWZmZXJlbnQgbnVtYmVyIG9mIGNvbXBvbmVudHMgYWZmZWN0cyB0aGUgcGVyZm9ybWFuY2UgbWV0cmljcyBkaWZmZXJlbnRseS4gRG8gbm90ZSB0aGF0IHVzaW5nIGEgZGlmZmVyZW50IHNlZWQgd2lsbCBnaXZlIGEgZGlmZmVyZW50IHBsb3QNCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQojIE5vdGUgdGhhdCBhIGRpZmZlcmVudCBzZWVkIHdpbGwgZ2l2ZSBkaWZmZXJlbnQgcGxvdHMNCnR1bmU6OmF1dG9wbG90KHR1bmVfcmVzKQ0KYGBgDQoNClRoZSDigJxiZXN04oCdIHZhbHVlcyBvZiB0aGlzIGNhbiBiZSBzZWxlY3RlZCB1c2luZyBgdHVuZTo6c2VsZWN0X2Jlc3QoKWAsIHRoaXMgZnVuY3Rpb24gcmVxdWlyZXMgeW91IHRvIHNwZWNpZnkgYSBtZXRyaWMgdGhhdCBpdCBzaG91bGQgc2VsZWN0IGFnYWluc3QuIFRoZSBudW1iZXIgb2YgY29tcG9uZW50cyB2YWx1ZSBpcyAwLjg4OSBmb3IgbWV0cmljIGByc21lYCBzaW5jZSBpdCBnaXZlcyB0aGUgbG93ZXN0IHZhbHVlLiBEbyBub3RlIHRoYXQgdXNpbmcgYSBkaWZmZXJlbnQgc2VlZCB3aWxsIGdpdmUgYSBkaWZmZXJlbnQgYmVzdCBudW1iZXIgb2YgY29tcG9uZW50cyB2YWx1ZS4NCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0UsIG1heC5oZWlnaHQ9JzE1MHB4J30NCg0KdG9wX251bV9jb21wIDwtIHR1bmU6OnNob3dfYmVzdCh0dW5lX3JlcywgbWV0cmljID0gInJtc2UiLCBuID0gNSkNCnRvcF9udW1fY29tcA0KDQpiZXN0X251bV9jb21wIDwtIHR1bmU6OnNlbGVjdF9iZXN0KHR1bmVfcmVzLCBtZXRyaWMgPSAicm1zZSIpDQpiZXN0X251bV9jb21wDQoNCmBgYA0KDQojIyBQYXJ0aWFsIGxlYXN0IHNxdWFyZSBtb2RlbCB3aXRoIG9wdGltaXNlZCB0aHJlc2hvbGQgdmFsdWUNCg0KV2UgY3JlYXRlIHRoZSBwYXJ0aWFsIGxlYXN0IHNxdWFyZSByZWdyZXNzaW9uIHdvcmtmbG93IHdpdGggdGhlIGJlc3QgdGhyZXNob2xkLg0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRSwgbWF4LmhlaWdodD0nMTUwcHgnfQ0KDQpwbHNfZmluYWwgPC0gdHVuZTo6ZmluYWxpemVfd29ya2Zsb3coeCA9IHBsc193b3JrZmxvdywgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1ldGVycyA9IGJlc3RfbnVtX2NvbXApDQoNCnBsc19maW5hbA0KYGBgDQoNCldlIG5vdyB0cmFpbiB0aGUgcGFydGlhbCBsZWFzdCBzcXVhcmUgcmVncmVzc2lvbiBtb2RlbCB3aXRoIHRoZSB0cmFpbmluZyBkYXRhLg0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCg0KcGxzX2ZpbmFsX2ZpdCA8LSBwYXJzbmlwOjpmaXQob2JqZWN0ID0gcGxzX2ZpbmFsLCBkYXRhID0gSGl0dGVyc190cmFpbikNCmBgYA0KDQojIyBQYXJ0aWFsIGxlYXN0IHNxdWFyZSByZWdyZXNzaW9uIG1vZGVsIG9uIHRlc3QgZGF0YQ0KDQpUaGlzIHBhcnRpYWwgbGVhc3Qgc3F1YXJlIHJlZ3Jlc3Npb24gbW9kZWwgY2FuIG5vdyBiZSBhcHBsaWVkIG9uIG91ciB0ZXN0aW5nIGRhdGEgc2V0IHRvIHZhbGlkYXRlIGl0cyBwZXJmb3JtYW5jZS4gRm9yIHJlZ3Jlc3Npb24gbW9kZWxzLCBhIC5wcmVkIGNvbHVtbiBpcyBhZGRlZC4NCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQoNCnRlc3RfcmVzdWx0cyA8LSBwYXJzbmlwOjphdWdtZW50KHggPSBwbHNfZmluYWxfZml0LCBuZXdfZGF0YSA9IEhpdHRlcnNfdGVzdCkNCiAgDQp0ZXN0X3Jlc3VsdHMgJT4lDQogIHJlYWN0YWJsZTo6cmVhY3RhYmxlKGRlZmF1bHRQYWdlU2l6ZSA9IDUpDQogIA0KYGBgDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KdGVzdF9yZXN1bHRzICU+JQ0KICB5YXJkc3RpY2s6OnJzcSh0cnV0aCA9IC5kYXRhW1siU2FsYXJ5Il1dLCBlc3RpbWF0ZSA9IC5kYXRhW1siLnByZWQiXV0pICU+JQ0KICByZWFjdGFibGU6OnJlYWN0YWJsZShkZWZhdWx0UGFnZVNpemUgPSA1KQ0KYGBgDQoNCkFsdGVybmF0aXZlbHksIHdlIGNhbiB1c2UgYHR1bmU6Omxhc3RfZml0YCBhbmQgYHR1bmU6OmNvbGxlY3RfbWV0cmljc2ANCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQoNCnRlc3RfcmVzdWx0cyA8LSB0dW5lOjpsYXN0X2ZpdChvYmplY3QgPSBwbHNfZmluYWxfZml0LCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcGxpdCA9IEhpdHRlcnNfc3BsaXQpICU+JQ0KICB0dW5lOjpjb2xsZWN0X21ldHJpY3MoKQ0KICANCnRlc3RfcmVzdWx0cyAlPiUNCiAgcmVhY3RhYmxlOjpyZWFjdGFibGUoZGVmYXVsdFBhZ2VTaXplID0gNSkNCiAgDQpgYGANCg0KIyBSbWFya2Rvd24gVGVtcGxhdGUNCg0KVGhpcyBSbWFya2Rvd24gdGVtcGxhdGUgaXMgY3JlYXRlZCBieSB0aGUgW1JlYWxpdHkgQmVuZGluZyBMYWJdKGh0dHBzOi8vcmVhbGl0eWJlbmRpbmcuZ2l0aHViLmlvLykuIFRoZSB0ZW1wbGF0ZSBjYW4gYmUgZG93bmxvYWQgZnJvbSB0aGUgbGFiJ3MgW2dpdGh1Yl0oaHR0cHM6Ly9naXRodWIuY29tL1JlYWxpdHlCZW5kaW5nL1RlbXBsYXRlUmVzdWx0cykgcmVwb3NpdG9yeS4gRm9yIG1vcmUgaW5mb3JtYXRpb24gYWJvdXQgdGhlIG1vdGl2YXRpb24gYmVoaW5kIGNyZWF0aW5nIHRoaXMgdGVtcGxhdGUsIGNoZWNrIG91dCBbRHIuIERvbWluaXF1ZSBNYWtvd3NraSdzIGJsb2cgcG9zdF0oaHR0cHM6Ly9kb21pbmlxdWVtYWtvd3NraS5naXRodWIuaW8vcG9zdC8yMDIxLTAyLTEwLXRlbXBsYXRlX3Jlc3VsdHMvKQ0KDQojIFBhY2thZ2UgUmVmZXJlbmNlcw0KYGBge3Igd2FybmluZz1GQUxTRSwgbWVzc2FnZT1UUlVFLCByZXN1bHRzPSdhc2lzJ30NCnJlcG9ydDo6Y2l0ZV9wYWNrYWdlcyhzZXNzaW9uSW5mbygpKQ0KYGBgDQo=</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("Chapter6_Lab.Rmd");
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
