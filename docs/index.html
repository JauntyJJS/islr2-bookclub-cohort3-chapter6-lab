<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Jeremy Selva" />


<title>Chapter 6 Lab</title>

<script src="rmarkdown_libs/header-attrs-2.13/header-attrs.js"></script>
<script src="rmarkdown_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="rmarkdown_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="rmarkdown_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="rmarkdown_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="rmarkdown_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="rmarkdown_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="rmarkdown_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="rmarkdown_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="rmarkdown_libs/navigation-1.1/tabsets.js"></script>
<script src="rmarkdown_libs/navigation-1.1/codefolding.js"></script>
<script src="rmarkdown_libs/navigation-1.1/sourceembed.js"></script>
<script src="rmarkdown_libs/clipboard-2.0.6/clipboard.min.js"></script>
<link href="rmarkdown_libs/xaringanExtra-clipboard-0.2.6/xaringanExtra-clipboard.css" rel="stylesheet" />
<script src="rmarkdown_libs/xaringanExtra-clipboard-0.2.6/xaringanExtra-clipboard.js"></script>
<script>window.xaringanExtraClipboard(null, {"button":"<i class=\"fa fa-clipboard\"><\/i> Copy Code","success":"<i class=\"fa fa-check\" style=\"color: #90BE6D\"><\/i> Copied!","error":"Press Ctrl+C to Copy"})</script>
<link href="rmarkdown_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="rmarkdown_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<script src="rmarkdown_libs/core-js-2.5.3/shim.min.js"></script>
<script src="rmarkdown_libs/react-17.0.0/react.min.js"></script>
<script src="rmarkdown_libs/react-17.0.0/react-dom.min.js"></script>
<script src="rmarkdown_libs/reactwidget-1.0.0/react-tools.js"></script>
<script src="rmarkdown_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="rmarkdown_libs/reactable-binding-0.2.3/reactable.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>


<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>





<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore"><strong>Chapter 6 Lab</strong></h1>
<h3 class="subtitle">This document was prepared on 2022-04-17.</h3>
<h4 class="author">Jeremy Selva</h4>

</div>


<!-- 
!!!! IMPORTANT: run `source("utils/render.R")` to publish instead of clicking on 'Knit'
# See https://yihui.org/knitr/options/
-->
<div class="sourceCode" id="cb1"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rmarkdown stuff</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rmarkdown, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(htmltools, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(styler, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xaringanExtra, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Dataset</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR2, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Session info and package reporting</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(report, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Data wrangling</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Create interactive tables</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reactable, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co"># For plotting</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidytext, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="co"># For parallel processing for tuning</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(foreach, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(doParallel, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="co"># For applying tidymodels</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rsample, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parsnip, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(recipes, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dials, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tune, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(workflows, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(yardstick, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="co"># For subset selection</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaps, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="co"># For ridge regression and lasso</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a><span class="co"># For partial least square regression</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a><span class="co"># In recipes::step_pls</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Warning message:</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="co">#  `step_pls()` failed: Error in loadNamespace(x) : there is no package called ‘mixOmics’</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Install from Bioconductor</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mixOmics, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a><span class="co"># For variable importance</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vip, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(report<span class="sc">::</span><span class="fu">report</span>(<span class="fu">sessionInfo</span>()))</span></code></pre></div>
<p>The analysis was done using the R Statistical language (v4.1.3; R Core Team, 2022) on Windows 10 x64, using the packages vip (v0.3.2), broom (v0.7.12), workflows (v0.2.6), Matrix (v1.4.0), ISLR2 (v1.3.1), xaringanExtra (v0.5.5), reactable (v0.2.3), ggplot2 (v3.3.5), forcats (v0.5.1), scales (v1.1.1), tidyr (v1.2.0), dplyr (v1.0.8), glmnet (v4.1.3), rmarkdown (v2.13), htmltools (v0.5.2), rsample (v0.1.1), styler (v1.7.0), report (v0.5.1), tune (v0.2.0), yardstick (v0.0.9), parsnip (v0.2.1), recipes (v0.2.0), dials (v0.1.0), foreach (v1.5.2), doParallel (v1.0.17), iterators (v1.0.14), mixOmics (v6.18.1), lattice (v0.20.45), tidytext (v0.3.2), magrittr (v2.0.2), leaps (v3.1), MASS (v7.3.55) and knitr (v1.38).</p>
<div id="subset-selection-methods" class="section level1">
<h1>Subset Selection Methods</h1>
<div id="best-subset-selection" class="section level2">
<h2>Best Subset Selection</h2>
<p>We will be using the <a href="https://rdrr.io/cran/ISLR2/man/Hitters.html"><code>Hitters</code></a> data set from the <code>ISLR2</code> package. We wish to predict the baseball players <code>Salary</code> based on several different characteristics which are included in the data set.</p>
<p>Remove all rows with missing data from that column.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>Hitters <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">as_tibble</span>(ISLR2<span class="sc">::</span>Hitters) <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">drop_na</span>()</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>Hitters <span class="sc">%&gt;%</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">defaultPageSize =</span> <span class="dv">5</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">filterable =</span> <span class="cn">TRUE</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div id="htmlwidget-d69e41576558348d25a4" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-d69e41576558348d25a4">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"AtBat":[315,479,496,321,594,185,298,323,401,574,202,418,239,196,568,190,127,413,426,472,629,587,324,474,550,513,419,583,204,379,268,181,217,254,416,205,526,457,214,591,403,405,244,313,627,416,155,236,216,585,199,521,311,512,507,529,424,351,388,339,255,677,614,329,637,280,155,458,314,475,317,511,382,565,415,424,495,233,566,641,215,441,325,490,574,596,472,283,408,327,370,354,539,340,510,282,380,584,570,306,220,278,445,143,185,589,343,438,600,663,232,479,528,160,599,497,210,151,278,341,537,399,309,616,579,165,618,257,315,591,404,315,429,453,184,591,181,441,490,551,550,283,560,328,586,503,344,680,279,484,431,283,491,199,589,327,464,338,584,216,625,489,209,407,490,442,288,209,303,330,504,258,20,374,211,299,576,381,288,369,547,572,514,359,526,313,540,437,237,236,473,309,271,357,216,256,466,327,341,608,419,376,486,246,205,348,523,312,496,126,275,627,394,208,382,459,549,288,522,512,220,522,461,581,530,557,439,453,528,633,562,281,593,687,368,263,642,265,559,520,19,205,193,213,510,578,441,172,127,279,480,600,610,360,387,580,408,593,497,492,475,573,631],"Hits":[81,130,141,87,169,37,73,81,92,159,53,113,60,43,158,46,32,92,109,116,168,163,73,129,152,137,108,168,49,106,60,41,46,68,132,57,146,101,53,168,101,102,58,78,177,113,44,56,53,139,53,142,81,131,122,137,119,97,103,96,70,238,163,83,174,82,41,114,83,123,78,138,119,148,115,110,151,49,154,198,51,128,76,125,152,171,118,77,94,85,96,77,139,84,126,78,120,158,169,104,54,70,99,39,40,170,103,103,144,200,55,133,132,39,183,136,70,41,86,95,147,102,94,163,174,39,200,66,76,157,92,73,91,101,47,184,58,118,150,171,147,74,161,91,159,136,85,223,64,127,127,70,141,52,149,84,128,92,157,54,179,131,56,93,148,131,65,54,71,77,120,60,1,94,43,75,167,110,76,93,137,152,144,80,163,83,135,123,52,56,154,72,77,96,56,70,108,68,110,160,101,82,145,76,52,90,135,68,119,27,68,178,86,57,101,113,149,63,163,117,66,140,112,145,159,142,96,103,122,210,169,76,152,213,103,70,211,68,141,120,4,43,47,61,147,138,113,42,32,69,112,139,186,81,124,207,117,172,127,136,126,144,170],"HmRun":[7,18,20,10,4,1,0,6,17,21,4,13,0,7,20,2,8,16,3,16,18,4,4,10,6,20,6,17,6,10,5,1,7,2,7,8,13,14,2,19,12,18,9,6,25,24,6,0,1,31,5,20,3,26,29,26,6,4,15,4,7,31,29,9,31,16,12,13,13,27,7,25,13,24,27,15,17,2,22,31,4,16,16,24,31,34,12,14,4,3,21,16,5,11,2,13,5,15,21,14,10,7,1,5,4,40,6,2,33,29,9,10,21,8,10,7,13,4,4,6,23,3,5,27,7,2,20,5,13,16,11,5,12,3,5,20,6,28,21,13,29,4,26,12,12,5,24,31,0,20,8,8,11,9,21,22,28,18,20,2,4,19,12,8,14,18,8,3,3,19,28,8,0,5,10,6,8,9,7,9,2,18,0,15,12,9,30,9,0,6,6,0,5,7,4,13,33,13,9,28,18,21,11,5,8,11,8,2,8,3,5,14,1,8,16,20,7,3,9,29,5,16,18,17,3,21,0,8,1,6,17,3,23,10,3,1,14,8,2,17,1,2,10,4,10,1,5,3,4,4,18,0,19,5,1,8,11,22,7,5,3,9,9],"Runs":[24,66,65,39,74,23,24,26,49,107,31,48,30,29,89,24,16,72,55,60,73,92,32,50,92,90,55,83,23,38,24,15,32,28,57,34,71,42,30,80,45,49,28,32,98,58,21,27,31,93,29,67,42,69,78,86,57,55,59,37,49,117,89,50,89,44,21,67,39,76,35,76,54,90,97,70,61,41,76,101,19,70,33,81,91,91,63,45,42,30,49,36,93,62,42,37,54,70,72,50,30,22,46,18,23,107,48,65,85,108,34,48,61,18,80,58,32,26,33,48,58,56,37,83,67,13,98,31,35,90,54,23,41,46,20,83,34,84,69,94,85,34,89,51,72,62,69,119,31,66,77,33,77,26,89,53,67,42,95,27,94,77,22,47,64,68,30,25,18,47,71,28,0,36,26,38,89,61,34,43,58,105,67,45,88,43,82,62,15,41,61,33,35,50,22,42,75,42,45,130,65,42,51,35,31,50,52,32,57,8,42,68,38,32,50,59,73,25,82,54,20,73,54,66,82,58,44,53,67,91,88,42,69,91,48,26,107,26,48,53,2,24,21,17,56,56,76,17,14,35,50,94,107,37,67,107,66,82,65,76,61,85,77],"RBI":[38,72,78,42,51,8,24,32,66,75,26,61,11,27,75,8,22,48,43,62,102,51,18,56,37,95,36,80,25,60,25,21,19,26,49,32,70,63,29,72,53,85,25,41,81,69,23,15,15,94,22,86,30,96,85,97,46,29,47,29,35,113,83,39,116,45,29,57,46,93,35,96,58,104,71,47,84,23,84,108,18,73,52,105,101,108,54,47,36,44,46,55,58,33,44,51,51,84,88,58,39,37,24,30,11,108,36,32,117,121,23,72,74,31,74,38,51,21,38,42,88,34,32,107,78,9,110,26,60,78,49,37,42,43,28,79,23,86,58,83,91,29,96,43,79,48,64,96,26,65,45,37,47,28,86,62,94,60,73,25,60,55,36,30,78,77,36,14,30,53,71,33,0,26,35,23,49,45,37,42,47,49,54,48,50,41,88,55,25,19,48,31,29,45,18,36,86,29,49,74,58,60,76,39,27,45,44,22,33,10,42,76,28,25,55,57,47,33,46,88,28,77,54,68,50,81,36,33,45,56,73,25,75,65,28,23,59,30,61,44,3,17,29,22,52,59,52,14,25,31,71,29,98,44,27,71,41,100,48,50,43,60,44],"Walks":[39,76,37,30,35,21,7,8,65,59,27,47,22,30,73,15,14,65,62,74,40,70,22,40,81,90,22,56,12,30,15,33,9,22,33,9,84,22,23,39,39,20,35,12,70,16,15,11,22,62,21,45,26,52,91,97,13,39,39,23,43,53,75,56,56,47,22,48,16,72,32,61,36,77,68,36,78,18,43,41,11,80,37,62,64,52,30,26,66,20,60,41,69,47,35,29,31,42,38,25,31,18,29,15,18,69,40,71,65,32,45,55,41,22,32,26,28,19,45,20,47,34,26,32,58,16,62,32,25,26,18,16,57,61,18,38,22,68,35,94,71,22,66,33,53,83,88,34,30,67,58,27,37,21,64,38,52,21,63,33,65,34,19,30,49,33,27,12,36,27,54,18,0,62,39,26,57,32,15,49,12,65,79,63,77,30,55,40,30,21,29,26,33,39,15,44,72,45,46,89,92,35,40,13,17,43,52,24,21,5,61,46,36,18,22,68,42,16,62,43,13,60,35,21,47,23,65,52,51,59,53,20,53,27,54,30,52,29,73,21,1,20,24,3,53,34,76,15,12,32,44,60,74,37,36,105,34,57,37,94,52,78,31],"Years":[14,3,11,2,11,2,3,2,13,10,9,4,6,13,15,5,8,1,1,6,18,6,7,10,5,14,3,5,7,14,2,2,4,6,3,5,6,17,2,9,12,6,4,12,6,1,16,4,4,17,3,4,17,14,18,15,9,4,6,4,15,5,11,9,14,2,16,4,5,4,1,3,12,14,3,7,10,8,14,5,1,14,5,13,3,6,4,16,9,8,15,20,5,5,11,5,8,5,7,7,5,18,4,9,3,6,15,2,2,4,12,17,6,14,5,11,15,2,1,10,10,5,13,3,6,3,13,14,3,4,6,4,13,3,11,5,1,8,14,13,6,10,4,2,9,10,7,3,1,7,2,12,15,6,7,10,13,3,10,1,5,7,2,2,13,6,9,1,3,6,3,3,2,7,3,3,4,7,4,5,2,2,9,7,4,14,1,9,24,5,6,5,12,5,12,16,3,18,9,8,20,5,11,6,12,10,9,1,7,4,6,6,4,3,1,12,1,10,13,6,3,4,2,2,6,18,4,2,4,6,8,8,6,4,8,4,5,7,8,4,1,7,6,17,7,3,5,10,19,4,7,2,6,7,7,5,1,1,5,12,6,8,11],"CAtBat":[3449,1624,5628,396,4408,214,509,341,5206,4631,1876,1512,1941,3231,8068,479,727,413,426,1924,8424,2695,1931,2331,2308,5201,591,1646,1309,6207,350,232,694,999,932,756,2648,6521,226,4478,5150,950,1335,3742,3210,416,6631,1115,926,7546,514,815,8247,5347,7761,6661,3651,1258,2174,1064,6311,2223,5017,3828,6727,428,5409,1350,1457,1810,317,592,2133,7287,711,2130,5624,1350,6100,2129,215,6675,1506,6063,985,2862,793,6840,3573,2140,6986,8716,1469,1516,5562,1649,3118,2358,3754,2954,1185,7186,618,639,524,2325,4338,440,696,1447,4405,7472,2641,2128,2482,3871,4040,288,278,2964,2744,670,4618,1437,3053,196,7127,3910,630,2020,1354,450,5590,948,3327,1689,181,2723,6126,6090,2816,3919,1789,342,3082,3423,911,1928,279,3006,667,4479,4291,805,3558,4273,5829,682,4704,216,1696,2051,216,969,3400,1416,2815,209,344,1928,1085,638,41,1968,498,580,822,3015,1644,1258,1038,978,4739,1493,1556,5885,540,4139,14053,1257,1966,354,4933,1394,2796,7058,652,3949,2331,4071,9528,1770,3967,912,5134,2288,3368,312,3358,239,961,3146,1089,653,382,5348,549,2682,7037,1750,290,730,680,831,1619,8759,711,507,1716,3070,3181,2658,2765,1518,1897,888,2364,1337,3162,927,19,854,1136,4061,2872,1399,1546,4086,8396,1359,3031,1236,2728,2268,1775,2778,408,593,2703,5511,1700,3198,4908],"CHits":[835,457,1575,101,1133,42,108,86,1332,1300,467,392,510,825,2273,102,180,92,109,489,2464,747,491,604,633,1382,149,452,308,1906,78,50,160,236,273,192,715,1767,59,1307,1429,231,333,968,927,113,1634,270,210,1982,120,205,2198,1397,1947,1785,1046,353,555,290,1661,737,1388,948,2024,113,1338,298,405,471,78,164,594,2083,184,544,1679,336,1583,610,51,2095,351,1646,260,728,187,1910,866,568,1972,2172,369,376,1578,453,900,636,1077,822,299,2081,129,151,125,634,1193,103,173,404,1213,2147,671,543,715,1066,1130,68,86,808,730,167,1330,377,880,44,2163,979,151,541,325,108,1397,218,890,462,58,750,1839,1840,815,1062,470,94,880,970,214,587,64,844,187,1222,1240,191,928,1123,1552,185,1320,54,476,549,58,230,1000,398,698,54,76,516,259,170,9,519,116,160,232,834,408,323,271,249,1169,359,470,1543,135,1203,4256,329,566,82,1358,344,665,1845,142,939,658,1182,2510,408,1102,234,1323,614,895,68,882,49,238,902,267,170,101,1369,149,667,2019,412,80,185,160,210,426,2583,148,123,403,872,841,657,686,448,493,220,770,339,874,227,4,219,256,1145,821,357,397,1150,2402,355,771,309,753,566,506,978,117,172,806,1511,433,857,1457],"CHmRun":[69,63,225,12,19,1,0,6,253,90,15,41,4,36,177,5,24,16,3,67,164,17,13,61,32,166,8,44,27,146,5,4,32,21,24,32,77,281,2,113,166,29,49,35,133,24,98,1,9,315,8,22,100,221,347,291,32,16,80,11,154,93,266,145,247,25,181,28,28,108,7,28,41,305,45,38,275,7,131,92,4,209,71,271,53,107,14,259,59,16,231,384,12,42,44,73,92,58,140,55,40,190,1,16,7,128,70,2,38,57,194,153,97,56,27,40,97,9,4,81,97,4,57,65,32,2,351,33,24,52,30,6,83,6,74,40,6,126,121,128,117,85,65,12,83,20,64,35,0,116,9,94,84,30,102,212,210,36,93,2,12,62,12,14,113,47,55,3,3,90,54,17,2,26,14,8,19,40,16,54,3,36,13,61,38,104,30,79,160,24,29,0,48,43,43,312,44,78,50,103,548,115,67,12,56,43,39,2,36,3,16,74,3,17,16,155,7,38,153,100,5,22,24,21,11,271,1,8,12,19,61,48,133,15,9,9,27,32,16,22,1,12,42,83,63,7,17,57,242,31,110,1,69,41,6,32,11,22,32,39,7,97,30],"CRuns":[321,224,828,48,501,30,41,32,784,702,192,205,309,376,1045,65,67,72,55,242,1008,442,291,246,349,763,80,219,126,859,34,20,86,108,113,117,352,1003,32,634,747,99,164,409,529,58,698,116,118,1141,57,99,950,712,1175,1082,461,196,285,123,1019,349,813,575,978,61,746,160,156,292,35,87,287,1135,156,335,884,166,743,297,19,1072,195,847,148,361,102,915,429,216,1070,1172,247,284,703,211,444,265,492,313,145,935,72,80,58,371,581,67,101,210,702,980,273,304,330,450,544,45,33,379,302,89,616,181,366,18,1104,518,68,310,188,38,578,96,419,219,34,433,983,969,405,505,233,51,363,408,150,262,31,436,117,557,615,113,513,577,740,88,724,27,216,300,24,121,445,210,315,25,20,247,150,80,6,181,59,71,132,451,198,181,129,168,583,176,245,751,82,676,2165,166,250,41,630,178,266,965,102,438,249,862,1509,238,410,102,643,295,377,32,365,16,128,494,94,98,50,713,73,315,1043,204,27,93,76,106,218,1138,68,63,211,420,450,324,369,196,207,83,352,135,421,106,2,105,129,488,307,149,226,579,1048,180,338,201,399,279,272,474,66,82,379,897,217,470,775],"CRBI":[414,266,838,46,336,9,37,34,890,504,186,204,103,290,993,23,82,48,43,251,1072,198,108,327,182,734,46,208,132,803,29,29,76,117,121,107,342,977,32,563,666,138,179,321,472,69,661,64,69,1179,40,103,909,815,1152,949,301,110,274,108,608,401,822,528,1093,70,805,123,159,343,35,110,294,1234,119,174,1015,122,693,319,18,1050,219,999,173,401,80,1067,365,208,955,1267,126,141,519,280,419,316,589,377,154,1088,31,97,37,376,421,32,130,222,705,1032,383,268,326,367,462,39,38,428,351,48,522,227,337,10,1289,324,94,226,135,46,579,72,382,195,23,420,707,900,474,456,260,44,477,303,156,201,26,458,64,483,430,119,471,700,840,112,522,25,163,263,37,69,491,203,325,14,36,288,167,75,7,199,55,33,83,249,120,177,80,91,374,202,167,714,88,390,1314,125,252,32,435,192,304,1128,109,380,322,417,1659,299,497,96,445,273,284,22,280,13,104,345,71,54,55,660,47,259,827,276,31,106,75,86,149,1299,56,39,146,230,342,300,384,137,162,82,230,163,349,80,3,99,139,491,340,161,149,363,1348,148,406,69,366,257,125,322,41,100,311,451,93,420,357],"CWalks":[375,263,354,33,194,24,12,8,866,488,161,203,207,238,732,39,56,65,62,240,402,317,180,166,308,784,31,136,66,571,18,45,32,118,80,51,289,619,27,319,526,64,194,170,313,16,777,57,114,727,39,78,690,548,1380,989,112,117,186,55,820,171,617,635,495,63,875,122,76,267,32,71,227,791,99,258,709,106,300,117,11,695,214,680,95,224,50,546,410,93,921,1057,198,219,256,138,240,134,263,187,128,643,48,61,47,238,325,71,69,68,625,854,226,298,158,241,551,35,45,221,174,54,436,82,218,18,564,382,55,91,63,28,644,91,304,82,22,309,600,917,319,283,155,33,295,414,187,91,30,377,88,307,340,87,351,334,452,50,576,33,166,153,19,68,301,136,189,12,45,161,114,36,4,288,78,44,79,168,113,157,24,101,528,175,174,535,55,364,1566,105,178,26,403,136,198,990,102,466,274,708,1342,157,284,80,459,269,296,24,165,14,172,242,76,62,22,735,42,204,535,155,15,86,49,40,163,478,99,58,155,274,373,179,321,89,198,86,193,128,359,52,1,71,106,244,174,87,191,406,819,158,239,110,286,246,194,417,34,57,138,875,146,332,249],"League":["N","A","N","N","A","N","A","N","A","A","N","N","A","N","N","A","N","N","A","N","A","A","N","N","N","A","N","A","A","N","N","A","A","A","N","A","N","A","N","A","A","N","N","N","A","A","N","A","N","A","A","A","N","A","A","A","A","N","A","A","N","A","N","A","N","A","A","A","A","N","A","A","N","A","N","N","A","A","A","A","A","A","N","N","N","A","A","A","N","A","N","N","A","N","N","A","A","N","A","N","N","A","A","N","N","A","A","A","A","A","N","N","N","A","A","A","A","A","N","N","N","A","N","A","N","A","A","N","N","N","A","A","A","N","N","N","N","A","A","N","A","N","N","N","N","N","A","A","N","N","N","A","A","N","A","A","A","A","A","N","A","A","N","N","A","A","N","A","N","N","A","A","N","N","A","N","N","N","N","A","A","A","N","N","A","N","A","A","N","A","A","N","A","A","A","N","A","A","A","A","A","A","N","A","A","A","N","A","N","N","N","N","N","N","A","A","N","A","A","A","A","N","A","N","A","N","N","A","A","N","A","A","A","A","N","N","N","N","N","A","N","N","A","A","N","N","A","N","N","N","N","N","N","N","N","A","N","A","N","A","A","A","A"],"Division":["W","W","E","E","W","E","W","W","E","E","W","E","E","E","W","W","W","E","W","W","E","E","E","W","W","W","W","E","W","W","W","E","E","E","W","E","W","W","E","W","E","W","W","W","E","E","E","W","W","E","W","E","W","W","E","E","E","W","W","W","E","E","W","W","W","E","W","W","W","E","E","W","W","E","W","W","E","E","W","E","E","W","W","E","W","W","W","W","W","E","E","W","W","E","W","W","W","E","W","E","E","W","W","W","E","E","E","W","W","E","E","W","E","E","E","E","E","W","W","W","E","W","E","W","E","W","E","W","E","E","E","W","W","W","W","W","W","E","E","E","W","W","W","E","E","W","W","W","W","E","E","E","E","W","E","E","W","E","E","W","E","W","E","W","E","E","E","W","E","W","E","W","E","W","W","E","E","E","W","E","W","W","E","W","W","W","W","E","W","E","E","E","W","W","E","E","E","E","E","E","W","W","E","E","E","E","W","E","W","E","E","E","E","E","W","W","W","W","E","W","W","E","W","E","W","W","E","W","W","W","E","E","W","E","W","E","W","W","E","W","W","E","W","W","E","E","W","W","W","E","E","E","E","E","E","E","W","W","E","E","W","E","W"],"PutOuts":[632,880,200,805,282,76,121,143,0,238,304,211,121,80,105,102,202,280,361,518,1067,434,222,732,262,267,226,109,419,72,442,326,307,359,73,58,303,389,109,67,316,161,142,106,240,203,53,125,73,0,152,107,153,119,808,280,224,226,182,104,51,1377,303,276,278,148,165,246,533,226,45,157,59,292,274,292,1045,102,316,269,116,97,726,869,1253,118,228,144,282,91,137,83,462,185,207,670,237,331,295,116,50,0,278,138,97,368,211,276,319,241,623,237,885,33,231,304,0,28,102,158,92,211,161,110,280,332,330,87,498,290,222,227,686,249,49,303,88,190,96,1199,1218,145,332,145,181,65,0,429,107,1231,283,156,239,235,371,483,0,0,276,317,303,310,201,172,0,233,259,102,468,149,103,358,78,756,463,212,325,228,203,149,261,325,229,682,250,58,157,82,523,172,846,117,62,167,391,41,286,659,251,426,0,0,88,44,155,60,367,86,155,190,181,309,203,42,200,0,255,135,352,1236,281,1320,111,320,196,1160,229,289,209,367,351,106,315,294,209,81,337,92,352,70,692,131,299,178,810,133,160,65,167,133,94,300,1182,170,186,121,942,1222,325,313,37,1314,408],"Assists":[43,82,11,40,421,127,283,290,0,445,45,11,151,45,290,177,22,9,22,55,157,9,3,83,329,5,7,292,46,170,59,29,25,30,177,4,9,39,7,147,6,10,14,206,482,70,88,199,152,0,3,242,223,216,108,10,286,7,9,213,54,100,6,6,9,4,9,389,40,10,122,7,156,9,2,6,88,132,439,17,5,218,87,62,111,334,377,6,487,185,5,174,9,8,358,57,8,20,15,222,136,0,415,15,2,20,56,7,4,8,35,5,105,3,374,347,0,56,4,4,257,9,3,308,479,19,16,166,39,440,5,15,46,444,2,12,0,2,5,149,104,5,9,59,13,258,0,8,205,80,8,2,8,22,6,48,0,0,421,36,450,9,6,317,0,7,30,6,47,8,283,32,220,64,32,1,12,7,3,1,459,13,453,93,11,141,6,170,43,1,84,269,90,2,44,118,8,53,9,4,0,0,204,0,3,176,475,150,371,2,3,492,369,94,7,0,450,257,9,98,21,166,226,465,354,53,406,407,372,432,442,144,10,445,246,147,19,5,414,144,70,6,13,45,99,371,290,0,18,173,270,12,96,284,290,267,72,139,9,381,113,131,4],"Errors":[10,14,3,4,25,7,9,19,0,22,11,7,6,8,10,16,2,5,2,3,14,3,3,13,16,3,4,25,5,24,6,5,1,4,18,4,9,4,3,4,5,3,2,7,13,10,3,13,11,0,5,23,10,12,2,5,8,3,4,9,8,6,6,2,9,2,1,18,4,6,26,8,9,5,7,3,13,10,10,10,12,16,3,8,11,21,26,5,19,12,9,16,7,4,20,5,1,4,5,15,20,0,16,1,2,3,13,9,14,6,3,4,8,0,18,10,0,2,2,5,20,3,3,15,5,2,8,14,13,25,5,3,4,16,0,5,3,2,3,5,10,7,8,8,4,8,0,6,16,7,3,2,2,5,6,6,0,0,11,1,14,9,3,25,0,7,10,3,6,6,19,8,6,15,8,2,8,5,3,6,22,3,15,13,1,23,14,15,6,4,9,12,3,4,4,8,8,7,4,6,0,0,16,1,2,6,19,15,29,9,2,5,16,13,6,0,17,7,1,18,3,17,11,32,15,7,22,6,17,16,17,7,6,13,3,4,4,3,9,11,8,1,5,4,18,20,11,0,6,9,16,9,13,3,17,19,11,15,3,20,7,12,3],"Salary":[475,480,500,91.5,750,70,100,75,1100,517.143,512.5,550,700,240,775,175,135,100,115,600,776.667,765,708.333,750,625,900,110,612.5,300,850,90,67.5,180,305,215,247.5,815,875,70,1200,675,415,340,416.667,1350,90,275,230,225,950,75,105,320,850,535,933.333,850,210,325,275,450,1975,1900,600,1041.667,110,260,475,431.5,1220,70,145,595,1861.46,300,490,2460,375,750,1175,70,1500,385,1925.571,215,900,155,700,535,362.5,733.333,200,400,400,737.5,500,600,662.5,950,750,297.5,325,87.5,175,90,1237.5,430,100,165,250,1300,773.333,1008.333,275,775,850,365,95,110,100,277.5,80,600,200,657,75,2412.5,250,155,640,300,110,825,195,450,630,86.5,1300,1000,1800,1310,737.5,625,125,1043.333,725,300,365,75,1183.333,202.5,225,525,265,787.5,800,587.5,145,420,75,575,780,90,150,700,550,650,68,100,670,175,137,2127.333,875,120,140,210,800,240,350,175,200,1940,700,750,450,172,1260,750,190,580,130,450,300,250,1050,215,400,560,1670,487.5,425,500,250,400,450,750,70,875,190,191,740,250,140,97.5,740,140,341.667,1000,100,90,200,135,155,475,1450,150,105,350,90,530,341.667,940,350,326.667,250,740,425,925,185,920,286.667,245,235,1150,160,425,900,500,277.5,750,160,1300,525,550,1600,120,165,700,875,385,960,1000],"NewLeague":["N","A","N","N","A","A","A","N","A","A","N","N","A","N","N","A","N","N","N","N","A","A","N","N","N","A","N","A","A","N","N","A","A","A","N","A","N","A","N","A","A","N","N","N","A","A","N","A","N","A","A","A","N","A","A","A","N","A","A","A","N","A","N","A","N","A","A","A","A","N","A","A","N","A","N","N","A","A","A","A","A","A","A","N","N","A","A","A","N","A","N","N","A","A","N","A","A","N","A","N","N","A","A","N","N","A","A","N","A","A","N","N","N","A","A","A","A","A","N","N","N","A","N","A","N","N","A","A","N","N","A","A","N","N","N","N","N","A","N","N","A","N","N","N","N","N","A","A","N","N","N","A","A","N","A","N","A","A","A","N","A","A","N","N","N","A","A","A","N","N","A","A","N","N","A","N","N","N","N","A","A","A","N","N","A","N","A","A","N","A","A","N","A","A","A","A","A","A","A","A","A","A","A","A","A","A","N","A","N","N","N","N","N","N","A","A","N","A","A","A","A","N","A","N","A","N","N","A","A","N","A","A","A","A","N","N","N","A","N","A","A","N","A","A","N","N","A","N","N","N","N","N","N","N","N","A","N","A","N","A","A","A","A"]},"columns":[{"accessor":"AtBat","name":"AtBat","type":"numeric"},{"accessor":"Hits","name":"Hits","type":"numeric"},{"accessor":"HmRun","name":"HmRun","type":"numeric"},{"accessor":"Runs","name":"Runs","type":"numeric"},{"accessor":"RBI","name":"RBI","type":"numeric"},{"accessor":"Walks","name":"Walks","type":"numeric"},{"accessor":"Years","name":"Years","type":"numeric"},{"accessor":"CAtBat","name":"CAtBat","type":"numeric"},{"accessor":"CHits","name":"CHits","type":"numeric"},{"accessor":"CHmRun","name":"CHmRun","type":"numeric"},{"accessor":"CRuns","name":"CRuns","type":"numeric"},{"accessor":"CRBI","name":"CRBI","type":"numeric"},{"accessor":"CWalks","name":"CWalks","type":"numeric"},{"accessor":"League","name":"League","type":"factor"},{"accessor":"Division","name":"Division","type":"factor"},{"accessor":"PutOuts","name":"PutOuts","type":"numeric"},{"accessor":"Assists","name":"Assists","type":"numeric"},{"accessor":"Errors","name":"Errors","type":"numeric"},{"accessor":"Salary","name":"Salary","type":"numeric"},{"accessor":"NewLeague","name":"NewLeague","type":"factor"}],"filterable":true,"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"8c7b8a22853d401d4b5fa7c9080d75e2","key":"8c7b8a22853d401d4b5fa7c9080d75e2"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>Use <code>leaps::regsubsets</code> function to performs best subset selection.</p>
<p>An asterisk indicates that a given variable is included in the corresponding model. For instance, this output indicates that the best two-variable model contains only Hits and CRBI.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>regfit.full <span class="ot">&lt;-</span> leaps<span class="sc">::</span><span class="fu">regsubsets</span>(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> Salary <span class="sc">~</span> .,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> Hitters,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">nvmax =</span> <span class="dv">8</span> <span class="co"># default</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(regfit.full)</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; Subset selection object
&gt; Call: regsubsets.formula(x = Salary ~ ., data = Hitters, nvmax = 8)
&gt; 19 Variables  (and intercept)
&gt;            Forced in Forced out
&gt; AtBat          FALSE      FALSE
&gt; Hits           FALSE      FALSE
&gt; HmRun          FALSE      FALSE
&gt; Runs           FALSE      FALSE
&gt; RBI            FALSE      FALSE
&gt; Walks          FALSE      FALSE
&gt; Years          FALSE      FALSE
&gt; CAtBat         FALSE      FALSE
&gt; CHits          FALSE      FALSE
&gt; CHmRun         FALSE      FALSE
&gt; CRuns          FALSE      FALSE
&gt; CRBI           FALSE      FALSE
&gt; CWalks         FALSE      FALSE
&gt; LeagueN        FALSE      FALSE
&gt; DivisionW      FALSE      FALSE
&gt; PutOuts        FALSE      FALSE
&gt; Assists        FALSE      FALSE
&gt; Errors         FALSE      FALSE
&gt; NewLeagueN     FALSE      FALSE
&gt; 1 subsets of each size up to 8
&gt; Selection Algorithm: exhaustive
&gt;          AtBat Hits HmRun Runs RBI Walks Years CAtBat CHits CHmRun
&gt; 1  ( 1 ) &quot; &quot;   &quot; &quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot; &quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;   
&gt; 2  ( 1 ) &quot; &quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot; &quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;   
&gt; 3  ( 1 ) &quot; &quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot; &quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;   
&gt; 4  ( 1 ) &quot; &quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot; &quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;   
&gt; 5  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot; &quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;   
&gt; 6  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;   
&gt; 7  ( 1 ) &quot; &quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot;*&quot;    &quot;*&quot;   &quot;*&quot;   
&gt; 8  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot;*&quot;   
&gt;          CRuns CRBI CWalks LeagueN DivisionW PutOuts Assists Errors
&gt; 1  ( 1 ) &quot; &quot;   &quot;*&quot;  &quot; &quot;    &quot; &quot;     &quot; &quot;       &quot; &quot;     &quot; &quot;     &quot; &quot;   
&gt; 2  ( 1 ) &quot; &quot;   &quot;*&quot;  &quot; &quot;    &quot; &quot;     &quot; &quot;       &quot; &quot;     &quot; &quot;     &quot; &quot;   
&gt; 3  ( 1 ) &quot; &quot;   &quot;*&quot;  &quot; &quot;    &quot; &quot;     &quot; &quot;       &quot;*&quot;     &quot; &quot;     &quot; &quot;   
&gt; 4  ( 1 ) &quot; &quot;   &quot;*&quot;  &quot; &quot;    &quot; &quot;     &quot;*&quot;       &quot;*&quot;     &quot; &quot;     &quot; &quot;   
&gt; 5  ( 1 ) &quot; &quot;   &quot;*&quot;  &quot; &quot;    &quot; &quot;     &quot;*&quot;       &quot;*&quot;     &quot; &quot;     &quot; &quot;   
&gt; 6  ( 1 ) &quot; &quot;   &quot;*&quot;  &quot; &quot;    &quot; &quot;     &quot;*&quot;       &quot;*&quot;     &quot; &quot;     &quot; &quot;   
&gt; 7  ( 1 ) &quot; &quot;   &quot; &quot;  &quot; &quot;    &quot; &quot;     &quot;*&quot;       &quot;*&quot;     &quot; &quot;     &quot; &quot;   
&gt; 8  ( 1 ) &quot;*&quot;   &quot; &quot;  &quot;*&quot;    &quot; &quot;     &quot;*&quot;       &quot;*&quot;     &quot; &quot;     &quot; &quot;   
&gt;          NewLeagueN
&gt; 1  ( 1 ) &quot; &quot;       
&gt; 2  ( 1 ) &quot; &quot;       
&gt; 3  ( 1 ) &quot; &quot;       
&gt; 4  ( 1 ) &quot; &quot;       
&gt; 5  ( 1 ) &quot; &quot;       
&gt; 6  ( 1 ) &quot; &quot;       
&gt; 7  ( 1 ) &quot; &quot;       
&gt; 8  ( 1 ) &quot; &quot;</code></pre>
<p>Here we fit up to a 19-variable model.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>regfit.full <span class="ot">&lt;-</span> leaps<span class="sc">::</span><span class="fu">regsubsets</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> Salary <span class="sc">~</span> .,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> Hitters,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">nvmax =</span> <span class="dv">19</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>The <code>summary</code> function also returns <span class="math inline">\(R^2\)</span>, <span class="math inline">\(RSS\)</span>, adjusted <span class="math inline">\(R^2\)</span>, <span class="math inline">\(C_p\)</span>, and <span class="math inline">\(BIC\)</span>. We can examine these to try to select the best overall model.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>reg.summary <span class="ot">&lt;-</span> regfit.full <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(reg.summary)</span></code></pre></div>
<pre><code>&gt; [1] &quot;which&quot;  &quot;rsq&quot;    &quot;rss&quot;    &quot;adjr2&quot;  &quot;cp&quot;     &quot;bic&quot;    &quot;outmat&quot;
&gt; [8] &quot;obj&quot;</code></pre>
<p>For instance, we see that the <span class="math inline">\(R^2\)</span> statistic increases from 32 %, when only one variable is included in the model, to almost 55 %, when all variables are included. As expected, the <span class="math inline">\(R^2\)</span> statistic increases monotonically as more variables are included.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>reg.summary<span class="sc">$</span>rsq</span></code></pre></div>
<pre><code>&gt;  [1] 0.3214501 0.4252237 0.4514294 0.4754067 0.4908036 0.5087146
&gt;  [7] 0.5141227 0.5285569 0.5346124 0.5404950 0.5426153 0.5436302
&gt; [13] 0.5444570 0.5452164 0.5454692 0.5457656 0.5459518 0.5460945
&gt; [19] 0.5461159</code></pre>
<p>The <code>leaps::regsubsets</code> function has a built-in <code>plot</code> command which can be used to display the selected variables for the best model with a given number of predictors, ranked according to the <span class="math inline">\(BIC\)</span>, <span class="math inline">\(C_p\)</span>, adjusted <span class="math inline">\(R^2\)</span>, or <span class="math inline">\(AIC\)</span>. To find out more about this function, type <code>?plot.regsubsets</code>.</p>
<p>The top row of each plot contains a black square for each variable selected according to the optimal model associated with that statistic. For instance, we see that several models share a <span class="math inline">\(BIC\)</span> close to <span class="math inline">\(−150\)</span>. However, the model with the lowest <span class="math inline">\(BIC\)</span> is the six-variable model that contains only <code>AtBat</code>, <code>Hits</code>, <code>Walks</code>, <code>CRBI</code>, <code>DivisionW</code>, and <code>PutOuts</code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(regfit.full, <span class="at">scale =</span> <span class="st">&quot;bic&quot;</span>)</span></code></pre></div>
<p><img src="figures/unnamed-chunk-8-1.png" width="3883.2" style="display: block; margin: auto;" /></p>
<p>We can use the <code>coef</code> function to see the coefficient estimates associated with this model.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(regfit.full, <span class="dv">6</span>)</span></code></pre></div>
<pre><code>&gt;  (Intercept)        AtBat         Hits        Walks         CRBI 
&gt;   91.5117981   -1.8685892    7.6043976    3.6976468    0.6430169 
&gt;    DivisionW      PutOuts 
&gt; -122.9515338    0.2643076</code></pre>
</div>
<div id="forward-and-backward-stepwise-selection" class="section level2">
<h2>Forward and Backward Stepwise Selection</h2>
<p>We can also use the <code>leaps::regsubsets</code> function to perform forward stepwise selection using the argument <code>method = "forward"</code></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>regfit.fwd <span class="ot">&lt;-</span> leaps<span class="sc">::</span><span class="fu">regsubsets</span>(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> Salary <span class="sc">~</span> .,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> Hitters,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">nvmax =</span> <span class="dv">19</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">&quot;forward&quot;</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(regfit.fwd)</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; Subset selection object
&gt; Call: regsubsets.formula(x = Salary ~ ., data = Hitters, nvmax = 19, 
&gt;     method = &quot;forward&quot;)
&gt; 19 Variables  (and intercept)
&gt;            Forced in Forced out
&gt; AtBat          FALSE      FALSE
&gt; Hits           FALSE      FALSE
&gt; HmRun          FALSE      FALSE
&gt; Runs           FALSE      FALSE
&gt; RBI            FALSE      FALSE
&gt; Walks          FALSE      FALSE
&gt; Years          FALSE      FALSE
&gt; CAtBat         FALSE      FALSE
&gt; CHits          FALSE      FALSE
&gt; CHmRun         FALSE      FALSE
&gt; CRuns          FALSE      FALSE
&gt; CRBI           FALSE      FALSE
&gt; CWalks         FALSE      FALSE
&gt; LeagueN        FALSE      FALSE
&gt; DivisionW      FALSE      FALSE
&gt; PutOuts        FALSE      FALSE
&gt; Assists        FALSE      FALSE
&gt; Errors         FALSE      FALSE
&gt; NewLeagueN     FALSE      FALSE
&gt; 1 subsets of each size up to 19
&gt; Selection Algorithm: forward
&gt;           AtBat Hits HmRun Runs RBI Walks Years CAtBat CHits CHmRun
&gt; 1  ( 1 )  &quot; &quot;   &quot; &quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot; &quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;   
&gt; 2  ( 1 )  &quot; &quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot; &quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;   
&gt; 3  ( 1 )  &quot; &quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot; &quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;   
&gt; 4  ( 1 )  &quot; &quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot; &quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;   
&gt; 5  ( 1 )  &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot; &quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;   
&gt; 6  ( 1 )  &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;   
&gt; 7  ( 1 )  &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;   
&gt; 8  ( 1 )  &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;   
&gt; 9  ( 1 )  &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot;*&quot;    &quot; &quot;   &quot; &quot;   
&gt; 10  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot;*&quot;    &quot; &quot;   &quot; &quot;   
&gt; 11  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot;*&quot;    &quot; &quot;   &quot; &quot;   
&gt; 12  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot;*&quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot;*&quot;    &quot; &quot;   &quot; &quot;   
&gt; 13  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot;*&quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot;*&quot;    &quot; &quot;   &quot; &quot;   
&gt; 14  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;   &quot;*&quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot;*&quot;    &quot; &quot;   &quot; &quot;   
&gt; 15  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;   &quot;*&quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot;*&quot;    &quot;*&quot;   &quot; &quot;   
&gt; 16  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;   &quot;*&quot;  &quot;*&quot; &quot;*&quot;   &quot; &quot;   &quot;*&quot;    &quot;*&quot;   &quot; &quot;   
&gt; 17  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;   &quot;*&quot;  &quot;*&quot; &quot;*&quot;   &quot; &quot;   &quot;*&quot;    &quot;*&quot;   &quot; &quot;   
&gt; 18  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;   &quot;*&quot;  &quot;*&quot; &quot;*&quot;   &quot;*&quot;   &quot;*&quot;    &quot;*&quot;   &quot; &quot;   
&gt; 19  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;   &quot;*&quot;  &quot;*&quot; &quot;*&quot;   &quot;*&quot;   &quot;*&quot;    &quot;*&quot;   &quot;*&quot;   
&gt;           CRuns CRBI CWalks LeagueN DivisionW PutOuts Assists Errors
&gt; 1  ( 1 )  &quot; &quot;   &quot;*&quot;  &quot; &quot;    &quot; &quot;     &quot; &quot;       &quot; &quot;     &quot; &quot;     &quot; &quot;   
&gt; 2  ( 1 )  &quot; &quot;   &quot;*&quot;  &quot; &quot;    &quot; &quot;     &quot; &quot;       &quot; &quot;     &quot; &quot;     &quot; &quot;   
&gt; 3  ( 1 )  &quot; &quot;   &quot;*&quot;  &quot; &quot;    &quot; &quot;     &quot; &quot;       &quot;*&quot;     &quot; &quot;     &quot; &quot;   
&gt; 4  ( 1 )  &quot; &quot;   &quot;*&quot;  &quot; &quot;    &quot; &quot;     &quot;*&quot;       &quot;*&quot;     &quot; &quot;     &quot; &quot;   
&gt; 5  ( 1 )  &quot; &quot;   &quot;*&quot;  &quot; &quot;    &quot; &quot;     &quot;*&quot;       &quot;*&quot;     &quot; &quot;     &quot; &quot;   
&gt; 6  ( 1 )  &quot; &quot;   &quot;*&quot;  &quot; &quot;    &quot; &quot;     &quot;*&quot;       &quot;*&quot;     &quot; &quot;     &quot; &quot;   
&gt; 7  ( 1 )  &quot; &quot;   &quot;*&quot;  &quot;*&quot;    &quot; &quot;     &quot;*&quot;       &quot;*&quot;     &quot; &quot;     &quot; &quot;   
&gt; 8  ( 1 )  &quot;*&quot;   &quot;*&quot;  &quot;*&quot;    &quot; &quot;     &quot;*&quot;       &quot;*&quot;     &quot; &quot;     &quot; &quot;   
&gt; 9  ( 1 )  &quot;*&quot;   &quot;*&quot;  &quot;*&quot;    &quot; &quot;     &quot;*&quot;       &quot;*&quot;     &quot; &quot;     &quot; &quot;   
&gt; 10  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;    &quot; &quot;     &quot;*&quot;       &quot;*&quot;     &quot;*&quot;     &quot; &quot;   
&gt; 11  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;    &quot;*&quot;     &quot;*&quot;       &quot;*&quot;     &quot;*&quot;     &quot; &quot;   
&gt; 12  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;    &quot;*&quot;     &quot;*&quot;       &quot;*&quot;     &quot;*&quot;     &quot; &quot;   
&gt; 13  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;    &quot;*&quot;     &quot;*&quot;       &quot;*&quot;     &quot;*&quot;     &quot;*&quot;   
&gt; 14  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;    &quot;*&quot;     &quot;*&quot;       &quot;*&quot;     &quot;*&quot;     &quot;*&quot;   
&gt; 15  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;    &quot;*&quot;     &quot;*&quot;       &quot;*&quot;     &quot;*&quot;     &quot;*&quot;   
&gt; 16  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;    &quot;*&quot;     &quot;*&quot;       &quot;*&quot;     &quot;*&quot;     &quot;*&quot;   
&gt; 17  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;    &quot;*&quot;     &quot;*&quot;       &quot;*&quot;     &quot;*&quot;     &quot;*&quot;   
&gt; 18  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;    &quot;*&quot;     &quot;*&quot;       &quot;*&quot;     &quot;*&quot;     &quot;*&quot;   
&gt; 19  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;    &quot;*&quot;     &quot;*&quot;       &quot;*&quot;     &quot;*&quot;     &quot;*&quot;   
&gt;           NewLeagueN
&gt; 1  ( 1 )  &quot; &quot;       
&gt; 2  ( 1 )  &quot; &quot;       
&gt; 3  ( 1 )  &quot; &quot;       
&gt; 4  ( 1 )  &quot; &quot;       
&gt; 5  ( 1 )  &quot; &quot;       
&gt; 6  ( 1 )  &quot; &quot;       
&gt; 7  ( 1 )  &quot; &quot;       
&gt; 8  ( 1 )  &quot; &quot;       
&gt; 9  ( 1 )  &quot; &quot;       
&gt; 10  ( 1 ) &quot; &quot;       
&gt; 11  ( 1 ) &quot; &quot;       
&gt; 12  ( 1 ) &quot; &quot;       
&gt; 13  ( 1 ) &quot; &quot;       
&gt; 14  ( 1 ) &quot; &quot;       
&gt; 15  ( 1 ) &quot; &quot;       
&gt; 16  ( 1 ) &quot; &quot;       
&gt; 17  ( 1 ) &quot;*&quot;       
&gt; 18  ( 1 ) &quot;*&quot;       
&gt; 19  ( 1 ) &quot;*&quot;</code></pre>
<p>To perform backward stepwise selection, use the argument <code>method = "backward"</code></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>regfit.bwd <span class="ot">&lt;-</span> leaps<span class="sc">::</span><span class="fu">regsubsets</span>(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> Salary <span class="sc">~</span> .,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> Hitters,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">nvmax =</span> <span class="dv">19</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">&quot;backward&quot;</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(regfit.bwd)</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; Subset selection object
&gt; Call: regsubsets.formula(x = Salary ~ ., data = Hitters, nvmax = 19, 
&gt;     method = &quot;backward&quot;)
&gt; 19 Variables  (and intercept)
&gt;            Forced in Forced out
&gt; AtBat          FALSE      FALSE
&gt; Hits           FALSE      FALSE
&gt; HmRun          FALSE      FALSE
&gt; Runs           FALSE      FALSE
&gt; RBI            FALSE      FALSE
&gt; Walks          FALSE      FALSE
&gt; Years          FALSE      FALSE
&gt; CAtBat         FALSE      FALSE
&gt; CHits          FALSE      FALSE
&gt; CHmRun         FALSE      FALSE
&gt; CRuns          FALSE      FALSE
&gt; CRBI           FALSE      FALSE
&gt; CWalks         FALSE      FALSE
&gt; LeagueN        FALSE      FALSE
&gt; DivisionW      FALSE      FALSE
&gt; PutOuts        FALSE      FALSE
&gt; Assists        FALSE      FALSE
&gt; Errors         FALSE      FALSE
&gt; NewLeagueN     FALSE      FALSE
&gt; 1 subsets of each size up to 19
&gt; Selection Algorithm: backward
&gt;           AtBat Hits HmRun Runs RBI Walks Years CAtBat CHits CHmRun
&gt; 1  ( 1 )  &quot; &quot;   &quot; &quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot; &quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;   
&gt; 2  ( 1 )  &quot; &quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot; &quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;   
&gt; 3  ( 1 )  &quot; &quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot; &quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;   
&gt; 4  ( 1 )  &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot; &quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;   
&gt; 5  ( 1 )  &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;   
&gt; 6  ( 1 )  &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;   
&gt; 7  ( 1 )  &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;   
&gt; 8  ( 1 )  &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot; &quot;    &quot; &quot;   &quot; &quot;   
&gt; 9  ( 1 )  &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot;*&quot;    &quot; &quot;   &quot; &quot;   
&gt; 10  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot;*&quot;    &quot; &quot;   &quot; &quot;   
&gt; 11  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot; &quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot;*&quot;    &quot; &quot;   &quot; &quot;   
&gt; 12  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot;*&quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot;*&quot;    &quot; &quot;   &quot; &quot;   
&gt; 13  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot; &quot;   &quot;*&quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot;*&quot;    &quot; &quot;   &quot; &quot;   
&gt; 14  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;   &quot;*&quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot;*&quot;    &quot; &quot;   &quot; &quot;   
&gt; 15  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;   &quot;*&quot;  &quot; &quot; &quot;*&quot;   &quot; &quot;   &quot;*&quot;    &quot;*&quot;   &quot; &quot;   
&gt; 16  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;   &quot;*&quot;  &quot;*&quot; &quot;*&quot;   &quot; &quot;   &quot;*&quot;    &quot;*&quot;   &quot; &quot;   
&gt; 17  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;   &quot;*&quot;  &quot;*&quot; &quot;*&quot;   &quot; &quot;   &quot;*&quot;    &quot;*&quot;   &quot; &quot;   
&gt; 18  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;   &quot;*&quot;  &quot;*&quot; &quot;*&quot;   &quot;*&quot;   &quot;*&quot;    &quot;*&quot;   &quot; &quot;   
&gt; 19  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;   &quot;*&quot;  &quot;*&quot; &quot;*&quot;   &quot;*&quot;   &quot;*&quot;    &quot;*&quot;   &quot;*&quot;   
&gt;           CRuns CRBI CWalks LeagueN DivisionW PutOuts Assists Errors
&gt; 1  ( 1 )  &quot;*&quot;   &quot; &quot;  &quot; &quot;    &quot; &quot;     &quot; &quot;       &quot; &quot;     &quot; &quot;     &quot; &quot;   
&gt; 2  ( 1 )  &quot;*&quot;   &quot; &quot;  &quot; &quot;    &quot; &quot;     &quot; &quot;       &quot; &quot;     &quot; &quot;     &quot; &quot;   
&gt; 3  ( 1 )  &quot;*&quot;   &quot; &quot;  &quot; &quot;    &quot; &quot;     &quot; &quot;       &quot;*&quot;     &quot; &quot;     &quot; &quot;   
&gt; 4  ( 1 )  &quot;*&quot;   &quot; &quot;  &quot; &quot;    &quot; &quot;     &quot; &quot;       &quot;*&quot;     &quot; &quot;     &quot; &quot;   
&gt; 5  ( 1 )  &quot;*&quot;   &quot; &quot;  &quot; &quot;    &quot; &quot;     &quot; &quot;       &quot;*&quot;     &quot; &quot;     &quot; &quot;   
&gt; 6  ( 1 )  &quot;*&quot;   &quot; &quot;  &quot; &quot;    &quot; &quot;     &quot;*&quot;       &quot;*&quot;     &quot; &quot;     &quot; &quot;   
&gt; 7  ( 1 )  &quot;*&quot;   &quot; &quot;  &quot;*&quot;    &quot; &quot;     &quot;*&quot;       &quot;*&quot;     &quot; &quot;     &quot; &quot;   
&gt; 8  ( 1 )  &quot;*&quot;   &quot;*&quot;  &quot;*&quot;    &quot; &quot;     &quot;*&quot;       &quot;*&quot;     &quot; &quot;     &quot; &quot;   
&gt; 9  ( 1 )  &quot;*&quot;   &quot;*&quot;  &quot;*&quot;    &quot; &quot;     &quot;*&quot;       &quot;*&quot;     &quot; &quot;     &quot; &quot;   
&gt; 10  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;    &quot; &quot;     &quot;*&quot;       &quot;*&quot;     &quot;*&quot;     &quot; &quot;   
&gt; 11  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;    &quot;*&quot;     &quot;*&quot;       &quot;*&quot;     &quot;*&quot;     &quot; &quot;   
&gt; 12  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;    &quot;*&quot;     &quot;*&quot;       &quot;*&quot;     &quot;*&quot;     &quot; &quot;   
&gt; 13  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;    &quot;*&quot;     &quot;*&quot;       &quot;*&quot;     &quot;*&quot;     &quot;*&quot;   
&gt; 14  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;    &quot;*&quot;     &quot;*&quot;       &quot;*&quot;     &quot;*&quot;     &quot;*&quot;   
&gt; 15  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;    &quot;*&quot;     &quot;*&quot;       &quot;*&quot;     &quot;*&quot;     &quot;*&quot;   
&gt; 16  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;    &quot;*&quot;     &quot;*&quot;       &quot;*&quot;     &quot;*&quot;     &quot;*&quot;   
&gt; 17  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;    &quot;*&quot;     &quot;*&quot;       &quot;*&quot;     &quot;*&quot;     &quot;*&quot;   
&gt; 18  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;    &quot;*&quot;     &quot;*&quot;       &quot;*&quot;     &quot;*&quot;     &quot;*&quot;   
&gt; 19  ( 1 ) &quot;*&quot;   &quot;*&quot;  &quot;*&quot;    &quot;*&quot;     &quot;*&quot;       &quot;*&quot;     &quot;*&quot;     &quot;*&quot;   
&gt;           NewLeagueN
&gt; 1  ( 1 )  &quot; &quot;       
&gt; 2  ( 1 )  &quot; &quot;       
&gt; 3  ( 1 )  &quot; &quot;       
&gt; 4  ( 1 )  &quot; &quot;       
&gt; 5  ( 1 )  &quot; &quot;       
&gt; 6  ( 1 )  &quot; &quot;       
&gt; 7  ( 1 )  &quot; &quot;       
&gt; 8  ( 1 )  &quot; &quot;       
&gt; 9  ( 1 )  &quot; &quot;       
&gt; 10  ( 1 ) &quot; &quot;       
&gt; 11  ( 1 ) &quot; &quot;       
&gt; 12  ( 1 ) &quot; &quot;       
&gt; 13  ( 1 ) &quot; &quot;       
&gt; 14  ( 1 ) &quot; &quot;       
&gt; 15  ( 1 ) &quot; &quot;       
&gt; 16  ( 1 ) &quot; &quot;       
&gt; 17  ( 1 ) &quot;*&quot;       
&gt; 18  ( 1 ) &quot;*&quot;       
&gt; 19  ( 1 ) &quot;*&quot;</code></pre>
<p>For this data, the best seven-variable models identified by forward stepwise selection, backward stepwise selection, and best subset selection are different.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(regfit.full, <span class="dv">7</span>)</span></code></pre></div>
<pre><code>&gt;  (Intercept)         Hits        Walks       CAtBat        CHits 
&gt;   79.4509472    1.2833513    3.2274264   -0.3752350    1.4957073 
&gt;       CHmRun    DivisionW      PutOuts 
&gt;    1.4420538 -129.9866432    0.2366813</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(regfit.fwd, <span class="dv">7</span>)</span></code></pre></div>
<pre><code>&gt;  (Intercept)        AtBat         Hits        Walks         CRBI 
&gt;  109.7873062   -1.9588851    7.4498772    4.9131401    0.8537622 
&gt;       CWalks    DivisionW      PutOuts 
&gt;   -0.3053070 -127.1223928    0.2533404</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(regfit.bwd, <span class="dv">7</span>)</span></code></pre></div>
<pre><code>&gt;  (Intercept)        AtBat         Hits        Walks        CRuns 
&gt;  105.6487488   -1.9762838    6.7574914    6.0558691    1.1293095 
&gt;       CWalks    DivisionW      PutOuts 
&gt;   -0.7163346 -116.1692169    0.3028847</code></pre>
</div>
<div id="choosing-among-models-using-the-validation-set-approach" class="section level2">
<h2>Choosing Among Models Using the Validation-Set Approach</h2>
<p>We split the samples into training set and a test set</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>Hitters <span class="ot">&lt;-</span> Hitters <span class="sc">%&gt;%</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">isTrainingSet =</span> <span class="fu">sample</span>(</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>),</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="fu">nrow</span>(Hitters),</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">replace =</span> <span class="cn">TRUE</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">relocate</span>(.data[[<span class="st">&quot;isTrainingSet&quot;</span>]])</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> Hitters <span class="sc">%&gt;%</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(.data[[<span class="st">&quot;isTrainingSet&quot;</span>]] <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">&quot;isTrainingSet&quot;</span>))</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> Hitters <span class="sc">%&gt;%</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(.data[[<span class="st">&quot;isTrainingSet&quot;</span>]] <span class="sc">==</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">&quot;isTrainingSet&quot;</span>))</span></code></pre></div>
<p>Now, we apply <code>leaps::regsubsets</code> to the training set in order to perform best subset selection and compute the the validation set error for the best model of each model size.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>regfit.best <span class="ot">&lt;-</span> leaps<span class="sc">::</span><span class="fu">regsubsets</span>(Salary <span class="sc">~</span> ., <span class="at">data =</span> train, <span class="at">nvmax =</span> <span class="dv">19</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>test.mat <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">model.matrix</span>(Salary <span class="sc">~</span> ., <span class="at">data =</span> test)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>val.errors <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">19</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">19</span>) {</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  coefi <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">coef</span>(regfit.best, <span class="at">id =</span> i)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  pred <span class="ot">&lt;-</span> test.mat[, <span class="fu">names</span>(coefi)] <span class="sc">%*%</span> coefi</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  val.errors[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>((test<span class="sc">$</span>Salary <span class="sc">-</span> pred)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>val.errors</span></code></pre></div>
<pre><code>&gt;  [1] 135855.0 121223.7 112839.0 108921.6 108777.0 106698.8 111575.5
&gt;  [8] 118578.6 107488.7 111622.5 105683.6 106537.6 105781.1 106511.1
&gt; [15] 107497.2 107930.6 108624.8 110326.5 110231.6</code></pre>
<p>We find that the best model is the one that contains seven variables.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which.min</span>(val.errors)</span></code></pre></div>
<pre><code>&gt; [1] 11</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(regfit.best, <span class="dv">7</span>)</span></code></pre></div>
<pre><code>&gt; (Intercept)       AtBat        Hits       Walks      CHmRun 
&gt; 197.8996737  -3.1466588   8.7295868  10.2800410   1.8032438 
&gt;       CRuns      CWalks     Assists 
&gt;   1.2066890  -1.2903890   0.4338648</code></pre>
<p>However, the best seven-variable model on the full data set has a different set of variables than the best seven-variable model on the training set.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>regfit.best <span class="ot">&lt;-</span> leaps<span class="sc">::</span><span class="fu">regsubsets</span>(Salary <span class="sc">~</span> ., <span class="at">data =</span> Hitters, <span class="at">nvmax =</span> <span class="dv">19</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(regfit.best, <span class="dv">7</span>)</span></code></pre></div>
<pre><code>&gt;  (Intercept)         Hits        Walks       CAtBat        CHits 
&gt;   79.4509472    1.2833513    3.2274264   -0.3752350    1.4957073 
&gt;       CHmRun    DivisionW      PutOuts 
&gt;    1.4420538 -129.9866432    0.2366813</code></pre>
</div>
<div id="choosing-among-models-using-cross-validation" class="section level2">
<h2>Choosing Among Models Using Cross-Validation</h2>
<p>We now try to choose among the models of different sizes using cross validation. Create a vector that allocates each observation to one of k = 10 folds.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(Hitters)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>k, <span class="at">length =</span> n))</span></code></pre></div>
<p>We write a for loop that performs cross-validation</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A predict method for leaps::regsubsets</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>predict.regsubsets <span class="ot">&lt;-</span> <span class="cf">function</span>(object, newdata, id, ...) {</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  form <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(object<span class="sc">$</span>call[[<span class="dv">2</span>]])</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  mat <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(form, newdata)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  coefi <span class="ot">&lt;-</span> <span class="fu">coef</span>(object, <span class="at">id =</span> id)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  xvars <span class="ot">&lt;-</span> <span class="fu">names</span>(coefi)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  mat[, xvars] <span class="sc">%*%</span> coefi</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>cv.errors <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, k, <span class="dv">19</span>,</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="cn">NULL</span>, <span class="fu">paste</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">19</span>))</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  best.fit <span class="ot">&lt;-</span> leaps<span class="sc">::</span><span class="fu">regsubsets</span>(Salary <span class="sc">~</span> .,</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> Hitters[folds <span class="sc">!=</span> j, ],</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">nvmax =</span> <span class="dv">19</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">19</span>) {</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>    pred <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">predict</span>(best.fit, Hitters[folds <span class="sc">==</span> j, ], <span class="at">id =</span> i)</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>    cv.errors[j, i] <span class="ot">&lt;-</span> <span class="fu">mean</span>((Hitters<span class="sc">$</span>Salary[folds <span class="sc">==</span> j] <span class="sc">-</span> pred)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>This has given us a <span class="math inline">\(10\)</span> by <span class="math inline">\(19\)</span> matrix, of which the <span class="math inline">\((j, i)\)</span>th element corresponds to the test <span class="math inline">\(MSE\)</span> for the <span class="math inline">\(j\)</span>th cross-validation fold for the best <span class="math inline">\(i\)</span>-variable model.</p>
<p>We use the <code>apply</code> function to average over the columns of this <code>apply</code> matrix in order to obtain a vector for which the <span class="math inline">\(i\)</span>th element is the cross validation error for the <span class="math inline">\(i\)</span>-variable model.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>mean.cv.errors <span class="ot">&lt;-</span> <span class="fu">apply</span>(cv.errors, <span class="dv">2</span>, mean)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mean.cv.errors, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>)</span></code></pre></div>
<p><img src="figures/unnamed-chunk-19-1.png" width="3883.2" style="display: block; margin: auto;" /></p>
<p>We see that cross-validation selects a 10-variable model.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>regfit.best <span class="ot">&lt;-</span> leaps<span class="sc">::</span><span class="fu">regsubsets</span>(Salary <span class="sc">~</span> ., <span class="at">data =</span> Hitters, <span class="at">nvmax =</span> <span class="dv">19</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(regfit.best, <span class="dv">10</span>)</span></code></pre></div>
<pre><code>&gt;  (Intercept)        AtBat         Hits        Walks       CAtBat 
&gt;  162.5354420   -2.1686501    6.9180175    5.7732246   -0.1300798 
&gt;        CRuns         CRBI       CWalks    DivisionW      PutOuts 
&gt;    1.4082490    0.7743122   -0.8308264 -112.3800575    0.2973726 
&gt;      Assists 
&gt;    0.2831680</code></pre>
</div>
</div>
<div id="ridge-regression" class="section level1">
<h1>Ridge Regression</h1>
<div id="introduction-to-ridge-regression" class="section level2">
<h2>Introduction to ridge regression</h2>
<p>Use <a href="https://parsnip.tidymodels.org/reference/linear_reg.html"><code>parsnip::linear_reg</code></a>, <a href="https://parsnip.tidymodels.org/reference/set_args.html"><code>parsnip::set_mode</code></a> and <a href="https://parsnip.tidymodels.org/reference/set_engine.html"><code>parsnip::set_engine</code></a> to create the model.</p>
<p>Set mixture to 0 to indicate Ridge Regression. For now, we set penalty/lambda as 0.</p>
<p>Use <a href="https://parsnip.tidymodels.org/reference/translate.html"><code>parsnip::translate</code></a> to better understand the model created.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>Hitters <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">as_tibble</span>(ISLR2<span class="sc">::</span>Hitters) <span class="sc">%&gt;%</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">drop_na</span>()</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>ridge_spec <span class="ot">&lt;-</span> parsnip<span class="sc">::</span><span class="fu">linear_reg</span>(</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">mixture =</span> <span class="dv">0</span>,</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">penalty =</span> <span class="dv">0</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_mode</span>(<span class="st">&quot;regression&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">&quot;glmnet&quot;</span>)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>ridge_spec <span class="sc">%&gt;%</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">translate</span>()</span></code></pre></div>
<pre><code>&gt; Linear Regression Model Specification (regression)
&gt; 
&gt; Main Arguments:
&gt;   penalty = 0
&gt;   mixture = 0
&gt; 
&gt; Computational engine: glmnet 
&gt; 
&gt; Model fit template:
&gt; glmnet::glmnet(x = missing_arg(), y = missing_arg(), weights = missing_arg(), 
&gt;     alpha = 0, family = &quot;gaussian&quot;)</code></pre>
<p>Once the specification is created we can fit it to our data using <a href="https://parsnip.tidymodels.org/reference/fit.html"><code>parsnip::fit</code></a>. We will use all the predictors.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>ridge_fit <span class="ot">&lt;-</span> ridge_spec <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">fit</span>(</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> Salary <span class="sc">~</span> .,</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> Hitters</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>We can see the parameter estimate for different values of penalty/lambda with <a href="https://parsnip.tidymodels.org/reference/tidy.model_fit.html"><code>parsnip::tidy</code></a>. Notice how the estimates are decreasing when the amount of penalty goes up</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>parsnip<span class="sc">::</span><span class="fu">tidy</span>(ridge_fit) <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-ca9fad3bdbff68b373a0" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ca9fad3bdbff68b373a0">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"term":["(Intercept)","AtBat","Hits","HmRun","Runs","RBI","Walks","Years","CAtBat","CHits","CHmRun","CRuns","CRBI","CWalks","LeagueN","DivisionW","PutOuts","Assists","Errors","NewLeagueN"],"estimate":[81.126931905343,-0.68159588908878,2.77231158515167,-1.36568011504582,1.01482648205765,0.713022448716654,3.37855759692001,-9.06680040713677,-0.00119947769064437,0.136102881002513,0.697995816101639,0.295889602029511,0.257071062373432,-0.278966595389854,53.2127203431237,-122.834451506425,0.263887566925254,0.169879574615924,-3.68564533746002,-18.1050959562384],"penalty":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},"columns":[{"accessor":"term","name":"term","type":"character"},{"accessor":"estimate","name":"estimate","type":"numeric"},{"accessor":"penalty","name":"penalty","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"2809998446197878396f0e457a5a745b","key":"2809998446197878396f0e457a5a745b"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>parsnip<span class="sc">::</span><span class="fu">tidy</span>(ridge_fit, <span class="at">penalty =</span> <span class="dv">705</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-e0df0ee5fdd4c921ea18" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-e0df0ee5fdd4c921ea18">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"term":["(Intercept)","AtBat","Hits","HmRun","Runs","RBI","Walks","Years","CAtBat","CHits","CHmRun","CRuns","CRBI","CWalks","LeagueN","DivisionW","PutOuts","Assists","Errors","NewLeagueN"],"estimate":[54.3901900988229,0.111991026858279,0.656183080813358,1.17557058238517,0.937457802251324,0.846828376637506,1.32044897466514,2.58210271788695,0.0108284984948835,0.046811466934414,0.33843941992353,0.0937216470218284,0.0978893030649248,0.0717942214109513,13.69631792642,-54.7169353656736,0.118646551581848,0.0161035970550055,-0.704397815882292,8.6093630366201],"penalty":[705,705,705,705,705,705,705,705,705,705,705,705,705,705,705,705,705,705,705,705]},"columns":[{"accessor":"term","name":"term","type":"character"},{"accessor":"estimate","name":"estimate","type":"numeric"},{"accessor":"penalty","name":"penalty","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"db7f6caabd4f2a175c0f204d9945ade2","key":"db7f6caabd4f2a175c0f204d9945ade2"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>parsnip<span class="sc">::</span><span class="fu">tidy</span>(ridge_fit, <span class="at">penalty =</span> <span class="dv">11498</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-b1ab6a72a478c1e5c184" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-b1ab6a72a478c1e5c184">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"term":["(Intercept)","AtBat","Hits","HmRun","Runs","RBI","Walks","Years","CAtBat","CHits","CHmRun","CRuns","CRBI","CWalks","LeagueN","DivisionW","PutOuts","Assists","Errors","NewLeagueN"],"estimate":[407.205936774294,0.0370030829770469,0.138357552142382,0.525195507898014,0.230978289682357,0.240114774750315,0.289971555493143,1.1088323992277,0.00313521465449831,0.0116666839903429,0.0876427890639526,0.0234062578636385,0.0241657234471385,0.0250421169757924,0.0866292341487684,-6.22543133217844,0.0165065958061373,0.0026163350944088,-0.0205641577295531,0.30292289881745],"penalty":[11498,11498,11498,11498,11498,11498,11498,11498,11498,11498,11498,11498,11498,11498,11498,11498,11498,11498,11498,11498]},"columns":[{"accessor":"term","name":"term","type":"character"},{"accessor":"estimate","name":"estimate","type":"numeric"},{"accessor":"penalty","name":"penalty","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"cca2d45705dc5f7ebf6eb2135fd3fc98","key":"cca2d45705dc5f7ebf6eb2135fd3fc98"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>Using <a href="https://parsnip.tidymodels.org/reference/extract-parsnip.html"><code>parsnip::extract_fit_engine</code></a> we can visualize how the magnitude of the coefficients are being regularized towards zero as the penalty goes up.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrange figure margin</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">1</span>))</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>ridge_fit <span class="sc">%&gt;%</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">extract_fit_engine</span>() <span class="sc">%&gt;%</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">xvar =</span> <span class="st">&quot;lambda&quot;</span>)</span></code></pre></div>
<p><img src="figures/unnamed-chunk-24-1.png" width="3883.2" style="display: block; margin: auto;" /></p>
<p>It would be nice if we could find the “best” value of the penalty/lambda. We can do this using the <a href="https://tune.tidymodels.org/reference/tune_grid.html"><code>tune::tune_grid</code></a></p>
<p>Need we need three things in order to use the <a href="https://tune.tidymodels.org/reference/tune_grid.html"><code>tune::tune_grid</code></a></p>
<ul>
<li><p>a <code>resample</code> object containing the resamples the <code>workflow</code> should be fitted within,</p></li>
<li><p>a <code>workflow</code> object containing the model and preprocessor,and</p></li>
<li><p>a tibble <code>penalty_grid</code> containing the parameter values to be evaluated.</p></li>
</ul>
</div>
<div id="create-the-resample-object" class="section level2">
<h2>Create the resample object</h2>
<p>First, we split the samples into a training set and a test set. From the training set, we create a 10-fold cross-validation data set from the training set.</p>
<p>This is done with <a href="https://rsample.tidymodels.org/reference/initial_split.html"><code>rsample::initial_split</code></a>, <a href="https://rsample.tidymodels.org/reference/initial_split.html"><code>rsample::training</code></a>, <a href="https://rsample.tidymodels.org/reference/initial_split.html"><code>rsample::testing</code></a> and <a href="https://rsample.tidymodels.org/reference/vfold_cv.html"><code>rsample::vfold_cv</code></a>.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>Hitters <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">as_tibble</span>(ISLR2<span class="sc">::</span>Hitters) <span class="sc">%&gt;%</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">drop_na</span>()</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>Hitters_split <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">initial_split</span>(Hitters, <span class="at">strata =</span> <span class="st">&quot;Salary&quot;</span>)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>Hitters_train <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">training</span>(Hitters_split)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>Hitters_test <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">testing</span>(Hitters_split)</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>Hitters_fold <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">vfold_cv</span>(Hitters_train, <span class="at">v =</span> <span class="dv">10</span>)</span></code></pre></div>
</div>
<div id="create-the-preprocessor" class="section level2">
<h2>Create the preprocessor</h2>
<p>We use the <code>recipes</code> package to create the preprocessing steps. However, the order of the preprocessing step is actually important. See the <a href="https://cran.r-project.org/web/packages/recipes/vignettes/Ordering.html">Ordering of steps vignette</a></p>
<p>We create a basic recipe with <a href="https://recipes.tidymodels.org/reference/recipe.html"><code>recipes::recipe</code></a>.</p>
<p>Apply <a href="https://recipes.tidymodels.org/reference/prep.html"><code>recipes::prep</code></a> and <a href="https://recipes.tidymodels.org/reference/bake.html"><code>recipes::bake</code></a> to compute the preprocessing step.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>ridge_recipe <span class="ot">&lt;-</span> recipes<span class="sc">::</span><span class="fu">recipe</span>(</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> Salary <span class="sc">~</span> .,</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> Hitters_train</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>rec <span class="ot">&lt;-</span> recipes<span class="sc">::</span><span class="fu">prep</span>(<span class="at">x =</span> ridge_recipe, <span class="at">training =</span> Hitters_train)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>rec <span class="sc">%&gt;%</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>() <span class="sc">%&gt;%</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-7d566c79b3a4c8369aa5" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-7d566c79b3a4c8369aa5">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"variable":["AtBat","Hits","HmRun","Runs","RBI","Walks","Years","CAtBat","CHits","CHmRun","CRuns","CRBI","CWalks","League","Division","PutOuts","Assists","Errors","NewLeague","Salary"],"type":["numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","nominal","nominal","numeric","numeric","numeric","nominal","numeric"],"role":["predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","outcome"],"source":["original","original","original","original","original","original","original","original","original","original","original","original","original","original","original","original","original","original","original","original"]},"columns":[{"accessor":"variable","name":"variable","type":"character"},{"accessor":"type","name":"type","type":"character"},{"accessor":"role","name":"role","type":"character"},{"accessor":"source","name":"source","type":"character"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"c411a1329a41941d02bdceb1680a64d8","key":"c411a1329a41941d02bdceb1680a64d8"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>rec <span class="sc">%&gt;%</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">bake</span>(<span class="at">new_data =</span> Hitters_train) <span class="sc">%&gt;%</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-ced5d368e14a17cbb784" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ced5d368e14a17cbb784">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"AtBat":[185,298,323,190,127,426,419,268,416,199,521,280,511,215,472,445,143,185,600,151,278,341,399,165,315,181,328,279,338,216,209,407,209,504,258,211,299,547,540,236,312,126,382,549,512,461,453,578,408,593,196,204,254,416,405,244,313,155,236,216,311,351,155,415,325,574,327,354,539,340,220,278,663,160,210,537,257,404,344,680,431,576,288,369,572,357,376,246,205,394,522,528,281,687,265,205,193,213,441,475,479,496,594,574,202,418,239,472,403,507,255,314,424,566,283,408,510,380,584,306,343,579,184,591,283,560,503,491,625,490,442,288,330,526,313,237,473,271,419,348,523,627,530,562,642,127,480,360,387,497,401,568,629,587,379,526,457,591,627,585,512,677,614,637,475,565,495,441,490,570,479,599,497,618,429,490,550,586,484,589,327,489,20,374,437,608,496,522,557,593,559,510,172,580,492,573],"Hits":[37,73,81,46,32,109,108,60,113,53,142,82,138,51,118,99,39,40,144,41,86,95,102,39,76,58,91,64,92,54,56,93,54,120,60,43,75,137,135,56,68,27,101,149,117,112,103,138,117,172,43,49,68,132,102,58,78,44,56,53,81,97,41,115,76,152,85,77,139,84,54,70,200,39,70,147,66,92,85,223,127,167,76,93,152,96,82,76,52,86,140,122,76,213,68,43,47,61,113,126,130,141,169,159,53,113,60,116,101,122,70,83,110,154,77,94,126,120,158,104,103,174,47,184,74,161,136,141,179,148,131,65,77,163,83,52,154,77,101,90,135,178,159,169,211,32,112,81,124,127,92,158,168,163,106,146,101,168,177,139,131,238,163,174,123,148,151,128,125,169,133,183,136,200,91,150,147,159,127,149,84,131,1,94,123,160,119,163,142,152,141,147,42,207,136,144],"HmRun":[1,0,6,2,8,3,6,5,24,5,20,16,25,4,12,1,5,4,33,4,4,6,3,2,13,6,12,0,18,2,12,8,3,28,8,10,6,2,30,6,2,3,16,7,29,18,8,1,11,22,7,6,2,7,18,9,6,6,0,1,3,4,12,27,16,31,3,16,5,11,10,7,29,8,13,23,5,11,24,31,8,8,7,9,18,7,21,5,8,1,16,1,3,10,8,2,10,4,5,3,18,20,4,21,4,13,0,16,12,29,7,13,15,22,14,4,2,5,15,14,6,7,5,20,4,26,5,11,4,14,18,8,19,12,9,0,6,5,18,11,8,14,3,17,14,4,18,5,1,7,17,20,18,4,10,13,14,19,25,31,26,31,29,31,27,24,17,16,24,21,10,10,7,20,12,21,29,12,20,21,22,19,0,5,9,28,8,9,21,23,2,10,3,8,5,9],"Runs":[23,24,26,24,16,55,55,24,58,29,67,44,76,19,63,46,18,23,85,26,33,48,56,13,35,34,51,31,42,27,22,47,25,71,28,26,38,58,82,41,32,8,50,73,54,54,53,56,66,82,29,23,28,57,49,28,32,21,27,31,42,55,21,97,33,91,30,36,93,62,30,22,108,18,32,58,31,54,69,119,77,89,34,43,105,50,42,35,31,38,73,67,42,91,26,24,21,17,76,61,66,65,74,107,31,48,30,60,45,78,49,39,70,76,45,42,42,54,70,50,48,67,20,83,34,89,62,77,94,64,68,30,47,88,43,15,61,35,65,50,52,68,82,88,107,14,50,37,67,65,49,89,73,92,38,71,42,80,98,93,69,117,89,89,76,90,61,70,81,72,48,80,58,98,41,69,85,72,66,89,53,77,0,36,62,130,57,82,58,69,48,56,17,107,76,85],"RBI":[8,24,32,8,22,43,36,25,69,22,86,45,96,18,54,24,30,11,117,21,38,42,34,9,60,23,43,26,60,25,36,30,14,71,33,35,23,47,88,19,22,10,55,47,88,54,33,59,41,100,27,25,26,49,85,25,41,23,15,15,30,29,29,71,52,101,44,55,58,33,39,37,121,31,51,88,26,49,64,96,45,49,37,42,49,45,60,39,27,28,77,45,25,65,30,17,29,22,52,43,72,78,51,75,26,61,11,62,53,85,35,46,47,84,47,36,44,51,84,58,36,78,28,79,29,96,48,47,60,78,77,36,53,50,41,25,48,29,58,45,44,76,50,73,59,25,71,44,27,48,66,75,102,51,60,70,63,72,81,94,96,113,83,116,93,104,84,73,105,88,72,74,38,110,42,58,91,79,65,86,62,55,0,26,55,74,33,46,81,75,61,52,14,71,50,60],"Walks":[21,7,8,15,14,62,22,15,16,21,45,47,61,11,30,29,15,18,65,19,45,20,34,16,25,22,33,30,21,33,19,30,12,54,18,39,26,12,55,21,24,5,22,42,43,35,52,34,34,57,30,12,22,33,20,35,12,15,11,22,26,39,22,68,37,64,20,41,69,47,31,18,32,22,28,47,32,18,88,34,58,57,15,49,65,39,35,13,17,36,60,51,20,27,29,20,24,3,76,52,76,37,35,59,27,47,22,74,39,91,43,16,36,43,26,66,35,31,42,25,40,58,18,38,22,66,83,37,65,49,33,27,27,77,30,30,29,33,92,43,52,46,47,53,52,12,44,37,36,37,65,73,40,70,30,84,22,39,70,62,52,53,75,56,72,77,78,80,62,38,55,32,26,62,57,35,71,53,67,64,38,34,0,62,40,89,21,62,23,53,73,53,15,105,94,78],"Years":[2,3,2,5,8,1,3,2,1,3,4,2,3,1,4,4,9,3,2,2,1,10,5,3,3,1,2,1,3,1,2,2,1,3,3,3,3,2,1,5,1,4,1,1,6,2,2,3,1,1,13,7,6,3,6,4,12,16,4,4,17,4,16,3,5,3,8,20,5,5,5,18,4,14,15,10,14,6,7,3,2,4,4,5,2,5,5,6,12,4,4,4,8,4,7,7,6,17,5,6,3,11,11,10,9,4,6,6,12,18,15,5,7,14,16,9,11,8,5,7,15,6,11,5,10,4,10,15,5,13,6,9,6,4,14,24,6,12,20,10,9,6,6,8,5,19,7,7,7,5,13,15,18,6,14,6,17,9,6,17,14,5,11,14,4,14,10,14,13,7,17,5,11,13,13,14,6,9,7,7,10,7,2,7,9,8,7,13,18,6,8,7,10,5,12,8],"CAtBat":[214,509,341,479,727,426,591,350,416,514,815,428,592,215,793,618,639,524,696,288,278,2964,670,196,630,181,342,279,682,216,216,969,209,1085,638,498,580,1038,540,1257,312,239,382,549,1750,680,507,1399,408,593,3231,1309,999,932,950,1335,3742,6631,1115,926,8247,1258,5409,711,1506,985,2140,8716,1469,1516,1185,7186,1447,2128,4040,2744,3910,1354,911,1928,667,822,1644,1258,978,1394,1770,912,5134,1089,730,1716,2658,1518,1337,854,1136,4061,1546,1700,1624,5628,4408,4631,1876,1512,1941,1924,5150,7761,6311,1457,2130,6100,6840,3573,5562,3118,2358,2954,4338,3053,3327,1689,3919,1789,3423,4291,1696,3400,1416,2815,1928,1556,5885,14053,1966,4933,9528,2288,3368,3146,1619,3181,2364,8396,3031,2268,1775,2703,5206,8068,8424,2695,6207,2648,6521,4478,3210,7546,5347,2223,5017,6727,1810,7287,5624,6675,6063,3754,7472,2482,3871,7127,5590,6126,2816,3082,3006,3558,4273,2051,41,1968,4139,4071,3358,7037,8759,2765,3162,2872,4086,2778,5511,3198],"CHits":[42,108,86,102,180,109,149,78,113,120,205,113,164,51,187,129,151,125,173,68,86,808,167,44,151,58,94,64,185,54,58,230,54,259,170,116,160,271,135,329,68,49,101,149,412,160,123,357,117,172,825,308,236,273,231,333,968,1634,270,210,2198,353,1338,184,351,260,568,2172,369,376,299,2081,404,543,1130,730,979,325,214,587,187,232,408,323,249,344,408,234,1323,267,185,403,657,448,339,219,256,1145,397,433,457,1575,1133,1300,467,392,510,489,1429,1947,1661,405,544,1583,1910,866,1578,900,636,822,1193,880,890,462,1062,470,970,1240,476,1000,398,698,516,470,1543,4256,566,1358,2510,614,895,902,426,841,770,2402,771,566,506,806,1332,2273,2464,747,1906,715,1767,1307,927,1982,1397,737,1388,2024,471,2083,1679,2095,1646,1077,2147,715,1066,2163,1397,1839,815,880,844,928,1123,549,9,519,1203,1182,882,2019,2583,686,874,821,1150,978,1511,857],"CHmRun":[1,0,6,5,24,3,8,5,24,8,22,25,28,4,14,1,16,7,38,9,4,81,4,2,24,6,12,0,36,2,12,14,3,54,17,14,8,3,30,24,2,3,16,7,100,24,8,7,11,22,36,27,21,24,29,49,35,98,1,9,100,16,181,45,71,53,16,384,12,42,40,190,57,56,97,97,33,30,64,35,9,19,16,54,36,43,115,12,56,3,22,12,48,15,32,12,42,83,17,7,63,225,19,90,15,41,4,67,166,347,154,28,38,131,259,59,44,92,58,55,70,32,74,40,85,65,20,84,12,113,47,55,90,38,104,160,29,48,548,43,39,74,11,61,27,242,110,41,6,32,253,177,164,17,146,77,281,113,133,315,221,93,266,247,108,305,275,209,271,140,153,27,40,351,83,121,117,83,116,102,212,62,2,26,79,103,36,153,271,133,16,63,57,32,39,97],"CRuns":[30,41,32,65,67,55,80,34,58,57,99,61,87,19,102,72,80,58,101,45,33,379,89,18,68,34,51,31,88,27,24,121,25,150,80,59,71,129,82,166,32,16,50,73,204,76,63,149,66,82,376,126,108,113,99,164,409,698,116,118,950,196,746,156,195,148,216,1172,247,284,145,935,210,304,544,302,518,188,150,262,117,132,198,181,168,178,238,102,643,94,93,211,324,196,135,105,129,488,226,217,224,828,501,702,192,205,309,242,747,1175,1019,156,335,743,915,429,703,444,265,313,581,366,419,219,505,233,408,615,216,445,210,315,247,245,751,2165,250,630,1509,295,377,494,218,450,352,1048,338,279,272,379,784,1045,1008,442,859,352,1003,634,529,1141,712,349,813,978,292,1135,884,1072,847,492,980,330,450,1104,578,983,405,363,436,513,577,300,6,181,676,862,365,1043,1138,369,421,307,579,474,897,470],"CRBI":[9,37,34,23,82,43,46,29,69,40,103,70,110,18,80,31,97,37,130,39,38,428,48,10,94,23,44,26,112,25,37,69,14,167,75,55,33,80,88,125,22,13,55,47,276,75,39,161,41,100,290,132,117,121,138,179,321,661,64,69,909,110,805,119,219,173,208,1267,126,141,154,1088,222,268,462,351,324,135,156,201,64,83,120,177,91,192,299,96,445,71,106,146,300,137,163,99,139,491,149,93,266,838,336,504,186,204,103,251,666,1152,608,159,174,693,1067,365,519,419,316,377,421,337,382,195,456,260,303,430,163,491,203,325,288,167,714,1314,252,435,1659,273,284,345,149,342,230,1348,406,257,125,311,890,993,1072,198,803,342,977,563,472,1179,815,401,822,1093,343,1234,1015,1050,999,589,1032,326,367,1289,579,707,474,477,458,471,700,263,7,199,390,417,280,827,1299,384,349,340,363,322,451,420],"CWalks":[24,12,8,39,56,62,31,18,16,39,78,63,71,11,50,48,61,47,69,35,45,221,54,18,55,22,33,30,50,33,19,68,12,114,36,78,44,24,55,105,24,14,22,42,155,49,58,87,34,57,238,66,118,80,64,194,170,777,57,114,690,117,875,99,214,95,93,1057,198,219,128,643,68,298,551,174,382,63,187,91,88,79,113,157,101,136,157,80,459,76,86,155,179,89,128,71,106,244,191,146,263,354,194,488,161,203,207,240,526,1380,820,76,258,300,546,410,256,240,134,187,325,218,304,82,283,155,414,340,166,301,136,189,161,174,535,1566,178,403,1342,269,296,242,163,373,193,819,239,246,194,138,866,732,402,317,571,289,619,319,313,727,548,171,617,495,267,791,709,695,680,263,854,158,241,564,644,600,319,295,377,351,334,153,4,288,364,708,165,535,478,321,359,174,406,417,875,332],"League":["N","A","N","A","N","A","N","N","A","A","A","A","A","A","A","A","N","N","A","A","N","N","A","A","N","N","N","N","A","N","N","N","A","A","A","A","N","A","A","A","A","N","A","N","A","A","A","N","N","A","N","A","A","N","N","N","N","N","A","N","N","N","A","N","N","N","A","N","A","N","N","A","A","A","A","N","N","A","A","A","N","N","N","A","A","A","A","A","A","N","N","A","A","A","N","N","A","A","A","A","A","N","A","A","N","N","A","N","A","A","N","A","N","A","A","N","N","A","N","N","A","N","N","N","N","N","N","A","A","A","A","N","N","A","N","N","A","A","A","A","N","N","A","A","N","N","N","N","N","N","A","N","A","A","N","N","A","A","A","A","A","A","N","N","N","A","A","A","N","A","N","A","A","A","A","A","A","N","N","A","A","A","N","N","A","A","N","A","N","A","N","N","N","A","A","A"],"Division":["E","W","W","W","W","W","W","W","E","W","E","E","W","E","W","W","W","E","W","W","W","W","W","W","E","W","E","W","E","W","E","W","W","E","W","W","E","W","W","E","E","E","W","W","W","W","W","E","W","W","E","W","E","W","W","W","W","E","W","W","W","W","W","W","W","W","E","W","W","E","E","W","E","E","E","E","W","E","W","W","E","E","W","E","W","W","W","E","E","E","E","W","E","E","W","E","W","W","W","W","W","E","W","E","W","E","E","W","E","E","E","W","W","W","W","W","W","W","E","E","E","E","W","W","W","W","W","E","E","E","E","E","W","W","W","W","E","W","W","E","W","E","W","E","W","W","E","E","E","E","E","W","E","E","W","W","W","W","E","E","W","E","W","W","E","E","E","W","E","W","W","E","E","E","W","E","W","E","E","E","E","W","E","W","E","E","W","E","W","W","E","E","W","E","E","E"],"PutOuts":[76,121,143,102,202,361,226,442,203,152,107,148,157,116,228,278,138,97,319,28,102,158,211,332,498,88,145,107,0,317,201,172,102,103,358,463,212,261,157,172,86,190,200,255,1236,111,289,133,942,1222,80,419,359,73,161,142,106,53,125,73,153,226,165,274,726,1253,91,83,462,185,50,0,241,33,0,92,87,222,0,429,283,325,203,149,325,167,0,44,155,203,1320,209,106,294,92,131,299,178,160,37,880,200,282,238,304,211,121,518,316,808,51,533,292,316,144,282,207,237,331,116,211,280,49,303,145,332,65,239,303,0,233,259,149,250,58,523,846,62,0,60,367,309,196,351,337,167,94,170,186,325,0,105,1067,434,72,303,389,67,240,0,119,1377,303,278,226,292,1045,97,869,295,237,231,304,330,686,96,1218,181,1231,371,483,310,78,756,82,426,155,352,1160,315,352,810,65,121,313,1314],"Assists":[127,283,290,177,22,22,7,59,70,3,242,4,7,5,377,415,15,2,4,56,4,4,9,19,39,0,59,205,0,36,6,317,6,283,32,32,1,459,6,1,150,2,7,450,98,226,407,371,72,139,45,46,30,177,10,14,206,88,199,152,223,7,9,2,87,111,185,174,9,8,136,0,8,3,0,257,166,5,0,8,8,12,3,1,13,2,0,0,3,369,166,372,144,445,5,6,13,45,290,113,82,11,421,445,45,11,151,55,6,108,54,40,6,439,6,487,358,8,20,222,56,479,2,12,5,9,258,8,450,0,7,30,8,11,141,43,84,90,0,176,475,492,354,442,19,18,270,284,290,9,0,290,157,9,170,9,39,147,482,0,216,100,6,9,10,9,88,218,62,15,5,374,347,16,46,5,104,13,80,6,48,9,220,64,170,4,371,9,53,10,414,99,0,267,381,131],"Errors":[7,9,19,16,2,2,4,6,10,5,23,2,8,12,26,16,1,2,14,2,2,5,3,2,13,3,8,16,0,1,3,25,3,19,8,8,2,22,14,4,15,9,6,17,18,11,6,20,11,15,8,5,4,18,3,2,7,3,13,11,10,3,1,7,3,11,12,16,7,4,20,0,6,0,0,20,14,5,0,6,3,8,3,6,3,4,0,1,2,16,17,17,7,13,3,1,5,4,11,7,14,3,25,22,11,7,6,3,5,2,8,4,3,10,5,19,20,1,4,15,13,5,0,5,7,8,8,2,14,0,7,10,6,1,23,6,9,3,0,6,19,5,15,17,4,6,16,3,17,3,0,10,14,3,24,9,4,4,13,0,12,6,6,9,6,5,13,16,8,5,4,18,10,8,4,3,10,4,7,6,6,9,6,15,15,6,29,1,7,6,9,18,0,19,20,12],"NewLeague":["A","A","N","A","N","N","N","N","A","A","A","A","A","A","A","A","N","N","A","A","N","N","A","N","N","N","N","N","A","N","N","N","A","A","A","A","N","A","A","A","A","N","A","N","A","A","A","N","N","A","N","A","A","N","N","N","N","N","A","N","N","A","A","N","A","N","A","N","A","A","N","A","A","A","A","N","A","A","A","A","N","N","N","A","A","A","A","A","A","N","N","A","A","A","A","N","A","A","A","A","A","N","A","A","N","N","A","N","A","A","N","A","N","A","A","N","N","A","N","N","A","N","N","N","N","N","N","A","A","N","A","A","N","A","N","N","A","A","A","A","N","N","A","A","N","N","N","N","N","N","A","N","A","A","N","N","A","A","A","A","A","A","N","N","N","A","A","A","N","A","N","A","A","A","N","N","A","N","N","A","N","A","N","N","A","A","N","A","N","A","N","N","N","A","A","A"],"Salary":[70,100,75,175,135,115,110,90,90,75,105,110,145,70,155,87.5,175,90,165,95,110,100,80,75,155,86.5,125,75,145,75,90,150,68,175,137,120,140,175,172,190,70,190,97.5,140,100,135,105,160,120,165,240,300,305,215,415,340,416.667,275,230,225,320,210,260,300,385,215,362.5,200,400,400,297.5,325,250,275,365,277.5,250,300,300,365,202.5,210,240,350,200,300,425,250,400,250,200,350,341.667,350,425,286.667,245,235,425,385,480,500,750,517.143,512.5,550,700,600,675,535,450,431.5,490,750,700,535,737.5,600,662.5,750,430,657,450,630,737.5,625,725,525,575,700,550,650,670,750,450,750,580,450,487.5,450,750,740,475,530,740,500,750,525,550,700,1100,775,776.667,765,850,815,875,1200,1350,950,850,1975,1900,1041.667,1220,1861.46,2460,1500,1925.571,950,773.333,775,850,2412.5,825,1000,1310,1043.333,1183.333,787.5,800,780,2127.333,875,1260,1670,875,1000,1450,940,925,1150,900,1600,875,960]},"columns":[{"accessor":"AtBat","name":"AtBat","type":"numeric"},{"accessor":"Hits","name":"Hits","type":"numeric"},{"accessor":"HmRun","name":"HmRun","type":"numeric"},{"accessor":"Runs","name":"Runs","type":"numeric"},{"accessor":"RBI","name":"RBI","type":"numeric"},{"accessor":"Walks","name":"Walks","type":"numeric"},{"accessor":"Years","name":"Years","type":"numeric"},{"accessor":"CAtBat","name":"CAtBat","type":"numeric"},{"accessor":"CHits","name":"CHits","type":"numeric"},{"accessor":"CHmRun","name":"CHmRun","type":"numeric"},{"accessor":"CRuns","name":"CRuns","type":"numeric"},{"accessor":"CRBI","name":"CRBI","type":"numeric"},{"accessor":"CWalks","name":"CWalks","type":"numeric"},{"accessor":"League","name":"League","type":"factor"},{"accessor":"Division","name":"Division","type":"factor"},{"accessor":"PutOuts","name":"PutOuts","type":"numeric"},{"accessor":"Assists","name":"Assists","type":"numeric"},{"accessor":"Errors","name":"Errors","type":"numeric"},{"accessor":"NewLeague","name":"NewLeague","type":"factor"},{"accessor":"Salary","name":"Salary","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"674bb56a3786cd1fa3e30a4e13fd5ace","key":"674bb56a3786cd1fa3e30a4e13fd5ace"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>Do preprocessing on the factor variables <a href="https://recipes.tidymodels.org/reference/has_role.html"><code>recipes::all_nominal_predictors</code></a>. <a href="https://recipes.tidymodels.org/reference/step_novel.html"><code>recipes::step_novel</code></a> and <a href="https://recipes.tidymodels.org/reference/step_dummy.html"><code>recipes::step_dummy</code></a> was used.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>ridge_recipe <span class="ot">&lt;-</span> ridge_recipe <span class="sc">%&gt;%</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step Novel is important.</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If test set has a new factor not found in training, it will be treated as &quot;new&quot; and not NA</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This will prevent the model from giving an error</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># https://blog.datascienceheroes.com/how-to-use-recipes-package-for-one-hot-encoding/</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_novel</span>(recipes<span class="sc">::</span><span class="fu">all_nominal_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create Dummy variables</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_dummy</span>(recipes<span class="sc">::</span><span class="fu">all_nominal_predictors</span>())</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>rec <span class="ot">&lt;-</span> recipes<span class="sc">::</span><span class="fu">prep</span>(<span class="at">x =</span> ridge_recipe, <span class="at">training =</span> Hitters_train)</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>rec <span class="sc">%&gt;%</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>() <span class="sc">%&gt;%</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-f2defae6332564cede63" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-f2defae6332564cede63">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"variable":["AtBat","Hits","HmRun","Runs","RBI","Walks","Years","CAtBat","CHits","CHmRun","CRuns","CRBI","CWalks","PutOuts","Assists","Errors","Salary","League_N","League_new","Division_W","Division_new","NewLeague_N","NewLeague_new"],"type":["numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric"],"role":["predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","outcome","predictor","predictor","predictor","predictor","predictor","predictor"],"source":["original","original","original","original","original","original","original","original","original","original","original","original","original","original","original","original","original","derived","derived","derived","derived","derived","derived"]},"columns":[{"accessor":"variable","name":"variable","type":"character"},{"accessor":"type","name":"type","type":"character"},{"accessor":"role","name":"role","type":"character"},{"accessor":"source","name":"source","type":"character"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"93057f8a0965c428e362dbde37c87b5a","key":"93057f8a0965c428e362dbde37c87b5a"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>rec <span class="sc">%&gt;%</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">bake</span>(<span class="at">new_data =</span> Hitters_train) <span class="sc">%&gt;%</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-96bb8c9b017ae97a2371" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-96bb8c9b017ae97a2371">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"AtBat":[185,298,323,190,127,426,419,268,416,199,521,280,511,215,472,445,143,185,600,151,278,341,399,165,315,181,328,279,338,216,209,407,209,504,258,211,299,547,540,236,312,126,382,549,512,461,453,578,408,593,196,204,254,416,405,244,313,155,236,216,311,351,155,415,325,574,327,354,539,340,220,278,663,160,210,537,257,404,344,680,431,576,288,369,572,357,376,246,205,394,522,528,281,687,265,205,193,213,441,475,479,496,594,574,202,418,239,472,403,507,255,314,424,566,283,408,510,380,584,306,343,579,184,591,283,560,503,491,625,490,442,288,330,526,313,237,473,271,419,348,523,627,530,562,642,127,480,360,387,497,401,568,629,587,379,526,457,591,627,585,512,677,614,637,475,565,495,441,490,570,479,599,497,618,429,490,550,586,484,589,327,489,20,374,437,608,496,522,557,593,559,510,172,580,492,573],"Hits":[37,73,81,46,32,109,108,60,113,53,142,82,138,51,118,99,39,40,144,41,86,95,102,39,76,58,91,64,92,54,56,93,54,120,60,43,75,137,135,56,68,27,101,149,117,112,103,138,117,172,43,49,68,132,102,58,78,44,56,53,81,97,41,115,76,152,85,77,139,84,54,70,200,39,70,147,66,92,85,223,127,167,76,93,152,96,82,76,52,86,140,122,76,213,68,43,47,61,113,126,130,141,169,159,53,113,60,116,101,122,70,83,110,154,77,94,126,120,158,104,103,174,47,184,74,161,136,141,179,148,131,65,77,163,83,52,154,77,101,90,135,178,159,169,211,32,112,81,124,127,92,158,168,163,106,146,101,168,177,139,131,238,163,174,123,148,151,128,125,169,133,183,136,200,91,150,147,159,127,149,84,131,1,94,123,160,119,163,142,152,141,147,42,207,136,144],"HmRun":[1,0,6,2,8,3,6,5,24,5,20,16,25,4,12,1,5,4,33,4,4,6,3,2,13,6,12,0,18,2,12,8,3,28,8,10,6,2,30,6,2,3,16,7,29,18,8,1,11,22,7,6,2,7,18,9,6,6,0,1,3,4,12,27,16,31,3,16,5,11,10,7,29,8,13,23,5,11,24,31,8,8,7,9,18,7,21,5,8,1,16,1,3,10,8,2,10,4,5,3,18,20,4,21,4,13,0,16,12,29,7,13,15,22,14,4,2,5,15,14,6,7,5,20,4,26,5,11,4,14,18,8,19,12,9,0,6,5,18,11,8,14,3,17,14,4,18,5,1,7,17,20,18,4,10,13,14,19,25,31,26,31,29,31,27,24,17,16,24,21,10,10,7,20,12,21,29,12,20,21,22,19,0,5,9,28,8,9,21,23,2,10,3,8,5,9],"Runs":[23,24,26,24,16,55,55,24,58,29,67,44,76,19,63,46,18,23,85,26,33,48,56,13,35,34,51,31,42,27,22,47,25,71,28,26,38,58,82,41,32,8,50,73,54,54,53,56,66,82,29,23,28,57,49,28,32,21,27,31,42,55,21,97,33,91,30,36,93,62,30,22,108,18,32,58,31,54,69,119,77,89,34,43,105,50,42,35,31,38,73,67,42,91,26,24,21,17,76,61,66,65,74,107,31,48,30,60,45,78,49,39,70,76,45,42,42,54,70,50,48,67,20,83,34,89,62,77,94,64,68,30,47,88,43,15,61,35,65,50,52,68,82,88,107,14,50,37,67,65,49,89,73,92,38,71,42,80,98,93,69,117,89,89,76,90,61,70,81,72,48,80,58,98,41,69,85,72,66,89,53,77,0,36,62,130,57,82,58,69,48,56,17,107,76,85],"RBI":[8,24,32,8,22,43,36,25,69,22,86,45,96,18,54,24,30,11,117,21,38,42,34,9,60,23,43,26,60,25,36,30,14,71,33,35,23,47,88,19,22,10,55,47,88,54,33,59,41,100,27,25,26,49,85,25,41,23,15,15,30,29,29,71,52,101,44,55,58,33,39,37,121,31,51,88,26,49,64,96,45,49,37,42,49,45,60,39,27,28,77,45,25,65,30,17,29,22,52,43,72,78,51,75,26,61,11,62,53,85,35,46,47,84,47,36,44,51,84,58,36,78,28,79,29,96,48,47,60,78,77,36,53,50,41,25,48,29,58,45,44,76,50,73,59,25,71,44,27,48,66,75,102,51,60,70,63,72,81,94,96,113,83,116,93,104,84,73,105,88,72,74,38,110,42,58,91,79,65,86,62,55,0,26,55,74,33,46,81,75,61,52,14,71,50,60],"Walks":[21,7,8,15,14,62,22,15,16,21,45,47,61,11,30,29,15,18,65,19,45,20,34,16,25,22,33,30,21,33,19,30,12,54,18,39,26,12,55,21,24,5,22,42,43,35,52,34,34,57,30,12,22,33,20,35,12,15,11,22,26,39,22,68,37,64,20,41,69,47,31,18,32,22,28,47,32,18,88,34,58,57,15,49,65,39,35,13,17,36,60,51,20,27,29,20,24,3,76,52,76,37,35,59,27,47,22,74,39,91,43,16,36,43,26,66,35,31,42,25,40,58,18,38,22,66,83,37,65,49,33,27,27,77,30,30,29,33,92,43,52,46,47,53,52,12,44,37,36,37,65,73,40,70,30,84,22,39,70,62,52,53,75,56,72,77,78,80,62,38,55,32,26,62,57,35,71,53,67,64,38,34,0,62,40,89,21,62,23,53,73,53,15,105,94,78],"Years":[2,3,2,5,8,1,3,2,1,3,4,2,3,1,4,4,9,3,2,2,1,10,5,3,3,1,2,1,3,1,2,2,1,3,3,3,3,2,1,5,1,4,1,1,6,2,2,3,1,1,13,7,6,3,6,4,12,16,4,4,17,4,16,3,5,3,8,20,5,5,5,18,4,14,15,10,14,6,7,3,2,4,4,5,2,5,5,6,12,4,4,4,8,4,7,7,6,17,5,6,3,11,11,10,9,4,6,6,12,18,15,5,7,14,16,9,11,8,5,7,15,6,11,5,10,4,10,15,5,13,6,9,6,4,14,24,6,12,20,10,9,6,6,8,5,19,7,7,7,5,13,15,18,6,14,6,17,9,6,17,14,5,11,14,4,14,10,14,13,7,17,5,11,13,13,14,6,9,7,7,10,7,2,7,9,8,7,13,18,6,8,7,10,5,12,8],"CAtBat":[214,509,341,479,727,426,591,350,416,514,815,428,592,215,793,618,639,524,696,288,278,2964,670,196,630,181,342,279,682,216,216,969,209,1085,638,498,580,1038,540,1257,312,239,382,549,1750,680,507,1399,408,593,3231,1309,999,932,950,1335,3742,6631,1115,926,8247,1258,5409,711,1506,985,2140,8716,1469,1516,1185,7186,1447,2128,4040,2744,3910,1354,911,1928,667,822,1644,1258,978,1394,1770,912,5134,1089,730,1716,2658,1518,1337,854,1136,4061,1546,1700,1624,5628,4408,4631,1876,1512,1941,1924,5150,7761,6311,1457,2130,6100,6840,3573,5562,3118,2358,2954,4338,3053,3327,1689,3919,1789,3423,4291,1696,3400,1416,2815,1928,1556,5885,14053,1966,4933,9528,2288,3368,3146,1619,3181,2364,8396,3031,2268,1775,2703,5206,8068,8424,2695,6207,2648,6521,4478,3210,7546,5347,2223,5017,6727,1810,7287,5624,6675,6063,3754,7472,2482,3871,7127,5590,6126,2816,3082,3006,3558,4273,2051,41,1968,4139,4071,3358,7037,8759,2765,3162,2872,4086,2778,5511,3198],"CHits":[42,108,86,102,180,109,149,78,113,120,205,113,164,51,187,129,151,125,173,68,86,808,167,44,151,58,94,64,185,54,58,230,54,259,170,116,160,271,135,329,68,49,101,149,412,160,123,357,117,172,825,308,236,273,231,333,968,1634,270,210,2198,353,1338,184,351,260,568,2172,369,376,299,2081,404,543,1130,730,979,325,214,587,187,232,408,323,249,344,408,234,1323,267,185,403,657,448,339,219,256,1145,397,433,457,1575,1133,1300,467,392,510,489,1429,1947,1661,405,544,1583,1910,866,1578,900,636,822,1193,880,890,462,1062,470,970,1240,476,1000,398,698,516,470,1543,4256,566,1358,2510,614,895,902,426,841,770,2402,771,566,506,806,1332,2273,2464,747,1906,715,1767,1307,927,1982,1397,737,1388,2024,471,2083,1679,2095,1646,1077,2147,715,1066,2163,1397,1839,815,880,844,928,1123,549,9,519,1203,1182,882,2019,2583,686,874,821,1150,978,1511,857],"CHmRun":[1,0,6,5,24,3,8,5,24,8,22,25,28,4,14,1,16,7,38,9,4,81,4,2,24,6,12,0,36,2,12,14,3,54,17,14,8,3,30,24,2,3,16,7,100,24,8,7,11,22,36,27,21,24,29,49,35,98,1,9,100,16,181,45,71,53,16,384,12,42,40,190,57,56,97,97,33,30,64,35,9,19,16,54,36,43,115,12,56,3,22,12,48,15,32,12,42,83,17,7,63,225,19,90,15,41,4,67,166,347,154,28,38,131,259,59,44,92,58,55,70,32,74,40,85,65,20,84,12,113,47,55,90,38,104,160,29,48,548,43,39,74,11,61,27,242,110,41,6,32,253,177,164,17,146,77,281,113,133,315,221,93,266,247,108,305,275,209,271,140,153,27,40,351,83,121,117,83,116,102,212,62,2,26,79,103,36,153,271,133,16,63,57,32,39,97],"CRuns":[30,41,32,65,67,55,80,34,58,57,99,61,87,19,102,72,80,58,101,45,33,379,89,18,68,34,51,31,88,27,24,121,25,150,80,59,71,129,82,166,32,16,50,73,204,76,63,149,66,82,376,126,108,113,99,164,409,698,116,118,950,196,746,156,195,148,216,1172,247,284,145,935,210,304,544,302,518,188,150,262,117,132,198,181,168,178,238,102,643,94,93,211,324,196,135,105,129,488,226,217,224,828,501,702,192,205,309,242,747,1175,1019,156,335,743,915,429,703,444,265,313,581,366,419,219,505,233,408,615,216,445,210,315,247,245,751,2165,250,630,1509,295,377,494,218,450,352,1048,338,279,272,379,784,1045,1008,442,859,352,1003,634,529,1141,712,349,813,978,292,1135,884,1072,847,492,980,330,450,1104,578,983,405,363,436,513,577,300,6,181,676,862,365,1043,1138,369,421,307,579,474,897,470],"CRBI":[9,37,34,23,82,43,46,29,69,40,103,70,110,18,80,31,97,37,130,39,38,428,48,10,94,23,44,26,112,25,37,69,14,167,75,55,33,80,88,125,22,13,55,47,276,75,39,161,41,100,290,132,117,121,138,179,321,661,64,69,909,110,805,119,219,173,208,1267,126,141,154,1088,222,268,462,351,324,135,156,201,64,83,120,177,91,192,299,96,445,71,106,146,300,137,163,99,139,491,149,93,266,838,336,504,186,204,103,251,666,1152,608,159,174,693,1067,365,519,419,316,377,421,337,382,195,456,260,303,430,163,491,203,325,288,167,714,1314,252,435,1659,273,284,345,149,342,230,1348,406,257,125,311,890,993,1072,198,803,342,977,563,472,1179,815,401,822,1093,343,1234,1015,1050,999,589,1032,326,367,1289,579,707,474,477,458,471,700,263,7,199,390,417,280,827,1299,384,349,340,363,322,451,420],"CWalks":[24,12,8,39,56,62,31,18,16,39,78,63,71,11,50,48,61,47,69,35,45,221,54,18,55,22,33,30,50,33,19,68,12,114,36,78,44,24,55,105,24,14,22,42,155,49,58,87,34,57,238,66,118,80,64,194,170,777,57,114,690,117,875,99,214,95,93,1057,198,219,128,643,68,298,551,174,382,63,187,91,88,79,113,157,101,136,157,80,459,76,86,155,179,89,128,71,106,244,191,146,263,354,194,488,161,203,207,240,526,1380,820,76,258,300,546,410,256,240,134,187,325,218,304,82,283,155,414,340,166,301,136,189,161,174,535,1566,178,403,1342,269,296,242,163,373,193,819,239,246,194,138,866,732,402,317,571,289,619,319,313,727,548,171,617,495,267,791,709,695,680,263,854,158,241,564,644,600,319,295,377,351,334,153,4,288,364,708,165,535,478,321,359,174,406,417,875,332],"PutOuts":[76,121,143,102,202,361,226,442,203,152,107,148,157,116,228,278,138,97,319,28,102,158,211,332,498,88,145,107,0,317,201,172,102,103,358,463,212,261,157,172,86,190,200,255,1236,111,289,133,942,1222,80,419,359,73,161,142,106,53,125,73,153,226,165,274,726,1253,91,83,462,185,50,0,241,33,0,92,87,222,0,429,283,325,203,149,325,167,0,44,155,203,1320,209,106,294,92,131,299,178,160,37,880,200,282,238,304,211,121,518,316,808,51,533,292,316,144,282,207,237,331,116,211,280,49,303,145,332,65,239,303,0,233,259,149,250,58,523,846,62,0,60,367,309,196,351,337,167,94,170,186,325,0,105,1067,434,72,303,389,67,240,0,119,1377,303,278,226,292,1045,97,869,295,237,231,304,330,686,96,1218,181,1231,371,483,310,78,756,82,426,155,352,1160,315,352,810,65,121,313,1314],"Assists":[127,283,290,177,22,22,7,59,70,3,242,4,7,5,377,415,15,2,4,56,4,4,9,19,39,0,59,205,0,36,6,317,6,283,32,32,1,459,6,1,150,2,7,450,98,226,407,371,72,139,45,46,30,177,10,14,206,88,199,152,223,7,9,2,87,111,185,174,9,8,136,0,8,3,0,257,166,5,0,8,8,12,3,1,13,2,0,0,3,369,166,372,144,445,5,6,13,45,290,113,82,11,421,445,45,11,151,55,6,108,54,40,6,439,6,487,358,8,20,222,56,479,2,12,5,9,258,8,450,0,7,30,8,11,141,43,84,90,0,176,475,492,354,442,19,18,270,284,290,9,0,290,157,9,170,9,39,147,482,0,216,100,6,9,10,9,88,218,62,15,5,374,347,16,46,5,104,13,80,6,48,9,220,64,170,4,371,9,53,10,414,99,0,267,381,131],"Errors":[7,9,19,16,2,2,4,6,10,5,23,2,8,12,26,16,1,2,14,2,2,5,3,2,13,3,8,16,0,1,3,25,3,19,8,8,2,22,14,4,15,9,6,17,18,11,6,20,11,15,8,5,4,18,3,2,7,3,13,11,10,3,1,7,3,11,12,16,7,4,20,0,6,0,0,20,14,5,0,6,3,8,3,6,3,4,0,1,2,16,17,17,7,13,3,1,5,4,11,7,14,3,25,22,11,7,6,3,5,2,8,4,3,10,5,19,20,1,4,15,13,5,0,5,7,8,8,2,14,0,7,10,6,1,23,6,9,3,0,6,19,5,15,17,4,6,16,3,17,3,0,10,14,3,24,9,4,4,13,0,12,6,6,9,6,5,13,16,8,5,4,18,10,8,4,3,10,4,7,6,6,9,6,15,15,6,29,1,7,6,9,18,0,19,20,12],"Salary":[70,100,75,175,135,115,110,90,90,75,105,110,145,70,155,87.5,175,90,165,95,110,100,80,75,155,86.5,125,75,145,75,90,150,68,175,137,120,140,175,172,190,70,190,97.5,140,100,135,105,160,120,165,240,300,305,215,415,340,416.667,275,230,225,320,210,260,300,385,215,362.5,200,400,400,297.5,325,250,275,365,277.5,250,300,300,365,202.5,210,240,350,200,300,425,250,400,250,200,350,341.667,350,425,286.667,245,235,425,385,480,500,750,517.143,512.5,550,700,600,675,535,450,431.5,490,750,700,535,737.5,600,662.5,750,430,657,450,630,737.5,625,725,525,575,700,550,650,670,750,450,750,580,450,487.5,450,750,740,475,530,740,500,750,525,550,700,1100,775,776.667,765,850,815,875,1200,1350,950,850,1975,1900,1041.667,1220,1861.46,2460,1500,1925.571,950,773.333,775,850,2412.5,825,1000,1310,1043.333,1183.333,787.5,800,780,2127.333,875,1260,1670,875,1000,1450,940,925,1150,900,1600,875,960],"League_N":[1,0,1,0,1,0,1,1,0,0,0,0,0,0,0,0,1,1,0,0,1,1,0,0,1,1,1,1,0,1,1,1,0,0,0,0,1,0,0,0,0,1,0,1,0,0,0,1,1,0,1,0,0,1,1,1,1,1,0,1,1,1,0,1,1,1,0,1,0,1,1,0,0,0,0,1,1,0,0,0,1,1,1,0,0,0,0,0,0,1,1,0,0,0,1,1,0,0,0,0,0,1,0,0,1,1,0,1,0,0,1,0,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,0,0,0,0,1,1,0,1,1,0,0,0,0,1,1,0,0,1,1,1,1,1,1,0,1,0,0,1,1,0,0,0,0,0,0,1,1,1,0,0,0,1,0,1,0,0,0,0,0,0,1,1,0,0,0,1,1,0,0,1,0,1,0,1,1,1,0,0,0],"League_new":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"Division_W":[0,1,1,1,1,1,1,1,0,1,0,0,1,0,1,1,1,0,1,1,1,1,1,1,0,1,0,1,0,1,0,1,1,0,1,1,0,1,1,0,0,0,1,1,1,1,1,0,1,1,0,1,0,1,1,1,1,0,1,1,1,1,1,1,1,1,0,1,1,0,0,1,0,0,0,0,1,0,1,1,0,0,1,0,1,1,1,0,0,0,0,1,0,0,1,0,1,1,1,1,1,0,1,0,1,0,0,1,0,0,0,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,1,0,0,0,0,0,1,1,1,1,0,1,1,0,1,0,1,0,1,1,0,0,0,0,0,1,0,0,1,1,1,1,0,0,1,0,1,1,0,0,0,1,0,1,1,0,0,0,1,0,1,0,0,0,0,1,0,1,0,0,1,0,1,1,0,0,1,0,0,0],"Division_new":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"NewLeague_N":[0,0,1,0,1,1,1,1,0,0,0,0,0,0,0,0,1,1,0,0,1,1,0,1,1,1,1,1,0,1,1,1,0,0,0,0,1,0,0,0,0,1,0,1,0,0,0,1,1,0,1,0,0,1,1,1,1,1,0,1,1,0,0,1,0,1,0,1,0,0,1,0,0,0,0,1,0,0,0,0,1,1,1,0,0,0,0,0,0,1,1,0,0,0,0,1,0,0,0,0,0,1,0,0,1,1,0,1,0,0,1,0,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,0,0,1,0,0,1,0,1,1,0,0,0,0,1,1,0,0,1,1,1,1,1,1,0,1,0,0,1,1,0,0,0,0,0,0,1,1,1,0,0,0,1,0,1,0,0,0,1,1,0,1,1,0,1,0,1,1,0,0,1,0,1,0,1,1,1,0,0,0],"NewLeague_new":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},"columns":[{"accessor":"AtBat","name":"AtBat","type":"numeric"},{"accessor":"Hits","name":"Hits","type":"numeric"},{"accessor":"HmRun","name":"HmRun","type":"numeric"},{"accessor":"Runs","name":"Runs","type":"numeric"},{"accessor":"RBI","name":"RBI","type":"numeric"},{"accessor":"Walks","name":"Walks","type":"numeric"},{"accessor":"Years","name":"Years","type":"numeric"},{"accessor":"CAtBat","name":"CAtBat","type":"numeric"},{"accessor":"CHits","name":"CHits","type":"numeric"},{"accessor":"CHmRun","name":"CHmRun","type":"numeric"},{"accessor":"CRuns","name":"CRuns","type":"numeric"},{"accessor":"CRBI","name":"CRBI","type":"numeric"},{"accessor":"CWalks","name":"CWalks","type":"numeric"},{"accessor":"PutOuts","name":"PutOuts","type":"numeric"},{"accessor":"Assists","name":"Assists","type":"numeric"},{"accessor":"Errors","name":"Errors","type":"numeric"},{"accessor":"Salary","name":"Salary","type":"numeric"},{"accessor":"League_N","name":"League_N","type":"numeric"},{"accessor":"League_new","name":"League_new","type":"numeric"},{"accessor":"Division_W","name":"Division_W","type":"numeric"},{"accessor":"Division_new","name":"Division_new","type":"numeric"},{"accessor":"NewLeague_N","name":"NewLeague_N","type":"numeric"},{"accessor":"NewLeague_new","name":"NewLeague_new","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"91d83e4362f0de787eb993f4e0d30a53","key":"91d83e4362f0de787eb993f4e0d30a53"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>Do normalisation step on all predictors <a href="https://recipes.tidymodels.org/reference/has_role.html"><code>recipes::all_predictors()</code></a>. <a href="https://recipes.tidymodels.org/reference/step_zv.html"><code>recipes::step_zv</code></a> and <a href="https://recipes.tidymodels.org/reference/step_normalize.html"><code>recipes::step_normalize</code></a> was used.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>ridge_recipe <span class="ot">&lt;-</span> ridge_recipe <span class="sc">%&gt;%</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove predictors with zero variation</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_zv</span>(recipes<span class="sc">::</span><span class="fu">all_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Standardise all variable</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_normalize</span>(recipes<span class="sc">::</span><span class="fu">all_predictors</span>())</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>rec <span class="ot">&lt;-</span> recipes<span class="sc">::</span><span class="fu">prep</span>(<span class="at">x =</span> ridge_recipe, <span class="at">training =</span> Hitters_train)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>rec <span class="sc">%&gt;%</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">bake</span>(<span class="at">new_data =</span> Hitters_train) <span class="sc">%&gt;%</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-13698110c3558957d2cc" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-13698110c3558957d2cc">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"AtBat":[-1.48462564510093,-0.726218762830992,-0.558429629585431,-1.45106781845182,-1.87389643423063,0.132861599386281,0.0858806420775238,-0.927565722725665,0.0657459460880565,-1.39066373048341,0.770460305719413,-0.847026938767796,0.703344652421188,-1.28327868520625,0.441593604558113,0.260381340652907,-1.76651138895347,-1.48462564510093,1.30067396677539,-1.71281886631489,-0.86045006942744,-0.437621453648627,-0.048350664518925,-1.61885695169738,-0.61212215222401,-1.51147190642022,-0.524871802936318,-0.853738504097618,-0.457756149638094,-1.27656711987643,-1.32354807718519,0.00534185811965453,-1.32354807718519,0.656363695112431,-0.994681376023889,-1.31012494652554,-0.719507197501169,0.944961004294796,0.897980046986039,-1.14233581327998,-0.632256848213477,-1.88060799956045,-0.162447275125907,0.958384134954441,0.710056217751011,0.367766385930066,0.314073863291487,1.15301952951929,0.012053423449477,1.25369300946663,-1.41079842647288,-1.3571059038343,-1.02152763734318,0.0657459460880565,-0.00808127253999036,-1.0886432906414,-0.625545282883655,-1.6859726049956,-1.14233581327998,-1.27656711987643,-0.6389684135433,-0.370505800350402,-1.6859726049956,0.0590343807582341,-0.545006498925786,1.1261732682,-0.531583368266141,-0.350371104360935,0.891268481656217,-0.444333018978449,-1.24972085855714,-0.86045006942744,1.7235025825542,-1.65241477834649,-1.31683651185537,0.877845350996572,-1.00139294135371,-0.0147928378698128,-0.417486757659159,1.83759919316118,0.166419426035393,1.13959639885965,-0.793334416129216,-0.249697624413598,1.11275013754036,-0.330236408371468,-0.202716667104841,-1.07522015998176,-1.35039433850448,-0.0819084911680372,0.777171871049235,0.81744126302817,-0.840315373437973,1.88458015046994,-0.947700418715132,-1.35039433850448,-1.43093312246235,-1.2967018158659,0.233535079333618,0.461728300547581,0.48857456186687,0.602671172473852,1.26040457479645,1.1261732682,-1.37052903449395,0.0791690767477014,-1.12220111729052,0.441593604558113,-0.0215044031996352,0.676498391101899,-1.01481607201336,-0.618833717553833,0.119438468726636,1.07248074556142,-0.826892242778328,0.012053423449477,0.696633087091366,-0.175870405785551,1.19328892149823,-0.672526240192412,-0.424198322988982,1.15973109484911,-1.49133721043075,1.24026987880698,-0.826892242778328,1.03221135358249,0.649652129782609,0.56911334582474,1.46846310002095,0.562401780494917,0.24024664466344,-0.793334416129216,-0.511448672276673,0.804018132368525,-0.625545282883655,-1.13562424795016,0.448305169887936,-0.907431026736197,0.0858806420775238,-0.39064049633987,0.783883436379058,1.48188623068059,0.830864393687815,1.04563448424213,1.58255971062793,-1.87389643423063,0.495286127196693,-0.310101712382,-0.128889448476794,0.609382737803674,-0.0349275338592801,1.08590387622107,1.49530936134024,1.21342361748769,-0.182581971115374,0.804018132368525,0.340920124610777,1.24026987880698,1.48188623068059,1.20000048682805,0.710056217751011,1.81746449717171,1.3946358813929,1.54900188397882,0.461728300547581,1.0657691802316,0.595959607144029,0.233535079333618,0.562401780494917,1.09932700688071,0.48857456186687,1.29396240144556,0.609382737803674,1.42148214271219,0.152996295375748,0.562401780494917,0.965095700284264,1.20671205215787,0.522132388515983,1.22684674814734,-0.531583368266141,0.555690215165095,-2.59203392452163,-0.216139797764486,0.206688818014328,1.35436648941397,0.602671172473852,0.777171871049235,1.01207665759302,1.25369300946663,1.02549978825267,0.696633087091366,-1.57187599438862,1.16644266017894,0.575824911154562,1.11946170287018],"Hits":[-1.57139373465562,-0.784637600991384,-0.609802904621555,-1.37470470123956,-1.68066541988676,0.00211853267284884,-0.0197358043733799,-1.06874398259236,0.0895358808577636,-1.22172434191596,0.723311655198396,-0.587948567575326,0.635894307013481,-1.26543301600842,0.198807566088907,-0.216424837789438,-1.52768506056316,-1.50583072351693,0.767020329290853,-1.4839763864707,-0.500531219390411,-0.303842185974353,-0.150861826650752,-1.52768506056316,-0.719074589852698,-1.11245265668481,-0.391259534159268,-0.981326634407442,-0.369405197113039,-1.19987000486973,-1.15616133077727,-0.34755086006681,-1.19987000486973,0.242516240181364,-1.06874398259236,-1.44026771237824,-0.740928926898927,0.614039969967252,0.570331295874795,-1.15616133077727,-0.893909286222528,-1.7899371051179,-0.172716163696981,0.876292014521996,0.176953229042678,0.0676815438115349,-0.129007489604523,0.635894307013481,0.176953229042678,1.37894176658526,-1.44026771237824,-1.30914169010087,-0.893909286222528,0.504768284736109,-0.150861826650752,-1.11245265668481,-0.675365915760241,-1.41841337533202,-1.15616133077727,-1.22172434191596,-0.609802904621555,-0.260133511881895,-1.4839763864707,0.133244554950221,-0.719074589852698,0.941855025660683,-0.52238555643664,-0.697220252806469,0.65774864405971,-0.544239893482868,-1.19987000486973,-0.85020061213007,1.99086320387966,-1.52768506056316,-0.85020061213007,0.832583340429539,-0.937617960314985,-0.369405197113039,-0.52238555643664,2.49351295594292,0.395496599504965,1.26967008135411,-0.719074589852698,-0.34755086006681,0.941855025660683,-0.281987848928124,-0.587948567575326,-0.719074589852698,-1.24357867896219,-0.500531219390411,0.679602981105938,0.286224914273822,-0.719074589852698,2.27496958548063,-0.893909286222528,-1.44026771237824,-1.35285036419333,-1.04688964554613,0.0895358808577636,0.373642262458737,0.461059610643651,0.701457318152167,1.31337875544657,1.09483538498428,-1.22172434191596,0.0895358808577636,-1.06874398259236,0.15509889199645,-0.172716163696981,0.286224914273822,-0.85020061213007,-0.566094230529097,0.0239728697190775,0.98556369975314,-0.697220252806469,-0.325696523020581,0.373642262458737,0.242516240181364,1.07298104793805,-0.107153152558295,-0.129007489604523,1.42265044067771,-1.35285036419333,1.64119381114,-0.762783263945155,1.13854405907674,0.592185632921023,0.701457318152167,1.53192212590886,0.854437677475768,0.48291394768988,-0.959472297361214,-0.697220252806469,1.1822527331692,-0.566094230529097,-1.24357867896219,0.98556369975314,-0.697220252806469,-0.172716163696981,-0.413113871205496,0.570331295874795,1.51006778886263,1.09483538498428,1.31337875544657,2.23126091138818,-1.68066541988676,0.0676815438115349,-0.609802904621555,0.329933588366279,0.395496599504965,-0.369405197113039,1.07298104793805,1.29152441840034,1.1822527331692,-0.0634444784658372,0.81072900338331,-0.172716163696981,1.29152441840034,1.4882134518164,0.65774864405971,0.48291394768988,2.82132801163635,1.1822527331692,1.42265044067771,0.30807925132005,0.854437677475768,0.920000688614454,0.417350936551194,0.351787925412508,1.31337875544657,0.526622621782337,1.61933947409377,0.592185632921023,1.99086320387966,-0.391259534159268,0.898146351568225,0.832583340429539,1.09483538498428,0.395496599504965,0.876292014521996,-0.544239893482868,0.48291394768988,-2.35814986831985,-0.325696523020581,0.30807925132005,1.11668972203051,0.220661903135136,1.1822527331692,0.723311655198396,0.941855025660683,0.701457318152167,0.832583340429539,-1.46212204942447,2.14384356320326,0.592185632921023,0.767020329290853],"HmRun":[-1.25027916596267,-1.36719458415384,-0.665702075006842,-1.13336374777151,-0.431871238624511,-1.01644832958034,-0.665702075006842,-0.782617493198008,1.43877545243414,-0.782617493198008,0.97111377966948,0.503452106904816,1.55569087062531,-0.899532911389174,0.0357904341401528,-1.25027916596267,-0.782617493198008,-0.899532911389174,2.49101421615464,-0.899532911389174,-0.899532911389174,-0.665702075006842,-1.01644832958034,-1.13336374777151,0.152705852331319,-0.665702075006842,0.0357904341401528,-1.36719458415384,0.737282943287148,-1.13336374777151,0.0357904341401528,-0.431871238624511,-1.01644832958034,1.90643712519881,-0.431871238624511,-0.198040402242179,-0.665702075006842,-1.13336374777151,2.14026796158114,-0.665702075006842,-1.13336374777151,-1.01644832958034,0.503452106904816,-0.548786656815677,2.02335254338997,0.737282943287148,-0.431871238624511,-1.25027916596267,-0.0811249840510131,1.20494461605181,-0.548786656815677,-0.665702075006842,-1.13336374777151,-0.548786656815677,0.737282943287148,-0.314955820433345,-0.665702075006842,-0.665702075006842,-1.36719458415384,-1.25027916596267,-1.01644832958034,-0.899532911389174,0.0357904341401528,1.78952170700764,0.503452106904816,2.2571833797723,-1.01644832958034,0.503452106904816,-0.782617493198008,-0.0811249840510131,-0.198040402242179,-0.548786656815677,2.02335254338997,-0.431871238624511,0.152705852331319,1.32186003424298,-0.782617493198008,-0.0811249840510131,1.43877545243414,2.2571833797723,-0.431871238624511,-0.431871238624511,-0.548786656815677,-0.314955820433345,0.737282943287148,-0.548786656815677,1.08802919786065,-0.782617493198008,-0.431871238624511,-1.25027916596267,0.503452106904816,-1.25027916596267,-1.01644832958034,-0.198040402242179,-0.431871238624511,-1.13336374777151,-0.198040402242179,-0.899532911389174,-0.782617493198008,-1.01644832958034,0.737282943287148,0.97111377966948,-0.899532911389174,1.08802919786065,-0.899532911389174,0.152705852331319,-1.36719458415384,0.503452106904816,0.0357904341401528,2.02335254338997,-0.548786656815677,0.152705852331319,0.38653668871365,1.20494461605181,0.269621270522485,-0.899532911389174,-1.13336374777151,-0.782617493198008,0.38653668871365,0.269621270522485,-0.665702075006842,-0.548786656815677,-0.782617493198008,0.97111377966948,-0.899532911389174,1.67260628881647,-0.782617493198008,-0.0811249840510131,-0.899532911389174,0.269621270522485,0.737282943287148,-0.431871238624511,0.854198361478314,0.0357904341401528,-0.314955820433345,-1.36719458415384,-0.665702075006842,-0.782617493198008,0.737282943287148,-0.0811249840510131,-0.431871238624511,0.269621270522485,-1.01644832958034,0.620367525095982,0.269621270522485,-0.899532911389174,0.737282943287148,-0.782617493198008,-1.25027916596267,-0.548786656815677,0.620367525095982,0.97111377966948,0.737282943287148,-0.899532911389174,-0.198040402242179,0.152705852331319,0.269621270522485,0.854198361478314,1.55569087062531,2.2571833797723,1.67260628881647,2.2571833797723,2.02335254338997,2.2571833797723,1.78952170700764,1.43877545243414,0.620367525095982,0.503452106904816,1.43877545243414,1.08802919786065,-0.198040402242179,-0.198040402242179,-0.548786656815677,0.97111377966948,0.0357904341401528,1.08802919786065,2.02335254338997,0.0357904341401528,0.97111377966948,1.08802919786065,1.20494461605181,0.854198361478314,-1.36719458415384,-0.782617493198008,-0.314955820433345,1.90643712519881,-0.431871238624511,-0.314955820433345,1.08802919786065,1.32186003424298,-1.13336374777151,-0.198040402242179,-1.01644832958034,-0.431871238624511,-0.782617493198008,-0.314955820433345],"Runs":[-1.25259030674188,-1.21340937790029,-1.1350475202171,-1.21340937790029,-1.52685680863301,0.0011994161890283,0.0011994161890283,-1.21340937790029,0.118742202713801,-1.01750473369233,0.471370562288118,-0.42979080106847,0.823998921862435,-1.40931402210824,0.314646846921755,-0.351428943385289,-1.44849495094983,-1.25259030674188,1.17662728143675,-1.1350475202171,-0.860781018325969,-0.273067085702107,0.0403803450306191,-1.64439959515778,-0.782419160642787,-0.821600089484378,-0.155524299177335,-0.939142876009151,-0.508152658751652,-1.09586659137551,-1.29177123558347,-0.312248014543698,-1.1742284490587,0.628094277654481,-1.05668566253392,-1.1350475202171,-0.664876374118015,0.118742202713801,1.05908449491198,-0.547333587593243,-0.89996194716756,-1.84030423936574,-0.194705228018926,0.706456135337662,-0.0379815126525625,-0.0379815126525625,-0.0771624414941533,0.0403803450306191,0.432189633446527,1.05908449491198,-1.01750473369233,-1.25259030674188,-1.05668566253392,0.0795612738722099,-0.233886156860516,-1.05668566253392,-0.89996194716756,-1.33095216442506,-1.09586659137551,-0.939142876009151,-0.508152658751652,0.0011994161890283,-1.33095216442506,1.64679842753584,-0.860781018325969,1.4117128544863,-0.978323804850741,-0.743238231801197,1.49007471216948,0.275465918080164,-0.978323804850741,-1.29177123558347,2.07778864479334,-1.44849495094983,-0.89996194716756,0.118742202713801,-0.939142876009151,-0.0379815126525625,0.549732419971299,2.50877886205084,0.863179850704026,1.33335099680312,-0.821600089484378,-0.468971729910061,1.96024585826857,-0.194705228018926,-0.508152658751652,-0.782419160642787,-0.939142876009151,-0.664876374118015,0.706456135337662,0.471370562288118,-0.508152658751652,1.4117128544863,-1.1350475202171,-1.21340937790029,-1.33095216442506,-1.48767587979142,0.823998921862435,0.236284989238573,0.432189633446527,0.393008704604936,0.745637064179253,2.03860771595175,-0.939142876009151,-0.273067085702107,-0.978323804850741,0.197104060396982,-0.39060987222688,0.902360779545616,-0.233886156860516,-0.625695445276424,0.58891334881289,0.823998921862435,-0.39060987222688,-0.508152658751652,-0.508152658751652,-0.0379815126525625,0.58891334881289,-0.194705228018926,-0.273067085702107,0.471370562288118,-1.37013309326665,1.09826542375357,-0.821600089484378,1.33335099680312,0.275465918080164,0.863179850704026,1.52925564101107,0.353827775763345,0.510551491129709,-0.978323804850741,-0.312248014543698,1.29417006796152,-0.468971729910061,-1.5660377374746,0.236284989238573,-0.782419160642787,0.393008704604936,-0.194705228018926,-0.116343370335744,0.510551491129709,1.05908449491198,1.29417006796152,2.03860771595175,-1.60521866631619,-0.194705228018926,-0.704057302959606,0.471370562288118,0.393008704604936,-0.233886156860516,1.33335099680312,0.706456135337662,1.45089378332789,-0.664876374118015,0.628094277654481,-0.508152658751652,0.980722637228798,1.68597935637743,1.49007471216948,0.549732419971299,2.43041700436766,1.33335099680312,1.33335099680312,0.823998921862435,1.37253192564471,0.236284989238573,0.58891334881289,1.01990356607039,0.667275206496072,-0.273067085702107,0.980722637228798,0.118742202713801,1.68597935637743,-0.547333587593243,0.549732419971299,1.17662728143675,0.667275206496072,0.432189633446527,1.33335099680312,-0.0771624414941533,0.863179850704026,-2.15375167009847,-0.743238231801197,0.275465918080164,2.93976907930834,0.0795612738722099,1.05908449491198,0.118742202713801,0.549732419971299,-0.273067085702107,0.0403803450306191,-1.48767587979142,2.03860771595175,0.823998921862435,1.17662728143675],"RBI":[-1.70856316657107,-1.08784327658417,-0.777483331590727,-1.70856316657107,-1.16543326283254,-0.350738407224737,-0.622303359094003,-1.04904828345999,0.657931414003965,-1.16543326283254,1.31744629711504,-0.273148420976375,1.70539622835685,-1.32061323532926,0.0760065171412524,-1.08784327658417,-0.855073317839088,-1.59217818719852,2.52009108396465,-1.20422825595672,-0.544713372845641,-0.389533400348918,-0.699893345342365,-1.66976817344689,0.308776475886338,-1.12663826970835,-0.350738407224737,-1.01025329033581,0.308776475886338,-1.04904828345999,-0.622303359094003,-0.855073317839088,-1.47579320782598,0.735521400252327,-0.738688338466546,-0.661098352218184,-1.12663826970835,-0.195558434728014,1.3950362833634,-1.28181824220508,-1.16543326283254,-1.63097318032271,0.114801510265433,-0.195558434728014,1.3950362833634,0.0760065171412524,-0.738688338466546,0.269981482762157,-0.428328393473099,1.86057620085357,-0.971458297211631,-1.04904828345999,-1.01025329033581,-0.117968448479652,1.27865130399086,-1.04904828345999,-0.428328393473099,-1.12663826970835,-1.4369982147018,-1.4369982147018,-0.855073317839088,-0.893868310963269,-0.893868310963269,0.735521400252327,-0.00158346910710934,1.89937119397775,-0.311943414100556,0.114801510265433,0.231186489637976,-0.738688338466546,-0.505918379721461,-0.583508365969822,2.67527105646137,-0.816278324714907,-0.0403784622312902,1.3950362833634,-1.01025329033581,-0.117968448479652,0.463956448383061,1.70539622835685,-0.273148420976375,-0.117968448479652,-0.583508365969822,-0.389533400348918,-0.117968448479652,-0.273148420976375,0.308776475886338,-0.505918379721461,-0.971458297211631,-0.93266330408745,0.968291358997412,-0.273148420976375,-1.04904828345999,0.502751441507242,-0.855073317839088,-1.35940822845344,-0.893868310963269,-1.16543326283254,-0.00158346910710934,-0.350738407224737,0.774316393376508,1.00708635212159,-0.0403784622312902,0.89070137274905,-1.01025329033581,0.347571469010518,-1.59217818719852,0.386366462134699,0.0372115240170715,1.27865130399086,-0.661098352218184,-0.234353427852195,-0.195558434728014,1.23985631086668,-0.195558434728014,-0.622303359094003,-0.311943414100556,-0.0403784622312902,1.23985631086668,0.231186489637976,-0.622303359094003,1.00708635212159,-0.93266330408745,1.04588134524577,-0.893868310963269,1.70539622835685,-0.156763441603833,-0.195558434728014,0.308776475886338,1.00708635212159,0.968291358997412,-0.622303359094003,0.0372115240170715,-0.0791734553554711,-0.428328393473099,-1.04904828345999,-0.156763441603833,-0.893868310963269,0.231186489637976,-0.273148420976375,-0.311943414100556,0.929496365873231,-0.0791734553554711,0.813111386500689,0.269981482762157,-1.04904828345999,0.735521400252327,-0.311943414100556,-0.971458297211631,-0.156763441603833,0.541546434631423,0.89070137274905,1.93816618710193,-0.0403784622312902,0.308776475886338,0.696726407128146,0.42516145525888,0.774316393376508,1.12347133149414,1.62780624210849,1.70539622835685,2.36491111146792,1.2010613177425,2.48129609084047,1.58901124898431,2.0157561733503,1.23985631086668,0.813111386500689,2.05455116647448,1.3950362833634,0.774316393376508,0.85190637962487,-0.544713372845641,2.24852613209538,-0.389533400348918,0.231186489637976,1.51142126273594,1.04588134524577,0.502751441507242,1.31744629711504,0.386366462134699,0.114801510265433,-2.01892311156451,-1.01025329033581,0.114801510265433,0.85190637962487,-0.738688338466546,-0.234353427852195,1.12347133149414,0.89070137274905,0.347571469010518,-0.00158346910710934,-1.47579320782598,0.735521400252327,-0.0791734553554711,0.308776475886338],"Walks":[-0.908711113837888,-1.56111909300355,-1.51451852306315,-1.18831453348032,-1.23491510342072,1.0019122537187,-0.862110543897484,-1.18831453348032,-1.14171396353991,-0.908711113837888,0.20970256473182,0.302903704612629,0.955311683778293,-1.37471681324193,-0.489305984374247,-0.535906554314652,-1.18831453348032,-1.0485128236591,1.14171396353991,-1.0019122537187,0.20970256473182,-0.955311683778293,-0.302903704612629,-1.14171396353991,-0.72230883407627,-0.862110543897484,-0.349504274553034,-0.489305984374247,-0.908711113837888,-0.349504274553034,-1.0019122537187,-0.489305984374247,-1.32811624330153,0.629107694195461,-1.0485128236591,-0.0699008549106068,-0.675708264135865,-1.32811624330153,0.675708264135865,-0.908711113837888,-0.768909404016675,-1.65432023288436,-0.862110543897484,0.0699008549106068,0.116501424851011,-0.256303134672225,0.535906554314652,-0.302903704612629,-0.302903704612629,0.768909404016675,-0.489305984374247,-1.32811624330153,-0.862110543897484,-0.349504274553034,-0.955311683778293,-0.256303134672225,-1.32811624330153,-1.18831453348032,-1.37471681324193,-0.862110543897484,-0.675708264135865,-0.0699008549106068,-0.862110543897484,1.28151567336112,-0.163101994791416,1.09511339359951,-0.955311683778293,0.0233002849702023,1.32811624330153,0.302903704612629,-0.442705414433843,-1.0485128236591,-0.396104844493438,-0.862110543897484,-0.582507124255056,0.302903704612629,-0.396104844493438,-1.0485128236591,2.21352707216921,-0.302903704612629,0.815509973957079,0.768909404016675,-1.18831453348032,0.396104844493438,1.14171396353991,-0.0699008549106068,-0.256303134672225,-1.28151567336112,-1.09511339359951,-0.20970256473182,0.908711113837888,0.489305984374247,-0.955311683778293,-0.629107694195461,-0.535906554314652,-0.955311683778293,-0.768909404016675,-1.74752137276517,1.65432023288436,0.535906554314652,1.65432023288436,-0.163101994791416,-0.256303134672225,0.862110543897484,-0.629107694195461,0.302903704612629,-0.862110543897484,1.56111909300355,-0.0699008549106068,2.35332878199043,0.116501424851011,-1.14171396353991,-0.20970256473182,0.116501424851011,-0.675708264135865,1.18831453348032,-0.256303134672225,-0.442705414433843,0.0699008549106068,-0.72230883407627,-0.0233002849702023,0.815509973957079,-1.0485128236591,-0.116501424851011,-0.862110543897484,1.18831453348032,1.98052422246719,-0.163101994791416,1.14171396353991,0.396104844493438,-0.349504274553034,-0.629107694195461,-0.629107694195461,1.70092080282476,-0.489305984374247,-0.489305984374247,-0.535906554314652,-0.349504274553034,2.39992935193083,0.116501424851011,0.535906554314652,0.256303134672225,0.302903704612629,0.582507124255056,0.535906554314652,-1.32811624330153,0.163101994791416,-0.163101994791416,-0.20970256473182,-0.163101994791416,1.14171396353991,1.51451852306315,-0.0233002849702023,1.37471681324193,-0.489305984374247,2.0271247924076,-0.862110543897484,-0.0699008549106068,1.37471681324193,1.0019122537187,0.535906554314652,0.582507124255056,1.60771966294396,0.72230883407627,1.46791795312274,1.70092080282476,1.74752137276517,1.84072251264598,1.0019122537187,-0.116501424851011,0.675708264135865,-0.396104844493438,-0.675708264135865,1.0019122537187,0.768909404016675,-0.256303134672225,1.42131738318234,0.582507124255056,1.23491510342072,1.09511339359951,-0.116501424851011,-0.302903704612629,-1.88732308258638,1.0019122537187,-0.0233002849702023,2.26012764210962,-0.908711113837888,1.0019122537187,-0.815509973957079,0.582507124255056,1.51451852306315,0.582507124255056,-1.18831453348032,3.00573676115609,2.49313049181164,1.74752137276517],"Years":[-1.08921688912025,-0.887814520943301,-1.08921688912025,-0.485009784589396,0.119197319941462,-1.29061925729721,-0.887814520943301,-1.08921688912025,-1.29061925729721,-0.887814520943301,-0.686412152766349,-1.08921688912025,-0.887814520943301,-1.29061925729721,-0.686412152766349,-0.686412152766349,0.320599688118414,-0.887814520943301,-1.08921688912025,-1.08921688912025,-1.29061925729721,0.522002056295367,-0.485009784589396,-0.887814520943301,-0.887814520943301,-1.29061925729721,-1.08921688912025,-1.29061925729721,-0.887814520943301,-1.29061925729721,-1.08921688912025,-1.08921688912025,-1.29061925729721,-0.887814520943301,-0.887814520943301,-0.887814520943301,-0.887814520943301,-1.08921688912025,-1.29061925729721,-0.485009784589396,-1.29061925729721,-0.686412152766349,-1.29061925729721,-1.29061925729721,-0.283607416412443,-1.08921688912025,-1.08921688912025,-0.887814520943301,-1.29061925729721,-1.29061925729721,1.12620916082622,-0.0822050482354908,-0.283607416412443,-0.887814520943301,-0.283607416412443,-0.686412152766349,0.924806792649272,1.73041626535708,-0.686412152766349,-0.686412152766349,1.93181863353404,-0.686412152766349,1.73041626535708,-0.887814520943301,-0.485009784589396,-0.887814520943301,0.119197319941462,2.53602573806489,-0.485009784589396,-0.485009784589396,-0.485009784589396,2.13322100171099,-0.686412152766349,1.32761152900318,1.52901389718013,0.522002056295367,1.32761152900318,-0.283607416412443,-0.0822050482354908,-0.887814520943301,-1.08921688912025,-0.686412152766349,-0.686412152766349,-0.485009784589396,-1.08921688912025,-0.485009784589396,-0.485009784589396,-0.283607416412443,0.924806792649272,-0.686412152766349,-0.686412152766349,-0.686412152766349,0.119197319941462,-0.686412152766349,-0.0822050482354908,-0.0822050482354908,-0.283607416412443,1.93181863353404,-0.485009784589396,-0.283607416412443,-0.887814520943301,0.72340442447232,0.72340442447232,0.522002056295367,0.320599688118414,-0.686412152766349,-0.283607416412443,-0.283607416412443,0.924806792649272,2.13322100171099,1.52901389718013,-0.485009784589396,-0.0822050482354908,1.32761152900318,1.73041626535708,0.320599688118414,0.72340442447232,0.119197319941462,-0.485009784589396,-0.0822050482354908,1.52901389718013,-0.283607416412443,0.72340442447232,-0.485009784589396,0.522002056295367,-0.686412152766349,0.522002056295367,1.52901389718013,-0.485009784589396,1.12620916082622,-0.283607416412443,0.320599688118414,-0.283607416412443,-0.686412152766349,1.32761152900318,3.3416352107727,-0.283607416412443,0.924806792649272,2.53602573806489,0.522002056295367,0.320599688118414,-0.283607416412443,-0.283607416412443,0.119197319941462,-0.485009784589396,2.33462336988794,-0.0822050482354908,-0.0822050482354908,-0.0822050482354908,-0.485009784589396,1.12620916082622,1.52901389718013,2.13322100171099,-0.283607416412443,1.32761152900318,-0.283607416412443,1.93181863353404,0.320599688118414,-0.283607416412443,1.93181863353404,1.32761152900318,-0.485009784589396,0.72340442447232,1.32761152900318,-0.686412152766349,1.32761152900318,0.522002056295367,1.32761152900318,1.12620916082622,-0.0822050482354908,1.93181863353404,-0.485009784589396,0.72340442447232,1.12620916082622,1.12620916082622,1.32761152900318,-0.283607416412443,0.320599688118414,-0.0822050482354908,-0.0822050482354908,0.522002056295367,-0.0822050482354908,-1.08921688912025,-0.0822050482354908,0.320599688118414,0.119197319941462,-0.0822050482354908,1.12620916082622,2.13322100171099,-0.283607416412443,0.119197319941462,-0.0822050482354908,0.522002056295367,-0.485009784589396,0.924806792649272,0.119197319941462],"CAtBat":[-1.05481858549541,-0.932382186755829,-1.00210867824142,-0.944833345949685,-0.841903763280476,-0.96683039385883,-0.898349018292623,-0.998373330483265,-0.970980780256782,-0.930306993556853,-0.805380362978499,-0.96600031657924,-0.897933979652828,-1.05440354685562,-0.814511213053993,-0.887142975018153,-0.878427163582453,-0.926156607158901,-0.854769961114127,-1.02410572615057,-1.02825611254852,0.0865376739413792,-0.865560965748802,-1.06228928101173,-0.88216251134061,-1.06851486060865,-1.00169363960163,-1.02784107390872,-0.86058050207126,-1.05398850821582,-1.05398850821582,-0.741464412450038,-1.05689377869439,-0.693319930233796,-0.878842202222249,-0.936947611793576,-0.90291444333037,-0.71282674630417,-0.919515988922178,-0.621933284189022,-1.01414479879548,-1.04444261950053,-0.985092094009819,-0.915780641164021,-0.41731923476999,-0.86141057935085,-0.933212264035419,-0.562997797338104,-0.974301089375144,-0.897518941013033,0.197352990766697,-0.600351274919672,-0.729013253256183,-0.756820842122461,-0.749350146606147,-0.589560270284996,0.409437735702042,1.60848436607037,-0.68086877103994,-0.759311073961232,2.2791868079794,-0.621518245549227,1.10130714824064,-0.848544381517199,-0.518588662880018,-0.734823794213315,-0.255454165249863,2.47383993004335,-0.53394509255244,-0.514438276482066,-0.651816066254276,1.8388308111567,-0.543075942627934,-0.260434628927405,0.533119250361011,-0.00477082681356415,0.479164227187635,-0.581674536128888,-0.76553665355816,-0.343442356886445,-0.866806081668188,-0.802475092499932,-0.461313330588281,-0.621518245549227,-0.737729064691882,-0.56507299053708,-0.409018461974086,-0.765121614918365,0.987171522296956,-0.691659775674615,-0.840658647361091,-0.431430548523026,-0.0404641498359511,-0.513608199202475,-0.588730193005406,-0.789193856026486,-0.672152959604241,0.54183506179671,-0.50198711728821,-0.43807116675975,-0.469614103384185,1.19220061035578,0.685853469805643,0.778407086479972,-0.365024366155795,-0.516098431041247,-0.338046854569107,-0.345102511445626,0.993812140533679,2.07747802903894,1.4756720013359,-0.538925556229983,-0.259604551647815,1.38809884833912,1.69522744178756,0.339296205576654,1.1648080601293,0.150453624469839,-0.16497574177451,0.0823872875434272,0.65680076501998,0.123476112883152,0.237196700187036,-0.442636591797497,0.482899574945792,-0.401132727817977,0.277040409607374,0.637293948949605,-0.43973132131893,0.267494520892085,-0.555942140461586,0.0246969166118948,-0.343442356886445,-0.497836730890258,1.29886554078315,4.68890115063032,-0.327670888574227,0.903748755698122,2.81085130555705,-0.194028446560174,0.254213284418639,0.162074706384105,-0.471689296583161,0.176601058776937,-0.162485509935739,2.34102756530889,0.114345262807657,-0.202329219356078,-0.40694326877511,-0.0217874110451672,1.01705430436221,2.20489489145606,2.35264864722315,-0.0251077201635288,1.4325079827972,-0.044614536233903,1.56283011569289,0.714906174591307,0.188637179330998,1.98824472148297,1.07557475257333,-0.221005958146862,0.938612001440918,1.6483280754907,-0.392416916382278,1.88074971377601,1.1905404557966,1.62674606622135,1.37274241866669,0.414418199379585,1.95753186213813,-0.113510950439906,0.462977720235623,1.81434353140878,1.17642914204357,1.39888985297379,0.02511195525169,0.135512233437212,0.103969296812777,0.333070625979726,0.629823253433292,-0.292392604191636,-1.12662027017998,-0.326840811294637,0.574208075700735,0.545985448194662,0.250062898020687,1.77699005382722,2.49168659155454,0.00394498462213498,0.168715324620828,0.048354119080221,0.55221102779159,0.00934048693947254,1.14364108949975,0.183656715653455],"CHits":[-1.03787202416862,-0.941591653956167,-0.97368511069365,-0.950344414884572,-0.836558522815313,-0.9401328604681,-0.881781120945403,-0.98535545859819,-0.93429768651583,-0.924086132099358,-0.800088685613628,-0.93429768651583,-0.859899218624392,-1.02474288277601,-0.826346968398841,-0.910956990706752,-0.878863533969269,-0.916792164659021,-0.846770077231785,-0.999943393478864,-0.97368511069365,0.0795637876910238,-0.85552283816019,-1.03495443719248,-0.878863533969269,-1.01453132835954,-0.962014762789111,-1.00577856743113,-0.829264555374976,-1.02036650231181,-1.01453132835954,-0.763618848411943,-1.02036650231181,-0.721313837257988,-0.851146457695988,-0.929921306051628,-0.865734392576662,-0.703808315401179,-0.902204229778347,-0.619198293093268,-0.999943393478864,-1.02766046975214,-0.951803208372639,-0.881781120945403,-0.498118433583673,-0.865734392576662,-0.919709751635156,-0.578352075427381,-0.928462512563561,-0.848228870719853,0.10436327698817,-0.649832956342684,-0.754866087483538,-0.700890728425044,-0.762160054923875,-0.613363119140999,0.31297074578181,1.28452720883471,-0.705267108889246,-0.792794718173291,2.10728673610473,-0.58418724937965,0.852724336366754,-0.830723348863044,-0.587104836355785,-0.71985504376992,-0.270546649445156,2.06935810541498,-0.560846553570572,-0.5506349991541,-0.662962097735291,1.93660789800084,-0.509788781488212,-0.307016486646841,0.549295290848732,-0.0342221043782346,0.329017474150552,-0.625033467045538,-0.786959544221021,-0.242829573171875,-0.826346968398841,-0.760701261435808,-0.503953607535943,-0.627951054021673,-0.735901772138662,-0.597316390772257,-0.503953607535943,-0.757783674459673,0.830842434045743,-0.709643489353448,-0.829264555374976,-0.51124757497628,-0.140714029007156,-0.445601868013246,-0.604610358212594,-0.779665576780684,-0.72569021772219,0.571177193169743,-0.520000335904684,-0.467483770334257,-0.432472726620639,1.19845839303873,0.553671671312934,0.797290183820193,-0.417884791739965,-0.527294303345021,-0.355156671753066,-0.385791335002482,0.985474543780889,1.74112957059981,1.32391463301253,-0.508329988000145,-0.305557693158774,1.21012874094327,1.68715421154132,0.164173809998934,1.20283477350293,0.213772788593226,-0.171348692256572,0.0999868965239677,0.641199280596979,0.184596918831878,0.199184853712552,-0.425178759180302,0.450097333660148,-0.413508411275763,0.315888332757945,0.709762574536148,-0.404755650347358,0.359652137399968,-0.518541542416617,-0.0809034959963919,-0.346403910824662,-0.413508411275763,1.15177700142057,5.10948373454747,-0.273464236421291,0.881900206128103,2.56243030438177,-0.203442148994055,0.206478821152889,0.216690375569361,-0.477695324750729,0.127703972797249,0.024129635144462,2.40488060767048,0.0255884286325295,-0.273464236421291,-0.360991845705336,0.076646200714889,0.84397157543835,2.21669624770979,2.49532580393066,-0.00942261508108853,1.68131903758905,-0.0561040066992458,1.47854674274768,0.807501738236664,0.253160212771046,1.79218734268217,0.938793152162732,-0.0240105499617627,0.925664010770125,1.853456669181,-0.412049617787695,1.93952548497698,1.35017291579774,1.95703100683379,1.30203273069152,0.471979235981159,2.03288826821329,-0.0561040066992458,0.455932507612417,2.05622896402237,0.938793152162732,1.58357987388853,0.0897753421074958,0.184596918831878,0.132080353261451,0.254619006259114,0.53908373643226,-0.298263725718437,-1.08601220927484,-0.342027530360459,0.655787215477653,0.625152552228237,0.187514505808013,1.84616270174066,2.66892222901069,-0.0984090178532009,0.175844157903473,0.0985281030359003,0.57847116061008,0.327558680662485,1.10509560980242,0.151044668606327],"CHmRun":[-0.824168192105625,-0.835753716429852,-0.766240570484488,-0.777826094808715,-0.557701132648395,-0.80099714345717,-0.743069521836033,-0.777826094808715,-0.557701132648395,-0.743069521836033,-0.58087218129685,-0.546115608324168,-0.511359035351486,-0.789411619132943,-0.673556375890669,-0.824168192105625,-0.650385327242214,-0.754655046160261,-0.395503792109212,-0.731483997511806,-0.789411619132943,0.102673753832566,-0.789411619132943,-0.812582667781398,-0.557701132648395,-0.766240570484488,-0.696727424539124,-0.835753716429852,-0.418674840757666,-0.812582667781398,-0.696727424539124,-0.673556375890669,-0.80099714345717,-0.210135402921573,-0.638799802917987,-0.673556375890669,-0.743069521836033,-0.80099714345717,-0.488187986703031,-0.557701132648395,-0.812582667781398,-0.80099714345717,-0.650385327242214,-0.754655046160261,0.322798715992887,-0.557701132648395,-0.743069521836033,-0.754655046160261,-0.708312948863351,-0.58087218129685,-0.418674840757666,-0.522944559675713,-0.592457705621077,-0.557701132648395,-0.499773511027258,-0.26806302454271,-0.430260365081894,0.299627667344432,-0.824168192105625,-0.731483997511806,0.322798715992887,-0.650385327242214,1.26122618625531,-0.31440512183962,-0.0131814894097077,-0.221720927245801,-0.650385327242214,3.61308762407347,-0.696727424539124,-0.349161694812302,-0.372332743460757,1.36549590517335,-0.175378829948891,-0.186964354273119,0.288042143020205,0.288042143020205,-0.453431413730349,-0.488187986703031,-0.0942801596792994,-0.430260365081894,-0.731483997511806,-0.615628754269532,-0.650385327242214,-0.210135402921573,-0.418674840757666,-0.337576170488075,0.496581580856298,-0.696727424539124,-0.186964354273119,-0.80099714345717,-0.58087218129685,-0.696727424539124,-0.279648548866938,-0.661970851566442,-0.465016938054576,-0.696727424539124,-0.349161694812302,0.125844802481021,-0.638799802917987,-0.754655046160261,-0.105865684003527,1.77098925652131,-0.615628754269532,0.206943472750613,-0.661970851566442,-0.360747219136529,-0.789411619132943,-0.0595235867066172,1.08744332139189,3.18442322407705,0.948417029501166,-0.511359035351486,-0.395503792109212,0.681949970043936,2.16489708354504,-0.152207781300436,-0.325990646163847,0.230114521399068,-0.163793305624664,-0.198549878597346,-0.0247670137339351,-0.465016938054576,0.0215750835629745,-0.372332743460757,0.149015851129476,-0.082694635355072,-0.604043229945305,0.137430326805248,-0.696727424539124,0.473410532207843,-0.291234073191165,-0.198549878597346,0.206943472750613,-0.395503792109212,0.369140813289796,1.01793017544653,-0.499773511027258,-0.279648548866938,5.51311361324676,-0.337576170488075,-0.383918267784984,0.0215750835629745,-0.708312948863351,-0.129036732651982,-0.522944559675713,1.96794317003318,0.438653959235161,-0.360747219136529,-0.766240570484488,-0.465016938054576,2.09538393759968,1.2148840889584,1.06427227274344,-0.638799802917987,0.855732834907347,0.0563316565356567,2.41977861867804,0.473410532207843,0.705121018692391,2.81368644570178,1.7246471592244,0.241700045723295,2.24599575381463,2.02587079165431,0.415482910586706,2.6978312024595,2.35026547273268,1.58562086733367,2.30392337543577,0.786219688961982,0.936831505176938,-0.522944559675713,-0.372332743460757,3.23076532137396,0.125844802481021,0.566094726801662,0.519752629504752,0.125844802481021,0.508167105180525,0.345969764641341,1.62037744030635,-0.117451208327754,-0.812582667781398,-0.53453008399994,0.0795027051841115,0.357555288965569,-0.418674840757666,0.936831505176938,2.30392337543577,0.705121018692391,-0.650385327242214,-0.105865684003527,-0.175378829948891,-0.465016938054576,-0.383918267784984,0.288042143020205],"CRuns":[-0.994319045893696,-0.96266527161615,-0.988563814206869,-0.893602491374231,-0.887847259687405,-0.922378649808364,-0.850438253723032,-0.982808582520043,-0.913745802278124,-0.916623418121537,-0.79576355269818,-0.905112954747884,-0.830294942819139,-1.02597282017124,-0.78713070516794,-0.873459180470338,-0.850438253723032,-0.913745802278124,-0.790008321011353,-0.951154808242497,-0.985686198363456,0.00996888345753889,-0.824539711132313,-1.02885043601466,-0.884969643843991,-0.982808582520043,-0.933889113182017,-0.991441430050283,-0.827417326975726,-1.00295189342394,-1.01158474095418,-0.732456004143088,-1.00870712511076,-0.649005144684102,-0.850438253723032,-0.910868186434711,-0.876336796313751,-0.709435077395781,-0.844683022036205,-0.60296329118949,-0.988563814206869,-1.03460566770148,-0.93676672902543,-0.870581564626925,-0.493613889139785,-0.861948717096685,-0.899357723061058,-0.651882760527516,-0.890724875530818,-0.844683022036205,0.00133603592729905,-0.718067924926021,-0.76986501010746,-0.755476930890394,-0.79576355269818,-0.608718522876316,0.0962973587599373,0.927928337506375,-0.746844083360154,-0.741088851673327,1.65308753004652,-0.516634815887091,1.06605389799021,-0.631739449623623,-0.519512431730505,-0.654760376370929,-0.459082499018826,2.29191824728427,-0.369876407873014,-0.263404621666723,-0.663393223901169,1.60992329239532,-0.476348194079306,-0.205852304798457,0.48477549762073,-0.211607536485284,0.409957485691985,-0.539655742634398,-0.649005144684102,-0.326712170221815,-0.743966467516741,-0.700802229865541,-0.510879584200265,-0.559799053538291,-0.597208059502663,-0.56843190106853,-0.395774950463734,-0.78713070516794,0.769659466118645,-0.810151631915246,-0.813029247758659,-0.473470578235892,-0.148299987930192,-0.516634815887091,-0.692169382335302,-0.7784978576377,-0.709435077395781,0.323629010389586,-0.430306340584693,-0.456204883175413,-0.43606157227152,1.3020183971501,0.361038016353959,0.939438800880029,-0.528145279260745,-0.490736273296372,-0.191464225581391,-0.384264487090081,1.06893151383363,2.30055109481451,1.85164302324204,-0.631739449623623,-0.116646213652645,1.05742105045997,1.55237097552706,0.153849675628203,0.942316416723442,0.197013913279402,-0.318079322691575,-0.179953762207738,0.591247283827022,-0.0274401225068338,0.12507351719407,-0.450449651488586,0.372548479727612,-0.4101630296808,0.093419742916524,0.689086222503073,-0.459082499018826,0.199891529122815,-0.476348194079306,-0.174198530520911,-0.369876407873014,-0.375631639559841,1.08044197720728,5.14939077979366,-0.361243560342774,0.732250460154272,3.26167478651455,-0.231750847389177,0.00421365177071233,0.340894705450066,-0.453327267331999,0.214279608339882,-0.0677267443146197,1.93509388270102,-0.108013366122406,-0.277792700883789,-0.297936011787682,0.00996888345753889,1.17540330003992,1.92646103517078,1.81998924896449,0.191258681592576,1.39122448829591,-0.0677267443146197,1.80560116974743,0.743760923527925,0.441611259969531,2.20271215613846,0.968214959314161,-0.0763595918448595,1.2588541594989,1.73366077366209,-0.240383694919417,2.18544646107798,1.46316488438125,2.00415666294294,1.35669309817495,0.33513947376324,1.73941600534892,-0.131034292869712,0.214279608339882,2.09624036993217,0.582614436296782,1.74804885287916,0.0847868953862842,-0.0360729700370736,0.173992986532096,0.395569406474918,0.579736820453368,-0.21736276817211,-1.06338182613561,-0.559799053538291,0.864620788951283,1.39985733582615,-0.030317738350247,1.92070580348396,2.19407930860822,-0.0188072749765939,0.130828748880897,-0.197219457268217,0.585492052140195,0.283342388581801,1.50057389034562,0.271831925208147],"CRBI":[-0.985176895045393,-0.903112465678043,-0.911905083110259,-0.944144680361718,-0.771223204194802,-0.885527230813611,-0.876734613381395,-0.926559445497286,-0.809324546401072,-0.894319848245827,-0.70967488216929,-0.806393673923666,-0.689158774827452,-0.958799042748745,-0.777084949149613,-0.920697700542475,-0.727260117033722,-0.903112465678043,-0.630541325279345,-0.897250720723232,-0.900181593200638,0.242858672987451,-0.870872868426584,-0.982246022567988,-0.736052734465938,-0.944144680361718,-0.882596358336206,-0.935352062929502,-0.683297029872642,-0.938282935406907,-0.903112465678043,-0.809324546401072,-0.970522532658366,-0.522099043615347,-0.79173931153664,-0.850356761084747,-0.914835955587665,-0.777084949149613,-0.75363796933037,-0.645195687666372,-0.947075552839123,-0.973453405135772,-0.850356761084747,-0.87380374090399,-0.202633943578163,-0.79173931153664,-0.897250720723232,-0.539684278479779,-0.891388975768422,-0.718467499601506,-0.161601728894488,-0.624679580324534,-0.668642667485615,-0.656919177575993,-0.607094345460102,-0.486928573886483,-0.0707446820949222,0.925751960222899,-0.823978908788099,-0.809324546401072,1.65260833461943,-0.689158774827452,1.34779759696927,-0.662780922530804,-0.369693674790268,-0.504513808750915,-0.401933272041727,2.70186068153054,-0.642264815188966,-0.598301728027886,-0.560200385821617,2.17723450807499,-0.360901057358052,-0.226080923397406,0.342508337219233,0.0171814922272385,-0.0619520646627061,-0.615886962892318,-0.554338640866806,-0.422449379383565,-0.823978908788099,-0.768292331717397,-0.659850050053399,-0.492790318841293,-0.744845351898154,-0.448827231680213,-0.13522387659784,-0.730190989511127,0.292683505103342,-0.803462801446261,-0.700882264737074,-0.583647365640859,-0.132293004120435,-0.610025217937508,-0.533822533524968,-0.721398372078911,-0.604163472982697,0.427503639063988,-0.574854748208643,-0.738983606943343,-0.231942668352217,1.44451638872365,-0.0267815949338419,0.465604981270258,-0.466412466544645,-0.413656761951349,-0.70967488216929,-0.275905755513297,0.940406322609925,2.36481034662893,0.770415718920415,-0.54554602343459,-0.501582936273509,1.01953987949987,2.11568618604947,0.0582137069109134,0.509568068431338,0.216480820690803,-0.085399044481949,0.0933841766397777,0.222342565645613,-0.0238507224564365,0.108038539026804,-0.440034614247997,0.324923102354801,-0.249527903216649,-0.123500386688219,0.248720417942262,-0.533822533524968,0.427503639063988,-0.416587634428754,-0.0590211921853008,-0.167463473849299,-0.522099043615347,1.08108820152538,2.8396116879686,-0.272974883035892,0.263374780329288,3.85076269267344,-0.211426561010379,-0.17918696375892,-0.00040374263719367,-0.574854748208643,-0.00919636006940974,-0.33745407753881,2.93926135220038,0.178379478484533,-0.258320520648865,-0.645195687666372,-0.100053406868976,1.59692175754873,1.89880162272148,2.1303405484365,-0.431241996815781,1.34193585201446,-0.00919636006940974,1.85190766308299,0.638526457437174,0.371817061993286,2.44394390351887,1.37710632174332,0.163725116097506,1.39762242908516,2.19188887046201,-0.00626548759200438,2.60514188977617,1.96328081722439,2.06586135393358,1.91638685758591,0.714729141849713,2.01310564934029,-0.0560903197078954,0.0640754518657242,2.76633987603346,0.685420417075659,1.06057209418355,0.377678806948097,0.386471424380313,0.330784847309611,0.368886189515881,1.04005598684171,-0.240735285784433,-0.991038640000204,-0.428311124338376,0.131485518846047,0.210619075735992,-0.190910453668542,1.41227679147219,2.79564860080752,0.113900283981615,0.0113197472724278,-0.0150581050242204,0.0523519619561027,-0.0678138096175168,0.310268739967774,0.219411693168208],"CWalks":[-0.897170696534012,-0.941927425026769,-0.956846334524354,-0.841224785918066,-0.777819420553328,-0.75544105630695,-0.871062604913238,-0.919549060780391,-0.927008515529183,-0.841224785918066,-0.695765418316607,-0.751711328932553,-0.721873509937382,-0.945657152401165,-0.800197784799706,-0.807657239548499,-0.759170783681346,-0.811386966922895,-0.729332964686175,-0.856143695415652,-0.818846421671688,-0.162414403777924,-0.785278875302121,-0.919549060780391,-0.781549147927724,-0.904630151282805,-0.863603150164445,-0.874792332287634,-0.800197784799706,-0.863603150164445,-0.915819333405994,-0.733062692060571,-0.941927425026769,-0.561495232838337,-0.852413968041256,-0.695765418316607,-0.822576149046085,-0.897170696534012,-0.781549147927724,-0.595062779207905,-0.897170696534012,-0.934467970277976,-0.904630151282805,-0.830035603794877,-0.408576410488086,-0.803927512174103,-0.770359965804535,-0.66219787194704,-0.859873422790048,-0.774089693178932,-0.0990090384131857,-0.740522146809364,-0.546576323340752,-0.688305963567815,-0.747981601558157,-0.263117042886627,-0.35263049987214,1.91131401638647,-0.774089693178932,-0.561495232838337,1.58682773481398,-0.550306050715148,2.27682729907731,-0.617441143454283,-0.188522495398699,-0.632360052951869,-0.639819507700662,2.95563768121745,-0.248198133389041,-0.169873858526717,-0.509279049596788,1.41153054821735,-0.733062692060571,0.124774604050597,1.06839562977288,-0.337711590374554,0.438071703499894,-0.751711328932553,-0.289225134507401,-0.647278962449454,-0.658468144572644,-0.692035690942211,-0.565224960212734,-0.401116955739293,-0.609981688705491,-0.479441230601617,-0.401116955739293,-0.688305963567815,0.725260711328416,-0.7032248730654,-0.665927599321436,-0.408576410488086,-0.319062953502572,-0.654738417198247,-0.509279049596788,-0.721873509937382,-0.591333051833509,-0.0766306741668073,-0.274306225009816,-0.442143956857653,-0.00576585405327601,0.333639337016795,-0.263117042886627,0.833422805185911,-0.386198046241707,-0.229549496517059,-0.214630587019474,-0.0915495836643929,0.975152445412974,4.16033962314749,2.07169229348551,-0.7032248730654,-0.0244144909252579,0.13223405879939,1.0497469929009,0.542504069982993,-0.0318739456740507,-0.0915495836643929,-0.48690068535041,-0.289225134507401,0.2254772431593,-0.173603585901113,0.147152968296976,-0.680846508819022,0.0688286934346517,-0.408576410488086,0.557422979480578,0.281423153775246,-0.367549409369725,0.135963786173787,-0.479441230601617,-0.281765679758609,-0.386198046241707,-0.337711590374554,1.00871999178254,4.85406891478521,-0.322792680876969,0.516395978362218,4.01860998292042,0.0166125101931023,0.117315149301805,-0.0840901289156001,-0.378738591492915,0.404504157130326,-0.266846770261023,2.06796256611111,-0.0952793110387893,-0.0691712194180146,-0.263117042886627,-0.471981775852824,2.24325975270774,1.74347628453863,0.512666250987822,0.195639424164129,1.14299017726081,0.09120705768103,1.32201709123184,0.203098878912922,0.180720514666543,1.72482764766665,1.05720644764969,-0.348900772497743,1.31455763648304,0.859530896806685,0.00915305544430954,1.96353019962802,1.65769255492751,1.60547637168596,1.54953046107002,-0.00576585405327601,2.19850302421499,-0.397387228364897,-0.0878198562899965,1.11688208564004,1.41526027559175,1.25115227111831,0.203098878912922,0.113585421927408,0.419423066627912,0.322450154893606,0.259044789528867,-0.416035865236878,-0.97176524402194,0.0874773303066336,0.370936610760759,1.65396282755312,-0.371279136744122,1.00871999178254,0.796125531441947,0.210558333661714,0.352287973888777,-0.337711590374554,0.527585160485407,0.568612161603767,2.27682729907731,0.251585334780075],"PutOuts":[-0.733312073137102,-0.577179001680995,-0.500847277858009,-0.643101854073573,-0.296139473060002,0.255530712751577,-0.212868501616745,0.53657024137257,-0.292669849249866,-0.469620663566788,-0.625753735022895,-0.48349915880733,-0.452272544516109,-0.594527120731673,-0.205929253996473,-0.0324480634896875,-0.518195396908688,-0.660449973124252,0.109806512725877,-0.899854016023616,-0.643101854073573,-0.448802920705973,-0.26491285876878,0.154911622257641,0.73086917474017,-0.691676587415473,-0.493908030237738,-0.625753735022895,-0.997003482707416,0.102867265105605,-0.299609096870138,-0.400228187364073,-0.643101854073573,-0.639632230263438,0.24512184132117,0.60943234138542,-0.261443234958645,-0.0914316682619946,-0.452272544516109,-0.400228187364073,-0.698615835035745,-0.33777495878163,-0.303078720680273,-0.112249411122809,3.29145154662033,-0.611875239782352,0.00571779842180537,-0.535543515959366,2.27138214644043,3.24287681327843,-0.719433577896559,0.456768893739448,0.248591465131305,-0.743720944567509,-0.438394049275566,-0.504316901668145,-0.62922335883303,-0.813113420770223,-0.563300506440452,-0.743720944567509,-0.466151039756652,-0.212868501616745,-0.424515554035023,-0.0463265587302304,1.52194340345111,3.35043515139263,-0.681267715985066,-0.709024706466152,0.605962717575284,-0.355123077832309,-0.82352229220063,-0.997003482707416,-0.160824144464709,-0.882505896972938,-0.997003482707416,-0.67779809217493,-0.695146211225609,-0.226746996857288,-0.997003482707416,0.491465131840805,-0.0150999444390089,0.130624255586691,-0.292669849249866,-0.480029534997195,0.130624255586691,-0.417576306414752,-0.997003482707416,-0.844340035061445,-0.45921179213638,-0.292669849249866,3.58289994667173,-0.271852106389052,-0.62922335883303,0.0230659174724839,-0.67779809217493,-0.542482763579638,0.0404140365231625,-0.379410444503259,-0.441863673085702,-0.868627401732395,2.05626547021201,-0.303078720680273,-0.0185695682491446,-0.171233015895116,0.0577621555738411,-0.26491285876878,-0.577179001680995,0.800261650942884,0.0993976412954697,1.80645255588224,-0.820052668390495,0.85230600809492,0.0161266698522125,0.0993976412954697,-0.497377654047873,-0.0185695682491446,-0.278791354009323,-0.174702639705252,0.151441998447505,-0.594527120731673,-0.26491285876878,-0.0255088158694161,-0.826991916010766,0.0542925317637054,-0.493908030237738,0.154911622257641,-0.771477935048595,-0.16776339208498,0.0542925317637054,-0.997003482707416,-0.188581134945795,-0.0983709158822661,-0.480029534997195,-0.129597530173488,-0.795765301719545,0.817609769993563,1.9382982606674,-0.781886806479002,-0.997003482707416,-0.788826054099273,0.276348455612391,0.0751102746245197,-0.316957215920816,0.22083447465022,0.17225974130832,-0.417576306414752,-0.670858844554659,-0.407167434984345,-0.351653454022173,0.130624255586691,-0.997003482707416,-0.632692982643166,2.70508512270739,0.508813250891484,-0.747190568377645,0.0542925317637054,0.352680179435377,-0.764538687428323,-0.164293768274845,-0.997003482707416,-0.584118249301266,3.78066850384946,0.0542925317637054,-0.0324480634896875,-0.212868501616745,0.0161266698522125,2.62875339888441,-0.660449973124252,2.01809960830052,0.0265355412826197,-0.174702639705252,-0.195520382566066,0.0577621555738411,0.14797237463737,1.38315845104568,-0.663919596934388,3.22899831803788,-0.369001573072852,3.27410342756965,0.290226950852934,0.678824817588134,0.0785798984346554,-0.72637282551683,1.62603211775518,-0.712494330276288,0.481056260410398,-0.45921179213638,0.224304098460355,3.02776013705001,0.0959280174853339,0.224304098460355,1.81339180350251,-0.771477935048595,-0.577179001680995,0.0889887698650625,3.56208220381091],"Assists":[0.0744338686565573,1.15254375403927,1.20092047966541,0.419981908843323,-0.65121701573565,-0.65121701573565,-0.75488142779168,-0.395511465997444,-0.319490897156355,-0.782525271006621,0.869194361086118,-0.775614310202886,-0.75488142779168,-0.768703349399151,1.80217406959038,2.06479058013233,-0.699593741361797,-0.789436231810356,-0.775614310202886,-0.41624434840865,-0.775614310202886,-0.775614310202886,-0.741059506184209,-0.671949898146856,-0.53373068207215,-0.803258153417827,-0.395511465997444,0.613488811347911,-0.803258153417827,-0.554463564483356,-0.761792388595415,1.38751642136627,-0.761792388595415,1.15254375403927,-0.582107407698297,-0.582107407698297,-0.796347192614092,2.36887285549668,-0.761792388595415,-0.796347192614092,0.233385967142469,-0.789436231810356,-0.75488142779168,2.30667420826306,-0.125983994651767,0.758618988226353,2.00950289370244,1.76070830476797,-0.305668975548885,0.157365398301381,-0.492264917249738,-0.485353956446003,-0.595929329305768,0.419981908843323,-0.734148545380474,-0.706504702165533,0.620399772151647,-0.19509360268912,0.5720230465255,0.24720788874994,0.737886105815147,-0.75488142779168,-0.741059506184209,-0.789436231810356,-0.202004563492855,-0.0361415042032077,0.475269595273205,0.399249026432117,-0.741059506184209,-0.747970466987945,0.136632515890175,-0.803258153417827,-0.747970466987945,-0.782525271006621,-0.803258153417827,0.972858773142148,0.343961340002234,-0.768703349399151,-0.803258153417827,-0.747970466987945,-0.747970466987945,-0.720326623773003,-0.782525271006621,-0.796347192614092,-0.713415662969268,-0.789436231810356,-0.803258153417827,-0.803258153417827,-0.782525271006621,1.7468863831605,0.343961340002234,1.76761926557171,0.191920202320058,2.27211940424439,-0.768703349399151,-0.761792388595415,-0.713415662969268,-0.492264917249738,1.20092047966541,-0.022319582595737,-0.236559367511532,-0.727237584576739,2.10625634495474,2.27211940424439,-0.492264917249738,-0.727237584576739,0.240296927946205,-0.423155309212385,-0.761792388595415,-0.0568743866144136,-0.43006627001612,-0.526819721268415,-0.761792388595415,2.23065363942197,-0.761792388595415,2.56237975800127,1.67086581431941,-0.747970466987945,-0.665038937343121,0.730975145011412,-0.41624434840865,2.50709207157139,-0.789436231810356,-0.720326623773003,-0.768703349399151,-0.741059506184209,0.979769733945883,-0.747970466987945,2.30667420826306,-0.803258153417827,-0.75488142779168,-0.595929329305768,-0.747970466987945,-0.727237584576739,0.171187319908852,-0.506086838857209,-0.222737445904061,-0.181271681081649,-0.803258153417827,0.413070948039587,2.47944822835644,2.59693456201995,1.64322197110447,2.25138652183318,-0.671949898146856,-0.678860858950591,1.06270126359071,1.159454714843,1.20092047966541,-0.741059506184209,-0.803258153417827,1.20092047966541,0.281762692768617,-0.741059506184209,0.371605183217176,-0.741059506184209,-0.53373068207215,0.212653084731264,2.52782495398259,-0.803258153417827,0.689509380189,-0.112162073044296,-0.761792388595415,-0.741059506184209,-0.734148545380474,-0.741059506184209,-0.19509360268912,0.703331301796471,-0.374778583586238,-0.699593741361797,-0.768703349399151,1.78144118717918,1.59484524547833,-0.692682780558062,-0.485353956446003,-0.768703349399151,-0.0845182298293548,-0.713415662969268,-0.250381289119002,-0.761792388595415,-0.471532034838532,-0.741059506184209,0.717153223403941,-0.360956661978767,0.371605183217176,-0.775614310202886,1.76070830476797,-0.741059506184209,-0.436977230819856,-0.734148545380474,2.05787961932859,-0.119073033848031,-0.803258153417827,1.0419683811795,1.82981791280533,0.102077711871499],"Errors":[-0.232388925933805,0.0743331581269745,1.60794357843087,1.1478604523397,-0.999194136085753,-0.999194136085753,-0.692472052024974,-0.385749967964194,0.227694200157364,-0.539111009994584,2.22138774655243,-0.999194136085753,-0.0790278839034151,0.534416284218143,2.6814708726436,1.1478604523397,-1.15255517811614,-0.999194136085753,0.841138368278923,-0.999194136085753,-0.999194136085753,-0.539111009994584,-0.845833094055363,-0.999194136085753,0.687777326248533,-0.845833094055363,-0.0790278839034151,1.1478604523397,-1.30591622014653,-1.15255517811614,-0.845833094055363,2.52810983061321,-0.845833094055363,1.60794357843087,-0.0790278839034151,-0.0790278839034151,-0.999194136085753,2.06802670452204,0.841138368278923,-0.692472052024974,0.994499410309312,0.0743331581269745,-0.385749967964194,1.30122149437009,1.45458253640048,0.381055242187754,-0.385749967964194,1.76130462046126,0.381055242187754,0.994499410309312,-0.0790278839034151,-0.539111009994584,-0.692472052024974,1.45458253640048,-0.845833094055363,-0.999194136085753,-0.232388925933805,-0.845833094055363,0.687777326248533,0.381055242187754,0.227694200157364,-0.845833094055363,-1.15255517811614,-0.232388925933805,-0.845833094055363,0.381055242187754,0.534416284218143,1.1478604523397,-0.232388925933805,-0.692472052024974,1.76130462046126,-1.30591622014653,-0.385749967964194,-1.30591622014653,-1.30591622014653,1.76130462046126,0.841138368278923,-0.539111009994584,-1.30591622014653,-0.385749967964194,-0.845833094055363,-0.0790278839034151,-0.845833094055363,-0.385749967964194,-0.845833094055363,-0.692472052024974,-1.30591622014653,-1.15255517811614,-0.999194136085753,1.1478604523397,1.30122149437009,1.30122149437009,-0.232388925933805,0.687777326248533,-0.845833094055363,-1.15255517811614,-0.539111009994584,-0.692472052024974,0.381055242187754,-0.232388925933805,0.841138368278923,-0.845833094055363,2.52810983061321,2.06802670452204,0.381055242187754,-0.232388925933805,-0.385749967964194,-0.845833094055363,-0.539111009994584,-0.999194136085753,-0.0790278839034151,-0.692472052024974,-0.845833094055363,0.227694200157364,-0.539111009994584,1.60794357843087,1.76130462046126,-1.15255517811614,-0.692472052024974,0.994499410309312,0.687777326248533,-0.539111009994584,-1.30591622014653,-0.539111009994584,-0.232388925933805,-0.0790278839034151,-0.0790278839034151,-0.999194136085753,0.841138368278923,-1.30591622014653,-0.232388925933805,0.227694200157364,-0.385749967964194,-1.15255517811614,2.22138774655243,-0.385749967964194,0.0743331581269745,-0.845833094055363,-1.30591622014653,-0.385749967964194,1.60794357843087,-0.539111009994584,0.994499410309312,1.30122149437009,-0.692472052024974,-0.385749967964194,1.1478604523397,-0.845833094055363,1.30122149437009,-0.845833094055363,-1.30591622014653,0.227694200157364,0.841138368278923,-0.845833094055363,2.37474878858282,0.0743331581269745,-0.692472052024974,-0.692472052024974,0.687777326248533,-1.30591622014653,0.534416284218143,-0.385749967964194,-0.385749967964194,0.0743331581269745,-0.385749967964194,-0.539111009994584,0.687777326248533,1.1478604523397,-0.0790278839034151,-0.539111009994584,-0.692472052024974,1.45458253640048,0.227694200157364,-0.0790278839034151,-0.692472052024974,-0.845833094055363,0.227694200157364,-0.692472052024974,-0.232388925933805,-0.385749967964194,-0.385749967964194,0.0743331581269745,-0.385749967964194,0.994499410309312,0.994499410309312,-0.385749967964194,3.14155399873477,-1.15255517811614,-0.232388925933805,-0.385749967964194,0.0743331581269745,1.45458253640048,-1.30591622014653,1.60794357843087,1.76130462046126,0.534416284218143],"Salary":[70,100,75,175,135,115,110,90,90,75,105,110,145,70,155,87.5,175,90,165,95,110,100,80,75,155,86.5,125,75,145,75,90,150,68,175,137,120,140,175,172,190,70,190,97.5,140,100,135,105,160,120,165,240,300,305,215,415,340,416.667,275,230,225,320,210,260,300,385,215,362.5,200,400,400,297.5,325,250,275,365,277.5,250,300,300,365,202.5,210,240,350,200,300,425,250,400,250,200,350,341.667,350,425,286.667,245,235,425,385,480,500,750,517.143,512.5,550,700,600,675,535,450,431.5,490,750,700,535,737.5,600,662.5,750,430,657,450,630,737.5,625,725,525,575,700,550,650,670,750,450,750,580,450,487.5,450,750,740,475,530,740,500,750,525,550,700,1100,775,776.667,765,850,815,875,1200,1350,950,850,1975,1900,1041.667,1220,1861.46,2460,1500,1925.571,950,773.333,775,850,2412.5,825,1000,1310,1043.333,1183.333,787.5,800,780,2127.333,875,1260,1670,875,1000,1450,940,925,1150,900,1600,875,960],"League_N":[1.0824826592066,-0.919089050269755,1.0824826592066,-0.919089050269755,1.0824826592066,-0.919089050269755,1.0824826592066,1.0824826592066,-0.919089050269755,-0.919089050269755,-0.919089050269755,-0.919089050269755,-0.919089050269755,-0.919089050269755,-0.919089050269755,-0.919089050269755,1.0824826592066,1.0824826592066,-0.919089050269755,-0.919089050269755,1.0824826592066,1.0824826592066,-0.919089050269755,-0.919089050269755,1.0824826592066,1.0824826592066,1.0824826592066,1.0824826592066,-0.919089050269755,1.0824826592066,1.0824826592066,1.0824826592066,-0.919089050269755,-0.919089050269755,-0.919089050269755,-0.919089050269755,1.0824826592066,-0.919089050269755,-0.919089050269755,-0.919089050269755,-0.919089050269755,1.0824826592066,-0.919089050269755,1.0824826592066,-0.919089050269755,-0.919089050269755,-0.919089050269755,1.0824826592066,1.0824826592066,-0.919089050269755,1.0824826592066,-0.919089050269755,-0.919089050269755,1.0824826592066,1.0824826592066,1.0824826592066,1.0824826592066,1.0824826592066,-0.919089050269755,1.0824826592066,1.0824826592066,1.0824826592066,-0.919089050269755,1.0824826592066,1.0824826592066,1.0824826592066,-0.919089050269755,1.0824826592066,-0.919089050269755,1.0824826592066,1.0824826592066,-0.919089050269755,-0.919089050269755,-0.919089050269755,-0.919089050269755,1.0824826592066,1.0824826592066,-0.919089050269755,-0.919089050269755,-0.919089050269755,1.0824826592066,1.0824826592066,1.0824826592066,-0.919089050269755,-0.919089050269755,-0.919089050269755,-0.919089050269755,-0.919089050269755,-0.919089050269755,1.0824826592066,1.0824826592066,-0.919089050269755,-0.919089050269755,-0.919089050269755,1.0824826592066,1.0824826592066,-0.919089050269755,-0.919089050269755,-0.919089050269755,-0.919089050269755,-0.919089050269755,1.0824826592066,-0.919089050269755,-0.919089050269755,1.0824826592066,1.0824826592066,-0.919089050269755,1.0824826592066,-0.919089050269755,-0.919089050269755,1.0824826592066,-0.919089050269755,1.0824826592066,-0.919089050269755,-0.919089050269755,1.0824826592066,1.0824826592066,-0.919089050269755,1.0824826592066,1.0824826592066,-0.919089050269755,1.0824826592066,1.0824826592066,1.0824826592066,1.0824826592066,1.0824826592066,1.0824826592066,-0.919089050269755,-0.919089050269755,-0.919089050269755,-0.919089050269755,1.0824826592066,1.0824826592066,-0.919089050269755,1.0824826592066,1.0824826592066,-0.919089050269755,-0.919089050269755,-0.919089050269755,-0.919089050269755,1.0824826592066,1.0824826592066,-0.919089050269755,-0.919089050269755,1.0824826592066,1.0824826592066,1.0824826592066,1.0824826592066,1.0824826592066,1.0824826592066,-0.919089050269755,1.0824826592066,-0.919089050269755,-0.919089050269755,1.0824826592066,1.0824826592066,-0.919089050269755,-0.919089050269755,-0.919089050269755,-0.919089050269755,-0.919089050269755,-0.919089050269755,1.0824826592066,1.0824826592066,1.0824826592066,-0.919089050269755,-0.919089050269755,-0.919089050269755,1.0824826592066,-0.919089050269755,1.0824826592066,-0.919089050269755,-0.919089050269755,-0.919089050269755,-0.919089050269755,-0.919089050269755,-0.919089050269755,1.0824826592066,1.0824826592066,-0.919089050269755,-0.919089050269755,-0.919089050269755,1.0824826592066,1.0824826592066,-0.919089050269755,-0.919089050269755,1.0824826592066,-0.919089050269755,1.0824826592066,-0.919089050269755,1.0824826592066,1.0824826592066,1.0824826592066,-0.919089050269755,-0.919089050269755,-0.919089050269755],"Division_W":[-1.10499372474481,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,-1.10499372474481,0.900365257199478,-1.10499372474481,-1.10499372474481,0.900365257199478,-1.10499372474481,0.900365257199478,0.900365257199478,0.900365257199478,-1.10499372474481,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,-1.10499372474481,0.900365257199478,-1.10499372474481,0.900365257199478,-1.10499372474481,0.900365257199478,-1.10499372474481,0.900365257199478,0.900365257199478,-1.10499372474481,0.900365257199478,0.900365257199478,-1.10499372474481,0.900365257199478,0.900365257199478,-1.10499372474481,-1.10499372474481,-1.10499372474481,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,-1.10499372474481,0.900365257199478,0.900365257199478,-1.10499372474481,0.900365257199478,-1.10499372474481,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,-1.10499372474481,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,-1.10499372474481,0.900365257199478,0.900365257199478,-1.10499372474481,-1.10499372474481,0.900365257199478,-1.10499372474481,-1.10499372474481,-1.10499372474481,-1.10499372474481,0.900365257199478,-1.10499372474481,0.900365257199478,0.900365257199478,-1.10499372474481,-1.10499372474481,0.900365257199478,-1.10499372474481,0.900365257199478,0.900365257199478,0.900365257199478,-1.10499372474481,-1.10499372474481,-1.10499372474481,-1.10499372474481,0.900365257199478,-1.10499372474481,-1.10499372474481,0.900365257199478,-1.10499372474481,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,-1.10499372474481,0.900365257199478,-1.10499372474481,0.900365257199478,-1.10499372474481,-1.10499372474481,0.900365257199478,-1.10499372474481,-1.10499372474481,-1.10499372474481,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,-1.10499372474481,-1.10499372474481,-1.10499372474481,-1.10499372474481,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,-1.10499372474481,-1.10499372474481,-1.10499372474481,-1.10499372474481,-1.10499372474481,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,-1.10499372474481,0.900365257199478,0.900365257199478,-1.10499372474481,0.900365257199478,-1.10499372474481,0.900365257199478,-1.10499372474481,0.900365257199478,0.900365257199478,-1.10499372474481,-1.10499372474481,-1.10499372474481,-1.10499372474481,-1.10499372474481,0.900365257199478,-1.10499372474481,-1.10499372474481,0.900365257199478,0.900365257199478,0.900365257199478,0.900365257199478,-1.10499372474481,-1.10499372474481,0.900365257199478,-1.10499372474481,0.900365257199478,0.900365257199478,-1.10499372474481,-1.10499372474481,-1.10499372474481,0.900365257199478,-1.10499372474481,0.900365257199478,0.900365257199478,-1.10499372474481,-1.10499372474481,-1.10499372474481,0.900365257199478,-1.10499372474481,0.900365257199478,-1.10499372474481,-1.10499372474481,-1.10499372474481,-1.10499372474481,0.900365257199478,-1.10499372474481,0.900365257199478,-1.10499372474481,-1.10499372474481,0.900365257199478,-1.10499372474481,0.900365257199478,0.900365257199478,-1.10499372474481,-1.10499372474481,0.900365257199478,-1.10499372474481,-1.10499372474481,-1.10499372474481],"NewLeague_N":[-0.9096878296198,-0.9096878296198,1.09366963785751,-0.9096878296198,1.09366963785751,1.09366963785751,1.09366963785751,1.09366963785751,-0.9096878296198,-0.9096878296198,-0.9096878296198,-0.9096878296198,-0.9096878296198,-0.9096878296198,-0.9096878296198,-0.9096878296198,1.09366963785751,1.09366963785751,-0.9096878296198,-0.9096878296198,1.09366963785751,1.09366963785751,-0.9096878296198,1.09366963785751,1.09366963785751,1.09366963785751,1.09366963785751,1.09366963785751,-0.9096878296198,1.09366963785751,1.09366963785751,1.09366963785751,-0.9096878296198,-0.9096878296198,-0.9096878296198,-0.9096878296198,1.09366963785751,-0.9096878296198,-0.9096878296198,-0.9096878296198,-0.9096878296198,1.09366963785751,-0.9096878296198,1.09366963785751,-0.9096878296198,-0.9096878296198,-0.9096878296198,1.09366963785751,1.09366963785751,-0.9096878296198,1.09366963785751,-0.9096878296198,-0.9096878296198,1.09366963785751,1.09366963785751,1.09366963785751,1.09366963785751,1.09366963785751,-0.9096878296198,1.09366963785751,1.09366963785751,-0.9096878296198,-0.9096878296198,1.09366963785751,-0.9096878296198,1.09366963785751,-0.9096878296198,1.09366963785751,-0.9096878296198,-0.9096878296198,1.09366963785751,-0.9096878296198,-0.9096878296198,-0.9096878296198,-0.9096878296198,1.09366963785751,-0.9096878296198,-0.9096878296198,-0.9096878296198,-0.9096878296198,1.09366963785751,1.09366963785751,1.09366963785751,-0.9096878296198,-0.9096878296198,-0.9096878296198,-0.9096878296198,-0.9096878296198,-0.9096878296198,1.09366963785751,1.09366963785751,-0.9096878296198,-0.9096878296198,-0.9096878296198,-0.9096878296198,1.09366963785751,-0.9096878296198,-0.9096878296198,-0.9096878296198,-0.9096878296198,-0.9096878296198,1.09366963785751,-0.9096878296198,-0.9096878296198,1.09366963785751,1.09366963785751,-0.9096878296198,1.09366963785751,-0.9096878296198,-0.9096878296198,1.09366963785751,-0.9096878296198,1.09366963785751,-0.9096878296198,-0.9096878296198,1.09366963785751,1.09366963785751,-0.9096878296198,1.09366963785751,1.09366963785751,-0.9096878296198,1.09366963785751,1.09366963785751,1.09366963785751,1.09366963785751,1.09366963785751,1.09366963785751,-0.9096878296198,-0.9096878296198,1.09366963785751,-0.9096878296198,-0.9096878296198,1.09366963785751,-0.9096878296198,1.09366963785751,1.09366963785751,-0.9096878296198,-0.9096878296198,-0.9096878296198,-0.9096878296198,1.09366963785751,1.09366963785751,-0.9096878296198,-0.9096878296198,1.09366963785751,1.09366963785751,1.09366963785751,1.09366963785751,1.09366963785751,1.09366963785751,-0.9096878296198,1.09366963785751,-0.9096878296198,-0.9096878296198,1.09366963785751,1.09366963785751,-0.9096878296198,-0.9096878296198,-0.9096878296198,-0.9096878296198,-0.9096878296198,-0.9096878296198,1.09366963785751,1.09366963785751,1.09366963785751,-0.9096878296198,-0.9096878296198,-0.9096878296198,1.09366963785751,-0.9096878296198,1.09366963785751,-0.9096878296198,-0.9096878296198,-0.9096878296198,1.09366963785751,1.09366963785751,-0.9096878296198,1.09366963785751,1.09366963785751,-0.9096878296198,1.09366963785751,-0.9096878296198,1.09366963785751,1.09366963785751,-0.9096878296198,-0.9096878296198,1.09366963785751,-0.9096878296198,1.09366963785751,-0.9096878296198,1.09366963785751,1.09366963785751,1.09366963785751,-0.9096878296198,-0.9096878296198,-0.9096878296198]},"columns":[{"accessor":"AtBat","name":"AtBat","type":"numeric"},{"accessor":"Hits","name":"Hits","type":"numeric"},{"accessor":"HmRun","name":"HmRun","type":"numeric"},{"accessor":"Runs","name":"Runs","type":"numeric"},{"accessor":"RBI","name":"RBI","type":"numeric"},{"accessor":"Walks","name":"Walks","type":"numeric"},{"accessor":"Years","name":"Years","type":"numeric"},{"accessor":"CAtBat","name":"CAtBat","type":"numeric"},{"accessor":"CHits","name":"CHits","type":"numeric"},{"accessor":"CHmRun","name":"CHmRun","type":"numeric"},{"accessor":"CRuns","name":"CRuns","type":"numeric"},{"accessor":"CRBI","name":"CRBI","type":"numeric"},{"accessor":"CWalks","name":"CWalks","type":"numeric"},{"accessor":"PutOuts","name":"PutOuts","type":"numeric"},{"accessor":"Assists","name":"Assists","type":"numeric"},{"accessor":"Errors","name":"Errors","type":"numeric"},{"accessor":"Salary","name":"Salary","type":"numeric"},{"accessor":"League_N","name":"League_N","type":"numeric"},{"accessor":"Division_W","name":"Division_W","type":"numeric"},{"accessor":"NewLeague_N","name":"NewLeague_N","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"c4aab1aadb172c8d202f50e8123a9a22","key":"c4aab1aadb172c8d202f50e8123a9a22"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="specify-the-model" class="section level2">
<h2>Specify the model</h2>
<p>The model specification will look very similar to what we have seen earlier, but we will set <code>penalty = tune::tune</code>. This tells <a href="https://tune.tidymodels.org/reference/tune_grid.html"><code>tune::tune_grid</code></a> that the penalty parameter should be tuned using <a href="https://hardhat.tidymodels.org/reference/tune.html"><code>tune::tune</code></a>.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>ridge_spec <span class="ot">&lt;-</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">linear_reg</span>(<span class="at">penalty =</span> tune<span class="sc">::</span><span class="fu">tune</span>(), <span class="at">mixture =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_mode</span>(<span class="st">&quot;regression&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">&quot;glmnet&quot;</span>)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>ridge_spec <span class="sc">%&gt;%</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">translate</span>()</span></code></pre></div>
<pre><code>&gt; Linear Regression Model Specification (regression)
&gt; 
&gt; Main Arguments:
&gt;   penalty = tune()
&gt;   mixture = 0
&gt; 
&gt; Computational engine: glmnet 
&gt; 
&gt; Model fit template:
&gt; glmnet::glmnet(x = missing_arg(), y = missing_arg(), weights = missing_arg(), 
&gt;     alpha = 0, family = &quot;gaussian&quot;)</code></pre>
</div>
<div id="create-the-workflow" class="section level2">
<h2>Create the workflow</h2>
<p><a href="https://workflows.tidymodels.org/reference/workflow.html"><code>workflows::workflow</code></a>, <a href="https://workflows.tidymodels.org/reference/add_recipe.html"><code>workflows::add_recipe</code></a> and <a href="https://workflows.tidymodels.org/reference/add_model.html"><code>workflows::add_model</code></a> are used.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>ridge_workflow <span class="ot">&lt;-</span> workflows<span class="sc">::</span><span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  workflows<span class="sc">::</span><span class="fu">add_recipe</span>(ridge_recipe) <span class="sc">%&gt;%</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  workflows<span class="sc">::</span><span class="fu">add_model</span>(ridge_spec)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>ridge_workflow</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; == Workflow ==========================================================
&gt; Preprocessor: Recipe
&gt; Model: linear_reg()
&gt; 
&gt; -- Preprocessor ------------------------------------------------------
&gt; 4 Recipe Steps
&gt; 
&gt; * step_novel()
&gt; * step_dummy()
&gt; * step_zv()
&gt; * step_normalize()
&gt; 
&gt; -- Model -------------------------------------------------------------
&gt; Linear Regression Model Specification (regression)
&gt; 
&gt; Main Arguments:
&gt;   penalty = tune::tune()
&gt;   mixture = 0
&gt; 
&gt; Computational engine: glmnet</code></pre>
</div>
<div id="create-the-penaltylambda-grid" class="section level2">
<h2>Create the penalty/lambda grid</h2>
<p>A penalty/lambda grid of <span class="math inline">\(50\)</span> numbers from <span class="math inline">\(0.00001\)</span> (<span class="math inline">\(10^{-5}\)</span>) to <span class="math inline">\(10000\)</span> (<span class="math inline">\(10^5\)</span>) is created.</p>
<p>Regular grid is created using <a href="https://dials.tidymodels.org/reference/grid_regular.html"><code>dials::grid_regular</code></a>, <a href="https://dials.tidymodels.org/reference/penalty.html"><code>dials::penalty</code></a> and <a href="https://scales.r-lib.org/reference/log_trans.html"><code>scales::log10_trans</code></a></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>penalty_grid <span class="ot">&lt;-</span> dials<span class="sc">::</span><span class="fu">grid_regular</span>(</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> dials<span class="sc">::</span><span class="fu">penalty</span>(</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">range =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>),</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">trans =</span> scales<span class="sc">::</span><span class="fu">log10_trans</span>()</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="dv">50</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>penalty_grid <span class="sc">%&gt;%</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-ada8cc9ad64e1dba5279" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ada8cc9ad64e1dba5279">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"penalty":[1e-05,1.59985871960606e-05,2.55954792269953e-05,4.09491506238043e-05,6.55128556859551e-05,0.000104811313415469,0.000167683293681101,0.000268269579527973,0.000429193426012878,0.0006866488450043,0.00109854114198756,0.00175751062485479,0.00281176869797423,0.00449843266896944,0.00719685673001152,0.0115139539932645,0.0184206996932672,0.0294705170255181,0.0471486636345739,0.0754312006335462,0.120679264063933,0.193069772888325,0.308884359647748,0.494171336132384,0.79060432109077,1.2648552168553,2.02358964772516,3.23745754281765,5.17947467923121,8.28642772854684,13.2571136559011,21.2095088792019,33.9322177189533,54.2867543932386,86.8511373751352,138.949549437314,222.29964825262,355.648030622313,568.98660290183,910.298177991523,1456.34847750124,2329.95181051537,3727.59372031494,5963.62331659464,9540.95476349996,15264.1796717524,24420.5309454865,39069.3993705462,62505.5192527398,100000]},"columns":[{"accessor":"penalty","name":"penalty","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"a517c5b31a00344b54493cefbf8d691c","key":"a517c5b31a00344b54493cefbf8d691c"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="ridge-regression-model-fitting-on-cross-validated-data" class="section level2">
<h2>Ridge regression model fitting on cross validated data</h2>
<p>Now we have everything we need and we can fit all the models on the cross validated data with <a href="https://tune.tidymodels.org/reference/tune_grid.html"><code>tune::tune_grid</code></a>. Note that this process may take some time.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>doParallel<span class="sc">::</span><span class="fu">registerDoParallel</span>()</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>foreach<span class="sc">::</span><span class="fu">getDoParWorkers</span>()</span></code></pre></div>
<pre><code>&gt; [1] 3</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>tune_res <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">tune_grid</span>(</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">object =</span> ridge_workflow,</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">resamples =</span> Hitters_fold,</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">grid =</span> penalty_grid</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>tune_res</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; # Tuning results
&gt; # 10-fold cross-validation 
&gt; # A tibble: 10 x 4
&gt;    splits           id     .metrics           .notes          
&gt;    &lt;list&gt;           &lt;chr&gt;  &lt;list&gt;             &lt;list&gt;          
&gt;  1 &lt;split [176/20]&gt; Fold01 &lt;tibble [100 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  2 &lt;split [176/20]&gt; Fold02 &lt;tibble [100 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  3 &lt;split [176/20]&gt; Fold03 &lt;tibble [100 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  4 &lt;split [176/20]&gt; Fold04 &lt;tibble [100 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  5 &lt;split [176/20]&gt; Fold05 &lt;tibble [100 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  6 &lt;split [176/20]&gt; Fold06 &lt;tibble [100 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  7 &lt;split [177/19]&gt; Fold07 &lt;tibble [100 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  8 &lt;split [177/19]&gt; Fold08 &lt;tibble [100 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  9 &lt;split [177/19]&gt; Fold09 &lt;tibble [100 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt; 10 &lt;split [177/19]&gt; Fold10 &lt;tibble [100 x 5]&gt; &lt;tibble [0 x 3]&gt;</code></pre>
<p>Here we see that the amount of regularization affects the performance metrics differently using <a href="https://tune.tidymodels.org/reference/autoplot.tune_results.html"><code>tune::autoplot</code></a>. Do note that using a different seed will give a different plot</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that a different seed will give different plots</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>tune<span class="sc">::</span><span class="fu">autoplot</span>(tune_res)</span></code></pre></div>
<p><img src="figures/unnamed-chunk-34-1.png" width="3883.2" style="display: block; margin: auto;" /></p>
<p>We can also see the raw metrics that created this chart by calling <a href="https://tune.tidymodels.org/reference/collect_predictions.html"><code>tune::collect_metrics()</code></a>.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>tune<span class="sc">::</span><span class="fu">collect_metrics</span>(tune_res) <span class="sc">%&gt;%</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-c9cca045f4bb5562ee72" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-c9cca045f4bb5562ee72">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"penalty":[1e-05,1e-05,1.59985871960606e-05,1.59985871960606e-05,2.55954792269953e-05,2.55954792269953e-05,4.09491506238043e-05,4.09491506238043e-05,6.55128556859551e-05,6.55128556859551e-05,0.000104811313415469,0.000104811313415469,0.000167683293681101,0.000167683293681101,0.000268269579527973,0.000268269579527973,0.000429193426012878,0.000429193426012878,0.0006866488450043,0.0006866488450043,0.00109854114198756,0.00109854114198756,0.00175751062485479,0.00175751062485479,0.00281176869797423,0.00281176869797423,0.00449843266896944,0.00449843266896944,0.00719685673001152,0.00719685673001152,0.0115139539932645,0.0115139539932645,0.0184206996932672,0.0184206996932672,0.0294705170255181,0.0294705170255181,0.0471486636345739,0.0471486636345739,0.0754312006335462,0.0754312006335462,0.120679264063933,0.120679264063933,0.193069772888325,0.193069772888325,0.308884359647748,0.308884359647748,0.494171336132384,0.494171336132384,0.79060432109077,0.79060432109077,1.2648552168553,1.2648552168553,2.02358964772516,2.02358964772516,3.23745754281765,3.23745754281765,5.17947467923121,5.17947467923121,8.28642772854684,8.28642772854684,13.2571136559011,13.2571136559011,21.2095088792019,21.2095088792019,33.9322177189533,33.9322177189533,54.2867543932386,54.2867543932386,86.8511373751352,86.8511373751352,138.949549437314,138.949549437314,222.29964825262,222.29964825262,355.648030622313,355.648030622313,568.98660290183,568.98660290183,910.298177991523,910.298177991523,1456.34847750124,1456.34847750124,2329.95181051537,2329.95181051537,3727.59372031494,3727.59372031494,5963.62331659464,5963.62331659464,9540.95476349996,9540.95476349996,15264.1796717524,15264.1796717524,24420.5309454865,24420.5309454865,39069.3993705462,39069.3993705462,62505.5192527398,62505.5192527398,100000,100000],".metric":["rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq"],".estimator":["standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard"],"mean":[340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.055039325505,0.473386732236138,340.05770501505,0.474617001030473,339.266724142445,0.477591009307966,338.328013808896,0.480476012610295,337.375135298378,0.48338327472483,336.718850451287,0.486056772181424,336.815760342224,0.488042712895722,338.275532954339,0.488920443371489,341.839822523134,0.488684208282016,348.39858124587,0.487589829203652,358.622923796184,0.486083826407259,372.271600779018,0.484547735891463,387.826852578379,0.483212151974514,403.082465896531,0.482165741597226,416.237355032377,0.481404716260143,426.492774998186,0.480876663528723,433.918604234715,0.480523857631574,439.027214858191,0.480293842709345,442.423067809252,0.480145747972536],"n":[10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10],"std_err":[32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,32.7385958977142,0.0524854981889879,33.1158812148573,0.0528128210685976,33.7218356692893,0.0528795069509566,34.3401526813556,0.0530275455899041,34.9277930596862,0.0534268980010174,35.4244640760661,0.0541106041727805,35.7722541531859,0.0549567426363266,35.9277772810866,0.0557733011495091,35.8834959662472,0.0564277967724679,35.6670256763311,0.0568795703760463,35.3282860553273,0.0571568910684208,34.9228664303816,0.057307804424252,34.5088009570341,0.0573857506416078,34.1384895630914,0.0574237257152366,33.842970368351,0.0574416506537327,33.6267370706939,0.0574502141322647,33.4775673512221,0.0574543333445088,33.3785372438439,0.0574564190752509,33.3143590183283,0.0574574482413304],".config":["Preprocessor1_Model01","Preprocessor1_Model01","Preprocessor1_Model02","Preprocessor1_Model02","Preprocessor1_Model03","Preprocessor1_Model03","Preprocessor1_Model04","Preprocessor1_Model04","Preprocessor1_Model05","Preprocessor1_Model05","Preprocessor1_Model06","Preprocessor1_Model06","Preprocessor1_Model07","Preprocessor1_Model07","Preprocessor1_Model08","Preprocessor1_Model08","Preprocessor1_Model09","Preprocessor1_Model09","Preprocessor1_Model10","Preprocessor1_Model10","Preprocessor1_Model11","Preprocessor1_Model11","Preprocessor1_Model12","Preprocessor1_Model12","Preprocessor1_Model13","Preprocessor1_Model13","Preprocessor1_Model14","Preprocessor1_Model14","Preprocessor1_Model15","Preprocessor1_Model15","Preprocessor1_Model16","Preprocessor1_Model16","Preprocessor1_Model17","Preprocessor1_Model17","Preprocessor1_Model18","Preprocessor1_Model18","Preprocessor1_Model19","Preprocessor1_Model19","Preprocessor1_Model20","Preprocessor1_Model20","Preprocessor1_Model21","Preprocessor1_Model21","Preprocessor1_Model22","Preprocessor1_Model22","Preprocessor1_Model23","Preprocessor1_Model23","Preprocessor1_Model24","Preprocessor1_Model24","Preprocessor1_Model25","Preprocessor1_Model25","Preprocessor1_Model26","Preprocessor1_Model26","Preprocessor1_Model27","Preprocessor1_Model27","Preprocessor1_Model28","Preprocessor1_Model28","Preprocessor1_Model29","Preprocessor1_Model29","Preprocessor1_Model30","Preprocessor1_Model30","Preprocessor1_Model31","Preprocessor1_Model31","Preprocessor1_Model32","Preprocessor1_Model32","Preprocessor1_Model33","Preprocessor1_Model33","Preprocessor1_Model34","Preprocessor1_Model34","Preprocessor1_Model35","Preprocessor1_Model35","Preprocessor1_Model36","Preprocessor1_Model36","Preprocessor1_Model37","Preprocessor1_Model37","Preprocessor1_Model38","Preprocessor1_Model38","Preprocessor1_Model39","Preprocessor1_Model39","Preprocessor1_Model40","Preprocessor1_Model40","Preprocessor1_Model41","Preprocessor1_Model41","Preprocessor1_Model42","Preprocessor1_Model42","Preprocessor1_Model43","Preprocessor1_Model43","Preprocessor1_Model44","Preprocessor1_Model44","Preprocessor1_Model45","Preprocessor1_Model45","Preprocessor1_Model46","Preprocessor1_Model46","Preprocessor1_Model47","Preprocessor1_Model47","Preprocessor1_Model48","Preprocessor1_Model48","Preprocessor1_Model49","Preprocessor1_Model49","Preprocessor1_Model50","Preprocessor1_Model50"]},"columns":[{"accessor":"penalty","name":"penalty","type":"numeric"},{"accessor":".metric","name":".metric","type":"character"},{"accessor":".estimator","name":".estimator","type":"character"},{"accessor":"mean","name":"mean","type":"numeric"},{"accessor":"n","name":"n","type":"numeric"},{"accessor":"std_err","name":"std_err","type":"numeric"},{"accessor":".config","name":".config","type":"character"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"e60bd4c2f0c506d828b03ba1649f46e1","key":"e60bd4c2f0c506d828b03ba1649f46e1"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>Here is the <code>ggplot</code> way should <a href="https://tune.tidymodels.org/reference/autoplot.tune_results.html"><code>tune::autoplot</code></a> fails</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>tune_res <span class="sc">%&gt;%</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  tune<span class="sc">::</span><span class="fu">collect_metrics</span>() <span class="sc">%&gt;%</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> .data[[<span class="st">&quot;penalty&quot;</span>]],</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> .data[[<span class="st">&quot;mean&quot;</span>]],</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> .data[[<span class="st">&quot;.metric&quot;</span>]]</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_errorbar</span>(</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymin =</span> .data[[<span class="st">&quot;mean&quot;</span>]] <span class="sc">-</span> .data[[<span class="st">&quot;std_err&quot;</span>]],</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymax =</span> .data[[<span class="st">&quot;mean&quot;</span>]] <span class="sc">+</span> .data[[<span class="st">&quot;std_err&quot;</span>]]</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">facet_wrap</span>(</span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">facets =</span> ggplot2<span class="sc">::</span><span class="fu">vars</span>(.data[[<span class="st">&quot;.metric&quot;</span>]]),</span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>,</span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">2</span></span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="figures/unnamed-chunk-36-1.png" width="3883.2" style="display: block; margin: auto;" /></p>
<p>Use <a href="https://tune.tidymodels.org/reference/show_best.html"><code>tune::show_best</code></a> to see the top few values for a given metric.</p>
<p>The “best” values can be selected using <a href="https://tune.tidymodels.org/reference/show_best.html"><code>tune::select_best</code></a>, this function requires you to specify a metric that it should select against. The penalty/lambda value is 569 for metric <code>rsq</code> since it gives the highest value. Do note that using a different seed will give a different best penalty/lambda value.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>top_penalty <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">show_best</span>(tune_res, <span class="at">metric =</span> <span class="st">&quot;rsq&quot;</span>, <span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>top_penalty</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; # A tibble: 5 x 7
&gt;   penalty .metric .estimator  mean     n std_err .config              
&gt;     &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;                
&gt; 1    569. rsq     standard   0.489    10  0.0558 Preprocessor1_Model39
&gt; 2    910. rsq     standard   0.489    10  0.0564 Preprocessor1_Model40
&gt; 3    356. rsq     standard   0.488    10  0.0550 Preprocessor1_Model38
&gt; 4   1456. rsq     standard   0.488    10  0.0569 Preprocessor1_Model41
&gt; 5   2330. rsq     standard   0.486    10  0.0572 Preprocessor1_Model42</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>best_penalty <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">select_best</span>(tune_res, <span class="at">metric =</span> <span class="st">&quot;rsq&quot;</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>best_penalty</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; # A tibble: 1 x 2
&gt;   penalty .config              
&gt;     &lt;dbl&gt; &lt;chr&gt;                
&gt; 1    569. Preprocessor1_Model39</code></pre>
</div>
<div id="ridge-regression-model-with-optimised-penaltylambda-value" class="section level2">
<h2>Ridge regression model with optimised penalty/lambda value</h2>
<p>We create the ridge regression workflow with the best penalty score using <a href="https://tune.tidymodels.org/reference/finalize_model.html"><code>tune::finalize_workflow</code></a>.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>ridge_final <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">finalize_workflow</span>(</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> ridge_workflow,</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">parameters =</span> best_penalty</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>ridge_final</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; == Workflow ==========================================================
&gt; Preprocessor: Recipe
&gt; Model: linear_reg()
&gt; 
&gt; -- Preprocessor ------------------------------------------------------
&gt; 4 Recipe Steps
&gt; 
&gt; * step_novel()
&gt; * step_dummy()
&gt; * step_zv()
&gt; * step_normalize()
&gt; 
&gt; -- Model -------------------------------------------------------------
&gt; Linear Regression Model Specification (regression)
&gt; 
&gt; Main Arguments:
&gt;   penalty = 568.98660290183
&gt;   mixture = 0
&gt; 
&gt; Computational engine: glmnet</code></pre>
<p>We now train the ridge regression model with the training data using <a href="https://parsnip.tidymodels.org/reference/fit.html"><code>parsnip::fit</code></a></p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>ridge_final_fit <span class="ot">&lt;-</span> parsnip<span class="sc">::</span><span class="fu">fit</span>(<span class="at">object =</span> ridge_final, <span class="at">data =</span> Hitters_train)</span></code></pre></div>
<p>We can see the coefficients using <a href="https://tune.tidymodels.org/reference/extract-tune.html"><code>tune::extract_fit_parsnip</code></a> and <a href="https://parsnip.tidymodels.org/reference/tidy.model_fit.html"><code>parsnip::tidy</code></a></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>ridge_final_fit <span class="sc">%&gt;%</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  tune<span class="sc">::</span><span class="fu">extract_fit_parsnip</span>() <span class="sc">%&gt;%</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-7b6030f1ae2ed403bb8d" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-7b6030f1ae2ed403bb8d">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"term":["(Intercept)","AtBat","Hits","HmRun","Runs","RBI","Walks","Years","CAtBat","CHits","CHmRun","CRuns","CRBI","CWalks","PutOuts","Assists","Errors","League_N","Division_W","NewLeague_N"],"estimate":[537.573168367347,18.9572547370078,34.1890995185971,7.29522053918317,23.8577455673031,21.004093706964,34.8754405233867,8.84750935887093,24.4103571527999,33.1269057978843,33.6386661437702,32.9541786641792,35.5966673811665,15.2157280518985,30.2624787532278,2.42564517786294,-2.95895197700093,4.68935152880114,-35.3763172824557,6.19721803024467],"penalty":[568.98660290183,568.98660290183,568.98660290183,568.98660290183,568.98660290183,568.98660290183,568.98660290183,568.98660290183,568.98660290183,568.98660290183,568.98660290183,568.98660290183,568.98660290183,568.98660290183,568.98660290183,568.98660290183,568.98660290183,568.98660290183,568.98660290183,568.98660290183]},"columns":[{"accessor":"term","name":"term","type":"character"},{"accessor":"estimate","name":"estimate","type":"numeric"},{"accessor":"penalty","name":"penalty","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"fbf3ef4cae4f91dc9fc64720cd8ba220","key":"fbf3ef4cae4f91dc9fc64720cd8ba220"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="variable-importance" class="section level2">
<h2>Variable Importance</h2>
<p>While we’re at it, let’s see what the most important variables are using the <code>vip</code> package and <a href="https://workflows.tidymodels.org/reference/extract-workflow.html"><code>workflows::extract_fit_parsnip</code></a>.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>vip_table <span class="ot">&lt;-</span> ridge_final_fit <span class="sc">%&gt;%</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  workflows<span class="sc">::</span><span class="fu">extract_fit_parsnip</span>() <span class="sc">%&gt;%</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  vip<span class="sc">::</span><span class="fu">vi</span>(<span class="at">lambda =</span> best_penalty<span class="sc">$</span>penalty)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>vip_table <span class="sc">%&gt;%</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-daad9029afb65a754910" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-daad9029afb65a754910">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Variable":["CRBI","Division_W","Walks","Hits","CHmRun","CHits","CRuns","PutOuts","CAtBat","Runs","RBI","AtBat","CWalks","Years","HmRun","NewLeague_N","League_N","Errors","Assists"],"Importance":[35.5966673811665,35.3763172824557,34.8754405233867,34.1890995185971,33.6386661437702,33.1269057978843,32.9541786641792,30.2624787532278,24.4103571527999,23.8577455673031,21.004093706964,18.9572547370078,15.2157280518985,8.84750935887093,7.29522053918317,6.19721803024467,4.68935152880114,2.95895197700093,2.42564517786294],"Sign":["POS","NEG","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","NEG","POS"]},"columns":[{"accessor":"Variable","name":"Variable","type":"character"},{"accessor":"Importance","name":"Importance","type":"numeric"},{"accessor":"Sign","name":"Sign","type":"character"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"d75fe5b6262f43613469e407445696cd","key":"d75fe5b6262f43613469e407445696cd"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>vip_table <span class="sc">%&gt;%</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Importance =</span> <span class="fu">abs</span>(.data[[<span class="st">&quot;Importance&quot;</span>]]),</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> forcats<span class="sc">::</span><span class="fu">fct_reorder</span>(</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">.f =</span> .data[[<span class="st">&quot;Variable&quot;</span>]],</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">.x =</span> .data[[<span class="st">&quot;Importance&quot;</span>]]</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> .data[[<span class="st">&quot;Importance&quot;</span>]],</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> .data[[<span class="st">&quot;Variable&quot;</span>]],</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> .data[[<span class="st">&quot;Sign&quot;</span>]]</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<p><img src="figures/unnamed-chunk-42-1.png" width="3883.2" style="display: block; margin: auto;" /></p>
</div>
<div id="ridge-regression-model-on-test-data" class="section level2">
<h2>Ridge regression model on test data</h2>
<p>This ridge regression model can now be applied on our testing data set to validate its performance. For regression models, a <code>.pred</code> column is added when <a href="https://parsnip.tidymodels.org/reference/augment.html"><code>parsnip::augment</code></a> is used.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>test_results <span class="ot">&lt;-</span> parsnip<span class="sc">::</span><span class="fu">augment</span>(<span class="at">x =</span> ridge_final_fit, <span class="at">new_data =</span> Hitters_test)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>test_results <span class="sc">%&gt;%</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-8de5d5750e263464fb9a" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-8de5d5750e263464fb9a">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"AtBat":[315,321,413,324,474,550,513,583,181,217,205,214,529,424,388,339,329,458,317,382,233,641,596,370,282,589,438,232,528,309,616,591,315,453,441,551,283,199,464,584,303,381,514,359,309,216,256,466,327,341,486,275,208,459,288,220,581,439,633,368,263,520,19,279,600,610,631],"Hits":[81,87,92,73,129,152,137,168,41,46,57,53,137,119,103,96,83,114,78,119,49,198,171,96,78,170,103,55,132,94,163,157,73,101,118,171,70,52,128,157,71,110,144,80,72,56,70,108,68,110,145,68,57,113,63,66,145,96,210,103,70,120,4,69,139,186,170],"HmRun":[7,10,16,4,10,6,20,17,1,7,8,2,26,6,15,4,9,13,7,13,2,31,34,21,13,40,2,9,21,5,27,16,5,3,28,13,8,9,28,20,3,9,0,15,0,4,13,33,13,9,11,5,8,20,3,5,17,0,6,3,1,17,1,4,0,19,9],"Runs":[24,39,72,32,50,92,90,83,15,32,34,30,86,57,59,37,50,67,35,54,41,101,91,49,37,107,65,34,61,37,83,90,23,46,84,94,33,26,67,95,18,61,67,45,33,22,42,75,42,45,51,42,32,59,25,20,66,44,91,48,26,53,2,35,94,107,77],"RBI":[38,42,48,18,56,37,95,80,21,19,32,29,97,46,47,29,39,57,35,58,23,108,108,46,51,108,32,23,74,32,107,78,37,43,86,83,37,28,94,73,30,45,54,48,31,18,36,86,29,49,76,42,25,57,33,28,68,36,56,28,23,44,3,31,29,98,44],"Walks":[39,30,65,22,40,81,90,56,33,9,9,23,97,13,39,23,56,48,32,36,18,41,52,60,29,69,71,45,41,26,32,26,16,61,68,94,27,21,52,63,36,32,79,63,26,15,44,72,45,46,40,61,18,68,16,13,21,65,59,54,30,21,1,32,60,74,31],"Years":[14,2,1,7,10,5,14,5,2,4,5,2,15,9,6,4,9,4,1,12,8,5,6,15,5,6,2,12,6,13,3,4,4,3,8,13,12,6,13,10,3,7,9,7,5,12,16,3,18,9,11,6,3,12,10,3,2,4,6,8,4,4,1,4,2,6,11],"CAtBat":[3449,396,413,1931,2331,2308,5201,1646,232,694,756,226,6661,3651,2174,1064,3828,1350,317,2133,1350,2129,2862,6986,1649,2325,440,4405,2641,4618,1437,2020,450,948,2723,6090,4479,805,5829,4704,344,3015,4739,1493,354,2796,7058,652,3949,2331,3967,961,653,5348,2682,290,831,711,3070,1897,888,927,19,1359,1236,2728,4908],"CHits":[835,101,92,491,604,633,1382,452,50,160,192,59,1785,1046,555,290,948,298,78,594,336,610,728,1972,453,634,103,1213,671,1330,377,541,108,218,750,1840,1222,191,1552,1320,76,834,1169,359,82,665,1845,142,939,658,1102,238,170,1369,667,80,210,148,872,493,220,227,4,355,309,753,1457],"CHmRun":[69,12,16,13,61,32,166,44,4,32,32,2,291,32,80,11,145,28,7,41,7,92,107,231,73,128,2,194,97,57,65,52,6,6,126,128,94,30,210,93,3,40,13,61,0,43,312,44,78,50,67,16,17,155,38,5,21,1,19,9,9,22,1,31,1,69,30],"CRuns":[321,48,72,291,246,349,763,219,20,86,117,32,1082,461,285,123,575,160,35,287,166,297,361,1070,211,371,67,702,273,616,181,310,38,96,433,969,557,113,740,724,20,451,583,176,41,266,965,102,438,249,410,128,98,713,315,27,106,68,420,207,83,106,2,180,201,399,775],"CRBI":[414,46,48,108,327,182,734,208,29,76,107,32,949,301,274,108,528,123,35,294,122,319,401,955,280,376,32,705,383,522,227,226,46,72,420,900,483,119,840,522,36,249,374,202,32,304,1128,109,380,322,497,104,54,660,259,31,86,56,230,162,82,80,3,148,69,366,357],"CWalks":[375,33,65,180,166,308,784,136,45,32,51,27,989,112,186,55,635,122,32,227,106,117,224,921,138,238,71,625,226,436,82,91,28,91,309,917,307,87,452,576,45,168,528,175,26,198,990,102,466,274,284,172,62,735,204,15,40,99,274,198,86,52,1,158,110,286,249],"League":["N","N","N","N","N","N","A","A","A","A","A","N","A","A","A","A","A","A","A","N","A","A","A","N","A","A","A","N","N","N","A","N","A","N","A","N","A","N","A","A","N","N","N","N","N","A","N","A","A","A","N","N","N","A","A","A","N","N","N","N","N","A","N","N","N","N","A"],"Division":["W","E","E","E","W","W","W","E","E","E","E","E","E","E","W","W","W","W","E","W","E","E","W","E","W","E","W","E","E","E","W","E","W","W","E","E","E","W","W","E","E","E","E","W","E","E","E","E","E","E","E","E","E","W","W","W","E","E","W","W","E","W","W","E","E","E","W"],"PutOuts":[632,805,280,222,732,262,267,109,326,307,58,109,280,224,182,104,276,246,45,59,102,269,118,137,670,368,276,623,885,161,110,290,227,249,190,1199,156,235,0,276,468,228,229,682,117,391,41,286,659,251,88,181,42,0,135,281,320,229,367,209,81,70,692,133,300,1182,408],"Assists":[43,40,9,3,83,329,5,292,29,25,4,7,10,286,9,213,6,389,122,156,132,17,334,5,57,20,7,35,105,3,308,440,15,444,2,149,2,22,0,421,47,7,453,93,269,44,118,8,53,9,204,3,94,0,257,21,465,406,432,246,147,144,70,173,12,96,4],"Errors":[10,4,5,3,13,16,3,25,5,1,4,3,5,8,4,9,2,18,26,9,10,10,21,9,5,3,9,3,8,3,15,25,3,16,2,5,2,5,0,11,6,5,15,13,12,4,8,8,7,4,16,2,13,0,7,3,32,22,16,3,4,11,8,9,9,13,3],"Salary":[475,91.5,100,708.333,750,625,900,612.5,67.5,180,247.5,70,933.333,850,325,275,600,475,70,595,375,1175,900,733.333,500,1237.5,100,1300,1008.333,600,200,640,110,195,1300,1800,225,265,587.5,420,100,800,1940,700,130,250,1050,215,400,560,500,191,140,740,341.667,90,155,150,90,326.667,250,185,920,277.5,160,1300,1000],"NewLeague":["N","N","N","N","N","N","A","A","A","A","A","N","A","N","A","A","A","A","A","N","A","A","A","N","A","A","N","N","N","N","A","N","A","N","A","N","A","N","A","A","N","N","N","N","N","A","A","A","A","A","A","N","N","A","A","A","N","N","N","N","N","A","A","N","N","N","A"],".pred":[502.348230840265,410.898232879066,471.792835663583,376.771051772521,550.622353913178,601.545337292235,894.409038155699,611.294652650369,232.642378641607,255.982408887601,259.340539293363,250.527702968649,1131.39197235418,538.040057729062,442.887312438972,259.143777349907,584.651295687981,419.460916725712,276.624168384832,462.433175561056,287.600044176272,736.425169341082,676.592242642479,929.4486083644,403.174734017526,820.089103689534,374.153009455836,707.764166167591,710.425217796921,591.730783271634,531.444148752241,620.064572118563,201.106424090948,383.174052042758,719.502212807095,1170.19828767641,542.146113137895,238.117363779318,797.423600740117,855.253981703107,328.372511901817,548.367045387545,748.073315526524,479.904435814541,293.334289496033,382.653386662541,867.800658950476,558.208963909969,605.466287564181,521.936899744398,658.50869786855,417.095174576725,266.098342187659,724.919528406761,310.952610319212,166.054398252659,491.829998954669,429.686889575251,672.782871093133,409.474663708078,304.492861074245,324.638577199522,67.5098190035784,370.189073529272,546.086184389891,911.964993862117,663.640577569905]},"columns":[{"accessor":"AtBat","name":"AtBat","type":"numeric"},{"accessor":"Hits","name":"Hits","type":"numeric"},{"accessor":"HmRun","name":"HmRun","type":"numeric"},{"accessor":"Runs","name":"Runs","type":"numeric"},{"accessor":"RBI","name":"RBI","type":"numeric"},{"accessor":"Walks","name":"Walks","type":"numeric"},{"accessor":"Years","name":"Years","type":"numeric"},{"accessor":"CAtBat","name":"CAtBat","type":"numeric"},{"accessor":"CHits","name":"CHits","type":"numeric"},{"accessor":"CHmRun","name":"CHmRun","type":"numeric"},{"accessor":"CRuns","name":"CRuns","type":"numeric"},{"accessor":"CRBI","name":"CRBI","type":"numeric"},{"accessor":"CWalks","name":"CWalks","type":"numeric"},{"accessor":"League","name":"League","type":"factor"},{"accessor":"Division","name":"Division","type":"factor"},{"accessor":"PutOuts","name":"PutOuts","type":"numeric"},{"accessor":"Assists","name":"Assists","type":"numeric"},{"accessor":"Errors","name":"Errors","type":"numeric"},{"accessor":"Salary","name":"Salary","type":"numeric"},{"accessor":"NewLeague","name":"NewLeague","type":"factor"},{"accessor":".pred","name":".pred","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"c74db9dac4a0c4b570eb32f6ea164c67","key":"c74db9dac4a0c4b570eb32f6ea164c67"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>We check how well the <code>.pred</code> column matches the Salary using <a href="https://yardstick.tidymodels.org/reference/rsq.html"><code>yardstick::rsq</code></a>.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>test_results <span class="sc">%&gt;%</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  yardstick<span class="sc">::</span><span class="fu">rsq</span>(<span class="at">truth =</span> .data[[<span class="st">&quot;Salary&quot;</span>]], <span class="at">estimate =</span> .data[[<span class="st">&quot;.pred&quot;</span>]]) <span class="sc">%&gt;%</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-34a58cca3c353347efb2" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-34a58cca3c353347efb2">{"x":{"tag":{"name":"Reactable","attribs":{"data":{".metric":["rsq"],".estimator":["standard"],".estimate":[0.487714810035057]},"columns":[{"accessor":".metric","name":".metric","type":"character"},{"accessor":".estimator","name":".estimator","type":"character"},{"accessor":".estimate","name":".estimate","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"ce106a638c59a3c30113f3197a0107ec","key":"ce106a638c59a3c30113f3197a0107ec"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>Alternatively, we can use <a href="https://tune.tidymodels.org/reference/last_fit.html"><code>tune::last_fit</code></a> and <a href="https://tune.tidymodels.org/reference/collect_predictions.html"><code>tune::collect_metrics</code></a>.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>test_rs <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">last_fit</span>(</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">object =</span> ridge_final_fit,</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">split =</span> Hitters_split</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>test_rs <span class="sc">%&gt;%</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  tune<span class="sc">::</span><span class="fu">collect_metrics</span>() <span class="sc">%&gt;%</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-710f4b56df4ee7a30c7c" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-710f4b56df4ee7a30c7c">{"x":{"tag":{"name":"Reactable","attribs":{"data":{".metric":["rmse","rsq"],".estimator":["standard","standard"],".estimate":[311.754563118934,0.487714810035057],".config":["Preprocessor1_Model1","Preprocessor1_Model1"]},"columns":[{"accessor":".metric","name":".metric","type":"character"},{"accessor":".estimator","name":".estimator","type":"character"},{"accessor":".estimate","name":".estimate","type":"numeric"},{"accessor":".config","name":".config","type":"character"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"9abf38a49a764e98954a783b855196ae","key":"9abf38a49a764e98954a783b855196ae"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>Use <a href="https://tune.tidymodels.org/reference/collect_predictions.html"><code>tune::collect_predictions</code></a>, to see only the actual and predicted values of the test data.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>test_rs <span class="sc">%&gt;%</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-ff0d28923f2003974d5e" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ff0d28923f2003974d5e">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"id":["train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split"],".pred":[502.348230840265,410.898232879066,471.792835663583,376.771051772521,550.622353913178,601.545337292235,894.409038155699,611.294652650369,232.642378641607,255.982408887601,259.340539293363,250.527702968649,1131.39197235418,538.040057729062,442.887312438972,259.143777349907,584.651295687981,419.460916725712,276.624168384832,462.433175561056,287.600044176272,736.425169341082,676.592242642479,929.4486083644,403.174734017526,820.089103689534,374.153009455836,707.764166167591,710.425217796921,591.730783271634,531.444148752241,620.064572118563,201.106424090948,383.174052042758,719.502212807095,1170.19828767641,542.146113137895,238.117363779318,797.423600740117,855.253981703107,328.372511901817,548.367045387545,748.073315526524,479.904435814541,293.334289496033,382.653386662541,867.800658950476,558.208963909969,605.466287564181,521.936899744398,658.50869786855,417.095174576725,266.098342187659,724.919528406761,310.952610319212,166.054398252659,491.829998954669,429.686889575251,672.782871093133,409.474663708078,304.492861074245,324.638577199522,67.5098190035784,370.189073529272,546.086184389891,911.964993862117,663.640577569905],".row":[1,4,18,23,24,25,26,28,32,33,36,39,56,57,59,60,64,68,71,73,78,80,86,91,96,106,108,111,113,123,124,130,132,134,138,140,152,154,157,159,169,178,183,184,192,195,196,197,198,199,203,211,214,216,218,221,224,227,230,235,236,240,241,250,252,253,263],"Salary":[475,91.5,100,708.333,750,625,900,612.5,67.5,180,247.5,70,933.333,850,325,275,600,475,70,595,375,1175,900,733.333,500,1237.5,100,1300,1008.333,600,200,640,110,195,1300,1800,225,265,587.5,420,100,800,1940,700,130,250,1050,215,400,560,500,191,140,740,341.667,90,155,150,90,326.667,250,185,920,277.5,160,1300,1000],".config":["Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1"]},"columns":[{"accessor":"id","name":"id","type":"character"},{"accessor":".pred","name":".pred","type":"numeric"},{"accessor":".row","name":".row","type":"numeric"},{"accessor":"Salary","name":"Salary","type":"numeric"},{"accessor":".config","name":".config","type":"character"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"b7daab2b7da8e76772bdbe014aaed9ee","key":"b7daab2b7da8e76772bdbe014aaed9ee"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>Let us take a closer look at the predicted and actual response as a scatter plot.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>test_rs <span class="sc">%&gt;%</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> .data[[<span class="st">&quot;Salary&quot;</span>]],</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> .data[[<span class="st">&quot;.pred&quot;</span>]]</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">&quot;midnightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">coord_fixed</span>()</span></code></pre></div>
<p><img src="figures/unnamed-chunk-47-1.png" width="3883.2" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="the-lasso" class="section level1">
<h1>The Lasso</h1>
<p>The following procedure will be very similar to what we saw in the ridge regression section. The resampling step is the same.</p>
<div id="create-the-resample-object-1" class="section level2">
<h2>Create the resample object</h2>
<p>First, we split the samples into a training set and a test set. From the training set, we create a 10-fold cross-validation data set from the training set.</p>
<p>This is done with <a href="https://rsample.tidymodels.org/reference/initial_split.html"><code>rsample::initial_split</code></a>, <a href="https://rsample.tidymodels.org/reference/initial_split.html"><code>rsample::training</code></a>, <a href="https://rsample.tidymodels.org/reference/initial_split.html"><code>rsample::testing</code></a> and <a href="https://rsample.tidymodels.org/reference/vfold_cv.html"><code>rsample::vfold_cv</code></a>.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>Hitters <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">as_tibble</span>(ISLR2<span class="sc">::</span>Hitters) <span class="sc">%&gt;%</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">drop_na</span>()</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>Hitters_split <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">initial_split</span>(Hitters, <span class="at">strata =</span> <span class="st">&quot;Salary&quot;</span>)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>Hitters_train <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">training</span>(Hitters_split)</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>Hitters_test <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">testing</span>(Hitters_split)</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>Hitters_fold <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">vfold_cv</span>(Hitters_train, <span class="at">v =</span> <span class="dv">10</span>)</span></code></pre></div>
</div>
<div id="create-the-preprocessor-1" class="section level2">
<h2>Create the preprocessor</h2>
<p>The following procedure will be very similar to what we saw in the ridge regression section. The preprocessing steps needed are the same using <a href="https://recipes.tidymodels.org/reference/recipe.html"><code>recipes::recipe</code></a>, <a href="https://recipes.tidymodels.org/reference/has_role.html"><code>recipes::all_nominal_predictors</code></a>, <a href="https://recipes.tidymodels.org/reference/has_role.html"><code>recipes::all_predictors()</code></a>, <a href="https://recipes.tidymodels.org/reference/step_novel.html"><code>recipes::step_novel</code></a>, <a href="https://recipes.tidymodels.org/reference/step_dummy.html"><code>recipes::step_dummy</code></a>, <a href="https://recipes.tidymodels.org/reference/step_zv.html"><code>recipes::step_zv</code></a> and <a href="https://recipes.tidymodels.org/reference/step_normalize.html"><code>recipes::step_normalize</code></a>.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>lasso_recipe <span class="ot">&lt;-</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">recipe</span>(<span class="at">formula =</span> Salary <span class="sc">~</span> ., <span class="at">data =</span> Hitters_train) <span class="sc">%&gt;%</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_novel</span>(recipes<span class="sc">::</span><span class="fu">all_nominal_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_dummy</span>(recipes<span class="sc">::</span><span class="fu">all_nominal_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_zv</span>(recipes<span class="sc">::</span><span class="fu">all_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_normalize</span>(recipes<span class="sc">::</span><span class="fu">all_predictors</span>())</span></code></pre></div>
</div>
<div id="specify-the-model-1" class="section level2">
<h2>Specify the model</h2>
<p>Again we set <code>penalty = tune::tune</code>. This tells <a href="https://tune.tidymodels.org/reference/tune_grid.html"><code>tune::tune_grid</code></a> that the penalty parameter should be tuned using <a href="https://hardhat.tidymodels.org/reference/tune.html"><code>tune::tune</code></a>.</p>
<p>This time, it is <code>mixture=1</code> in <a href="https://parsnip.tidymodels.org/reference/linear_reg.html"><code>parsnip::linear_reg</code></a></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>lasso_spec <span class="ot">&lt;-</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">linear_reg</span>(<span class="at">penalty =</span> tune<span class="sc">::</span><span class="fu">tune</span>(), <span class="at">mixture =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_mode</span>(<span class="st">&quot;regression&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">&quot;glmnet&quot;</span>)</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>lasso_spec <span class="sc">%&gt;%</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">translate</span>()</span></code></pre></div>
<pre><code>&gt; Linear Regression Model Specification (regression)
&gt; 
&gt; Main Arguments:
&gt;   penalty = tune()
&gt;   mixture = 1
&gt; 
&gt; Computational engine: glmnet 
&gt; 
&gt; Model fit template:
&gt; glmnet::glmnet(x = missing_arg(), y = missing_arg(), weights = missing_arg(), 
&gt;     alpha = 1, family = &quot;gaussian&quot;)</code></pre>
</div>
<div id="create-the-workflow-1" class="section level2">
<h2>Create the workflow</h2>
<p><a href="https://workflows.tidymodels.org/reference/workflow.html"><code>workflows::workflow</code></a>, <a href="https://workflows.tidymodels.org/reference/add_recipe.html"><code>workflows::add_recipe</code></a> and <a href="https://workflows.tidymodels.org/reference/add_model.html"><code>workflows::add_model</code></a> are used.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>lasso_workflow <span class="ot">&lt;-</span> workflows<span class="sc">::</span><span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  workflows<span class="sc">::</span><span class="fu">add_recipe</span>(lasso_recipe) <span class="sc">%&gt;%</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  workflows<span class="sc">::</span><span class="fu">add_model</span>(lasso_spec)</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>lasso_workflow</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; == Workflow ==========================================================
&gt; Preprocessor: Recipe
&gt; Model: linear_reg()
&gt; 
&gt; -- Preprocessor ------------------------------------------------------
&gt; 4 Recipe Steps
&gt; 
&gt; * step_novel()
&gt; * step_dummy()
&gt; * step_zv()
&gt; * step_normalize()
&gt; 
&gt; -- Model -------------------------------------------------------------
&gt; Linear Regression Model Specification (regression)
&gt; 
&gt; Main Arguments:
&gt;   penalty = tune::tune()
&gt;   mixture = 1
&gt; 
&gt; Computational engine: glmnet</code></pre>
</div>
<div id="create-the-penaltylambda-grid-1" class="section level2">
<h2>Create the penalty/lambda grid</h2>
<p>A penalty/lambda grid of <span class="math inline">\(50\)</span> numbers from <span class="math inline">\(0.01\)</span> (<span class="math inline">\(10^{-2}\)</span>) to <span class="math inline">\(100\)</span> (<span class="math inline">\(10^2\)</span>) is created.</p>
<p>Regular grid is created using <a href="https://dials.tidymodels.org/reference/grid_regular.html"><code>dials::grid_regular</code></a>, <a href="https://dials.tidymodels.org/reference/penalty.html"><code>dials::penalty</code></a> and <a href="https://scales.r-lib.org/reference/log_trans.html"><code>scales::log10_trans</code></a></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>penalty_grid <span class="ot">&lt;-</span> dials<span class="sc">::</span><span class="fu">grid_regular</span>(</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> dials<span class="sc">::</span><span class="fu">penalty</span>(</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">range =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>),</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">trans =</span> scales<span class="sc">::</span><span class="fu">log10_trans</span>()</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="dv">50</span></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>penalty_grid <span class="sc">%&gt;%</span></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-09770c4cdae9f2ea8e34" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-09770c4cdae9f2ea8e34">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"penalty":[0.01,0.0120679264063933,0.0145634847750124,0.0175751062485479,0.0212095088792019,0.0255954792269954,0.0308884359647748,0.0372759372031494,0.0449843266896944,0.0542867543932386,0.0655128556859551,0.079060432109077,0.0954095476349994,0.115139539932645,0.138949549437314,0.167683293681101,0.202358964772516,0.244205309454865,0.294705170255181,0.355648030622313,0.429193426012878,0.517947467923121,0.625055192527397,0.754312006335461,0.910298177991522,1.09854114198756,1.32571136559011,1.59985871960606,1.93069772888325,2.32995181051537,2.81176869797423,3.39322177189533,4.09491506238042,4.94171336132383,5.96362331659464,7.19685673001151,8.68511373751352,10.4811313415469,12.648552168553,15.2641796717523,18.4206996932671,22.2299648252619,26.8269579527972,32.3745754281764,39.0693993705461,47.1486636345739,56.8986602901829,68.66488450043,82.8642772854684,100]},"columns":[{"accessor":"penalty","name":"penalty","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"8bfb7efc2b2a01977b799ddfecc3b9ec","key":"8bfb7efc2b2a01977b799ddfecc3b9ec"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="lasso-model-fitting-on-cross-validated-data" class="section level2">
<h2>Lasso model fitting on cross validated data</h2>
<p>Now we have everything we need and we can fit all the models on the cross validated data with <a href="https://tune.tidymodels.org/reference/tune_grid.html"><code>tune::tune_grid</code></a>. Note that this process may take some time.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>doParallel<span class="sc">::</span><span class="fu">registerDoParallel</span>()</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>foreach<span class="sc">::</span><span class="fu">getDoParWorkers</span>()</span></code></pre></div>
<pre><code>&gt; [1] 3</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>tune_res <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">tune_grid</span>(</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">object =</span> lasso_workflow,</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">resamples =</span> Hitters_fold,</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">grid =</span> penalty_grid</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>tune_res</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; # Tuning results
&gt; # 10-fold cross-validation 
&gt; # A tibble: 10 x 4
&gt;    splits           id     .metrics           .notes          
&gt;    &lt;list&gt;           &lt;chr&gt;  &lt;list&gt;             &lt;list&gt;          
&gt;  1 &lt;split [176/20]&gt; Fold01 &lt;tibble [100 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  2 &lt;split [176/20]&gt; Fold02 &lt;tibble [100 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  3 &lt;split [176/20]&gt; Fold03 &lt;tibble [100 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  4 &lt;split [176/20]&gt; Fold04 &lt;tibble [100 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  5 &lt;split [176/20]&gt; Fold05 &lt;tibble [100 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  6 &lt;split [176/20]&gt; Fold06 &lt;tibble [100 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  7 &lt;split [177/19]&gt; Fold07 &lt;tibble [100 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  8 &lt;split [177/19]&gt; Fold08 &lt;tibble [100 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  9 &lt;split [177/19]&gt; Fold09 &lt;tibble [100 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt; 10 &lt;split [177/19]&gt; Fold10 &lt;tibble [100 x 5]&gt; &lt;tibble [0 x 3]&gt;</code></pre>
<p>Here we see that the amount of regularization affects the performance metrics differently using <a href="https://tune.tidymodels.org/reference/autoplot.tune_results.html"><code>tune::autoplot</code></a>. Do note that using a different seed will give a different plot</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that a different seed will give different plots</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>tune<span class="sc">::</span><span class="fu">autoplot</span>(tune_res)</span></code></pre></div>
<p><img src="figures/unnamed-chunk-55-1.png" width="3883.2" style="display: block; margin: auto;" /></p>
<p>We can also see the raw metrics that created this chart by calling <a href="https://tune.tidymodels.org/reference/collect_predictions.html"><code>tune::collect_metrics()</code></a>.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>tune<span class="sc">::</span><span class="fu">collect_metrics</span>(tune_res) <span class="sc">%&gt;%</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-6e6aa3da357ab07e0d8d" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-6e6aa3da357ab07e0d8d">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"penalty":[0.01,0.01,0.0120679264063933,0.0120679264063933,0.0145634847750124,0.0145634847750124,0.0175751062485479,0.0175751062485479,0.0212095088792019,0.0212095088792019,0.0255954792269954,0.0255954792269954,0.0308884359647748,0.0308884359647748,0.0372759372031494,0.0372759372031494,0.0449843266896944,0.0449843266896944,0.0542867543932386,0.0542867543932386,0.0655128556859551,0.0655128556859551,0.079060432109077,0.079060432109077,0.0954095476349994,0.0954095476349994,0.115139539932645,0.115139539932645,0.138949549437314,0.138949549437314,0.167683293681101,0.167683293681101,0.202358964772516,0.202358964772516,0.244205309454865,0.244205309454865,0.294705170255181,0.294705170255181,0.355648030622313,0.355648030622313,0.429193426012878,0.429193426012878,0.517947467923121,0.517947467923121,0.625055192527397,0.625055192527397,0.754312006335461,0.754312006335461,0.910298177991522,0.910298177991522,1.09854114198756,1.09854114198756,1.32571136559011,1.32571136559011,1.59985871960606,1.59985871960606,1.93069772888325,1.93069772888325,2.32995181051537,2.32995181051537,2.81176869797423,2.81176869797423,3.39322177189533,3.39322177189533,4.09491506238042,4.09491506238042,4.94171336132383,4.94171336132383,5.96362331659464,5.96362331659464,7.19685673001151,7.19685673001151,8.68511373751352,8.68511373751352,10.4811313415469,10.4811313415469,12.648552168553,12.648552168553,15.2641796717523,15.2641796717523,18.4206996932671,18.4206996932671,22.2299648252619,22.2299648252619,26.8269579527972,26.8269579527972,32.3745754281764,32.3745754281764,39.0693993705461,39.0693993705461,47.1486636345739,47.1486636345739,56.8986602901829,56.8986602901829,68.66488450043,68.66488450043,82.8642772854684,82.8642772854684,100,100],".metric":["rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq"],".estimator":["standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard"],"mean":[352.912438452656,0.434088503359711,352.912438452656,0.434088503359711,352.912438452656,0.434088503359711,352.912438452656,0.434088503359711,352.912438452656,0.434088503359711,352.912438452656,0.434088503359711,352.912438452656,0.434088503359711,352.912438452656,0.434088503359711,352.868962637827,0.434137430087858,352.799426209138,0.434218649320816,352.715618532113,0.434319066648511,352.618722338376,0.434435680655989,352.513289114707,0.434552198350541,352.401479404639,0.434666553337121,352.275742688755,0.434794813232089,352.143687877041,0.434920609945402,351.979483310065,0.43508953755991,351.819035199137,0.435238772023992,351.747514834188,0.435258187945783,351.582729035066,0.435609946693216,351.412313863061,0.435953006329445,351.201233996491,0.436368079093587,350.985681364623,0.436794621602386,350.712842673623,0.437418627444478,350.440859048934,0.438101527566587,350.240970284762,0.438762059971222,349.986486128784,0.439739937444608,349.733294993313,0.440827006233394,349.589158343607,0.441753894263852,349.248184574502,0.443346851471585,348.30407970463,0.446575424931007,347.253544018853,0.449940162460046,346.71893344709,0.452488362143266,346.712925360387,0.454559512212306,346.914251186033,0.456366999605236,346.778978985055,0.458008357055923,345.449449821114,0.462690063868837,343.065784392851,0.468866107864747,340.97300357519,0.473607149179875,339.65163688516,0.476429079904563,338.688062959372,0.478682779061053,338.511785597481,0.479364099526682,339.09355506506,0.478548452909738,340.375611084037,0.476811907169586,342.327863391534,0.474409306070985,345.109146335965,0.471108538167535,348.974233508327,0.46643646900435,354.368283282973,0.458748479475574,360.367439101646,0.451343059699564,367.452578097241,0.44478836292045],"n":[10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10],"std_err":[32.4105453004296,0.050384102094505,32.4105453004296,0.050384102094505,32.4105453004296,0.050384102094505,32.4105453004296,0.050384102094505,32.4105453004296,0.050384102094505,32.4105453004296,0.050384102094505,32.4105453004296,0.050384102094505,32.4105453004296,0.050384102094505,32.391554500456,0.0503705417712658,32.3643877544758,0.0503413312120746,32.3343007960794,0.0503084121751063,32.3078362914617,0.0502810889299532,32.2765467629081,0.0502435248909878,32.2383330656667,0.0502024681666691,32.1943857013154,0.0501580358065248,32.1469961431734,0.0501202963046556,32.0963401390195,0.0500833393342676,32.0424955429901,0.0500214501548207,32.0230742045902,0.04997326109903,32.0023700718471,0.0500515566441791,31.9841803796557,0.0501609263765434,31.9556436751794,0.0502999601075935,31.9177693254536,0.0504631016833151,31.8856905257693,0.0507255073601971,31.8595808561368,0.0510754330238275,31.9127289043529,0.0516633600566315,31.9838016642292,0.0523767213571651,32.0687924699731,0.0532051914986062,32.2355956506871,0.0541713354520514,32.4564661153688,0.0550173309832302,32.7133464988743,0.055329196587009,32.8750543836382,0.0555454146415092,33.2109223618848,0.0557989179911886,33.7919118714969,0.0560170187312302,34.2989140177036,0.0559129051780005,34.4654711271458,0.0553481332078744,34.592318459808,0.0554188992775882,34.7175208491847,0.0554186558204733,34.8158533818202,0.0558670031394637,34.7723538398625,0.0560583682317538,34.8627112960617,0.0561828908690587,34.9556287340465,0.0568580660329015,35.057192216441,0.0578301811042253,35.1620859850422,0.0591480210825597,35.2834092440256,0.0607559372960523,35.3843770654893,0.0626521560795519,35.366527232852,0.0647172154153091,35.3080085698977,0.0670618129426653,34.8867028201003,0.0690258793469475,34.4033161399529,0.0707200637978501],".config":["Preprocessor1_Model01","Preprocessor1_Model01","Preprocessor1_Model02","Preprocessor1_Model02","Preprocessor1_Model03","Preprocessor1_Model03","Preprocessor1_Model04","Preprocessor1_Model04","Preprocessor1_Model05","Preprocessor1_Model05","Preprocessor1_Model06","Preprocessor1_Model06","Preprocessor1_Model07","Preprocessor1_Model07","Preprocessor1_Model08","Preprocessor1_Model08","Preprocessor1_Model09","Preprocessor1_Model09","Preprocessor1_Model10","Preprocessor1_Model10","Preprocessor1_Model11","Preprocessor1_Model11","Preprocessor1_Model12","Preprocessor1_Model12","Preprocessor1_Model13","Preprocessor1_Model13","Preprocessor1_Model14","Preprocessor1_Model14","Preprocessor1_Model15","Preprocessor1_Model15","Preprocessor1_Model16","Preprocessor1_Model16","Preprocessor1_Model17","Preprocessor1_Model17","Preprocessor1_Model18","Preprocessor1_Model18","Preprocessor1_Model19","Preprocessor1_Model19","Preprocessor1_Model20","Preprocessor1_Model20","Preprocessor1_Model21","Preprocessor1_Model21","Preprocessor1_Model22","Preprocessor1_Model22","Preprocessor1_Model23","Preprocessor1_Model23","Preprocessor1_Model24","Preprocessor1_Model24","Preprocessor1_Model25","Preprocessor1_Model25","Preprocessor1_Model26","Preprocessor1_Model26","Preprocessor1_Model27","Preprocessor1_Model27","Preprocessor1_Model28","Preprocessor1_Model28","Preprocessor1_Model29","Preprocessor1_Model29","Preprocessor1_Model30","Preprocessor1_Model30","Preprocessor1_Model31","Preprocessor1_Model31","Preprocessor1_Model32","Preprocessor1_Model32","Preprocessor1_Model33","Preprocessor1_Model33","Preprocessor1_Model34","Preprocessor1_Model34","Preprocessor1_Model35","Preprocessor1_Model35","Preprocessor1_Model36","Preprocessor1_Model36","Preprocessor1_Model37","Preprocessor1_Model37","Preprocessor1_Model38","Preprocessor1_Model38","Preprocessor1_Model39","Preprocessor1_Model39","Preprocessor1_Model40","Preprocessor1_Model40","Preprocessor1_Model41","Preprocessor1_Model41","Preprocessor1_Model42","Preprocessor1_Model42","Preprocessor1_Model43","Preprocessor1_Model43","Preprocessor1_Model44","Preprocessor1_Model44","Preprocessor1_Model45","Preprocessor1_Model45","Preprocessor1_Model46","Preprocessor1_Model46","Preprocessor1_Model47","Preprocessor1_Model47","Preprocessor1_Model48","Preprocessor1_Model48","Preprocessor1_Model49","Preprocessor1_Model49","Preprocessor1_Model50","Preprocessor1_Model50"]},"columns":[{"accessor":"penalty","name":"penalty","type":"numeric"},{"accessor":".metric","name":".metric","type":"character"},{"accessor":".estimator","name":".estimator","type":"character"},{"accessor":"mean","name":"mean","type":"numeric"},{"accessor":"n","name":"n","type":"numeric"},{"accessor":"std_err","name":"std_err","type":"numeric"},{"accessor":".config","name":".config","type":"character"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"9e5b93b288b20f9a6cfd7681d29ffdeb","key":"9e5b93b288b20f9a6cfd7681d29ffdeb"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>Here is the <code>ggplot</code> way should <a href="https://tune.tidymodels.org/reference/autoplot.tune_results.html"><code>tune::autoplot</code></a> fails</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>tune_res <span class="sc">%&gt;%</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  tune<span class="sc">::</span><span class="fu">collect_metrics</span>() <span class="sc">%&gt;%</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> .data[[<span class="st">&quot;penalty&quot;</span>]],</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> .data[[<span class="st">&quot;mean&quot;</span>]],</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> .data[[<span class="st">&quot;.metric&quot;</span>]]</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_errorbar</span>(</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymin =</span> .data[[<span class="st">&quot;mean&quot;</span>]] <span class="sc">-</span> .data[[<span class="st">&quot;std_err&quot;</span>]],</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymax =</span> .data[[<span class="st">&quot;mean&quot;</span>]] <span class="sc">+</span> .data[[<span class="st">&quot;std_err&quot;</span>]]</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">facet_wrap</span>(</span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">facets =</span> ggplot2<span class="sc">::</span><span class="fu">vars</span>(.data[[<span class="st">&quot;.metric&quot;</span>]]),</span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>,</span>
<span id="cb90-19"><a href="#cb90-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">2</span></span>
<span id="cb90-20"><a href="#cb90-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb90-21"><a href="#cb90-21" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb90-22"><a href="#cb90-22" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="figures/unnamed-chunk-57-1.png" width="3883.2" style="display: block; margin: auto;" /></p>
<p>Use <a href="https://tune.tidymodels.org/reference/show_best.html"><code>tune::show_best</code></a> to see the top few values for a given metric.</p>
<p>The “best” values can be selected using <a href="https://tune.tidymodels.org/reference/show_best.html"><code>tune::select_best</code></a>, this function requires you to specify a metric that it should select against. The penalty/lambda value is 22.2 for metric <code>rsq</code> since it gives the highest value. Do note that using a different seed will give a different best penalty/lambda value.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>top_penalty <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">show_best</span>(tune_res, <span class="at">metric =</span> <span class="st">&quot;rsq&quot;</span>, <span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>top_penalty</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; # A tibble: 5 x 7
&gt;   penalty .metric .estimator  mean     n std_err .config              
&gt;     &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;                
&gt; 1    22.2 rsq     standard   0.479    10  0.0569 Preprocessor1_Model42
&gt; 2    18.4 rsq     standard   0.479    10  0.0562 Preprocessor1_Model41
&gt; 3    26.8 rsq     standard   0.479    10  0.0578 Preprocessor1_Model43
&gt; 4    32.4 rsq     standard   0.477    10  0.0591 Preprocessor1_Model44
&gt; 5    15.3 rsq     standard   0.476    10  0.0561 Preprocessor1_Model40</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>best_penalty <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">select_best</span>(tune_res, <span class="at">metric =</span> <span class="st">&quot;rsq&quot;</span>)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>best_penalty</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; # A tibble: 1 x 2
&gt;   penalty .config              
&gt;     &lt;dbl&gt; &lt;chr&gt;                
&gt; 1    22.2 Preprocessor1_Model42</code></pre>
</div>
<div id="lasso-model-with-optimised-penaltylambda-value" class="section level2">
<h2>Lasso model with optimised penalty/lambda value</h2>
<p>We create the lasso regression workflow with the best penalty score using <a href="https://tune.tidymodels.org/reference/finalize_model.html"><code>tune::finalize_workflow</code></a>.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>lasso_final <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">finalize_workflow</span>(</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> lasso_workflow,</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">parameters =</span> best_penalty</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>lasso_final</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; == Workflow ==========================================================
&gt; Preprocessor: Recipe
&gt; Model: linear_reg()
&gt; 
&gt; -- Preprocessor ------------------------------------------------------
&gt; 4 Recipe Steps
&gt; 
&gt; * step_novel()
&gt; * step_dummy()
&gt; * step_zv()
&gt; * step_normalize()
&gt; 
&gt; -- Model -------------------------------------------------------------
&gt; Linear Regression Model Specification (regression)
&gt; 
&gt; Main Arguments:
&gt;   penalty = 22.2299648252619
&gt;   mixture = 1
&gt; 
&gt; Computational engine: glmnet</code></pre>
<p>We now train the lasso regression model with the training data using <a href="https://parsnip.tidymodels.org/reference/fit.html"><code>parsnip::fit</code></a></p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>lasso_final_fit <span class="ot">&lt;-</span> parsnip<span class="sc">::</span><span class="fu">fit</span>(<span class="at">object =</span> lasso_final, <span class="at">data =</span> Hitters_train)</span></code></pre></div>
<p>We can see the coefficients using <a href="https://tune.tidymodels.org/reference/extract-tune.html"><code>tune::extract_fit_parsnip</code></a> and <a href="https://parsnip.tidymodels.org/reference/tidy.model_fit.html"><code>parsnip::tidy</code></a></p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>lasso_final_fit <span class="sc">%&gt;%</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  tune<span class="sc">::</span><span class="fu">extract_fit_parsnip</span>() <span class="sc">%&gt;%</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-3e11ffd5a78c135ebe4a" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-3e11ffd5a78c135ebe4a">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"term":["(Intercept)","AtBat","Hits","HmRun","Runs","RBI","Walks","Years","CAtBat","CHits","CHmRun","CRuns","CRBI","CWalks","PutOuts","Assists","Errors","League_N","Division_W","NewLeague_N"],"estimate":[537.573168367347,0,84.7448549343025,0,0,0,59.1977262875019,0,0,0.25854356444712,0.350597589729928,35.7532390826939,161.145536665532,0,39.4075686731142,0,0,0,-55.6176594062202,0],"penalty":[22.2299648252619,22.2299648252619,22.2299648252619,22.2299648252619,22.2299648252619,22.2299648252619,22.2299648252619,22.2299648252619,22.2299648252619,22.2299648252619,22.2299648252619,22.2299648252619,22.2299648252619,22.2299648252619,22.2299648252619,22.2299648252619,22.2299648252619,22.2299648252619,22.2299648252619,22.2299648252619]},"columns":[{"accessor":"term","name":"term","type":"character"},{"accessor":"estimate","name":"estimate","type":"numeric"},{"accessor":"penalty","name":"penalty","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"d7f6aa22de73b030df31372225d83684","key":"d7f6aa22de73b030df31372225d83684"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="variable-importance-1" class="section level2">
<h2>Variable Importance</h2>
<p>While we’re at it, let’s see what the most important variables are using the <code>vip</code> package and <a href="https://workflows.tidymodels.org/reference/extract-workflow.html"><code>workflows::extract_fit_parsnip</code></a>.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>vip_table <span class="ot">&lt;-</span> lasso_final_fit <span class="sc">%&gt;%</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>  workflows<span class="sc">::</span><span class="fu">extract_fit_parsnip</span>() <span class="sc">%&gt;%</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  vip<span class="sc">::</span><span class="fu">vi</span>(<span class="at">lambda =</span> best_penalty<span class="sc">$</span>penalty)</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>vip_table <span class="sc">%&gt;%</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-02b51eaa49a911994203" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-02b51eaa49a911994203">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Variable":["CRBI","Hits","Walks","Division_W","PutOuts","CRuns","CHmRun","CHits","AtBat","HmRun","Runs","RBI","Years","CAtBat","CWalks","Assists","Errors","League_N","NewLeague_N"],"Importance":[161.145536665532,84.7448549343025,59.1977262875019,55.6176594062202,39.4075686731142,35.7532390826939,0.350597589729928,0.25854356444712,0,0,0,0,0,0,0,0,0,0,0],"Sign":["POS","POS","POS","NEG","POS","POS","POS","POS","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG"]},"columns":[{"accessor":"Variable","name":"Variable","type":"character"},{"accessor":"Importance","name":"Importance","type":"numeric"},{"accessor":"Sign","name":"Sign","type":"character"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"2e8d52d95450e8e41317accfb7f5b6d7","key":"2e8d52d95450e8e41317accfb7f5b6d7"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>vip_table <span class="sc">%&gt;%</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Importance =</span> <span class="fu">abs</span>(.data[[<span class="st">&quot;Importance&quot;</span>]]),</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> forcats<span class="sc">::</span><span class="fu">fct_reorder</span>(</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">.f =</span> .data[[<span class="st">&quot;Variable&quot;</span>]],</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">.x =</span> .data[[<span class="st">&quot;Importance&quot;</span>]]</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(</span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> .data[[<span class="st">&quot;Importance&quot;</span>]],</span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> .data[[<span class="st">&quot;Variable&quot;</span>]],</span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> .data[[<span class="st">&quot;Sign&quot;</span>]]</span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<p><img src="figures/unnamed-chunk-63-1.png" width="3883.2" style="display: block; margin: auto;" /></p>
</div>
<div id="lasso-regression-model-on-test-data" class="section level2">
<h2>Lasso regression model on test data</h2>
<p>This lasso regression model can now be applied on our testing data set to validate its performance. For regression models, a .pred column is added when <a href="https://parsnip.tidymodels.org/reference/augment.html"><code>parsnip::augment</code></a> is used.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>test_results <span class="ot">&lt;-</span> parsnip<span class="sc">::</span><span class="fu">augment</span>(<span class="at">x =</span> lasso_final_fit, <span class="at">new_data =</span> Hitters_test)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>test_results <span class="sc">%&gt;%</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-de6e14b5218ef731ee34" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-de6e14b5218ef731ee34">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"AtBat":[315,321,413,324,474,550,513,583,181,217,205,214,529,424,388,339,329,458,317,382,233,641,596,370,282,589,438,232,528,309,616,591,315,453,441,551,283,199,464,584,303,381,514,359,309,216,256,466,327,341,486,275,208,459,288,220,581,439,633,368,263,520,19,279,600,610,631],"Hits":[81,87,92,73,129,152,137,168,41,46,57,53,137,119,103,96,83,114,78,119,49,198,171,96,78,170,103,55,132,94,163,157,73,101,118,171,70,52,128,157,71,110,144,80,72,56,70,108,68,110,145,68,57,113,63,66,145,96,210,103,70,120,4,69,139,186,170],"HmRun":[7,10,16,4,10,6,20,17,1,7,8,2,26,6,15,4,9,13,7,13,2,31,34,21,13,40,2,9,21,5,27,16,5,3,28,13,8,9,28,20,3,9,0,15,0,4,13,33,13,9,11,5,8,20,3,5,17,0,6,3,1,17,1,4,0,19,9],"Runs":[24,39,72,32,50,92,90,83,15,32,34,30,86,57,59,37,50,67,35,54,41,101,91,49,37,107,65,34,61,37,83,90,23,46,84,94,33,26,67,95,18,61,67,45,33,22,42,75,42,45,51,42,32,59,25,20,66,44,91,48,26,53,2,35,94,107,77],"RBI":[38,42,48,18,56,37,95,80,21,19,32,29,97,46,47,29,39,57,35,58,23,108,108,46,51,108,32,23,74,32,107,78,37,43,86,83,37,28,94,73,30,45,54,48,31,18,36,86,29,49,76,42,25,57,33,28,68,36,56,28,23,44,3,31,29,98,44],"Walks":[39,30,65,22,40,81,90,56,33,9,9,23,97,13,39,23,56,48,32,36,18,41,52,60,29,69,71,45,41,26,32,26,16,61,68,94,27,21,52,63,36,32,79,63,26,15,44,72,45,46,40,61,18,68,16,13,21,65,59,54,30,21,1,32,60,74,31],"Years":[14,2,1,7,10,5,14,5,2,4,5,2,15,9,6,4,9,4,1,12,8,5,6,15,5,6,2,12,6,13,3,4,4,3,8,13,12,6,13,10,3,7,9,7,5,12,16,3,18,9,11,6,3,12,10,3,2,4,6,8,4,4,1,4,2,6,11],"CAtBat":[3449,396,413,1931,2331,2308,5201,1646,232,694,756,226,6661,3651,2174,1064,3828,1350,317,2133,1350,2129,2862,6986,1649,2325,440,4405,2641,4618,1437,2020,450,948,2723,6090,4479,805,5829,4704,344,3015,4739,1493,354,2796,7058,652,3949,2331,3967,961,653,5348,2682,290,831,711,3070,1897,888,927,19,1359,1236,2728,4908],"CHits":[835,101,92,491,604,633,1382,452,50,160,192,59,1785,1046,555,290,948,298,78,594,336,610,728,1972,453,634,103,1213,671,1330,377,541,108,218,750,1840,1222,191,1552,1320,76,834,1169,359,82,665,1845,142,939,658,1102,238,170,1369,667,80,210,148,872,493,220,227,4,355,309,753,1457],"CHmRun":[69,12,16,13,61,32,166,44,4,32,32,2,291,32,80,11,145,28,7,41,7,92,107,231,73,128,2,194,97,57,65,52,6,6,126,128,94,30,210,93,3,40,13,61,0,43,312,44,78,50,67,16,17,155,38,5,21,1,19,9,9,22,1,31,1,69,30],"CRuns":[321,48,72,291,246,349,763,219,20,86,117,32,1082,461,285,123,575,160,35,287,166,297,361,1070,211,371,67,702,273,616,181,310,38,96,433,969,557,113,740,724,20,451,583,176,41,266,965,102,438,249,410,128,98,713,315,27,106,68,420,207,83,106,2,180,201,399,775],"CRBI":[414,46,48,108,327,182,734,208,29,76,107,32,949,301,274,108,528,123,35,294,122,319,401,955,280,376,32,705,383,522,227,226,46,72,420,900,483,119,840,522,36,249,374,202,32,304,1128,109,380,322,497,104,54,660,259,31,86,56,230,162,82,80,3,148,69,366,357],"CWalks":[375,33,65,180,166,308,784,136,45,32,51,27,989,112,186,55,635,122,32,227,106,117,224,921,138,238,71,625,226,436,82,91,28,91,309,917,307,87,452,576,45,168,528,175,26,198,990,102,466,274,284,172,62,735,204,15,40,99,274,198,86,52,1,158,110,286,249],"League":["N","N","N","N","N","N","A","A","A","A","A","N","A","A","A","A","A","A","A","N","A","A","A","N","A","A","A","N","N","N","A","N","A","N","A","N","A","N","A","A","N","N","N","N","N","A","N","A","A","A","N","N","N","A","A","A","N","N","N","N","N","A","N","N","N","N","A"],"Division":["W","E","E","E","W","W","W","E","E","E","E","E","E","E","W","W","W","W","E","W","E","E","W","E","W","E","W","E","E","E","W","E","W","W","E","E","E","W","W","E","E","E","E","W","E","E","E","E","E","E","E","E","E","W","W","W","E","E","W","W","E","W","W","E","E","E","W"],"PutOuts":[632,805,280,222,732,262,267,109,326,307,58,109,280,224,182,104,276,246,45,59,102,269,118,137,670,368,276,623,885,161,110,290,227,249,190,1199,156,235,0,276,468,228,229,682,117,391,41,286,659,251,88,181,42,0,135,281,320,229,367,209,81,70,692,133,300,1182,408],"Assists":[43,40,9,3,83,329,5,292,29,25,4,7,10,286,9,213,6,389,122,156,132,17,334,5,57,20,7,35,105,3,308,440,15,444,2,149,2,22,0,421,47,7,453,93,269,44,118,8,53,9,204,3,94,0,257,21,465,406,432,246,147,144,70,173,12,96,4],"Errors":[10,4,5,3,13,16,3,25,5,1,4,3,5,8,4,9,2,18,26,9,10,10,21,9,5,3,9,3,8,3,15,25,3,16,2,5,2,5,0,11,6,5,15,13,12,4,8,8,7,4,16,2,13,0,7,3,32,22,16,3,4,11,8,9,9,13,3],"Salary":[475,91.5,100,708.333,750,625,900,612.5,67.5,180,247.5,70,933.333,850,325,275,600,475,70,595,375,1175,900,733.333,500,1237.5,100,1300,1008.333,600,200,640,110,195,1300,1800,225,265,587.5,420,100,800,1940,700,130,250,1050,215,400,560,500,191,140,740,341.667,90,155,150,90,326.667,250,185,920,277.5,160,1300,1000],"NewLeague":["N","N","N","N","N","N","A","A","A","A","A","N","A","N","A","A","A","A","A","N","A","A","A","N","A","A","N","N","N","N","A","N","A","N","A","N","A","N","A","A","N","N","N","N","N","A","A","A","A","A","A","N","N","A","A","A","N","N","N","N","N","A","A","N","N","N","A"],".pred":[505.735436455634,424.806406804163,462.263002218335,351.529768367383,562.139307651773,595.585148171933,897.444735198205,645.750671429403,271.433454586433,241.031790939991,245.201313030071,239.047970890368,1165.08973625586,521.099477193172,415.06579225935,251.849490011889,587.98659253611,384.531267463433,303.179201119029,429.112815351359,273.30743780959,742.513432025125,636.092258782015,968.959701877345,403.055671037543,816.124222191034,378.983177226664,761.724591646792,732.305060308636,622.580213086775,464.007327991439,585.296657946803,168.64318088909,365.936059578401,719.917027215365,1310.02780158121,555.826001119811,186.960138103142,787.380964815479,868.306688418109,357.998080369978,531.756570001901,797.153700288878,461.670228249582,284.533067371824,414.027379648073,934.727868916743,544.055826109946,609.490957863572,587.191750894501,712.627285086805,425.508381231369,240.785707034479,715.654933663278,266.982616163912,146.55552624328,466.020096280508,466.025004339118,686.682324654249,398.903203148935,314.965901074557,271.179989722521,38.9795790722504,367.032722170712,561.461556199988,968.810923009924,637.735281063423]},"columns":[{"accessor":"AtBat","name":"AtBat","type":"numeric"},{"accessor":"Hits","name":"Hits","type":"numeric"},{"accessor":"HmRun","name":"HmRun","type":"numeric"},{"accessor":"Runs","name":"Runs","type":"numeric"},{"accessor":"RBI","name":"RBI","type":"numeric"},{"accessor":"Walks","name":"Walks","type":"numeric"},{"accessor":"Years","name":"Years","type":"numeric"},{"accessor":"CAtBat","name":"CAtBat","type":"numeric"},{"accessor":"CHits","name":"CHits","type":"numeric"},{"accessor":"CHmRun","name":"CHmRun","type":"numeric"},{"accessor":"CRuns","name":"CRuns","type":"numeric"},{"accessor":"CRBI","name":"CRBI","type":"numeric"},{"accessor":"CWalks","name":"CWalks","type":"numeric"},{"accessor":"League","name":"League","type":"factor"},{"accessor":"Division","name":"Division","type":"factor"},{"accessor":"PutOuts","name":"PutOuts","type":"numeric"},{"accessor":"Assists","name":"Assists","type":"numeric"},{"accessor":"Errors","name":"Errors","type":"numeric"},{"accessor":"Salary","name":"Salary","type":"numeric"},{"accessor":"NewLeague","name":"NewLeague","type":"factor"},{"accessor":".pred","name":".pred","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"f653f49d6af2f6933b04294ea0e12c7f","key":"f653f49d6af2f6933b04294ea0e12c7f"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>We check how well the <code>.pred</code> column matches the Salary using <a href="https://yardstick.tidymodels.org/reference/rsq.html"><code>yardstick::rsq</code></a>.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>test_results <span class="sc">%&gt;%</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>  yardstick<span class="sc">::</span><span class="fu">rsq</span>(<span class="at">truth =</span> .data[[<span class="st">&quot;Salary&quot;</span>]], <span class="at">estimate =</span> .data[[<span class="st">&quot;.pred&quot;</span>]]) <span class="sc">%&gt;%</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-a5e7db6812975dd65aa7" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-a5e7db6812975dd65aa7">{"x":{"tag":{"name":"Reactable","attribs":{"data":{".metric":["rsq"],".estimator":["standard"],".estimate":[0.490544949390221]},"columns":[{"accessor":".metric","name":".metric","type":"character"},{"accessor":".estimator","name":".estimator","type":"character"},{"accessor":".estimate","name":".estimate","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"1329fdb9c03bfbfe085093d49c8b25b6","key":"1329fdb9c03bfbfe085093d49c8b25b6"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>Alternatively, we can use <a href="https://tune.tidymodels.org/reference/last_fit.html"><code>tune::last_fit</code></a> and <a href="https://tune.tidymodels.org/reference/collect_predictions.html"><code>tune::collect_metrics</code></a>.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>test_rs <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">last_fit</span>(</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">object =</span> lasso_final_fit,</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">split =</span> Hitters_split</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>test_rs <span class="sc">%&gt;%</span></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>  tune<span class="sc">::</span><span class="fu">collect_metrics</span>() <span class="sc">%&gt;%</span></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-5d7e4b42aeb01e22d3fb" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-5d7e4b42aeb01e22d3fb">{"x":{"tag":{"name":"Reactable","attribs":{"data":{".metric":["rmse","rsq"],".estimator":["standard","standard"],".estimate":[307.338143256555,0.490544949390221],".config":["Preprocessor1_Model1","Preprocessor1_Model1"]},"columns":[{"accessor":".metric","name":".metric","type":"character"},{"accessor":".estimator","name":".estimator","type":"character"},{"accessor":".estimate","name":".estimate","type":"numeric"},{"accessor":".config","name":".config","type":"character"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"89fb6b59a10c02e65c6ba446435adfd1","key":"89fb6b59a10c02e65c6ba446435adfd1"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>Use <a href="https://tune.tidymodels.org/reference/collect_predictions.html"><code>tune::collect_predictions</code></a>, to see only the actual and predicted values of the test data.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>test_rs <span class="sc">%&gt;%</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-ea3366438ccf5e300a94" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ea3366438ccf5e300a94">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"id":["train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split"],".pred":[505.735436455634,424.806406804163,462.263002218335,351.529768367383,562.139307651773,595.585148171933,897.444735198205,645.750671429403,271.433454586433,241.031790939991,245.201313030071,239.047970890368,1165.08973625586,521.099477193172,415.06579225935,251.849490011889,587.98659253611,384.531267463433,303.179201119029,429.112815351359,273.30743780959,742.513432025125,636.092258782015,968.959701877345,403.055671037543,816.124222191034,378.983177226664,761.724591646792,732.305060308636,622.580213086775,464.007327991439,585.296657946803,168.64318088909,365.936059578401,719.917027215365,1310.02780158121,555.826001119811,186.960138103142,787.380964815479,868.306688418109,357.998080369978,531.756570001901,797.153700288878,461.670228249582,284.533067371824,414.027379648073,934.727868916743,544.055826109946,609.490957863572,587.191750894501,712.627285086805,425.508381231369,240.785707034479,715.654933663278,266.982616163912,146.55552624328,466.020096280508,466.025004339118,686.682324654249,398.903203148935,314.965901074557,271.179989722521,38.9795790722504,367.032722170712,561.461556199988,968.810923009924,637.735281063423],".row":[1,4,18,23,24,25,26,28,32,33,36,39,56,57,59,60,64,68,71,73,78,80,86,91,96,106,108,111,113,123,124,130,132,134,138,140,152,154,157,159,169,178,183,184,192,195,196,197,198,199,203,211,214,216,218,221,224,227,230,235,236,240,241,250,252,253,263],"Salary":[475,91.5,100,708.333,750,625,900,612.5,67.5,180,247.5,70,933.333,850,325,275,600,475,70,595,375,1175,900,733.333,500,1237.5,100,1300,1008.333,600,200,640,110,195,1300,1800,225,265,587.5,420,100,800,1940,700,130,250,1050,215,400,560,500,191,140,740,341.667,90,155,150,90,326.667,250,185,920,277.5,160,1300,1000],".config":["Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1"]},"columns":[{"accessor":"id","name":"id","type":"character"},{"accessor":".pred","name":".pred","type":"numeric"},{"accessor":".row","name":".row","type":"numeric"},{"accessor":"Salary","name":"Salary","type":"numeric"},{"accessor":".config","name":".config","type":"character"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"8cef011c7767ffde39167b0b71d886ae","key":"8cef011c7767ffde39167b0b71d886ae"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>Let us take a closer look at the predicted and actual response as a scatter plot.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>test_rs <span class="sc">%&gt;%</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> .data[[<span class="st">&quot;Salary&quot;</span>]],</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> .data[[<span class="st">&quot;.pred&quot;</span>]]</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">&quot;midnightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">coord_fixed</span>()</span></code></pre></div>
<p><img src="figures/unnamed-chunk-68-1.png" width="3883.2" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="principal-components-regression" class="section level1">
<h1>Principal Components Regression</h1>
<p>The principal component regression is a linear model with pca transformed data. Hence, the major changes will be on the preprocessing steps.</p>
<div id="create-the-resample-object-2" class="section level2">
<h2>Create the resample object</h2>
<p>First, we split the samples into a training set and a test set. From the training set, we create a 10-fold cross-validation data set from the training set.</p>
<p>This is done with <a href="https://rsample.tidymodels.org/reference/initial_split.html"><code>rsample::initial_split</code></a>, <a href="https://rsample.tidymodels.org/reference/initial_split.html"><code>rsample::training</code></a>, <a href="https://rsample.tidymodels.org/reference/initial_split.html"><code>rsample::testing</code></a> and <a href="https://rsample.tidymodels.org/reference/vfold_cv.html"><code>rsample::vfold_cv</code></a>.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>Hitters <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">as_tibble</span>(ISLR2<span class="sc">::</span>Hitters) <span class="sc">%&gt;%</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">drop_na</span>()</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>Hitters_split <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">initial_split</span>(Hitters, <span class="at">strata =</span> <span class="st">&quot;Salary&quot;</span>)</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>Hitters_train <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">training</span>(Hitters_split)</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>Hitters_test <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">testing</span>(Hitters_split)</span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>Hitters_fold <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">vfold_cv</span>(Hitters_train, <span class="at">v =</span> <span class="dv">10</span>)</span></code></pre></div>
</div>
<div id="create-the-preprocessor-2" class="section level2">
<h2>Create the preprocessor</h2>
<p>We create a recipe with <a href="https://recipes.tidymodels.org/reference/recipe.html"><code>recipes::recipe</code></a>, <a href="https://recipes.tidymodels.org/reference/has_role.html"><code>recipes::all_nominal_predictors</code></a>, <a href="https://recipes.tidymodels.org/reference/has_role.html"><code>recipes::all_predictors()</code></a>, <a href="https://recipes.tidymodels.org/reference/step_novel.html"><code>recipes::step_novel</code></a>, <a href="https://recipes.tidymodels.org/reference/step_dummy.html"><code>recipes::step_dummy</code></a>, <a href="https://recipes.tidymodels.org/reference/step_zv.html"><code>recipes::step_zv</code></a> and <a href="https://recipes.tidymodels.org/reference/step_normalize.html"><code>recipes::step_normalize</code></a>.</p>
<p>We add <a href="https://recipes.tidymodels.org/reference/step_pca.html"><code>recipes::step_pca</code></a> this time to perform principal component analysis on all the predictors.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>pca_recipe <span class="ot">&lt;-</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">recipe</span>(<span class="at">formula =</span> Salary <span class="sc">~</span> ., <span class="at">data =</span> Hitters_train) <span class="sc">%&gt;%</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_novel</span>(recipes<span class="sc">::</span><span class="fu">all_nominal_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_dummy</span>(recipes<span class="sc">::</span><span class="fu">all_nominal_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_zv</span>(recipes<span class="sc">::</span><span class="fu">all_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_normalize</span>(recipes<span class="sc">::</span><span class="fu">all_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_pca</span>(recipes<span class="sc">::</span><span class="fu">all_predictors</span>(), <span class="at">id =</span> <span class="st">&quot;pca&quot;</span>)</span></code></pre></div>
<p>Apply <a href="https://recipes.tidymodels.org/reference/prep.html"><code>recipes::prep</code></a> and <a href="https://recipes.tidymodels.org/reference/bake.html"><code>recipes::bake</code></a> to compute the preprocessing step.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>rec <span class="ot">&lt;-</span> recipes<span class="sc">::</span><span class="fu">prep</span>(<span class="at">x =</span> pca_recipe, <span class="at">training =</span> Hitters_train)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>rec <span class="sc">%&gt;%</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>() <span class="sc">%&gt;%</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-e37d4e5cddd1c6c16435" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-e37d4e5cddd1c6c16435">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"variable":["Salary","PC1","PC2","PC3","PC4","PC5"],"type":["numeric","numeric","numeric","numeric","numeric","numeric"],"role":["outcome","predictor","predictor","predictor","predictor","predictor"],"source":["original","derived","derived","derived","derived","derived"]},"columns":[{"accessor":"variable","name":"variable","type":"character"},{"accessor":"type","name":"type","type":"character"},{"accessor":"role","name":"role","type":"character"},{"accessor":"source","name":"source","type":"character"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"ad0e10d70602e1245de8fc00e635526b","key":"ad0e10d70602e1245de8fc00e635526b"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>rec <span class="sc">%&gt;%</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">bake</span>(<span class="at">new_data =</span> Hitters_train) <span class="sc">%&gt;%</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-12ced968260f6b9714ea" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-12ced968260f6b9714ea">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Salary":[70,100,75,175,135,115,110,90,90,75,105,110,145,70,155,87.5,175,90,165,95,110,100,80,75,155,86.5,125,75,145,75,90,150,68,175,137,120,140,175,172,190,70,190,97.5,140,100,135,105,160,120,165,240,300,305,215,415,340,416.667,275,230,225,320,210,260,300,385,215,362.5,200,400,400,297.5,325,250,275,365,277.5,250,300,300,365,202.5,210,240,350,200,300,425,250,400,250,200,350,341.667,350,425,286.667,245,235,425,385,480,500,750,517.143,512.5,550,700,600,675,535,450,431.5,490,750,700,535,737.5,600,662.5,750,430,657,450,630,737.5,625,725,525,575,700,550,650,670,750,450,750,580,450,487.5,450,750,740,475,530,740,500,750,525,550,700,1100,775,776.667,765,850,815,875,1200,1350,950,850,1975,1900,1041.667,1220,1861.46,2460,1500,1925.571,950,773.333,775,850,2412.5,825,1000,1310,1043.333,1183.333,787.5,800,780,2127.333,875,1260,1670,875,1000,1450,940,925,1150,900,1600,875,960],"PC1":[-3.94936291570364,-3.44832316474186,-3.39773617327447,-3.56555435184881,-3.25975339545356,-2.16918288810179,-2.53967377437542,-3.50431227054158,-1.71178707085248,-3.3041551224216,-0.660520240431698,-2.1303935011809,-0.426322968005356,-3.75567881768636,-1.60059811513426,-2.5453820533035,-3.16663560854435,-3.68518705873106,0.278037649931169,-3.65636570063591,-3.070367855849,-0.510383335455067,-2.22971507343869,-3.96767014941176,-2.26063723609541,-3.68131052535488,-2.53632258471978,-3.57009464175496,-1.91491229440418,-3.60628715532925,-3.31961464691246,-2.45477486711452,-3.83405332878633,-0.329037442808071,-2.86962471304846,-2.76843367379213,-2.97717721732576,-2.001181174702,-0.544247245979557,-2.43118854351683,-3.30682839580285,-4.19218365429862,-2.25168061143223,-1.84941974325833,0.612191910497019,-1.69887371984232,-2.0977212749581,-1.48032920431843,-2.09704157496286,-0.0366022227781362,-1.09987803722011,-2.61597755225221,-2.49842815325986,-1.89317980778684,-1.45141017813548,-2.30084386488829,-0.843765688785429,1.17091827838351,-3.24579158692874,-3.26982909816822,2.70100623347741,-2.00047284967781,1.86028341666333,-0.547499964217356,-1.14049126748275,0.551117161187305,-1.64505684984415,5.64374215904005,-0.300824988221808,-1.24362072845684,-2.30894722157569,2.96686773564834,1.04127316884758,-1.28105373566639,0.849754050506571,0.950347777873304,-0.387986542525131,-1.51337385763403,-0.348231542941208,1.13679885733523,-1.62581971443815,-0.919258183492396,-2.39820050660983,-1.3108224398167,-0.411375886057845,-1.46802110111738,-0.645970831995506,-2.53814610510526,0.258613109946897,-2.51587000830609,-0.472332528387543,-1.10359347840897,-1.29035509543258,-0.170972539520479,-2.24013658394143,-3.12397531196264,-2.44152623160375,-0.336103870588938,-0.702606206867681,-1.17196002302799,0.34354950111349,3.25292393708575,0.902619104865593,3.01056840903855,-2.19011846743034,-0.966935829507016,-2.30384221469219,0.00774918197105767,2.28397823881559,7.63665780372707,2.44800450982032,-1.76015895199382,-0.558793570441652,3.38473003518987,3.40358143384408,0.0961067165015936,0.989032224454881,0.119547807435154,0.293232449327394,-0.482378980980667,0.862103657388996,0.629841558206341,-1.11636186960489,-0.0129299268578161,-0.433464612690883,0.682501971102112,0.629356678396783,1.75351070950154,0.0281972360646473,1.61353668268418,-0.350365363140566,-1.04265016599878,-0.963547415639888,-0.0443366244013654,1.59245890175069,7.37165619738004,-0.427040163826823,0.351620489418153,8.69480009059291,-0.435725014813603,0.1954806037586,1.0989523332591,-0.657893009425072,1.57098775568206,0.656770924447626,3.3461063718112,0.473527699503533,-1.16306113800209,-1.40586021956363,-0.406817912736086,3.66373357618881,5.35693325833659,5.70655144455936,0.672706799346065,2.55423822851225,0.820211809187725,4.00399862607991,2.27800558303805,2.48643613868345,6.55401209401128,3.91650081486463,2.70799742617248,4.51252983973848,5.68256133469429,0.845378915995726,6.63233142597011,4.90726174621174,4.87383385725944,5.02843037040728,2.04083577876588,4.43870547661726,0.382584767947741,0.46934205611466,6.69646771360241,1.97477914718499,3.50270204992272,2.29861336655702,1.24806432693602,1.58184678726942,2.19758292209239,1.89106743229861,0.00583069845348599,-4.93188760198835,-1.14298226092579,1.15098380908497,3.84408402460366,-0.635935748922225,4.08548016765223,5.83757608865087,1.38812159401384,0.519132048507543,0.301038367056004,-1.00540450244071,1.87057676143256,3.07582285685666,1.8773067724381],"PC2":[-1.51200203199781,-0.672957102563078,-0.373692088450115,-1.28335496634881,-2.49865934710503,0.93499887782411,0.0253259868157111,-1.0775743335684,1.83365509295716,-1.10784928521407,3.00675401005554,0.491768380229364,2.95182537967722,-0.956645040432106,2.04709110052658,0.801898807702,-2.46449276639182,-2.00226107922522,4.14404472760468,-1.4460345895536,-0.56516062578227,-1.66912821859511,0.275438873565777,-1.90908498460705,0.204748763976033,-1.36542177933592,0.282341834193718,-0.651019259723575,0.347995984270232,-1.24457937114091,-1.06478252828243,0.514865890209259,-1.26507144020916,2.82154692663408,-0.563798774123037,-0.440155422376464,-0.856768217323612,1.82462672050267,3.34839926443398,-1.10434615932665,-0.081765821835995,-2.38801140874944,0.956296996813495,2.18622501881092,2.67159466671216,1.61507745257586,1.38959068134271,1.47985450133908,1.39812110290337,4.55029061797031,-2.67122267038324,-1.49490849126383,-1.00170941347509,0.775137318479234,0.379604526372863,-1.66330076008223,-2.09915249595284,-4.70532481769968,-1.195239924377,-1.67477048566202,-3.85811398544706,-0.302850933777503,-4.19577023260381,2.14814465265767,-0.144350367352547,3.94866405624002,-0.63025549806051,-4.09772638086963,2.13497031349559,-0.127613257243003,-0.925158806339554,-4.39440725713396,4.17981061147948,-2.67226316585195,-2.48026842687973,1.53795829597496,-2.31325004619761,0.282343571244768,1.15370102422615,4.31810269122777,1.21332156891821,2.1183785552048,-1.33651446534361,0.171949560286957,2.86026999571171,-0.0104290103644072,-0.113299185150907,-0.958153396326369,-2.9655929080727,0.00252982903180458,3.14389024798703,1.57457540774617,-1.28958359909705,3.49664376658425,-1.45037422393027,-2.21273299135318,-1.35000821176573,-3.38083115961096,1.57096068077396,0.764765828497068,2.52900856091849,-0.717525310743568,1.42254830857069,2.36240779515753,-1.92935338280352,0.426917368035494,-1.59687155741238,0.931844104257475,-1.38490109476647,-0.638260201979618,-3.41361219628215,-0.130527889080987,0.00408328629810638,0.994479141617288,-3.17638925205543,-0.454457179597842,-0.938717699752471,-0.630894065477255,1.58413099873628,-0.377249100777421,-1.2186053522282,1.68891979446,-3.43905572645988,2.17044630864877,-2.61956022348504,2.6957114485066,0.202307628838833,-0.214517332647601,3.19965235031526,0.0942990594712984,1.52515096743827,-1.46102359260083,-0.715277232962622,2.11957471285256,-2.4658674354137,-7.73052698191716,1.327220972696,-2.41599427997496,-3.6988054379067,-0.273076773448743,0.595689095579002,1.76817135760396,1.98953694343792,2.55290092407105,2.34469711246174,-6.32503196852563,0.539038133658609,-0.926112466717444,0.170160133951,0.18368211184986,-1.65765844017032,-0.411535344969508,0.658997101140736,1.85644631122327,-2.17463078086504,1.29635220916474,-2.34445053999837,0.98393386977941,3.24044285302418,-0.33975692366137,0.413679190303435,5.19510632561896,0.758305156183288,0.627927938374469,1.82877581019584,0.146232442644515,0.677759495822704,-0.614281592247892,0.155708420564308,1.4002206379752,-2.35704078494398,2.61703992892204,0.209271044143703,0.84746427061106,-1.40303513001175,-0.987993173764571,3.09667881697996,0.891478505597023,1.30640813105818,2.0851170055444,-0.868005443647767,1.28289766904635,-3.04752966295402,-0.271502653294001,0.0272154514688386,2.63363337753689,0.205645251423405,-0.587877083191167,-1.54612473680399,1.74956141063363,0.770961244339003,1.15226066655539,-4.00897183212363,3.40831492852178,0.580326312818655,2.38556050916075],"PC3":[0.218971342150585,0.381477069229517,-2.229781304736,0.36696869365447,-0.0147174831045598,0.508637170668943,-0.487137564393924,-0.613790574442072,1.51152502208198,1.72636198433848,-0.183642258399881,2.16291478256739,1.63487417836456,1.32400230216992,-1.02712390953534,-0.700887431397135,-0.00631103826160473,-0.0162053402985852,1.35643541055765,1.83871916714307,-0.233159346253629,-0.589761123843065,1.52951121877006,0.840606713924063,-0.806765752700032,-0.0970878845185317,-0.579344271636511,-1.86003954653357,2.35683783505829,-0.21857841823816,0.0917508745868735,-2.83928548163985,1.82850000710643,0.17675557543008,1.43907598297988,1.52321104614868,-0.128089583338013,-1.33460110785719,1.33438293177197,1.81121072137189,0.504922490568987,-0.429022784337135,1.73480599063673,-2.90404581615094,0.683647464533811,0.649805622659587,0.154104245846947,-2.95169529310231,-1.11640306267557,0.468362701270763,-0.719832754035441,1.5576755482795,1.60131757209959,-1.98900757266162,-0.0664553053572143,-0.134615940595839,-1.39100013690287,-0.702132750492134,0.375825284106662,-1.32069770239534,-2.08554500209006,0.527298682597315,1.91311019208126,-0.201246465358137,0.635661038086839,-0.964469114482314,0.465303600811697,-1.81151945693608,1.03477055203393,0.723294714593899,-1.57888684772787,1.63328286470496,1.74367833362701,2.15605219197695,2.08001787295497,-2.10635398544102,-0.786913319241984,1.69534935415834,2.32901178165874,1.5256391985856,-0.386948407132261,-0.932745195951967,-0.291269128598902,1.59637881800474,1.62115789561411,1.61289129304314,2.31064264837288,2.01843722938983,1.7278510823199,-2.47754238734203,-1.79509065646714,-0.802718384481044,0.950488855830857,-0.702149961229428,0.77177056312186,-0.0602564925193114,1.78995510034068,1.36585660481755,0.0223948114867377,0.751708468786868,0.690890014539935,-0.333006350330237,-1.78053300797755,-1.12021195150313,-1.00965471112621,-0.524678266898287,0.963236566691728,-0.518163933767942,1.44980635762766,1.47498109035392,-1.01663592416057,1.66158835843851,-0.347534318889368,-0.346794580080306,1.53383569866721,-3.28778243604655,-3.27165400231091,1.59402732126258,-0.519552119618024,-1.66948654679618,0.600419241639996,-2.34002730757746,-0.110418955197719,-0.556601498316185,-0.789368503675677,-0.540497252755106,-1.98906034230278,1.46228564392989,-0.887375285398632,0.837925541148977,1.63079111061203,0.186254237216093,-0.219331755491357,1.56792863140631,-2.37487853418628,-1.83496638715405,0.754783943846036,1.13363566739145,1.81708659761092,1.02565615299183,-3.31025215900044,-2.2338933748038,-0.631450065118964,-0.769076922738855,-0.875114418383829,-0.815584489611052,-1.89040123067193,-1.24448894316272,-2.4474658977104,-0.592235089929932,2.03470683423897,-2.15871257197371,-0.0622208413596378,1.16067677955038,-2.59725382183087,-0.983781823077089,1.3630145427985,0.960902100107943,-0.432211560047271,2.04586900366193,0.539382749160977,1.22071079622321,-0.511770750413353,-0.811781089866747,-0.138398327627617,1.48175184543282,0.582653571712712,-0.162367564650121,-0.755137994649924,1.4701186662974,-0.977005254938991,-0.760316864068579,-0.204608132275374,1.12150726219055,0.128680420977832,0.487827643379553,1.00935020651022,-0.637944948895125,-0.837953354628747,1.46776275972535,0.709744155826192,1.31469299098344,-0.812580109834451,-1.61816031477653,0.143770533921075,1.43798255988564,-3.55896982912445,1.21892668384992,-1.14903027152111,1.51532377889482,-2.54943444171839,-1.92312010296189,-0.243456820699461,-0.728209121169146,-1.29973914386579,0.291526203717869],"PC4":[0.506159540116044,1.94415426904393,0.406128227243187,2.03255839550475,-1.4590750563153,-0.924446507206077,-1.53983190189159,-1.29004002228195,0.166668759215759,0.512571221455154,1.59343923488764,-0.170114956894086,-0.579088664296521,1.12644861503881,2.54139411713037,2.61968952030285,-1.43394597166905,-1.23656484474556,-0.774669219623475,0.602717134305926,-1.67056162005864,-1.19960279357015,0.380013868196959,-0.48125835618374,-1.36258569453865,-1.5341201676431,-1.28702098803083,0.086199020977541,-0.23216969536421,-1.5830295878915,-1.70019872190444,0.737635757957711,0.537503654426372,1.2730944200318,0.510223898187175,0.274011484976802,-1.47540710177616,3.01518904246553,-0.370198538492082,0.631647895624005,1.81682391901341,-0.800286000020465,-0.066311055175888,0.497416963779563,-0.291921627144955,0.966912065340214,1.57525525285237,0.883903243496862,-1.68031320658395,-0.34939452171225,-0.576922229717533,0.589770311799361,0.707302666575121,-0.176353982062181,-2.18138046397612,-1.58984019832178,-0.191005974577971,-0.252029101748498,1.99135224193474,-0.195390131103349,0.599287851001892,-0.527348979184358,0.629871690545375,-2.55286402604482,-1.1049311734391,-2.84911523156718,1.87412177328543,0.0912277489327027,0.170559160264867,-0.575552437586466,-0.0519583176204041,0.953462448754011,-0.752544837878387,0.604924418102484,0.484121355170011,-0.269050169070771,1.19098237311016,0.352532934523434,-0.77140446506262,-0.860712666805701,-1.78490938576352,-1.47502493594303,-1.50233627559149,0.42189190485015,-0.452974561375345,0.256417026809626,-0.440063768412638,0.475412012901768,0.909772979058747,0.768593342679769,-1.5380152395552,2.44345700388993,1.55890956236629,2.18897878905639,-0.495933959877582,-1.18257698638567,0.320325912784397,1.21371965783274,1.56650837417562,1.08231433520993,-0.0225615079524084,-1.79037320613589,3.30950369534066,2.54126312708279,-0.735651536955082,-1.59641774448111,1.67526332717073,-2.16856485744379,0.565489644579658,-0.272041737818084,-0.316415316661586,0.0456203010387399,-1.86000771264781,1.73683366349435,0.667467630908807,1.20386922343466,1.23777087800769,0.300340237379601,-1.9581352889694,-0.156558850039917,1.59719837290488,0.0646812690125125,-1.22593005699126,-2.19404196339688,-0.835217911583331,-2.50075275940377,-0.191304965215428,0.539583409619691,2.36861032019322,-0.878566345254316,0.00950235159166291,0.119297440318208,-1.82438356048184,-0.26130990404262,0.59754079469339,0.492388023128258,0.670124973207009,1.23077138753747,0.181006097044722,1.20253970457884,0.980248781855614,-0.0797070186215521,2.220034895462,2.19003310677469,-1.88561712806637,-0.332127828805292,-0.220382982902589,-0.354307975458449,0.69684627973979,-1.47458355544383,0.0930791492623633,-0.25174729608638,0.957418802079804,0.317514433253789,0.644672983055036,-1.75968520333909,0.510206117631516,0.578827859108365,1.69443779961252,-0.358168368748351,0.881065665679248,-1.18488682185589,-2.3338552087435,-2.13476910011907,-2.4739511956929,-0.149718009078779,0.284143938322245,1.71312871174394,-2.11909230525669,-0.264251053790641,-1.17372842375033,2.29786779316962,2.26311331180138,0.0762350044092214,-0.556790684496482,-0.462518648626333,-0.757331784639966,-1.6560261736697,-2.21832517135936,-0.236112390855944,-0.903268561638765,0.121174964300286,-0.0432756302295672,-0.881293872843296,1.86469611483655,-0.382854434799833,1.46058288035574,0.569064713680109,-1.7817336924605,-0.362195569646662,0.353450013404907,-0.763535006883585,-0.976385771218572,1.95018242233786,2.97709551092107,0.427493892038205],"PC5":[1.23347508634863,-0.873958346440647,-0.84559519448805,-1.03694786633621,-0.595346285950656,-0.601048527183507,-0.481189806073889,-0.785878955957303,0.797225406876903,-0.858222066632456,0.722469620632479,1.08500047484653,-0.929204114903692,0.8973610655834,-1.2953231389994,-1.03883539544941,-0.479797581656832,1.45658958575217,-1.24347052569191,-0.716442064838766,-0.366323855583932,-0.524669347990356,-0.71080036414539,-0.769915926768382,0.884167640500238,-0.451543081453134,1.32550956115758,-0.669587981816012,1.1722906748177,-0.533340229844746,1.28147157794774,-0.935023965167305,-0.779261097777723,0.711092475637226,-1.11109509897022,-1.19236341010889,1.42621529573119,-1.14757395208884,-1.11348917913112,1.07185316628634,0.938059550382281,1.19382508526748,-0.955915054212062,-0.686830773578145,-2.08296305935488,-0.98050881406267,-0.864494514280594,1.24089790752102,-1.15415087346562,-1.7736261411517,1.34083988824058,-1.09335739825169,0.97113023862219,-0.652497545914458,-0.57621555391829,-0.509508461935462,-0.553962394836185,1.42508296581614,-0.965599223322565,-0.55896239742953,-0.6157793603543,-0.591390927932623,-0.931864544975191,-0.665398306766358,-1.17096822964112,-1.49171657582418,0.990611226515834,-0.96106288772695,-0.843613463467479,1.26490982756996,1.06625136358091,-0.773437182938682,0.981666100585592,1.18938125782207,1.20609623636569,1.03245158125892,-0.802051320036807,1.00944067280741,-0.654810370120302,-1.01811549917745,1.50013099713437,1.42167950873395,-0.539988962604142,1.07178022429968,-0.782889940916233,-0.783474736265389,-0.804292677582135,1.24114308459717,1.07459037240857,1.21359083956411,0.370979148010291,-0.932642199685218,1.09115656397165,1.01168504523717,-0.642163258743164,1.48637117156943,-1.04612553549325,-0.910894022690439,-0.763088112032479,-0.611196855569698,-1.52388347085383,1.25129068015546,-1.15100422783529,0.743121895149819,-0.750812364588895,1.30740134156651,1.14037378448928,-0.712434489397171,0.88457874913672,0.532875955129908,1.41595261906237,-1.16749218105881,-0.544302151849886,-1.11614022528287,-1.03924643653235,-0.806041187157321,-0.788318239906133,-0.75840576186476,1.31601048543749,1.14301455953166,0.927718460529893,1.47697608450059,-0.413774103917828,-0.577726070018825,-0.58273045825359,-0.718391170373039,-0.297710178451476,1.17743356290376,1.07664205610357,1.48545865380994,0.960097442635331,0.979596190816724,-0.692329436337794,-0.628717530435588,-0.881989591540127,-0.811529144579092,0.618191620976638,-0.704335258677699,-0.83482666789135,1.1418506407835,-0.86068529729281,1.36059595424045,-0.830130177055764,0.790221007065241,-0.407600175230871,-0.772385816126,1.10030252533892,1.45318217047293,1.31655299351658,1.39954610912555,1.16800422517658,-0.575198875453635,0.161973327668066,1.2118507082976,-0.942850664350907,-0.605901898001807,-1.17140499039031,-0.751990161163137,0.865525263397927,1.08891750313192,-1.12424321226324,0.214109511324498,-0.761329676000166,-0.876735265550126,1.22755081817745,0.859031939425049,0.189465011971641,-1.05248239563562,0.661460624011467,-1.00863567869642,-0.549366020433968,0.882317679006296,0.953669039750039,0.80181914765863,-1.03793499463533,1.28621724721803,-1.78096473823257,1.47186076251835,0.54441529393386,0.915940634043835,0.75561754671964,-1.04363537590197,1.32321425494339,-1.07718738241986,0.978744457096011,0.986179249802314,-0.989322819074862,1.13857220371959,-1.52188415186408,-1.03672352656192,1.36779811494526,0.710030131773083,-0.399772585814806,1.15824300751326,0.934817533771663,0.257507493185214]},"columns":[{"accessor":"Salary","name":"Salary","type":"numeric"},{"accessor":"PC1","name":"PC1","type":"numeric"},{"accessor":"PC2","name":"PC2","type":"numeric"},{"accessor":"PC3","name":"PC3","type":"numeric"},{"accessor":"PC4","name":"PC4","type":"numeric"},{"accessor":"PC5","name":"PC5","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"4b891c6cdff5d01bca1c9d1d5f09accf","key":"4b891c6cdff5d01bca1c9d1d5f09accf"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="pca-exploration" class="section level2">
<h2>PCA exploration</h2>
<p>We can explore the results of the PCA using the <a href="https://recipes.tidymodels.org/reference/prep.html"><code>recipes::prep</code></a> and <a href="https://parsnip.tidymodels.org/reference/tidy.model_fit.html"><code>parsnip::tidy</code></a>. We can see that pca is done at step number 5</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>recipes<span class="sc">::</span><span class="fu">prep</span>(<span class="at">x =</span> pca_recipe, <span class="at">training =</span> Hitters_train) <span class="sc">%&gt;%</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-79189c38e6bb77597eb6" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-79189c38e6bb77597eb6">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"number":[1,2,3,4,5],"operation":["step","step","step","step","step"],"type":["novel","dummy","zv","normalize","pca"],"trained":[true,true,true,true,true],"skip":[false,false,false,false,false],"id":["novel_Q5yC4","dummy_MpRxu","zv_1sozO","normalize_DrgbK","pca"]},"columns":[{"accessor":"number","name":"number","type":"numeric"},{"accessor":"operation","name":"operation","type":"character"},{"accessor":"type","name":"type","type":"character"},{"accessor":"trained","name":"trained","type":"logical"},{"accessor":"skip","name":"skip","type":"logical"},{"accessor":"id","name":"id","type":"character"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"768f034b63f1bd3322e57d26d49652e1","key":"768f034b63f1bd3322e57d26d49652e1"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>As such, we extract the results of step number 5 or the pca step.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>tidied_pca_loadings <span class="ot">&lt;-</span> recipes<span class="sc">::</span><span class="fu">prep</span>(<span class="at">x =</span> pca_recipe, <span class="at">training =</span> Hitters_train) <span class="sc">%&gt;%</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">tidy</span>(<span class="at">id =</span> <span class="st">&quot;pca&quot;</span>, <span class="at">type =</span> <span class="st">&quot;coef&quot;</span>)</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>tidied_pca_loadings <span class="sc">%&gt;%</span></span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-ffc6b7a45fc560650c49" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ffc6b7a45fc560650c49">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"terms":["AtBat","Hits","HmRun","Runs","RBI","Walks","Years","CAtBat","CHits","CHmRun","CRuns","CRBI","CWalks","PutOuts","Assists","Errors","League_N","Division_W","NewLeague_N","AtBat","Hits","HmRun","Runs","RBI","Walks","Years","CAtBat","CHits","CHmRun","CRuns","CRBI","CWalks","PutOuts","Assists","Errors","League_N","Division_W","NewLeague_N","AtBat","Hits","HmRun","Runs","RBI","Walks","Years","CAtBat","CHits","CHmRun","CRuns","CRBI","CWalks","PutOuts","Assists","Errors","League_N","Division_W","NewLeague_N","AtBat","Hits","HmRun","Runs","RBI","Walks","Years","CAtBat","CHits","CHmRun","CRuns","CRBI","CWalks","PutOuts","Assists","Errors","League_N","Division_W","NewLeague_N","AtBat","Hits","HmRun","Runs","RBI","Walks","Years","CAtBat","CHits","CHmRun","CRuns","CRBI","CWalks","PutOuts","Assists","Errors","League_N","Division_W","NewLeague_N","AtBat","Hits","HmRun","Runs","RBI","Walks","Years","CAtBat","CHits","CHmRun","CRuns","CRBI","CWalks","PutOuts","Assists","Errors","League_N","Division_W","NewLeague_N","AtBat","Hits","HmRun","Runs","RBI","Walks","Years","CAtBat","CHits","CHmRun","CRuns","CRBI","CWalks","PutOuts","Assists","Errors","League_N","Division_W","NewLeague_N","AtBat","Hits","HmRun","Runs","RBI","Walks","Years","CAtBat","CHits","CHmRun","CRuns","CRBI","CWalks","PutOuts","Assists","Errors","League_N","Division_W","NewLeague_N","AtBat","Hits","HmRun","Runs","RBI","Walks","Years","CAtBat","CHits","CHmRun","CRuns","CRBI","CWalks","PutOuts","Assists","Errors","League_N","Division_W","NewLeague_N","AtBat","Hits","HmRun","Runs","RBI","Walks","Years","CAtBat","CHits","CHmRun","CRuns","CRBI","CWalks","PutOuts","Assists","Errors","League_N","Division_W","NewLeague_N","AtBat","Hits","HmRun","Runs","RBI","Walks","Years","CAtBat","CHits","CHmRun","CRuns","CRBI","CWalks","PutOuts","Assists","Errors","League_N","Division_W","NewLeague_N","AtBat","Hits","HmRun","Runs","RBI","Walks","Years","CAtBat","CHits","CHmRun","CRuns","CRBI","CWalks","PutOuts","Assists","Errors","League_N","Division_W","NewLeague_N","AtBat","Hits","HmRun","Runs","RBI","Walks","Years","CAtBat","CHits","CHmRun","CRuns","CRBI","CWalks","PutOuts","Assists","Errors","League_N","Division_W","NewLeague_N","AtBat","Hits","HmRun","Runs","RBI","Walks","Years","CAtBat","CHits","CHmRun","CRuns","CRBI","CWalks","PutOuts","Assists","Errors","League_N","Division_W","NewLeague_N","AtBat","Hits","HmRun","Runs","RBI","Walks","Years","CAtBat","CHits","CHmRun","CRuns","CRBI","CWalks","PutOuts","Assists","Errors","League_N","Division_W","NewLeague_N","AtBat","Hits","HmRun","Runs","RBI","Walks","Years","CAtBat","CHits","CHmRun","CRuns","CRBI","CWalks","PutOuts","Assists","Errors","League_N","Division_W","NewLeague_N","AtBat","Hits","HmRun","Runs","RBI","Walks","Years","CAtBat","CHits","CHmRun","CRuns","CRBI","CWalks","PutOuts","Assists","Errors","League_N","Division_W","NewLeague_N","AtBat","Hits","HmRun","Runs","RBI","Walks","Years","CAtBat","CHits","CHmRun","CRuns","CRBI","CWalks","PutOuts","Assists","Errors","League_N","Division_W","NewLeague_N","AtBat","Hits","HmRun","Runs","RBI","Walks","Years","CAtBat","CHits","CHmRun","CRuns","CRBI","CWalks","PutOuts","Assists","Errors","League_N","Division_W","NewLeague_N"],"value":[0.19727317551609,0.190268614624229,0.198608582093501,0.188804119075887,0.234463153870718,0.203784830349919,0.286678932820882,0.331420477062938,0.332084925017579,0.322351096171259,0.339840196841872,0.343044261241691,0.317291620877833,0.0889559110074991,0.00289931432861538,0.000635967485621988,-0.0541690239097687,-0.0358669957107385,-0.0329423819026151,0.37655400261221,0.37377547846447,0.242378231913417,0.37862318892662,0.310246006522843,0.247166858452991,-0.260767814878528,-0.197733962491703,-0.187015082612194,-0.116636974939696,-0.175659815858636,-0.164836253248168,-0.193561451767597,0.186932199304229,0.131690299509865,0.156684969294768,-0.121276217182111,-0.0581354144708289,-0.113831470570543,-0.113516642278035,-0.0920289804249273,0.18695654541782,0.00984079737727143,0.0445028173937327,-0.0304402555102851,-0.0214921132154201,-0.0766959540703064,-0.0788414095488316,0.0977732734380543,-0.0378716360791698,-0.00291994360433667,-0.015444246839982,-0.0268511224925171,-0.447403231849298,-0.447086510419209,-0.510281111107394,-0.0396486691109963,-0.504133963383042,0.0223759934946882,0.013692664936949,-0.276281123203894,-0.0370522221029898,-0.169539384775273,-0.0785641654032035,0.0907185946868458,0.0769497886920608,0.0715719894881573,-0.0850811902447422,0.0669108650743323,-0.00430234976567062,0.0449984979871633,-0.187846701737178,0.491319527054063,0.381489440017557,-0.451802496388514,-0.0616503412834979,-0.472775975980792,-0.00259231140891066,0.0481276771965062,-0.0861779697087504,0.0514328321505171,-0.00682753013265931,0.0287290969179742,0.0165478692598868,-0.0114250528116958,-0.00756426191589047,-0.0441886483668338,0.0151275989731717,-0.033098100479768,0.0237746625109955,-0.20629305458315,0.00351285294572999,-0.141034689998767,0.0743303783445257,-0.952647400330484,0.0831098511674762,0.109557116795095,0.127433100158345,0.0338165398484922,0.185504203415337,0.0438223177718584,0.113172599008525,-0.0171024059331626,-0.0176426975717804,-0.0207191669559985,-0.000757833375243962,0.00562106845303172,-0.0226285170940618,-0.00612320024461752,-0.902579629897259,0.0224482940634462,-0.179564277098673,0.0647185771995248,0.250640906223588,0.0738436566428548,-0.0761464401897386,-0.10571973506148,0.514875012681949,-0.166039684983794,0.337486822969359,-0.552388523710086,0.0236463993799028,-0.0189059757538844,-0.0309237929219756,0.210024071848805,-0.0663177173536898,0.105733272661538,-0.189942790747845,-0.190829847529786,0.0358448782370088,0.352469208182614,0.0151418085087343,-0.107290486624253,0.00379539107872712,0.272662242087887,0.390312928667497,-0.251517178990427,0.114575115585431,0.00799151046680631,-0.627899268174684,0.130194383641654,0.142512464936026,0.18718704638979,-0.228143739693721,0.0711796604580222,0.0149735543837875,-0.257409328827591,0.0927822302216928,-0.0561321565194533,-0.298592500126258,-0.0213515497407983,0.0587748463815352,0.0433007128536919,-0.024866026485367,0.0659931577502497,-0.110827253324492,0.202469668995431,-0.0975696381059697,0.0132215006357635,0.036458947889017,0.0637542395400501,0.107593258931922,-0.232187168768692,0.101382620200479,-0.0741016564585446,0.0137083330333469,-0.106067898388453,-0.696514544998681,0.587338388666575,0.0215659206710765,-0.0294925284638039,-0.0503253902999457,-0.154428393356603,-0.139461083837047,0.408827727885904,0.029186894508623,0.116794519862157,0.0529291679336836,0.375933468097514,0.123192094390801,0.108607362057148,-0.673824826761766,0.0558463566684219,-0.301653593441329,0.150946990009647,0.0215482223631331,0.140854762112138,-0.109358549372579,0.0121679512181681,0.0211535787669089,-0.0131300834697981,-0.0643055904575442,-0.0314955885971939,0.183582320144624,0.358158598111922,-0.319749084121182,-0.195948949195294,-0.188372824252412,0.00393183952146763,-0.0120301947570598,0.0836022572963399,0.1362287955429,-0.0476314504089193,0.121638064943456,0.0450181059914104,0.0996994454513608,-0.0620796204572977,0.570486560590888,-0.00378886262131851,-0.522217234471626,0.0831307604562736,0.0342117443925701,-0.258969481872712,-0.330624178924184,0.39075275575266,0.217248944825387,0.360084028544859,-0.0245177012638958,-0.0336265579008687,-0.0263622910638597,-0.171676573452742,0.0791123014579036,-0.246339985717003,-0.0293911200896331,-0.0764832000190551,-0.0035225581266411,0.420482308334588,0.00729623133868341,-0.451186888348286,-0.038063608197923,-0.0141235290987467,0.0792459111850983,0.360376842607799,-0.3510050781807,0.0308288072285949,0.679800115243599,-0.122614152655267,-0.230785888129362,0.26205303563728,-0.220607229632172,-0.013711075825274,-0.264532710463821,0.0491463024639299,0.0255405186237869,0.0417227679724224,-0.0557244259214014,-0.0029889608667409,0.110423127988809,0.254058319150265,0.16672437026207,-0.0791602108047638,-0.14704348893107,0.0615741524703995,-0.250190055419214,0.191168440003578,-0.198965651845916,-0.34591414852985,0.0861654424604588,-0.159773327302068,-0.223924881096122,0.724750711483782,-0.000701343027840015,-0.0812624048301938,0.0364244914448376,0.0274609412655318,0.0229161682168665,-0.00504709767527658,-0.57362797239675,-0.0254371789591618,-0.34833252570978,0.475220532390487,0.491746080113949,-0.128107031872903,0.00597307069058569,-0.122017444905657,-0.0768609020424549,-0.00275081298315159,-0.0227272414664157,0.0989137554983499,0.143196635506241,0.0392435182434291,0.0860355298085158,-0.0118994819596339,-0.0191020847881299,0.0476550380060463,0.0392897788050869,0.50220783780668,-0.738312857403744,-0.184318784911628,0.252780623894358,0.198449718304854,-0.0849285710629713,0.00577006923554728,0.0760555586082063,-0.0965422494282234,0.018601903357196,0.159481740218474,-0.113846384707213,-0.0498292505086693,0.00884934369652707,-0.0155306581453583,-0.021244563502744,-0.0168377033603505,-0.00572115328030225,0.02766152762256,-0.125962104583689,0.143443902877648,-0.0467960173543094,-0.12401196091517,0.105802726385038,0.032237801364865,0.0869666356354592,-0.182278078032529,-0.0176580584511637,0.288327969426496,0.631956362182733,-0.613126154140302,-0.181406434180491,0.0158101836156266,0.0165629740654851,0.00402831424602791,-0.00535494635303158,0.0198842027553666,0.0188773095077715,0.107784645268907,-0.0411414437196326,0.0537601082784942,-0.0418719043952642,-0.0663546274388836,-0.0115993729503212,0.0927187631120272,-0.728607876597049,0.00346281935214106,-0.252857449952491,0.389952152173623,0.470848270462927,0.0104274964761897,0.000889063494605196,0.0109606722713798,0.00167487877381812,0.00124522041236945,0.00329053771377391,0.00939460184367417,-0.0591490573453132,0.106637317542897,0.0216877671480395,-0.0630884222573904,-0.0156374811306457,0.0185581678635626,-0.0185727445941123,0.398626014240961,-0.770588609169035,-0.168580569047095,0.353567525772799,0.25768359203402,-0.0834117598347397,0.00377973029523466,-0.00876787901779488,0.00559290754219747,-0.00595409170438529,0.00291284909730881,0.00904647957681595],"component":["PC1","PC1","PC1","PC1","PC1","PC1","PC1","PC1","PC1","PC1","PC1","PC1","PC1","PC1","PC1","PC1","PC1","PC1","PC1","PC2","PC2","PC2","PC2","PC2","PC2","PC2","PC2","PC2","PC2","PC2","PC2","PC2","PC2","PC2","PC2","PC2","PC2","PC2","PC3","PC3","PC3","PC3","PC3","PC3","PC3","PC3","PC3","PC3","PC3","PC3","PC3","PC3","PC3","PC3","PC3","PC3","PC3","PC4","PC4","PC4","PC4","PC4","PC4","PC4","PC4","PC4","PC4","PC4","PC4","PC4","PC4","PC4","PC4","PC4","PC4","PC4","PC5","PC5","PC5","PC5","PC5","PC5","PC5","PC5","PC5","PC5","PC5","PC5","PC5","PC5","PC5","PC5","PC5","PC5","PC5","PC6","PC6","PC6","PC6","PC6","PC6","PC6","PC6","PC6","PC6","PC6","PC6","PC6","PC6","PC6","PC6","PC6","PC6","PC6","PC7","PC7","PC7","PC7","PC7","PC7","PC7","PC7","PC7","PC7","PC7","PC7","PC7","PC7","PC7","PC7","PC7","PC7","PC7","PC8","PC8","PC8","PC8","PC8","PC8","PC8","PC8","PC8","PC8","PC8","PC8","PC8","PC8","PC8","PC8","PC8","PC8","PC8","PC9","PC9","PC9","PC9","PC9","PC9","PC9","PC9","PC9","PC9","PC9","PC9","PC9","PC9","PC9","PC9","PC9","PC9","PC9","PC10","PC10","PC10","PC10","PC10","PC10","PC10","PC10","PC10","PC10","PC10","PC10","PC10","PC10","PC10","PC10","PC10","PC10","PC10","PC11","PC11","PC11","PC11","PC11","PC11","PC11","PC11","PC11","PC11","PC11","PC11","PC11","PC11","PC11","PC11","PC11","PC11","PC11","PC12","PC12","PC12","PC12","PC12","PC12","PC12","PC12","PC12","PC12","PC12","PC12","PC12","PC12","PC12","PC12","PC12","PC12","PC12","PC13","PC13","PC13","PC13","PC13","PC13","PC13","PC13","PC13","PC13","PC13","PC13","PC13","PC13","PC13","PC13","PC13","PC13","PC13","PC14","PC14","PC14","PC14","PC14","PC14","PC14","PC14","PC14","PC14","PC14","PC14","PC14","PC14","PC14","PC14","PC14","PC14","PC14","PC15","PC15","PC15","PC15","PC15","PC15","PC15","PC15","PC15","PC15","PC15","PC15","PC15","PC15","PC15","PC15","PC15","PC15","PC15","PC16","PC16","PC16","PC16","PC16","PC16","PC16","PC16","PC16","PC16","PC16","PC16","PC16","PC16","PC16","PC16","PC16","PC16","PC16","PC17","PC17","PC17","PC17","PC17","PC17","PC17","PC17","PC17","PC17","PC17","PC17","PC17","PC17","PC17","PC17","PC17","PC17","PC17","PC18","PC18","PC18","PC18","PC18","PC18","PC18","PC18","PC18","PC18","PC18","PC18","PC18","PC18","PC18","PC18","PC18","PC18","PC18","PC19","PC19","PC19","PC19","PC19","PC19","PC19","PC19","PC19","PC19","PC19","PC19","PC19","PC19","PC19","PC19","PC19","PC19","PC19"],"id":["pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca"]},"columns":[{"accessor":"terms","name":"terms","type":"character"},{"accessor":"value","name":"value","type":"numeric"},{"accessor":"component","name":"component","type":"character"},{"accessor":"id","name":"id","type":"character"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"e1b8a04337bb94105d4305c3312ad152","key":"e1b8a04337bb94105d4305c3312ad152"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>We make a visualization to see what the first four components look like</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>tidied_pca_loadings <span class="sc">%&gt;%</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(.data[[<span class="st">&quot;component&quot;</span>]] <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;PC1&quot;</span>, <span class="st">&quot;PC2&quot;</span>, <span class="st">&quot;PC3&quot;</span>, <span class="st">&quot;PC4&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">component =</span> forcats<span class="sc">::</span><span class="fu">fct_inorder</span>(.data[[<span class="st">&quot;component&quot;</span>]])) <span class="sc">%&gt;%</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> .data[[<span class="st">&quot;value&quot;</span>]],</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> .data[[<span class="st">&quot;terms&quot;</span>]],</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> .data[[<span class="st">&quot;terms&quot;</span>]]</span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">facet_wrap</span>(<span class="at">facets =</span> ggplot2<span class="sc">::</span><span class="fu">vars</span>(.data[[<span class="st">&quot;component&quot;</span>]])) <span class="sc">+</span></span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<p><img src="figures/unnamed-chunk-74-1.png" width="3883.2" style="display: block; margin: auto;" /></p>
<p>Let us take a closer look at the top 6 variables that contribute to the first four components</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>tidied_pca_loadings <span class="sc">%&gt;%</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(.data[[<span class="st">&quot;component&quot;</span>]] <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;PC1&quot;</span>, <span class="st">&quot;PC2&quot;</span>, <span class="st">&quot;PC3&quot;</span>, <span class="st">&quot;PC4&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(.data[[<span class="st">&quot;component&quot;</span>]]) <span class="sc">%&gt;%</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">top_n</span>(<span class="dv">6</span>, <span class="fu">abs</span>(.data[[<span class="st">&quot;value&quot;</span>]])) <span class="sc">%&gt;%</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">terms =</span> tidytext<span class="sc">::</span><span class="fu">reorder_within</span>(</span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> .data[[<span class="st">&quot;terms&quot;</span>]],</span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">by =</span> <span class="fu">abs</span>(.data[[<span class="st">&quot;value&quot;</span>]]),</span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">within =</span> .data[[<span class="st">&quot;component&quot;</span>]]</span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(</span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">abs</span>(.data[[<span class="st">&quot;value&quot;</span>]]),</span>
<span id="cb113-15"><a href="#cb113-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> .data[[<span class="st">&quot;terms&quot;</span>]],</span>
<span id="cb113-16"><a href="#cb113-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> .data[[<span class="st">&quot;value&quot;</span>]] <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb113-17"><a href="#cb113-17" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb113-18"><a href="#cb113-18" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb113-19"><a href="#cb113-19" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">facet_wrap</span>(</span>
<span id="cb113-20"><a href="#cb113-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">facets =</span> ggplot2<span class="sc">::</span><span class="fu">vars</span>(.data[[<span class="st">&quot;component&quot;</span>]]),</span>
<span id="cb113-21"><a href="#cb113-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span></span>
<span id="cb113-22"><a href="#cb113-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb113-23"><a href="#cb113-23" aria-hidden="true" tabindex="-1"></a>  tidytext<span class="sc">::</span><span class="fu">scale_y_reordered</span>() <span class="sc">+</span></span>
<span id="cb113-24"><a href="#cb113-24" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb113-25"><a href="#cb113-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Absolute value of contribution to PCA component&quot;</span>,</span>
<span id="cb113-26"><a href="#cb113-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb113-27"><a href="#cb113-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Positive?&quot;</span></span>
<span id="cb113-28"><a href="#cb113-28" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="figures/unnamed-chunk-75-1.png" width="3883.2" style="display: block; margin: auto;" /></p>
<p>How much variation are we capturing for each component?</p>
<p>Here is how we can see the variance statistics but it is in a long form</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>tidied_pca_variance <span class="ot">&lt;-</span> recipes<span class="sc">::</span><span class="fu">prep</span>(<span class="at">x =</span> pca_recipe, <span class="at">training =</span> Hitters_train) <span class="sc">%&gt;%</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  broom<span class="sc">::</span><span class="fu">tidy</span>(<span class="at">id =</span> <span class="st">&quot;pca&quot;</span>, <span class="at">type =</span> <span class="st">&quot;variance&quot;</span>)</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>tidied_pca_variance <span class="sc">%&gt;%</span></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-ed97937fc5a1fd73691c" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ed97937fc5a1fd73691c">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"terms":["variance","variance","variance","variance","variance","variance","variance","variance","variance","variance","variance","variance","variance","variance","variance","variance","variance","variance","variance","cumulative variance","cumulative variance","cumulative variance","cumulative variance","cumulative variance","cumulative variance","cumulative variance","cumulative variance","cumulative variance","cumulative variance","cumulative variance","cumulative variance","cumulative variance","cumulative variance","cumulative variance","cumulative variance","cumulative variance","cumulative variance","cumulative variance","percent variance","percent variance","percent variance","percent variance","percent variance","percent variance","percent variance","percent variance","percent variance","percent variance","percent variance","percent variance","percent variance","percent variance","percent variance","percent variance","percent variance","percent variance","percent variance","cumulative percent variance","cumulative percent variance","cumulative percent variance","cumulative percent variance","cumulative percent variance","cumulative percent variance","cumulative percent variance","cumulative percent variance","cumulative percent variance","cumulative percent variance","cumulative percent variance","cumulative percent variance","cumulative percent variance","cumulative percent variance","cumulative percent variance","cumulative percent variance","cumulative percent variance","cumulative percent variance","cumulative percent variance"],"value":[7.17100395103403,4.31547615800859,1.92495563054448,1.6578942361212,0.998676563986726,0.807673293707148,0.658819586410746,0.501387345393356,0.26820853988413,0.186792025385833,0.134624442242666,0.125712707112574,0.0930762594005521,0.0629162030225831,0.0466844566274288,0.0266165934464943,0.0140130332776124,0.0042857166557028,0.0011832577381689,7.17100395103403,11.4864801090426,13.4114357395871,15.0693299757083,16.068006539695,16.8756798334022,17.5344994198129,18.0358867652063,18.3040953050904,18.4908873304762,18.6255117727189,18.7512244798315,18.844300739232,18.9072169422546,18.953901398882,18.9805179923285,18.9945310256062,18.9988167422619,19,37.7421260580738,22.7130324105715,10.1313454239183,8.72575913747997,5.25619244203539,4.25091207214288,3.46747150742497,2.63888076522819,1.411623894127,0.983115923083331,0.708549696014029,0.661645826908281,0.48987504947659,0.331137910645174,0.245707666460151,0.140087333928917,0.0737528067242758,0.0225564034510673,0.00622767230615212,37.7421260580738,60.4551584686453,70.5865038925636,79.3122630300436,84.568455472079,88.8193675442219,92.2868390516469,94.925719816875,96.337343711002,97.3204596340854,98.0290093300994,98.6906551570077,99.1805302064843,99.5116681171294,99.7573757835896,99.8974631175185,99.9712159242428,99.9937723276939,100],"component":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19],"id":["pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca","pca"]},"columns":[{"accessor":"terms","name":"terms","type":"character"},{"accessor":"value","name":"value","type":"numeric"},{"accessor":"component","name":"component","type":"numeric"},{"accessor":"id","name":"id","type":"character"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"d6e12c2694af9271c0309d846cfba723","key":"d6e12c2694af9271c0309d846cfba723"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>Here is how we can see the variance statistics in its wide form</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>tidied_pca_variance <span class="sc">%&gt;%</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> .data[[<span class="st">&quot;component&quot;</span>]],</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> .data[[<span class="st">&quot;value&quot;</span>]],</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_prefix =</span> <span class="st">&quot;PC&quot;</span></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>dplyr<span class="sc">::</span><span class="fu">all_of</span>(<span class="st">&quot;id&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-168e970060f0d332feef" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-168e970060f0d332feef">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"terms":["variance","cumulative variance","percent variance","cumulative percent variance"],"PC1":[7.17100395103403,7.17100395103403,37.7421260580738,37.7421260580738],"PC2":[4.31547615800859,11.4864801090426,22.7130324105715,60.4551584686453],"PC3":[1.92495563054448,13.4114357395871,10.1313454239183,70.5865038925636],"PC4":[1.6578942361212,15.0693299757083,8.72575913747997,79.3122630300436],"PC5":[0.998676563986726,16.068006539695,5.25619244203539,84.568455472079],"PC6":[0.807673293707148,16.8756798334022,4.25091207214288,88.8193675442219],"PC7":[0.658819586410746,17.5344994198129,3.46747150742497,92.2868390516469],"PC8":[0.501387345393356,18.0358867652063,2.63888076522819,94.925719816875],"PC9":[0.26820853988413,18.3040953050904,1.411623894127,96.337343711002],"PC10":[0.186792025385833,18.4908873304762,0.983115923083331,97.3204596340854],"PC11":[0.134624442242666,18.6255117727189,0.708549696014029,98.0290093300994],"PC12":[0.125712707112574,18.7512244798315,0.661645826908281,98.6906551570077],"PC13":[0.0930762594005521,18.844300739232,0.48987504947659,99.1805302064843],"PC14":[0.0629162030225831,18.9072169422546,0.331137910645174,99.5116681171294],"PC15":[0.0466844566274288,18.953901398882,0.245707666460151,99.7573757835896],"PC16":[0.0266165934464943,18.9805179923285,0.140087333928917,99.8974631175185],"PC17":[0.0140130332776124,18.9945310256062,0.0737528067242758,99.9712159242428],"PC18":[0.0042857166557028,18.9988167422619,0.0225564034510673,99.9937723276939],"PC19":[0.0011832577381689,19,0.00622767230615212,100]},"columns":[{"accessor":"terms","name":"terms","type":"character"},{"accessor":"PC1","name":"PC1","type":"numeric"},{"accessor":"PC2","name":"PC2","type":"numeric"},{"accessor":"PC3","name":"PC3","type":"numeric"},{"accessor":"PC4","name":"PC4","type":"numeric"},{"accessor":"PC5","name":"PC5","type":"numeric"},{"accessor":"PC6","name":"PC6","type":"numeric"},{"accessor":"PC7","name":"PC7","type":"numeric"},{"accessor":"PC8","name":"PC8","type":"numeric"},{"accessor":"PC9","name":"PC9","type":"numeric"},{"accessor":"PC10","name":"PC10","type":"numeric"},{"accessor":"PC11","name":"PC11","type":"numeric"},{"accessor":"PC12","name":"PC12","type":"numeric"},{"accessor":"PC13","name":"PC13","type":"numeric"},{"accessor":"PC14","name":"PC14","type":"numeric"},{"accessor":"PC15","name":"PC15","type":"numeric"},{"accessor":"PC16","name":"PC16","type":"numeric"},{"accessor":"PC17","name":"PC17","type":"numeric"},{"accessor":"PC18","name":"PC18","type":"numeric"},{"accessor":"PC19","name":"PC19","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"d845dfce4cd1aa1c20702ebeff9479c1","key":"d845dfce4cd1aa1c20702ebeff9479c1"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>Here is a simple plot to show the variance captured for each component</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the variance</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>percent_variation <span class="ot">&lt;-</span> tidied_pca_variance <span class="sc">%&gt;%</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(.data[[<span class="st">&quot;terms&quot;</span>]] <span class="sc">==</span> <span class="st">&quot;percent variance&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(.data[[<span class="st">&quot;value&quot;</span>]])</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>percent_variation <span class="ot">&lt;-</span> percent_variation <span class="sc">/</span> <span class="dv">100</span></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a><span class="co"># I use [1:4] to select the first four components</span></span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">component =</span> <span class="fu">unique</span>(tidied_pca_loadings<span class="sc">$</span>component)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],</span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">percent_var =</span> percent_variation[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">component =</span> forcats<span class="sc">::</span><span class="fu">fct_inorder</span>(.data[[<span class="st">&quot;component&quot;</span>]])) <span class="sc">%&gt;%</span></span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(</span>
<span id="cb116-15"><a href="#cb116-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> .data[[<span class="st">&quot;component&quot;</span>]],</span>
<span id="cb116-16"><a href="#cb116-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> .data[[<span class="st">&quot;percent_var&quot;</span>]]</span>
<span id="cb116-17"><a href="#cb116-17" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb116-18"><a href="#cb116-18" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb116-19"><a href="#cb116-19" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>()) <span class="sc">+</span></span>
<span id="cb116-20"><a href="#cb116-20" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb116-21"><a href="#cb116-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb116-22"><a href="#cb116-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Percent variance explained by each PCA component&quot;</span></span>
<span id="cb116-23"><a href="#cb116-23" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="figures/unnamed-chunk-78-1.png" width="3883.2" style="display: block; margin: auto;" /></p>
<p>Threshold is the fraction of the total variance that should be covered by the components. For example, <code>threshold = .75</code> means that step_pca should generate enough components to capture 75 percent of the variability in the variables. Note: using this argument will override and reset any value given to <code>num_comp</code>.</p>
<p>We will now try to find the best threshold value using the <a href="https://hardhat.tidymodels.org/reference/tune.html"><code>tune::tune()</code></a></p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>pca_recipe <span class="ot">&lt;-</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">recipe</span>(<span class="at">formula =</span> Salary <span class="sc">~</span> ., <span class="at">data =</span> Hitters_train) <span class="sc">%&gt;%</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_novel</span>(recipes<span class="sc">::</span><span class="fu">all_nominal_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_dummy</span>(recipes<span class="sc">::</span><span class="fu">all_nominal_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_zv</span>(recipes<span class="sc">::</span><span class="fu">all_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_normalize</span>(recipes<span class="sc">::</span><span class="fu">all_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_pca</span>(recipes<span class="sc">::</span><span class="fu">all_predictors</span>(), <span class="at">threshold =</span> tune<span class="sc">::</span><span class="fu">tune</span>())</span></code></pre></div>
</div>
<div id="specify-the-model-2" class="section level2">
<h2>Specify the model</h2>
<p>We use a linear model</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>lm_spec <span class="ot">&lt;-</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_mode</span>(<span class="st">&quot;regression&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">&quot;lm&quot;</span>)</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>lm_spec <span class="sc">%&gt;%</span></span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">translate</span>()</span></code></pre></div>
<pre><code>&gt; Linear Regression Model Specification (regression)
&gt; 
&gt; Computational engine: lm 
&gt; 
&gt; Model fit template:
&gt; stats::lm(formula = missing_arg(), data = missing_arg(), weights = missing_arg())</code></pre>
</div>
<div id="create-the-workflow-2" class="section level2">
<h2>Create the workflow</h2>
<p><a href="https://workflows.tidymodels.org/reference/workflow.html"><code>workflows::workflow</code></a>, <a href="https://workflows.tidymodels.org/reference/add_recipe.html"><code>workflows::add_recipe</code></a> and <a href="https://workflows.tidymodels.org/reference/add_model.html"><code>workflows::add_model</code></a> are used.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>pca_workflow <span class="ot">&lt;-</span> workflows<span class="sc">::</span><span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>  workflows<span class="sc">::</span><span class="fu">add_recipe</span>(pca_recipe) <span class="sc">%&gt;%</span></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>  workflows<span class="sc">::</span><span class="fu">add_model</span>(lm_spec)</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>pca_workflow</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; == Workflow ==========================================================
&gt; Preprocessor: Recipe
&gt; Model: linear_reg()
&gt; 
&gt; -- Preprocessor ------------------------------------------------------
&gt; 5 Recipe Steps
&gt; 
&gt; * step_novel()
&gt; * step_dummy()
&gt; * step_zv()
&gt; * step_normalize()
&gt; * step_pca()
&gt; 
&gt; -- Model -------------------------------------------------------------
&gt; Linear Regression Model Specification (regression)
&gt; 
&gt; Computational engine: lm</code></pre>
</div>
<div id="create-the-threshold-grid" class="section level2">
<h2>Create the threshold grid</h2>
<p>A threshold grid of <span class="math inline">\(10\)</span> numbers from <span class="math inline">\(0\)</span> to <span class="math inline">\(1\)</span> is created.</p>
<p>Threshold grid is created using <a href="https://dials.tidymodels.org/reference/grid_regular.html"><code>dials::grid_regular</code></a> and <a href="https://dials.tidymodels.org/reference/threshold.html"><code>dials::threshold</code></a></p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>threshold_grid <span class="ot">&lt;-</span> dials<span class="sc">::</span><span class="fu">grid_regular</span>(</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> dials<span class="sc">::</span><span class="fu">threshold</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)),</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="dv">10</span></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>threshold_grid <span class="sc">%&gt;%</span></span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-f0c5de542c78ea30ae5b" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-f0c5de542c78ea30ae5b">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"threshold":[0,0.111111111111111,0.222222222222222,0.333333333333333,0.444444444444444,0.555555555555556,0.666666666666667,0.777777777777778,0.888888888888889,1]},"columns":[{"accessor":"threshold","name":"threshold","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"e43a94363d88e7d1c0f859ac0e73872b","key":"e43a94363d88e7d1c0f859ac0e73872b"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="principal-component-regression-model-fitting-on-cross-validated-data" class="section level2">
<h2>Principal component regression model fitting on cross validated data</h2>
<p>Now we have everything we need and we can fit all the models on the cross validated data with <a href="https://tune.tidymodels.org/reference/tune_grid.html"><code>tune::tune_grid</code></a>. Note that this process may take some time.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>doParallel<span class="sc">::</span><span class="fu">registerDoParallel</span>()</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>foreach<span class="sc">::</span><span class="fu">getDoParWorkers</span>()</span></code></pre></div>
<pre><code>&gt; [1] 3</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>tune_res <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">tune_grid</span>(</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">object =</span> pca_workflow,</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">resamples =</span> Hitters_fold,</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">grid =</span> threshold_grid</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>tune_res</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; # Tuning results
&gt; # 10-fold cross-validation 
&gt; # A tibble: 10 x 4
&gt;    splits           id     .metrics          .notes          
&gt;    &lt;list&gt;           &lt;chr&gt;  &lt;list&gt;            &lt;list&gt;          
&gt;  1 &lt;split [176/20]&gt; Fold01 &lt;tibble [20 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  2 &lt;split [176/20]&gt; Fold02 &lt;tibble [20 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  3 &lt;split [176/20]&gt; Fold03 &lt;tibble [20 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  4 &lt;split [176/20]&gt; Fold04 &lt;tibble [20 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  5 &lt;split [176/20]&gt; Fold05 &lt;tibble [20 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  6 &lt;split [176/20]&gt; Fold06 &lt;tibble [20 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  7 &lt;split [177/19]&gt; Fold07 &lt;tibble [20 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  8 &lt;split [177/19]&gt; Fold08 &lt;tibble [20 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  9 &lt;split [177/19]&gt; Fold09 &lt;tibble [20 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt; 10 &lt;split [177/19]&gt; Fold10 &lt;tibble [20 x 5]&gt; &lt;tibble [0 x 3]&gt;</code></pre>
<p>Here we see that the amount of regularization affects the performance metrics differently using <a href="https://tune.tidymodels.org/reference/autoplot.tune_results.html"><code>tune::autoplot</code></a>. Do note that using a different seed will give a different plot</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that a different seed will give different plots</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>tune<span class="sc">::</span><span class="fu">autoplot</span>(tune_res)</span></code></pre></div>
<p><img src="figures/unnamed-chunk-85-1.png" width="3883.2" style="display: block; margin: auto;" /></p>
<p>We can also see the raw metrics that created this chart by calling <a href="https://tune.tidymodels.org/reference/collect_predictions.html"><code>tune::collect_metrics()</code></a>.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>tune<span class="sc">::</span><span class="fu">collect_metrics</span>(tune_res) <span class="sc">%&gt;%</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-e57cc8607ea285f33fde" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-e57cc8607ea285f33fde">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"threshold":[0,0,0.111111111111111,0.111111111111111,0.222222222222222,0.222222222222222,0.333333333333333,0.333333333333333,0.444444444444444,0.444444444444444,0.555555555555556,0.555555555555556,0.666666666666667,0.666666666666667,0.777777777777778,0.777777777777778,0.888888888888889,0.888888888888889,1,1],".metric":["rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq"],".estimator":["standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard"],"mean":[343.781428109761,0.461000965153733,343.781428109761,0.461000965153733,343.781428109761,0.461000965153733,343.781428109761,0.461000965153733,340.187780731658,0.4738302809985,340.187780731658,0.4738302809985,339.51461640406,0.481112517233591,340.278507361879,0.479571061329753,337.557714821218,0.479419838160952,341.564118785536,0.453550526802057],"n":[10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10],"std_err":[34.940476193501,0.0565455735025548,34.940476193501,0.0565455735025548,34.940476193501,0.0565455735025548,34.940476193501,0.0565455735025548,37.5435181330923,0.0576886206568745,37.5435181330923,0.0576886206568745,37.9205590454764,0.0602649730410526,38.03624447457,0.059434545371906,36.1110079020144,0.0504044066513419,33.4830516141708,0.0473550871463117],".config":["Preprocessor01_Model1","Preprocessor01_Model1","Preprocessor02_Model1","Preprocessor02_Model1","Preprocessor03_Model1","Preprocessor03_Model1","Preprocessor04_Model1","Preprocessor04_Model1","Preprocessor05_Model1","Preprocessor05_Model1","Preprocessor06_Model1","Preprocessor06_Model1","Preprocessor07_Model1","Preprocessor07_Model1","Preprocessor08_Model1","Preprocessor08_Model1","Preprocessor09_Model1","Preprocessor09_Model1","Preprocessor10_Model1","Preprocessor10_Model1"]},"columns":[{"accessor":"threshold","name":"threshold","type":"numeric"},{"accessor":".metric","name":".metric","type":"character"},{"accessor":".estimator","name":".estimator","type":"character"},{"accessor":"mean","name":"mean","type":"numeric"},{"accessor":"n","name":"n","type":"numeric"},{"accessor":"std_err","name":"std_err","type":"numeric"},{"accessor":".config","name":".config","type":"character"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"7dae2f28497339ac2365ec23a0095306","key":"7dae2f28497339ac2365ec23a0095306"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>Here is the <code>ggplot</code> way should <a href="https://tune.tidymodels.org/reference/autoplot.tune_results.html"><code>tune::autoplot</code></a> fails</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>tune_res <span class="sc">%&gt;%</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>  tune<span class="sc">::</span><span class="fu">collect_metrics</span>() <span class="sc">%&gt;%</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> .data[[<span class="st">&quot;threshold&quot;</span>]],</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> .data[[<span class="st">&quot;mean&quot;</span>]],</span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> .data[[<span class="st">&quot;.metric&quot;</span>]]</span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_errorbar</span>(</span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(</span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymin =</span> .data[[<span class="st">&quot;mean&quot;</span>]] <span class="sc">-</span> .data[[<span class="st">&quot;std_err&quot;</span>]],</span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymax =</span> .data[[<span class="st">&quot;mean&quot;</span>]] <span class="sc">+</span> .data[[<span class="st">&quot;std_err&quot;</span>]]</span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb129-14"><a href="#cb129-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb129-15"><a href="#cb129-15" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb129-16"><a href="#cb129-16" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">facet_wrap</span>(</span>
<span id="cb129-17"><a href="#cb129-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">facets =</span> ggplot2<span class="sc">::</span><span class="fu">vars</span>(.data[[<span class="st">&quot;.metric&quot;</span>]]),</span>
<span id="cb129-18"><a href="#cb129-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>,</span>
<span id="cb129-19"><a href="#cb129-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">2</span></span>
<span id="cb129-20"><a href="#cb129-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb129-21"><a href="#cb129-21" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="figures/unnamed-chunk-87-1.png" width="3883.2" style="display: block; margin: auto;" /></p>
<p>Use <a href="https://tune.tidymodels.org/reference/show_best.html"><code>tune::show_best</code></a> to see the top few values for a given metric.</p>
<p>The “best” values can be selected using <a href="https://tune.tidymodels.org/reference/show_best.html"><code>tune::select_best</code></a>, this function requires you to specify a metric that it should select against. The threshold value is 0.889 for metric <code>rsme</code> since it gives the lowest value. Do note that using a different seed will give a different best number of threshold value.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>top_threshold <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">show_best</span>(tune_res, <span class="at">metric =</span> <span class="st">&quot;rmse&quot;</span>, <span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>top_threshold</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; # A tibble: 5 x 7
&gt;   threshold .metric .estimator  mean     n std_err .config            
&gt;       &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;              
&gt; 1     0.889 rmse    standard    338.    10    36.1 Preprocessor09_Mod~
&gt; 2     0.667 rmse    standard    340.    10    37.9 Preprocessor07_Mod~
&gt; 3     0.444 rmse    standard    340.    10    37.5 Preprocessor05_Mod~
&gt; 4     0.556 rmse    standard    340.    10    37.5 Preprocessor06_Mod~
&gt; 5     0.778 rmse    standard    340.    10    38.0 Preprocessor08_Mod~</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>best_threshold <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">select_best</span>(tune_res, <span class="at">metric =</span> <span class="st">&quot;rmse&quot;</span>)</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>best_threshold</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; # A tibble: 1 x 2
&gt;   threshold .config              
&gt;       &lt;dbl&gt; &lt;chr&gt;                
&gt; 1     0.889 Preprocessor09_Model1</code></pre>
</div>
<div id="principal-component-regression-model-with-optimised-threshold-value" class="section level2">
<h2>Principal component regression model with optimised threshold value</h2>
<p>We create the principal component regression workflow with the best threshold using <a href="https://tune.tidymodels.org/reference/finalize_model.html"><code>tune::finalize_workflow</code></a>.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>pca_final <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">finalize_workflow</span>(</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> pca_workflow,</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">parameters =</span> best_threshold</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>pca_final</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; == Workflow ==========================================================
&gt; Preprocessor: Recipe
&gt; Model: linear_reg()
&gt; 
&gt; -- Preprocessor ------------------------------------------------------
&gt; 5 Recipe Steps
&gt; 
&gt; * step_novel()
&gt; * step_dummy()
&gt; * step_zv()
&gt; * step_normalize()
&gt; * step_pca()
&gt; 
&gt; -- Model -------------------------------------------------------------
&gt; Linear Regression Model Specification (regression)
&gt; 
&gt; Computational engine: lm</code></pre>
<p>We now train the principal component regression model with the training data using <a href="https://parsnip.tidymodels.org/reference/fit.html"><code>parsnip::fit</code></a></p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>pca_final_fit <span class="ot">&lt;-</span> parsnip<span class="sc">::</span><span class="fu">fit</span>(<span class="at">object =</span> pca_final, <span class="at">data =</span> Hitters_train)</span></code></pre></div>
<p>We can see the coefficients using <a href="https://tune.tidymodels.org/reference/extract-tune.html"><code>tune::extract_fit_parsnip</code></a> and <a href="https://parsnip.tidymodels.org/reference/tidy.model_fit.html"><code>parsnip::tidy</code></a></p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>pca_final_fit <span class="sc">%&gt;%</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>  tune<span class="sc">::</span><span class="fu">extract_fit_parsnip</span>() <span class="sc">%&gt;%</span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-911878549535907d1101" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-911878549535907d1101">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"term":["(Intercept)","PC1","PC2","PC3","PC4","PC5","PC6","PC7"],"estimate":[537.573168367347,108.446542333998,26.131476846147,-18.8887536796312,-20.7477790300859,66.3627166039657,-52.8710079743809,-45.5144869330192],"std.error":[24.6402998087957,9.22500769020068,11.8916565329578,17.8051794852139,19.1857290528506,24.7197621987984,27.4877287370389,30.4350112574892],"statistic":[21.816827414391,11.7557129463638,2.19746313507488,-1.06085724636009,-1.0814172853652,2.6846017397041,-1.92344040063007,-1.49546476418074],"p.value":[2.11012790800483e-53,2.8279137765082e-24,0.0292093202515404,0.29011573329404,0.280896750212437,0.00791039361300916,0.0559355159375508,0.136469921985634]},"columns":[{"accessor":"term","name":"term","type":"character"},{"accessor":"estimate","name":"estimate","type":"numeric"},{"accessor":"std.error","name":"std.error","type":"numeric"},{"accessor":"statistic","name":"statistic","type":"numeric"},{"accessor":"p.value","name":"p.value","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"d4b53c56d50bd6494d7fa162eed8552f","key":"d4b53c56d50bd6494d7fa162eed8552f"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="principal-component-regression-model-on-test-data" class="section level2">
<h2>Principal component regression model on test data</h2>
<p>This principal component regression model can now be applied on our testing data set to validate its performance. For regression models, a <code>.pred</code> column is added when <a href="https://parsnip.tidymodels.org/reference/augment.html"><code>parsnip::augment</code></a> is used.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>test_results <span class="ot">&lt;-</span> parsnip<span class="sc">::</span><span class="fu">augment</span>(<span class="at">x =</span> pca_final_fit, <span class="at">new_data =</span> Hitters_test)</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>test_results <span class="sc">%&gt;%</span></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-a0d44a3d9d39b98616e4" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-a0d44a3d9d39b98616e4">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"AtBat":[315,321,413,324,474,550,513,583,181,217,205,214,529,424,388,339,329,458,317,382,233,641,596,370,282,589,438,232,528,309,616,591,315,453,441,551,283,199,464,584,303,381,514,359,309,216,256,466,327,341,486,275,208,459,288,220,581,439,633,368,263,520,19,279,600,610,631],"Hits":[81,87,92,73,129,152,137,168,41,46,57,53,137,119,103,96,83,114,78,119,49,198,171,96,78,170,103,55,132,94,163,157,73,101,118,171,70,52,128,157,71,110,144,80,72,56,70,108,68,110,145,68,57,113,63,66,145,96,210,103,70,120,4,69,139,186,170],"HmRun":[7,10,16,4,10,6,20,17,1,7,8,2,26,6,15,4,9,13,7,13,2,31,34,21,13,40,2,9,21,5,27,16,5,3,28,13,8,9,28,20,3,9,0,15,0,4,13,33,13,9,11,5,8,20,3,5,17,0,6,3,1,17,1,4,0,19,9],"Runs":[24,39,72,32,50,92,90,83,15,32,34,30,86,57,59,37,50,67,35,54,41,101,91,49,37,107,65,34,61,37,83,90,23,46,84,94,33,26,67,95,18,61,67,45,33,22,42,75,42,45,51,42,32,59,25,20,66,44,91,48,26,53,2,35,94,107,77],"RBI":[38,42,48,18,56,37,95,80,21,19,32,29,97,46,47,29,39,57,35,58,23,108,108,46,51,108,32,23,74,32,107,78,37,43,86,83,37,28,94,73,30,45,54,48,31,18,36,86,29,49,76,42,25,57,33,28,68,36,56,28,23,44,3,31,29,98,44],"Walks":[39,30,65,22,40,81,90,56,33,9,9,23,97,13,39,23,56,48,32,36,18,41,52,60,29,69,71,45,41,26,32,26,16,61,68,94,27,21,52,63,36,32,79,63,26,15,44,72,45,46,40,61,18,68,16,13,21,65,59,54,30,21,1,32,60,74,31],"Years":[14,2,1,7,10,5,14,5,2,4,5,2,15,9,6,4,9,4,1,12,8,5,6,15,5,6,2,12,6,13,3,4,4,3,8,13,12,6,13,10,3,7,9,7,5,12,16,3,18,9,11,6,3,12,10,3,2,4,6,8,4,4,1,4,2,6,11],"CAtBat":[3449,396,413,1931,2331,2308,5201,1646,232,694,756,226,6661,3651,2174,1064,3828,1350,317,2133,1350,2129,2862,6986,1649,2325,440,4405,2641,4618,1437,2020,450,948,2723,6090,4479,805,5829,4704,344,3015,4739,1493,354,2796,7058,652,3949,2331,3967,961,653,5348,2682,290,831,711,3070,1897,888,927,19,1359,1236,2728,4908],"CHits":[835,101,92,491,604,633,1382,452,50,160,192,59,1785,1046,555,290,948,298,78,594,336,610,728,1972,453,634,103,1213,671,1330,377,541,108,218,750,1840,1222,191,1552,1320,76,834,1169,359,82,665,1845,142,939,658,1102,238,170,1369,667,80,210,148,872,493,220,227,4,355,309,753,1457],"CHmRun":[69,12,16,13,61,32,166,44,4,32,32,2,291,32,80,11,145,28,7,41,7,92,107,231,73,128,2,194,97,57,65,52,6,6,126,128,94,30,210,93,3,40,13,61,0,43,312,44,78,50,67,16,17,155,38,5,21,1,19,9,9,22,1,31,1,69,30],"CRuns":[321,48,72,291,246,349,763,219,20,86,117,32,1082,461,285,123,575,160,35,287,166,297,361,1070,211,371,67,702,273,616,181,310,38,96,433,969,557,113,740,724,20,451,583,176,41,266,965,102,438,249,410,128,98,713,315,27,106,68,420,207,83,106,2,180,201,399,775],"CRBI":[414,46,48,108,327,182,734,208,29,76,107,32,949,301,274,108,528,123,35,294,122,319,401,955,280,376,32,705,383,522,227,226,46,72,420,900,483,119,840,522,36,249,374,202,32,304,1128,109,380,322,497,104,54,660,259,31,86,56,230,162,82,80,3,148,69,366,357],"CWalks":[375,33,65,180,166,308,784,136,45,32,51,27,989,112,186,55,635,122,32,227,106,117,224,921,138,238,71,625,226,436,82,91,28,91,309,917,307,87,452,576,45,168,528,175,26,198,990,102,466,274,284,172,62,735,204,15,40,99,274,198,86,52,1,158,110,286,249],"League":["N","N","N","N","N","N","A","A","A","A","A","N","A","A","A","A","A","A","A","N","A","A","A","N","A","A","A","N","N","N","A","N","A","N","A","N","A","N","A","A","N","N","N","N","N","A","N","A","A","A","N","N","N","A","A","A","N","N","N","N","N","A","N","N","N","N","A"],"Division":["W","E","E","E","W","W","W","E","E","E","E","E","E","E","W","W","W","W","E","W","E","E","W","E","W","E","W","E","E","E","W","E","W","W","E","E","E","W","W","E","E","E","E","W","E","E","E","E","E","E","E","E","E","W","W","W","E","E","W","W","E","W","W","E","E","E","W"],"PutOuts":[632,805,280,222,732,262,267,109,326,307,58,109,280,224,182,104,276,246,45,59,102,269,118,137,670,368,276,623,885,161,110,290,227,249,190,1199,156,235,0,276,468,228,229,682,117,391,41,286,659,251,88,181,42,0,135,281,320,229,367,209,81,70,692,133,300,1182,408],"Assists":[43,40,9,3,83,329,5,292,29,25,4,7,10,286,9,213,6,389,122,156,132,17,334,5,57,20,7,35,105,3,308,440,15,444,2,149,2,22,0,421,47,7,453,93,269,44,118,8,53,9,204,3,94,0,257,21,465,406,432,246,147,144,70,173,12,96,4],"Errors":[10,4,5,3,13,16,3,25,5,1,4,3,5,8,4,9,2,18,26,9,10,10,21,9,5,3,9,3,8,3,15,25,3,16,2,5,2,5,0,11,6,5,15,13,12,4,8,8,7,4,16,2,13,0,7,3,32,22,16,3,4,11,8,9,9,13,3],"Salary":[475,91.5,100,708.333,750,625,900,612.5,67.5,180,247.5,70,933.333,850,325,275,600,475,70,595,375,1175,900,733.333,500,1237.5,100,1300,1008.333,600,200,640,110,195,1300,1800,225,265,587.5,420,100,800,1940,700,130,250,1050,215,400,560,500,191,140,740,341.667,90,155,150,90,326.667,250,185,920,277.5,160,1300,1000],"NewLeague":["N","N","N","N","N","N","A","A","A","A","A","N","A","N","A","A","A","A","A","N","A","A","A","N","A","A","N","N","N","N","A","N","A","N","A","N","A","N","A","A","N","N","N","N","N","A","A","A","A","A","A","N","N","A","A","A","N","N","N","N","N","A","A","N","N","N","A"],".pred":[537.961260728539,487.933176449342,529.280744132435,425.515447292061,576.759591409139,631.589470974026,949.396632993558,608.361592832004,226.194139907648,237.191389605008,211.443763189415,247.78030440152,1266.08517427277,563.464514563441,373.885352348202,153.558300781957,580.791235422017,344.663053714979,214.571633294176,422.287299998319,272.512993585622,746.431475642404,580.761158670152,1034.54931345629,355.554279716133,869.395186386563,360.177463495872,826.91497864964,821.579013911809,668.231677568443,416.980101696334,635.635439700984,104.884366776633,350.378127408055,759.839081985815,1458.70413754216,565.183762394671,169.1777910741,737.792315292937,944.514376295539,376.462069703534,603.474813824322,883.218330840795,497.259502252443,296.196253540107,411.987879813515,922.053994966483,578.060801531538,727.59445616882,563.458880712393,683.629993204259,481.217445858107,237.310385492124,721.386794601218,227.648674743146,61.9418648443724,482.286777620891,476.54005576662,700.997369127649,408.604858264539,315.012046556728,215.166396124787,-16.52332955019,384.756084898132,646.854137352415,1106.04981351353,681.739321505725]},"columns":[{"accessor":"AtBat","name":"AtBat","type":"numeric"},{"accessor":"Hits","name":"Hits","type":"numeric"},{"accessor":"HmRun","name":"HmRun","type":"numeric"},{"accessor":"Runs","name":"Runs","type":"numeric"},{"accessor":"RBI","name":"RBI","type":"numeric"},{"accessor":"Walks","name":"Walks","type":"numeric"},{"accessor":"Years","name":"Years","type":"numeric"},{"accessor":"CAtBat","name":"CAtBat","type":"numeric"},{"accessor":"CHits","name":"CHits","type":"numeric"},{"accessor":"CHmRun","name":"CHmRun","type":"numeric"},{"accessor":"CRuns","name":"CRuns","type":"numeric"},{"accessor":"CRBI","name":"CRBI","type":"numeric"},{"accessor":"CWalks","name":"CWalks","type":"numeric"},{"accessor":"League","name":"League","type":"factor"},{"accessor":"Division","name":"Division","type":"factor"},{"accessor":"PutOuts","name":"PutOuts","type":"numeric"},{"accessor":"Assists","name":"Assists","type":"numeric"},{"accessor":"Errors","name":"Errors","type":"numeric"},{"accessor":"Salary","name":"Salary","type":"numeric"},{"accessor":"NewLeague","name":"NewLeague","type":"factor"},{"accessor":".pred","name":".pred","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"79390458e58fe31eae3a1ced0ba5eabb","key":"79390458e58fe31eae3a1ced0ba5eabb"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>We check how well the <code>.pred</code> column matches the Salary using <a href="https://yardstick.tidymodels.org/reference/rsq.html"><code>yardstick::rsq</code></a>.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>test_results <span class="sc">%&gt;%</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>  yardstick<span class="sc">::</span><span class="fu">rsq</span>(<span class="at">truth =</span> .data[[<span class="st">&quot;Salary&quot;</span>]], <span class="at">estimate =</span> .data[[<span class="st">&quot;.pred&quot;</span>]]) <span class="sc">%&gt;%</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-7313ca9f4d15dadf06b9" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-7313ca9f4d15dadf06b9">{"x":{"tag":{"name":"Reactable","attribs":{"data":{".metric":["rsq"],".estimator":["standard"],".estimate":[0.491469225827072]},"columns":[{"accessor":".metric","name":".metric","type":"character"},{"accessor":".estimator","name":".estimator","type":"character"},{"accessor":".estimate","name":".estimate","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"3f783f50a17c8bd697c9a6a0c4af9bb6","key":"3f783f50a17c8bd697c9a6a0c4af9bb6"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>Alternatively, we can use <a href="https://tune.tidymodels.org/reference/last_fit.html"><code>tune::last_fit</code></a> and <a href="https://tune.tidymodels.org/reference/collect_predictions.html"><code>tune::collect_metrics</code></a>.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>test_rs <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">last_fit</span>(</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">object =</span> pca_final_fit,</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">split =</span> Hitters_split</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>test_rs <span class="sc">%&gt;%</span></span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a>  tune<span class="sc">::</span><span class="fu">collect_metrics</span>() <span class="sc">%&gt;%</span></span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-cd2dbfc686764c46ec40" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-cd2dbfc686764c46ec40">{"x":{"tag":{"name":"Reactable","attribs":{"data":{".metric":["rmse","rsq"],".estimator":["standard","standard"],".estimate":[303.24034707145,0.491469225827072],".config":["Preprocessor1_Model1","Preprocessor1_Model1"]},"columns":[{"accessor":".metric","name":".metric","type":"character"},{"accessor":".estimator","name":".estimator","type":"character"},{"accessor":".estimate","name":".estimate","type":"numeric"},{"accessor":".config","name":".config","type":"character"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"7b070092a68fa9d4a36f2b9ffc4d7a47","key":"7b070092a68fa9d4a36f2b9ffc4d7a47"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>Use <a href="https://tune.tidymodels.org/reference/collect_predictions.html"><code>tune::collect_predictions</code></a>, to see only the actual and predicted values of the test data.</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>test_rs <span class="sc">%&gt;%</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-7c3b1d228ef5a9123f9b" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-7c3b1d228ef5a9123f9b">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"id":["train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split"],".pred":[537.961260728539,487.933176449342,529.280744132435,425.515447292061,576.759591409139,631.589470974026,949.396632993558,608.361592832004,226.194139907648,237.191389605008,211.443763189415,247.78030440152,1266.08517427277,563.464514563441,373.885352348202,153.558300781957,580.791235422017,344.663053714979,214.571633294176,422.287299998319,272.512993585622,746.431475642404,580.761158670152,1034.54931345629,355.554279716133,869.395186386563,360.177463495872,826.91497864964,821.579013911809,668.231677568443,416.980101696334,635.635439700984,104.884366776633,350.378127408055,759.839081985815,1458.70413754216,565.183762394671,169.1777910741,737.792315292937,944.514376295539,376.462069703534,603.474813824322,883.218330840795,497.259502252443,296.196253540107,411.987879813515,922.053994966483,578.060801531538,727.59445616882,563.458880712393,683.629993204259,481.217445858107,237.310385492124,721.386794601218,227.648674743146,61.9418648443724,482.286777620891,476.54005576662,700.997369127649,408.604858264539,315.012046556728,215.166396124787,-16.52332955019,384.756084898132,646.854137352415,1106.04981351353,681.739321505725],".row":[1,4,18,23,24,25,26,28,32,33,36,39,56,57,59,60,64,68,71,73,78,80,86,91,96,106,108,111,113,123,124,130,132,134,138,140,152,154,157,159,169,178,183,184,192,195,196,197,198,199,203,211,214,216,218,221,224,227,230,235,236,240,241,250,252,253,263],"Salary":[475,91.5,100,708.333,750,625,900,612.5,67.5,180,247.5,70,933.333,850,325,275,600,475,70,595,375,1175,900,733.333,500,1237.5,100,1300,1008.333,600,200,640,110,195,1300,1800,225,265,587.5,420,100,800,1940,700,130,250,1050,215,400,560,500,191,140,740,341.667,90,155,150,90,326.667,250,185,920,277.5,160,1300,1000],".config":["Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1"]},"columns":[{"accessor":"id","name":"id","type":"character"},{"accessor":".pred","name":".pred","type":"numeric"},{"accessor":".row","name":".row","type":"numeric"},{"accessor":"Salary","name":"Salary","type":"numeric"},{"accessor":".config","name":".config","type":"character"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"9bf4d79fdc1154221cf984ac93b20df0","key":"9bf4d79fdc1154221cf984ac93b20df0"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>Let us take a closer look at the predicted and actual response as a scatter plot.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>test_rs <span class="sc">%&gt;%</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(</span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> .data[[<span class="st">&quot;Salary&quot;</span>]],</span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> .data[[<span class="st">&quot;.pred&quot;</span>]]</span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">&quot;midnightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">coord_fixed</span>()</span></code></pre></div>
<p><img src="figures/unnamed-chunk-96-1.png" width="3883.2" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="partial-least-square" class="section level1">
<h1>Partial Least Square</h1>
<p>The partial least square regression is a linear model with pls transformed data. Hence, the major changes will be on the preprocessing steps.</p>
<div id="create-the-resample-object-3" class="section level2">
<h2>Create the resample object</h2>
<p>First, we split the samples into a training set and a test set. From the training set, we create a 10-fold cross-validation data set from the training set.</p>
<p>This is done with <a href="https://rsample.tidymodels.org/reference/initial_split.html"><code>rsample::initial_split</code></a>, <a href="https://rsample.tidymodels.org/reference/initial_split.html"><code>rsample::training</code></a>, <a href="https://rsample.tidymodels.org/reference/initial_split.html"><code>rsample::testing</code></a> and <a href="https://rsample.tidymodels.org/reference/vfold_cv.html"><code>rsample::vfold_cv</code></a>.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>Hitters <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">as_tibble</span>(ISLR2<span class="sc">::</span>Hitters) <span class="sc">%&gt;%</span></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">drop_na</span>()</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>Hitters_split <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">initial_split</span>(Hitters, <span class="at">strata =</span> <span class="st">&quot;Salary&quot;</span>)</span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>Hitters_train <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">training</span>(Hitters_split)</span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>Hitters_test <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">testing</span>(Hitters_split)</span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a>Hitters_fold <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">vfold_cv</span>(Hitters_train, <span class="at">v =</span> <span class="dv">10</span>)</span></code></pre></div>
</div>
<div id="create-the-preprocessor-3" class="section level2">
<h2>Create the preprocessor</h2>
<p>We create a recipe with <a href="https://recipes.tidymodels.org/reference/recipe.html"><code>recipes::recipe</code></a>, <a href="https://recipes.tidymodels.org/reference/has_role.html"><code>recipes::all_nominal_predictors</code></a>, <a href="https://recipes.tidymodels.org/reference/has_role.html"><code>recipes::all_predictors()</code></a>, <a href="https://recipes.tidymodels.org/reference/step_novel.html"><code>recipes::step_novel</code></a>, <a href="https://recipes.tidymodels.org/reference/step_dummy.html"><code>recipes::step_dummy</code></a>, <a href="https://recipes.tidymodels.org/reference/step_zv.html"><code>recipes::step_zv</code></a> and <a href="https://recipes.tidymodels.org/reference/step_normalize.html"><code>recipes::step_normalize</code></a>.</p>
<p>We add <a href="https://recipes.tidymodels.org/reference/step_pls.html"><code>recipes::step_pls</code></a> this time to perform partial least square calculation on all the predictors. <code>num_comp</code> is the number of partial least square components to retain as new predictors. <code>outcome</code> is the response variable for partial least square regression to use.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>pls_recipe <span class="ot">&lt;-</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">recipe</span>(<span class="at">formula =</span> Salary <span class="sc">~</span> ., <span class="at">data =</span> Hitters_train) <span class="sc">%&gt;%</span></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_novel</span>(recipes<span class="sc">::</span><span class="fu">all_nominal_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_dummy</span>(recipes<span class="sc">::</span><span class="fu">all_nominal_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_zv</span>(recipes<span class="sc">::</span><span class="fu">all_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_normalize</span>(recipes<span class="sc">::</span><span class="fu">all_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_pls</span>(recipes<span class="sc">::</span><span class="fu">all_predictors</span>(), <span class="at">num_comp =</span> <span class="dv">19</span>, <span class="at">outcome =</span> <span class="st">&quot;Salary&quot;</span>)</span></code></pre></div>
<p>Apply <a href="https://recipes.tidymodels.org/reference/prep.html"><code>recipes::prep</code></a> and <a href="https://recipes.tidymodels.org/reference/bake.html"><code>recipes::bake</code></a> to compute the preprocessing step.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>rec <span class="ot">&lt;-</span> recipes<span class="sc">::</span><span class="fu">prep</span>(<span class="at">x =</span> pls_recipe, <span class="at">training =</span> Hitters_train)</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>rec <span class="sc">%&gt;%</span></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>() <span class="sc">%&gt;%</span></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-bea0ec5770a78e998f69" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-bea0ec5770a78e998f69">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"variable":["Salary","PLS01","PLS02","PLS03","PLS04","PLS05","PLS06","PLS07","PLS08","PLS09","PLS10","PLS11","PLS12","PLS13","PLS14","PLS15","PLS16","PLS17","PLS18","PLS19"],"type":["numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric"],"role":["outcome","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor","predictor"],"source":["original","derived","derived","derived","derived","derived","derived","derived","derived","derived","derived","derived","derived","derived","derived","derived","derived","derived","derived","derived"]},"columns":[{"accessor":"variable","name":"variable","type":"character"},{"accessor":"type","name":"type","type":"character"},{"accessor":"role","name":"role","type":"character"},{"accessor":"source","name":"source","type":"character"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"9027b7d0b22ec875c946c6cd9acfbf46","key":"9027b7d0b22ec875c946c6cd9acfbf46"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>rec <span class="sc">%&gt;%</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">bake</span>(<span class="at">new_data =</span> Hitters_train) <span class="sc">%&gt;%</span></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-a1408d4b72ce1ba1667d" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-a1408d4b72ce1ba1667d">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Salary":[70,100,75,175,135,115,110,90,90,75,105,110,145,70,155,87.5,175,90,165,95,110,100,80,75,155,86.5,125,75,145,75,90,150,68,175,137,120,140,175,172,190,70,190,97.5,140,100,135,105,160,120,165,240,300,305,215,415,340,416.667,275,230,225,320,210,260,300,385,215,362.5,200,400,400,297.5,325,250,275,365,277.5,250,300,300,365,202.5,210,240,350,200,300,425,250,400,250,200,350,341.667,350,425,286.667,245,235,425,385,480,500,750,517.143,512.5,550,700,600,675,535,450,431.5,490,750,700,535,737.5,600,662.5,750,430,657,450,630,737.5,625,725,525,575,700,550,650,670,750,450,750,580,450,487.5,450,750,740,475,530,740,500,750,525,550,700,1100,775,776.667,765,850,815,875,1200,1350,950,850,1975,1900,1041.667,1220,1861.46,2460,1500,1925.571,950,773.333,775,850,2412.5,825,1000,1310,1043.333,1183.333,787.5,800,780,2127.333,875,1260,1670,875,1000,1450,940,925,1150,900,1600,875,960],"PLS01":[-3.98206908795159,-3.64739536446023,-3.41165115971322,-3.86974149910722,-3.55887988157091,-1.96290125642002,-2.45260658094125,-3.52752135021332,-1.49857297416104,-3.55755734480857,-0.312008720707897,-2.0190330682954,-0.223904850996182,-3.82741039439325,-1.50160361875732,-2.52498192442541,-3.46517420984151,-3.70650833893293,0.614183329133275,-3.9613652017576,-3.031881932136,-0.730349321810083,-2.27911451878471,-4.18655117930934,-1.99809087328361,-3.78115559549736,-2.27726035682265,-3.56686870190614,-1.89554248558668,-3.62424603173775,-3.23529927019195,-2.34859489919831,-4.09426993103614,-0.0194680002042285,-3.04558591348008,-2.903763238227,-2.82863312941548,-1.87482264835273,-0.313584907840743,-2.53250344499424,-3.25372279375556,-4.27432707997471,-2.27131929336262,-1.46461040203343,0.871581879625431,-1.65883269593667,-1.97715816621315,-1.05776018468815,-1.71613523966392,0.570226992531403,-1.31712133142743,-2.9226390289698,-2.54282282611528,-1.75236836988132,-1.43278221727226,-2.4684497211697,-1.1571160182223,0.608676469940675,-3.52549669132302,-3.43348646850951,2.10767892597298,-2.02814360747837,1.01102238817734,-0.241957505683945,-1.15165751672633,1.21639240778085,-1.72792972723445,4.88948956016774,-0.0635917642723773,-1.13035982312914,-2.27339238585685,2.08617703795868,1.53490705852934,-1.69464719431082,0.405036766462216,1.22813395346076,-0.831599294201878,-1.46743846088862,-0.3871971350565,1.52777964435535,-1.16664915594489,-0.351630253366921,-2.52574195071969,-1.24391954886935,-0.119102647089656,-1.59049312897749,-0.885547948876406,-2.64814075493416,-0.18940580543029,-2.26215300465522,0.326698011220754,-0.991411410771051,-1.44751941415311,0.340599072707036,-2.49506906617783,-3.18551289695489,-2.75200334392748,-1.00857479200045,-0.588792541831054,-1.19085361673844,0.64233302334689,3.26128891174335,0.917807673626244,3.23558520942276,-2.39899216502924,-0.701668422314292,-2.46585904415464,0.225173468236754,2.06130846536882,7.45106234626893,2.07390141586888,-1.88689422595641,-0.540043747243165,3.25259208511535,2.69438928948591,0.0791290183293988,0.86473271529192,-0.0949602464015257,0.712998309660689,-0.398012912188628,0.670534181366169,1.10101794840827,-1.59185431401124,0.299078933214506,-0.778641308199455,1.05142578610552,0.693744684391824,1.69100648954353,0.549097159785868,1.6500019931518,-0.165384936743184,-1.14315502282936,-1.0900499103694,0.16830000308411,1.15493038962538,6.21810239582927,-0.102240635189706,-0.170497539363391,7.85471627339993,-0.502778069882163,0.312192957566136,1.53916269034526,-0.504302568568671,1.89188989782604,1.04806314230688,2.39324228050122,0.657517822457831,-1.07539214746487,-1.15025100581233,-0.12877778871239,3.32358694514224,5.18614883071239,5.78654542988475,1.04232222302467,2.14307798632957,1.06063138495048,3.42040628947376,2.16715194383787,2.88381087769419,6.29383265527893,3.63408379523481,3.54332127233649,4.53774743189477,5.62317773659968,1.242406353676,6.53749005800646,5.08019317064983,4.5224567220891,5.20293898958864,2.02371877249103,4.04603457212678,0.73908127531654,0.502030413428133,6.73594434397905,1.73464608631595,3.33410944415238,2.64743690366079,1.54045408442077,2.08804878026194,2.46484334051256,1.83216939220997,-0.00540665034796969,-5.09049305284011,-1.02297385544753,1.11038462540701,4.16093998757533,-0.633940482919982,4.02743944271921,5.63423684560546,1.42914496481222,0.886967513017086,0.755527619384651,-1.54620606986183,2.39069831069235,3.15358903380742,2.41014724689757],"PLS02":[0.325131951623139,-1.17277015188103,-0.255138440429184,-1.58366584967971,-1.03147948623341,0.784740328444726,0.318620249634293,0.091544734239827,0.407776905689306,-1.28369405173591,0.748643526509339,0.446533916497599,-0.179334171768243,-0.154830093806892,-0.512334814029217,-0.413157546930716,-1.040610768218,0.602559624369772,0.122518122006564,-1.47336817287604,0.289634104516831,-0.732054188939371,-0.556137712416846,-0.738295242443959,1.42778884550831,-0.279301835580162,1.35726447802903,0.026296159408507,-0.110399055950382,0.233965350637472,0.836795098374898,0.150902935578507,-1.27382378728606,0.614497695203476,-1.024794504692,-0.803434182878102,1.20015402492739,-0.211929001383072,-0.221261752073047,-0.176620490990723,0.255416318937541,0.340233387496815,-0.737273999992523,1.22291712832693,0.428235448826442,-0.662575466150203,0.0123482857318704,1.88204924611524,1.63323321520474,1.7768417791288,-0.237099135083504,-1.40199183056871,0.15498934156411,0.307907715771373,-0.303067412559274,-0.492422654175369,-1.19498812890739,-1.35107881285483,-1.43252696036691,-0.546110343402495,-1.90615903909047,-0.149971391137218,-3.36616135271855,0.798734932127769,-0.0781893130838837,2.3670737658708,-0.27975904592029,-2.67117053848845,0.544693624541658,0.766565050467297,0.464405729809139,-3.3652791260658,1.2598564390399,-1.42272932694041,-1.59304538305062,1.00112757518979,-1.86825964690402,0.128676342831615,-0.83839219518719,0.495063582155146,2.32073869210705,2.61220463930022,-0.411443511634711,0.368541451736007,0.529011117282355,-0.846496025840171,-1.54646748647891,-0.33106264864411,-1.37968201044149,1.45845958724537,3.65712929205978,-0.0940832342262269,-0.38497044175176,1.67500016774069,-1.12928583582631,0.472053302023839,-1.49313560427907,-2.74462038634658,-0.0374491619077243,-0.547123241326863,0.795372080430952,0.619199238575149,-0.56438079751136,0.515143918099728,-0.652527798822898,1.43206902673775,-0.325620792823775,0.908247080674019,-0.523305771307657,-0.310998878457145,-0.650622090833006,-0.84427973078972,-0.0172845040571285,-1.15118036747785,-2.80358397654772,0.0185783590107062,-0.389124237996405,-1.01261120546,1.96211271435265,0.640070337034025,-0.52761020447224,2.2840127663027,-1.57332461548898,0.869113227645939,-1.06820878771909,1.02228706718792,0.273070480699132,-0.110563678579407,1.92681616208214,0.309197055479081,0.488736907742638,0.0170704980599604,-0.651944647272118,0.424780036553851,-1.69197732444089,-3.32420821676563,1.5814648966541,-2.17522606283016,-2.99940867720941,-0.280039260092794,0.365616043596634,2.05427220278649,-0.00226929078882603,0.9812181421936,1.38932520408246,-2.95512804528074,0.887669554513344,0.928429920540237,1.45988906375594,1.71538717971394,-1.08610447805424,-0.672942633676901,0.679558747711737,1.68929359917391,-1.59354468887439,0.929182576771639,-2.36461960009065,-1.05229864588672,1.22741557901604,-1.04603200745554,-1.83716294187727,3.22175308644214,0.00444301406707017,-0.435977553253164,1.70592932339694,-0.14525161105848,1.30381154405636,-1.64542704277346,1.39625463842226,-0.637993500736015,-1.20436310477623,1.12113374877001,0.209601170284269,0.436240176045934,-0.771743743737647,-0.390659447061577,0.968901654741918,1.52660691722586,2.81503240151636,0.946981385768169,0.216016328821865,-0.704765400384659,0.131366883538045,0.796854544004696,-0.14238252063776,1.09472818038641,-0.285818440395815,0.344726198629662,-0.205547867145606,-0.489451115303243,2.05116054342949,2.43647427324744,-1.70261786525792,1.95374254225946,0.482475052974582,2.61493067999773],"PLS03":[1.82263548183891,-0.80591979661759,-0.638914005231144,-0.750992006576368,0.69215715212464,-0.00208669050798783,-0.119086974148479,0.715506755604544,-1.38956166116684,-0.419960570225568,-2.22140913496834,0.26378810478002,-3.27687132915175,0.867806023102605,-2.91161208232148,-1.36513743300545,0.642220938761676,2.41024144078474,-4.2025128638377,-0.304925224559061,0.548187205389415,0.457700735938994,-0.873736059889832,0.836231560110291,1.10713883164765,0.566128608941483,0.969030102149977,0.136228186554445,-0.397981773072263,1.17859658397108,1.69125027350801,-0.998075003472932,-0.236213307629779,-2.13758835190005,-0.666601777588404,-0.488749455596562,2.02508850919645,-2.20072591153675,-3.82323276865517,1.11743719056013,0.490682264330027,2.37010985182208,-1.92307725437526,-1.24237932717296,-2.10075846010819,-2.55723611915837,-1.30595405904906,0.382364615620511,0.238274249574529,-2.26523719600549,2.03791835555494,-0.154589362484301,1.45251600896531,-0.951873506225265,-1.42885978942378,0.675670676781565,0.152649629289331,2.89036308334433,-0.58405026200371,0.481315633565651,1.42891792413622,0.0563696510819177,0.395932808346716,-1.68778935964242,-0.030219340818245,-1.46923733427318,0.420533179372496,0.899499037383389,-1.25531376726114,1.08517129064285,0.999703075904753,0.851598623050015,-2.59091161636743,1.08080319756017,0.791293463178529,-0.812768555527902,-0.210562971670814,-0.00250651614102134,-2.12830357402784,-3.70236144201963,1.43950658355204,0.847044148423617,0.376594797308299,0.559169660248753,-2.04935562925188,-0.878178292179759,-1.69487807081467,0.701862364619679,1.637523387735,1.37498521357384,1.09251345378831,-1.64327282721225,1.11604532347137,-1.30589312902285,-0.134193308761962,2.46695960229053,-0.417587662211965,0.210568395838477,-1.48037973651171,-1.34563767570822,-1.30020187970989,1.65437063994247,-2.06699583654458,-1.51941868539967,0.642589062216269,1.02558429229937,1.44086630054552,-0.0983301502945916,1.32729381765329,1.11426540051217,2.60954915397401,-0.825503094077195,-0.487408670858352,-2.14429097728053,0.379031921262553,0.109048036206323,0.179606922175615,-0.22478942641947,0.601197171601439,0.814544255725045,0.922573161387064,0.984755902679778,1.18981737739627,-1.57162604681514,1.06916496224709,-1.89276647132094,-0.192833233486677,0.484882558695253,-0.57014577367868,0.389849466952996,-0.797945825167442,1.48018375865299,-0.568686547522355,-1.28228342883219,0.025076661686589,4.08814142158649,1.02938895715026,0.0291412015917703,1.28443958191165,0.101215936766909,-0.603828091839061,0.591085331778964,-1.94018568602556,-1.16103407035361,-0.908535959358109,2.91622970346293,0.188624419288355,1.8023919243738,1.2773515815554,1.82102592560847,0.953371629724688,-0.415113042472178,0.958422861720248,0.706276497409192,-0.0459787408827764,-0.379168091630346,0.0331427249073856,-1.9945207438582,-1.37885515432278,-0.202979588187183,-2.43446449548908,-0.714798010698613,-0.759514027732834,-1.16482714023311,0.000394675238322658,0.601756803040148,1.94758826090793,-0.781972611848353,1.80610898937987,-1.8558544006802,0.908867758817995,-1.06253342629545,0.332253587470226,0.79616162491774,0.537012220382789,0.725933269804598,-1.54960681945098,0.826050498845015,2.22858194429514,-0.525434705911339,1.44202238468144,-2.09771469186398,2.81294430774262,0.937164055885351,0.131191191422574,-0.86566150893951,-1.17695348046607,1.95280714071317,1.66475829689414,-2.16258896533653,1.60562316641713,1.74387305481609,1.65838725727278,-0.550121291857225,0.413391635177517,1.51152523814004],"PLS04":[0.751697747208582,0.795518186984946,-1.02316912555698,0.603402075728602,-0.907542807068101,0.676458019119564,-0.696272534854154,-0.409253500773532,0.148355917143184,0.922503753466893,-0.230518679384574,1.08557875556259,-0.226240249933028,1.18350295033421,-0.168765623519586,0.621757764802982,-0.963514595053712,-0.0958238975303104,-0.711324514809061,1.05051460229936,-0.124286948118185,-0.814363724780383,0.780926771975328,0.504623705275534,-0.701875681016311,-0.310277618635142,-0.519194643024283,-0.464012570320227,0.537044020904365,0.0366091395829704,-0.378894262056052,-1.09019442159971,1.13304709717012,-0.136689829216766,0.77237387452516,0.842196668179387,-0.138459949063326,0.402752691125747,-0.474217476502573,1.12628101959684,1.15009536253225,-0.302773387198787,0.353304658449078,-0.762507131369383,0.00977797083330951,0.0800789791232354,0.918672755484395,-0.68849276367266,-0.251512384447353,0.599902091480308,-0.992947353894223,0.735920942137535,1.26337221450189,-0.895418506880354,-1.75344455136766,-0.530563770611928,-1.3054462508209,-1.24510315464499,0.761337277682702,-0.634170097487123,-1.08937854780962,0.412750179627712,-0.0242350358639222,-1.28380017274691,0.0673383835099171,-1.1355663279445,0.69378485770336,-1.36462014288851,0.78950437782667,0.292956417857499,-0.865066175083372,0.669228726022835,-0.227703619981902,0.270844736134197,0.0323950867346825,-1.70502807135473,-0.803615123405531,0.536646342110203,0.108097778494277,-0.209535868309877,0.0142129001941881,-0.278175514442963,-0.735971760700769,1.08565819750942,0.697021570020403,0.796001033691482,0.288119787738331,0.857241181689813,0.58933495682228,-0.401223985416295,-0.339787669591882,0.616466010603504,1.08968108787213,0.632878192868619,-0.115627385215761,-0.300322381045602,0.673311197523824,0.335086006441379,0.74815468786718,0.586106191979027,0.865945312152173,-0.212393608457588,0.0571822847077883,-0.150371639257177,-0.927429129123453,-0.629193879617287,1.15316431968096,-0.697917987835812,0.946292067781058,0.174489660530844,-0.93262561807203,0.601077059617474,-1.29995164515618,-0.0609369677913153,0.901708263798814,-0.897939334802453,-0.853238860309702,1.1292986796939,-0.641465668311761,-0.847280058771072,0.599595424808433,-0.238074319366317,-0.833409005397695,-1.24409355455504,-0.608569151363404,-1.34284909906246,-1.01477483209219,0.472597332499578,1.02179694882232,-0.279727325872265,0.315547010550456,0.127171431812039,-1.22313309114971,1.10985524286491,-1.55450588155789,-1.05976486225668,1.41497847038792,0.529335745440255,1.45194115255724,0.382608094268241,-1.18135137415035,-0.503241037146161,0.503219792219825,0.192837586574915,-0.71099203334059,-0.378896805686027,-1.12022996179223,-0.492298497565444,-0.514851057850717,-0.0817201294456574,0.586818774665682,-1.27653988866824,0.886871158026318,1.30269851060338,-1.40946375368804,-0.630259672885172,0.522783611083515,0.246754290736484,0.622704014264504,0.239006787800718,-0.445799497601597,1.10997893792743,-1.06233733075669,-1.34344920901049,-0.949573129841349,1.00836715538059,2.03357862275553,0.718273365319513,-0.502037871127556,0.511887473619786,-1.19495371187691,0.595718851451202,0.647967791521808,1.84368183797328,-0.497151284905015,-0.528283377409355,0.628168664391299,-0.767012632709248,0.0118927119609461,0.543273283904248,0.399010214775336,0.0704215814707913,0.0936343667449334,-0.472497619517512,0.629772249002449,0.0785736534975797,-1.46687636376304,1.78377318325054,-0.211812861462539,0.172647827648079,-0.353765972763266,-0.0827017509234194,-0.702914231142575,1.21783948399054,0.301148356332412,1.76927082130019],"PLS05":[0.191277552201109,0.475981565976884,0.775615946311057,0.302221451835839,-0.145816196531197,0.741215953671803,0.258070876381148,0.538880873321277,-0.977324916811934,0.237881634120895,-0.80785484262939,-0.381616579870767,-0.523148873756751,-0.131476364585823,0.163936466981666,0.456327851590751,-0.254252151280738,-0.116597898176779,-0.837584112854045,0.423836620918129,1.01833784671304,0.324325594786364,-0.105291619738407,0.400412359022637,-0.368233465119329,0.797782422509322,-0.124594473308688,1.15329244373904,-0.91969516597777,0.938395755476848,-0.235987226558552,0.907520326494739,0.446094771718423,-0.72129534661729,0.150664336619356,0.119204713481827,-0.165692762910105,0.710382461169305,-0.553642107513745,-0.571835688039126,0.0504932166009837,-0.20632540305573,-0.127937753914022,1.16820117584436,-0.464287912225636,-0.0141673962274303,0.607504133431088,0.340159194811895,0.758982015236007,0.185729945783813,-0.930713309137061,-0.132325688822526,-0.56515830449158,0.966516200370143,-0.718251854067204,0.455072237967042,-0.0426478793694699,-1.44119866208364,0.44531374967755,0.644957633894133,0.319093092646297,0.54297039483888,-1.10193854301219,0.00629907508390016,0.0755048767762016,-0.0299067180292919,-0.466666739693149,0.55984518585662,-0.0659492835875458,-0.501113901318048,-0.0318275503139902,0.227846727747174,-1.34567920120434,-1.78573097133035,-1.84046992175936,-0.50936600479748,-0.459001780261106,-1.11654028370004,-0.57574482808649,-0.472663901528178,0.138447784463821,-0.0537075502009679,0.242166467575723,-0.379108261068144,0.0480749648511938,0.167604440866233,-0.154216678646001,-0.867169905997713,-1.23423680374369,0.29963366269547,-0.174740532956884,0.593073602839885,-0.257508638789306,-0.131476137099619,0.00227904558757226,-0.497239414833307,-0.0826029440301565,-0.448738127788532,0.535040579590683,0.0685540265609946,0.45976041268716,0.727026555009375,0.416762075179065,-0.636447090242457,0.0576882889662481,-0.311715759134938,-0.440613335998952,0.263332717643492,-0.461349993162629,-1.76248703909728,-0.778798619558101,-0.173776679245261,-0.504919799124782,0.280664597561273,0.875141192336719,0.880677446931085,1.23913501503246,0.607107303037684,-0.262659506836333,0.159725794785144,-0.757944105559893,0.632938666268067,0.0389769314294042,0.0676840067483656,0.624202241135952,0.138006771438188,0.26441945005913,-1.28589580426225,0.145795476569304,-0.877064009062944,-1.05980418537124,-0.437112396136742,0.0628781111661091,0.520723030182115,0.303431631560736,-0.322188617702167,-0.19536171332292,-0.105244524449394,1.53816339427015,-1.08863232963508,0.609200230176817,0.430198197725372,0.448402187865732,-0.565984306092308,0.517831164244991,1.08060029738794,-0.0363029848851393,-0.239300659323545,0.130056520029349,0.143189845134702,-0.920951204147871,0.729780418753653,0.0304911817843042,-0.524781337137901,0.791472268664805,0.766101196360314,0.148863362741518,0.224220329050449,0.299446749714877,-0.71430835794525,-0.223296154085797,-0.237920005452014,0.577020298382592,0.784910230400157,-0.395150747590511,0.245737011199648,1.19869379935628,1.35067934132265,0.0219373538277304,0.469166419873748,-0.0629379155059314,0.0802694385038917,-0.522818750941623,1.72765003496853,-0.875693868638193,-1.02202249405919,0.119278043594532,-0.452108636087284,-0.000232020141961882,-0.793101944377452,0.160918608770107,-0.409826973686425,0.436842285932599,0.447143629584267,-0.227908464569074,-1.6162506232639,0.747246581983157,0.565615509922377,1.43255654207472,-0.214945204532138,0.175108224168096,0.513665000852879,0.103228513531834,0.721791392651017,-0.911463118920729,0.0830432815662294],"PLS06":[0.391914492087805,-0.650424615624803,-0.369033099778697,-0.638200037779584,0.434183463553587,0.0509599625850418,0.13692474491852,0.0118433275498068,1.02366949182631,0.36118780737701,-0.0472346312535833,1.36806931852611,0.926713478970077,0.45907495064652,-1.24385298713519,-1.76999943601324,0.342225303889365,0.835345977980326,0.777297090611031,0.680772753870164,1.0551268096575,0.284044649998926,-0.367176732690769,0.115850358731411,0.416591022944049,1.13434821709566,0.959020402544779,-0.185789776925379,1.48262849229662,0.563710424170107,1.3185095752676,-0.781797889043002,0.48191337198975,0.385953254932033,0.0420177218295488,0.00530338206356524,0.669697791600153,-1.68274002798038,0.892758345434727,0.330285999682676,-0.153872558004598,0.500748523288972,0.676456090502986,-0.856903820193595,-0.899573025370934,0.0652455837098946,-0.833677612018263,-0.953402497023079,-0.443329219556905,-0.736925344992801,0.0160268198874402,-0.299479470774955,-0.208106237989038,0.115655015321135,0.746695164652605,0.666152428071554,-0.381782220503015,-0.737255890579818,-0.656319230356852,-0.192852875795279,-1.13118201859693,0.191274090988438,-0.729515701139799,1.29126706935472,-0.0740712740571111,-0.148442885471405,-0.317476985086482,-0.414127842863715,-0.94567321482509,0.462138064209714,0.463784791388602,0.319842616927095,1.27841879863355,-0.0643154242958407,0.148308780013698,0.384052186343815,-1.19927455366856,0.134181978223898,1.12172537368691,0.890225333318289,0.739193720753329,0.120134312204332,0.470618548694633,0.463959315477234,0.246850870583427,0.232050026233795,1.31946504029865,0.566824935422163,-0.127901184511101,-0.884604794772688,-1.09889473460244,-1.63363067895531,-0.0737050640269692,-0.945739612473071,0.380487785773184,0.385989847986015,0.217445061189316,-0.483190845965649,-0.796564634586889,-0.591350842049524,-0.500750027471996,2.06680888560947,-2.09277964534081,-1.06267125156662,-0.425749102238492,0.746246242422869,-0.47360710145514,0.108849786778941,0.144740232979875,-1.38539067764812,-0.409591865479876,0.0177812368955112,-0.0595980424808114,-0.343491478239129,1.01669483267525,-1.76511913022651,-1.09669834801192,0.427229709089747,0.827861443345749,0.790015394621818,-0.59228147743598,-0.185746758743439,0.412856883858136,0.787160951008959,0.239239275655833,1.12669173539634,-1.02338065141162,-0.360130440556291,-1.33604519084408,0.85944231962264,0.672760889635446,0.13372498582761,1.02403470071482,0.431065149972621,-0.675424054916215,-2.31143684668619,-0.828389811117185,-0.33838342727125,1.03997558091251,-0.253591401807742,-1.76288343546026,-0.0502257097685899,-1.37157782853404,-1.08899741095835,0.327713213167388,0.352593699739451,0.39623200717823,-0.250388487326597,-0.870122426423864,0.53152776485052,0.426279275906051,-0.0195335876943406,-0.584079201934632,-0.738085195861578,-0.290581625145106,0.392310681640504,-0.140589037346982,0.527815011976687,0.233944142349628,1.54491094938425,0.179049817696745,0.371511815728073,1.07631251316643,1.75267689931801,1.65774056822343,1.3218929035325,0.190760996497337,0.399499638660018,0.474336334116987,1.06308214656559,-0.454880186412173,-0.55178183076046,-1.20357745847279,2.28627028749071,-1.74863037372711,0.590875020169682,-0.379577811704691,0.466929989796036,-0.358114627495842,0.409956818090083,1.31149316041379,0.0354503037772105,0.678328196146428,-1.3965816182112,-0.1715528429284,-0.319265103392229,-1.36250784739731,0.522773909032399,0.329354777858997,0.300801863251597,-1.2823086372311,-0.452927693500095,0.142156567799473,-0.219113081691445,-2.7041068890536,-1.67928345960399],"PLS07":[0.701254561730328,0.155947711639749,0.599351191484024,0.56556849765723,-0.444415175365191,-1.39515654792133,-1.21400418751371,-0.893947252968404,0.905120922993145,-0.207593701651286,1.61108300188489,0.630720744025226,-0.169466178589256,0.795927575559145,0.921183331360758,-0.0105591710375642,-0.571200583037206,0.0888109670392901,-0.189137498615344,0.0361173559698917,-0.492734784136538,-0.646502390051606,-1.13323634333323,-0.784985394138276,0.208937869059923,-0.226243211265154,0.480900245400827,0.20839038083269,0.54851474861153,-0.856570947617768,0.392715318079418,0.675039208548686,-0.321483351090146,1.67616578308545,-0.332335012347248,-0.376715739149777,-0.241170455690046,0.465046484708932,0.104754339845171,0.231700660784541,0.873012598947079,0.437207727043334,-0.313003357736632,0.1783242971345,-1.00727882066686,0.282936181381002,-0.179640585640672,0.668555948496681,-1.29518292791439,-1.05489451084288,0.642994000509785,-0.503912211061314,-0.172288550341481,0.427928726337273,-0.761072872632959,-0.689197521682801,0.174235995835908,0.0858310823232158,0.358928540201526,-0.0365777371493158,0.2682920196457,-0.800344072908044,-0.987824778680782,-0.34578332723463,-1.11803767399482,-1.41908434047083,1.1071117182938,-0.183699928919733,-1.62549835712401,-0.0416807279365851,1.50215279510457,0.000329376232137279,0.258823440210078,0.166448989082917,0.376639362487483,1.54858550533555,0.36293407981156,-0.110075177039817,-0.281201485969731,-0.381309198237684,-0.403209161225134,-0.654569349026131,-0.67925291804336,0.13931975572472,-1.17801159864806,-0.648438555387492,-0.34952574932121,0.283948795275719,0.469189061043913,0.748481547972505,-0.816795561049761,-0.0814319210758833,0.769082580843821,0.81821834107834,-0.424624643813649,-0.19549928999766,-0.281696060653325,-0.0189048683134825,0.0017748095855933,-0.530498164730257,-0.833394480288405,0.692726159843417,0.958463758533848,1.78833403608323,-0.36230128035274,-0.00908539019746922,0.581752833704765,-1.37466443288938,0.0472995450199634,-1.85656621622367,0.259249123500088,-0.607939724258126,-1.2354418751632,1.11501688076801,0.379913695114606,0.360955844308944,0.994149697464197,-0.541173504818551,-0.383373956760111,1.81625634254691,0.891108514249341,0.822115190282197,-0.485299797312181,-0.760930671556902,-0.288845732085132,-0.526421395036479,-0.438931942664656,-0.179796873707413,0.632159710375388,0.0263552647423968,0.353161802834257,0.513241178488895,-0.318558464183298,-0.861056750014559,0.891562956720067,-0.375729708681541,-0.452105401534795,0.171618480876638,-1.11184208493392,0.633384022335977,0.295114084920911,0.812440249229054,0.0888731151379895,1.23747783279381,-1.0323986589465,0.129072423968939,1.16351684165962,0.144702577664025,0.886100772319803,-0.341412536489477,-0.554112649225028,0.576036539485925,0.715659348661002,-1.00285366756381,1.2388145664993,-0.814621521657391,-0.91045985040299,0.155970183117162,1.68748051726722,0.303775814701858,0.414206191990134,-0.452276522719915,-0.942154778384841,0.247461508797522,0.176460967928961,0.322760684418991,-0.0180162079496955,1.42567548802417,-0.599766303051164,-0.239392635524428,-1.00049132708248,1.44654744901596,0.818923849132887,1.08752649559375,-1.9597270066968,0.615952994913894,-1.14137015415839,-0.515437283833109,-1.13247536067961,-0.223214228900234,0.505961014578048,-0.512497452871951,1.20057841583355,-1.30613646737805,1.35933576269597,-0.599754206704318,1.01777781063148,0.359113795254758,-0.678534510834623,-1.01229421076105,0.168175507368007,0.0713471416746253,-0.460821367127785,1.56169492106155,0.697324934410434,-1.2840404921874],"PLS08":[-0.119312499774634,-0.445749154390149,-0.299065542504494,0.198219074739116,0.506316838701639,-0.206949879180856,-0.685418699422532,-0.0323573671638829,0.00606054480813328,0.281995791556254,-0.105746688196093,0.599586459343951,0.304406629484639,-0.144531221609135,-0.196711156885781,-0.658096032137975,0.294545267939236,-0.142744368787215,0.277298305931898,0.264517141728184,0.202019013528388,-0.352091760265381,-0.475261136797876,0.258534500244892,0.109756879923732,0.303811854736722,-0.0289885182196798,-0.257299588485799,-0.116851371346648,0.203583301868279,0.28883655178775,-0.282798008942864,-0.039420969451006,0.142700731971893,0.262089089587375,0.793334487916437,-0.261098391008914,-1.0278603301077,0.23486837423875,-0.0392832742447322,-0.515239254873001,0.0512232314198676,-0.0196814688154004,-0.597159200913327,0.775412592726035,-0.122290390591326,-0.131020524909075,-1.4096402161873,0.446896577634174,0.867266560173226,0.440690582437438,0.406343755789632,-0.139011267838912,-0.228651561924002,-0.315653560465806,0.0399351052856977,0.142381918551426,-0.20527886173356,-0.054474462323898,-0.122754411392638,0.271240380886249,-0.00968399435256476,-0.282964266054367,0.772182952356129,0.470582433111997,1.0584310445498,-0.138062525782309,-1.31013456078192,-0.381009390625224,-0.0556680780272335,0.208094204365157,-0.0497124152664966,-0.482072269729097,0.122332469993795,0.241993525653362,-0.0819349264534662,0.525000872682871,-0.57420393911035,0.836852277786576,0.335534696203883,-0.158566190430945,-0.693594889014683,-0.0533902858365512,-0.229893989276471,-0.1659568048382,-0.16981272755773,-0.300347420275477,-0.212783861623508,0.45497689905436,-0.600743980029413,0.646909014424313,-0.774143949048023,-0.174638264197744,-0.876099178183509,0.133388207432265,-0.248045489787473,0.555229549210809,0.418911919027255,0.0871209698128665,-0.42740633770599,0.823380042201501,-0.205258999058987,-0.0115453773791695,0.207758985894266,0.461306945023673,-0.24660636593115,0.000124806742489951,0.222158946855727,-0.264081257588584,-0.857431744529548,-0.136180359027271,0.485549921251402,-0.144745636744575,0.651414759817184,0.158795626849648,0.0492972555340063,0.238680111358648,-0.0645515089328195,-0.657334084097555,0.520580587604695,0.50480574557289,-0.150673533028812,0.110289330177449,-0.106237918401745,0.00395007251271705,0.307540490359503,0.0221192998317631,-0.146977321293946,-0.602172791705924,-0.45150121981706,-0.0673457189157393,0.105160063369124,-0.012433842561677,0.276914360312784,0.265328734585335,1.49787598775506,0.0984520018783954,0.689557555123333,-1.66022039043867,-0.0065067192006059,0.014473786550816,-0.346318100755925,-0.428845709819963,0.0384704911779749,-0.0652116781247822,0.104444792564226,-0.499525782942165,-0.532238340228019,-0.185855607986202,-0.404848860643709,-1.25392791725731,0.355511711799824,1.02709103249962,-0.437569430747923,0.270847901733146,0.111540747559604,-0.880681442499544,-0.149026729159148,0.109288008032416,-0.776338477060241,-0.278456794216461,1.2003708135309,-0.496157276136897,0.211439231647864,0.0413552973431357,-0.373431993689984,0.448930910756964,0.927546227713063,-0.189215400626855,-0.133694138402718,-0.208016298574291,-0.404819536217475,-0.175813149534622,-0.328628346291555,0.0523878657285075,0.35432460538396,1.16254137738869,-0.932063398769919,0.684435159193634,-0.292169202463156,0.275387617365735,-0.0126549348593116,0.266963841631705,0.429881818026678,0.0753330557953513,0.194489949405151,-0.379357901801631,0.489204583247325,0.743700483069091,-0.584072322429516,-0.330223570746982,0.373214081656812,0.291024475009136,0.65790475807095,0.359450588383074,0.28631858203707],"PLS09":[-0.195170535507809,-0.259358091030468,-0.817564182832542,-0.42101014647297,0.139454216585713,0.810713711158696,0.123029366774898,-0.553882961282838,-0.942289227501672,-0.0021517619661773,-0.773914036656641,0.437898053527934,0.221141692841225,-0.953044871382713,-0.95154543849449,-0.307235649120714,0.342699367890108,0.0411359655670862,-0.753462343435906,0.290157459331698,0.941960212047733,0.0848392498282621,0.412848221469941,0.0157526988360934,-1.33449240887913,0.44719785535337,0.0120915373375613,-0.291052500635305,-0.0410709670044427,0.343976465562151,-0.219619399956807,-0.790657035259542,-0.0225364389656146,-0.600189200773202,-0.690225039412815,-0.499062831346622,0.158736088166006,-0.955954390147206,-0.432710155528812,-0.178394584242185,-0.763277177065489,-0.744122414355073,-0.366410524883041,0.264490567746308,-2.50915354073156,-0.144448110290474,0.670596491687775,-0.634022674576698,-0.7212440518751,-1.21332401400355,0.214162260776309,-0.521941731569885,-0.334332091771084,0.0910493091785761,-0.295186774837708,0.334038443545098,0.274336017688456,0.0400925644645869,-0.402056950994076,0.0598557116549351,0.402261134052709,0.646813367716972,-0.35154822792931,0.652613201230181,-0.720447924373733,-1.04622089590395,-0.334024060293193,-1.50660925850656,0.54804853778861,0.332077519028923,-0.803398100288949,0.155880824030402,-0.349943387288287,0.272752239034631,0.498900150037191,-0.447048834234822,0.341504756980137,-0.625057005035814,1.48000170575492,0.397210297888628,0.9026380011672,0.645429717479758,0.0331692474758857,0.0627533038154232,0.86847427632022,0.262316927084893,-0.153907713925627,0.126681117516858,0.0916532273034765,-0.269012114161611,-1.40911956767032,0.00691212703226163,-0.0235262286537481,0.343773087861794,0.310448876128489,0.160309545475103,-0.305124095584708,0.0938356480911843,1.07500454262586,0.998012280887442,-0.589526409902723,-0.123399778325827,0.0675965956938411,0.0780323081177686,-0.108495024853446,0.0173457569577776,0.295940714680245,0.551913125699212,-0.43630231236544,-0.881338103070816,0.44624307951991,-0.562860365657208,0.447932263325054,0.393283639540629,-0.47005476696857,0.386881462439986,0.232421884387591,0.518991995697449,-0.0919072351791456,-0.170973610529646,0.294879762858897,1.3588280788275,0.454705386693956,0.59770189300741,0.0702500028856561,0.369689061891529,1.97452742250919,0.807821959964062,0.826218284071002,1.01036094645314,-0.24892393500912,-0.692981766362389,-0.376112239370623,1.77675042303231,-0.517479235972019,0.802258836227257,-0.504959841835427,1.05723386716324,-0.131497717797818,0.50115020524352,0.339015560019664,0.930816068567565,0.732237461151757,0.206504966340046,1.57723749474478,-0.668773069841305,-0.704641018678446,0.344307431661721,0.532539661346729,0.283512551832758,-0.166386743683257,1.23188933836756,-1.33240581498022,1.07765344109424,-0.595830096063617,0.845538127224692,-1.17385158302236,0.780215638837054,0.56473455480947,-0.0823153306135245,-0.523917779462488,-0.474306435907577,0.121544735980609,-0.212317819607386,0.0135778168249236,-0.319227715411117,-1.23219793594697,0.768897487674601,-1.53013963001498,-0.135143228174695,0.628862417978535,-0.106902471195409,0.257089814330044,-0.350155901456648,-0.126093300360054,1.03996550181129,-0.986844304462986,0.350544227490442,-0.850675771586402,-0.153249132467976,-0.984942107180129,-0.181532281764531,-0.290336104193632,-0.280824407969151,0.143489236429486,0.910175889917092,-0.889361877488577,1.37293367198524,-1.61985890205165,-0.310501694701538,1.02632032124854,-0.71796405970265,0.65170348937269,2.06251026151663,1.19588251860085,-0.921777303046332],"PLS10":[-0.288910407484565,0.289690968132501,0.269406939174569,0.0768066355665611,0.444280276498119,-0.206189082718341,-0.0054647953086457,0.0849790250460425,0.0187814950336056,-0.0828138347827422,-0.110580441002527,-0.0279463092939174,-0.237606264799225,-0.278123129270798,-0.0391580161645688,0.149973233969095,0.466386056288675,-0.103331756573424,-0.59258564157625,-0.0319448643015435,0.0288781589418061,0.0844060608388379,-0.103235735219083,0.322346229495851,-0.156235296269948,0.0190587308076616,-0.083163216677374,-0.268373273007628,0.117170686868907,-0.0575773104455134,0.150224565286243,-0.218376990412676,-0.0392072032399332,-0.201047060243213,-0.0612079562229096,-0.208138183124027,-0.0297564936646237,0.0779895767229047,-0.500114951560876,-0.259618190108743,-0.404794849015547,0.045610918092427,-0.0539861811385204,0.23987674899911,0.160295577206195,0.0608288008322215,0.197451309225323,-0.289889899217878,0.107172918932611,0.160517622440785,-0.157049466191478,0.18333836243756,0.115326726239732,0.14429935992238,0.130705138943975,0.0267545476091671,0.192634622651358,-0.0811028749936446,-0.0876949827786798,-0.0621243578264541,-0.412086954017445,-0.234170809538578,0.439317052247676,-0.34363789924795,0.217214523834883,0.126969993359266,-0.0456746253251528,0.147528926221079,-0.628275724193916,-0.394653072208981,-0.258447771494079,0.084599097730638,0.0332865629693704,0.458833957538341,0.433488969461729,0.307892572061698,-0.0112096593131622,-0.236979849305051,-0.182348555991284,0.313677157142689,-0.243652719128196,-0.0889788287461277,-0.0172838724819516,-0.167715495210936,-0.361874515234094,-0.14329232161331,-0.0140300391695107,0.15039519403435,-0.287156663831746,-0.10210695510222,0.08350895962731,-0.42894050193128,-0.0861731958261086,0.734763715240474,0.0747703283007597,0.0326394420247558,0.156244393420874,0.59595306696979,-0.409849409243708,-0.178151141015013,-0.186722137288416,0.122264851284396,-0.0092860660941949,-0.204947224899351,-0.0499653735005885,-0.100120610351055,-0.00718332484170183,-0.0342929895001613,-0.0563257560816044,0.308562801172675,-0.118316471782156,0.177846074246088,0.0212932289260482,0.314794135579133,-0.0295884221050556,0.00583739481426335,-0.211627220878023,0.174262810153899,-0.146465085465781,0.0816383392734677,0.0409441921641657,0.487386301555096,0.176573029358126,0.413948452827543,-0.121587162697013,-0.149364003036544,-0.0298590847686237,0.22861280805741,0.0471159742543394,0.482405769337613,0.0625178457656433,-0.371882224142199,-0.0436201904858157,0.0119176277851948,-0.399684572074429,-0.455582266818001,0.443523558460931,-0.066075555631046,0.149627695675554,0.110119764664078,0.347903894843805,0.820293179264679,0.19232275973908,0.352385050137206,0.304197051789936,-0.149296850652905,-0.139073588421519,0.108413513225468,0.214394568867018,-0.37816928295604,-0.0504262457563325,-0.251131851820739,-0.292908632389975,-0.42904310102916,-0.101592313484283,-0.305927349176597,0.363496981524892,0.18276631535945,0.364171902300819,-0.267547711040901,0.138882290065889,0.91668175416254,0.217472448906212,-0.0827503003979454,-0.312398774014297,-0.432878664759901,0.260270963234841,-0.167613995333305,-0.208291454158558,0.163426737677976,-0.0498866166892223,0.193081372129959,0.347926017098284,0.087880433271077,-0.206783405860415,0.487960118394692,0.0747264189973567,-0.122566009764248,0.195117039453017,-0.560294250701026,0.139771935412711,-0.0212873759582309,0.252929115847849,-0.0532061031653931,-0.183907661364598,-0.513948369350495,-0.286046930072551,-0.135143773276537,0.215254520772399,0.0591165005143285,0.138991059311968,0.0205152892625918,0.062928230991173,-0.138296261177485,-0.312532122888513,-0.291260990394765],"PLS11":[0.0192024942314122,-0.361856916942132,0.323378252992577,0.627723266670229,0.216623908258163,-0.135070745227591,-0.298617889617042,-0.171716265038225,-0.174522795652811,0.0843939789528229,0.602901564938256,0.293473601166426,0.146924545493476,0.354165910118134,0.315036392324756,-0.164995027942104,0.192672004223471,-0.086755444418032,-0.0103890495554869,-0.1221162362179,0.337882409404799,-0.211907198020062,-0.20666086461707,0.054737203793727,0.124463735134741,0.128134770384622,0.173868859582937,0.273468786917963,-0.291006357392988,-0.156113497034052,0.0955633883083748,0.453291909888646,-0.0986348243711016,0.349625418294601,-0.034135609510544,0.235410123881837,-0.107328343453716,-0.513302626985555,0.216880664289105,-0.224005004319741,0.160224462213844,0.412626541710741,-0.188696641050589,-0.0853899887054393,0.233406948169992,-0.0985235853637235,-0.474340223774534,-0.41062454945003,0.0411355570103691,0.0230512333028616,0.0588930042507119,-0.193796067605412,0.0532644082746762,0.725643480267475,-0.547119340782589,0.211963150846125,-0.83888308335602,-0.464416591951884,-0.108309559257575,0.229852465344094,-1.14836660725064,-0.0278145526588217,0.668787069908998,0.223508942115995,-0.0345959481358225,-0.199063806140363,-0.253477454059377,1.00292266435186,-0.19081160182947,0.1872489001673,0.847494070280729,-0.527357752647111,-0.68241506487399,0.458985419525357,0.433514063856324,0.625398903330349,0.548125846584882,-0.611803254313528,0.620860778436212,-0.44786866831082,0.0374002830005108,0.345653311477524,-0.414735658277041,0.453527528873864,-0.244785549072145,-0.0267214127186106,-0.233083664497511,-0.179706161372365,-0.675621697711334,-0.134348623244668,0.231459231481239,-0.411164860758032,-0.389281829875199,-0.40123913249396,0.269615218498234,-0.113494362135389,0.265674999614516,-0.072483365968743,-0.0347689847644202,0.0033551867219672,0.656118209232822,-0.39939766823511,-0.324419875608951,-0.075298687478486,0.303537032978921,0.322924385493614,-0.0508260722518929,0.141004009558011,0.0412735323255976,1.0798532756409,0.720557575263652,-0.486984035263037,-0.159346611011355,-1.30553592466005,-0.254674938232329,0.332712341162272,-0.641318141715595,-0.253316514903612,-0.69830683598328,-0.0276581419813873,0.5922056666785,-0.872670018249255,-0.170145074244742,-0.0361229738080733,-0.139688235380119,0.0919203914752281,0.313356253944655,-0.197865808375863,-0.276371533572772,0.0959719348845709,0.0370358393437538,-0.0414249447295608,-0.0845694852326751,0.371934649224237,0.45572437062909,-0.512836147227222,0.100373486089778,-0.408012706314755,1.65761390394684,0.0619163121843694,0.142140199117944,-0.684492328312737,0.0736511219311623,0.117377399861882,0.0511553063030239,-0.375132326921,-0.0601093572955001,-0.654623438945822,0.563344714074004,-0.854888589372294,0.718527569366983,-0.583994133192284,-1.70243284417769,-0.195631981637862,0.697655024764498,0.620587298768182,-0.163306370944902,-0.638446320909331,-0.00287432898808032,-0.477045873511669,0.0840737459031735,-0.108567314910256,0.855826183165099,-0.338495879745879,0.281335981731504,-0.056815603216473,1.15103986444046,0.816343542445437,-0.301232192360188,-0.334587403247958,-0.0456530302273868,-0.315612853872684,-0.697208958276017,0.183019082272037,-0.517161606498963,0.138419672370551,-0.0204512042555009,-0.285915409010861,0.191624952162223,-0.458364460295714,-0.154173041233013,0.00282894147758724,-0.054135387517304,0.991007979549918,0.239360494220077,0.498747791644215,-0.0411218575928956,-0.34643589181676,-1.45522875481142,0.21697304914342,-0.232057469075722,0.540157215681043,-0.215373566589604,1.46646028017201,1.09165792484957,-0.0801608703934384],"PLS12":[-0.230419299841381,-0.161520639742387,0.266197994404483,0.17895147054238,-0.277448027945965,-0.379512600771834,0.580121081404118,0.0482464277818334,0.181254117201307,0.0291323382862711,0.257416857390758,-0.52030949595985,-0.0995644470290258,0.501463464347457,0.120880553790793,-0.325322060459546,-0.108088126051598,-0.190298019405109,-0.134746561233926,-0.405519208869557,-0.0450740912469438,0.521651511053508,0.367765135496799,-0.272307002517007,0.127009021891575,-0.04534713940841,-0.0146878587984496,-0.0738163738053373,-0.141141236153896,-0.42827981410052,-0.201082373696583,0.142708255044572,0.143968086205134,-0.734420705489582,0.105635779117122,-0.501518340271959,0.0555076290271214,0.379553493825381,0.0775706301614943,-0.052625547372643,0.135409554418645,0.289468539778669,0.254227316183363,-0.275865697971072,-0.121714373982647,-0.361812965578353,-1.33618137694844,0.206860646896278,0.333792485251964,0.16580641407794,-0.193186620355625,-0.0808560350804387,0.12619415561104,0.761073255368678,0.0610927466262648,-0.36690837659918,-0.155136535393237,-0.47809242783877,0.044537728362041,-0.0647758607848861,-0.278185181480838,0.440153797334517,-0.223903876250395,-0.608116043645231,-0.489392700243313,-0.547224697526925,0.126740223373769,-0.332422336477304,0.298834734113214,0.0423842303698914,-0.0261470011152172,0.191954150089498,0.703292277156144,-0.136133307723094,-0.00145002139131257,0.0558746553669802,0.430241319803354,0.291615939490598,-1.34608754468927,1.05644518953848,0.0383201059119245,0.842609032167289,0.245385053291076,0.0536512316978805,-0.0843961026415234,0.109680693074961,-0.586007638202367,0.242095963685263,-0.065541418993973,-0.543901263707489,-0.0805277575714775,-0.364170901972254,-0.109183828013187,0.52124111817412,0.197483150207099,-0.124677146101864,-0.214965406614074,0.51942824288825,-0.919773007043442,0.27506582006335,-0.229369049787999,0.249073735521404,0.703095197357238,-0.430872750522027,0.128399655039304,0.196115831220112,-0.00378839296014978,-0.661527278127819,0.2775835948896,-1.20637545670025,0.329067409226568,-0.00753284942495024,0.247480202100042,-1.05257551107998,-0.10295411233526,-1.13093995988792,0.396919250268624,0.501381527778888,0.327834746419317,-0.158980340912769,0.776002655611709,-0.93582437450773,-0.0808854364342456,0.899408267454455,0.456561552992479,-0.017003537508799,-0.475477279537406,0.786337179343559,-0.406734972908731,0.172900636067426,0.453551665140276,0.254154906936702,-0.19913307088939,0.143560024659311,0.628748623893898,1.28860683907826,0.976942743905129,-0.040735712338597,-0.864217971558811,-0.496242792239196,-0.428368588156653,-0.674849484740757,0.198667611636727,-0.357626123391363,1.22982030610958,-0.106516304657065,-0.599188458754416,-1.01313950706437,0.481882628375704,0.43348203468435,-0.613224804135527,-0.7200928998268,0.276285742985567,0.604854403699805,1.0398826257157,0.0989262830975897,0.420885239307458,0.292726568929507,-1.10270953594667,-0.55179200265148,-0.600933189348649,0.52669511466476,0.0697323582117316,0.375309615710848,-0.679275969024014,-0.309475087154817,0.0964206788694556,-0.134994776614543,-0.727230037395337,0.543861282272049,0.535260889831405,0.502692904652569,-0.0362527349014719,0.667517061051106,-0.744344957138629,0.893722064587873,-0.600372117738798,0.401929424121494,-0.475303257917237,-0.0673768869933642,-0.903181229273937,0.579827395752892,-0.839059736939044,0.220902396022793,0.656908063079383,0.152678738353512,0.541264405601199,0.611433287058769,0.341469441672415,0.22183676150748,-0.745292169665617,0.695763664960904,0.183147256345484,0.465676638254373,-0.114183759228127,-0.195441858943998],"PLS13":[0.277729464993636,0.184337361288972,0.189812039934174,-0.113516809558212,-0.0786415229945852,-0.177832387055595,0.0142212222818123,0.159679082317922,0.143201025301767,-0.0376860442334584,0.0684515207649085,0.0200446241094645,0.139650274552826,0.0499742323687751,-0.0340847498192257,0.0870714301995154,-0.00460802182998078,-0.0128726978344679,0.230182331817069,0.0483161866043202,0.138589342373035,-0.174405377599222,-0.0700949922600078,-0.174361844693737,0.12152375095311,-0.0186987429500891,-0.0332831740906479,0.0768381328215522,0.200748683512274,0.126975091980411,0.164545529652367,-0.00291056245551593,0.0711162261094533,0.0332479603107243,0.109135317667171,0.0858966644037066,-0.00100328955854865,0.191336602735558,0.0719364320580427,-0.164667408388017,0.0517766883994323,-0.0103430483269365,0.156645087576658,0.048302544319008,0.102365316084619,0.17354790412828,0.197839744798512,0.196486370761693,-0.125215591477101,0.1452441702748,-0.290958501379231,-0.100853570587111,-0.0536027980143153,-0.0949781623764986,0.226506264092082,0.0515513104549924,-0.0855903175208988,-0.45229977601638,-0.0471977985070184,-0.0692062769172154,-0.397223362615071,0.219856490830246,-0.0426552581089195,-0.254925688100134,0.474635320666227,0.0424355121923811,-0.0175805148872436,-0.2621683458142,-0.14295988143082,0.218723854771732,-0.105640020881139,0.020498413784214,0.0174388317900158,0.000863880379662198,0.000349520331102671,-0.0611725854113202,0.154452208748923,0.0123146908651755,-0.134653825294363,-0.17447438005095,-0.163369841391746,-0.250229547072708,0.098179295688657,0.0331580674338758,-0.272075240983882,-0.0487269404702177,0.172685476649553,-0.0327479353675633,-0.125111271517596,0.0277029347224778,-0.0581030036228586,0.00907372157916229,-0.23087912216003,0.0152610026318853,0.247761791980179,-0.0381006514613481,-0.0180770492676712,-0.208422215654529,-0.0951866473831143,-0.0193166541055288,0.0464436556739566,0.0601020549547569,-0.319070773708867,-0.133636537481108,-0.281679254546135,0.158693621925662,0.119612957684546,0.0433705589999291,0.132786032762764,0.100569580083025,0.107748198590143,0.0420968296453348,-0.00961483285613825,-0.143289790001723,-0.323603244343609,-0.0144463641084565,0.162591335087189,-5.30113822265436e-05,0.0696980606760799,-0.260629475022504,-0.30264750956154,0.25674767536238,-0.0178921417986346,-0.02789337486929,-0.119216061514407,-0.056325280816445,-0.012082598685992,-0.225881168748527,-0.144856666424718,-0.325411622105577,0.00667687754381525,0.105633738637787,-0.0251182688687778,-0.154982833672312,-0.286190168870437,1.16298731136987,-0.107116635939457,-0.026138300471458,-0.0860740414967733,-0.0695900173899743,-0.0011928495723872,0.540524540785935,-0.175036216819385,-0.0536945436298239,-0.191489879398298,-0.310951901468826,0.0136223727193559,0.193426768307731,-0.253266731807662,0.0842252130567939,0.178417184918507,-0.196154385498658,-0.193235092620198,-0.00148808330397491,0.14598188109868,-0.0477008578846366,0.291818307962211,0.130424888871709,0.120273427247746,-0.0386532966556581,-0.0480610980885154,-0.110034776903839,0.0720190067695472,0.138442177355274,0.106834396595852,0.14211089293576,0.202058692484188,0.249073991260187,-0.132686577964954,0.0660285743893965,0.195503956575614,0.0472585976290318,-0.135657040811514,-0.0703655327438631,-0.468304345406577,0.0635778786337914,0.0225432299107563,-0.0390040331967751,0.0286534854849961,0.0156725078015269,-0.510857337618932,-0.159334102473002,0.1007897744729,-0.192520838603266,0.207985892723155,0.248543496347434,-0.249934921030541,-0.101584495366817,-0.0547204471022751,0.0916599091744557,0.443112239947513,-0.247264570446276,0.190740754277414,-0.104381101582531,0.294981328050302,-0.17855232165188],"PLS14":[-0.315866605598097,-0.00645803595041156,0.0590551192508931,0.173875119354832,0.201711712162246,0.367422360111161,0.0980871224542003,0.0669623607425783,-0.137542237864087,-0.067683400362685,-0.0153435479446805,-0.163224302457056,-0.0260188942169328,-0.0868537473625621,0.17995050102705,0.263467391067036,0.300151905861165,0.0469097553867264,0.0642408579376031,-0.0809244825589527,-0.189753440396451,0.114852548883391,0.148027179536113,0.454692765616501,0.0236945745812603,-0.111961258235014,-0.00472339265995728,0.0595130539551213,-0.131162035833843,-0.03689202807099,-0.0534368238037141,0.12849561816614,-0.107973256783274,0.0811751935756547,0.0352976803655576,0.0390814372991713,0.0507168604950746,0.0622013338030427,-0.0116826753927851,0.0556996052645056,0.0200203223278293,0.109920085182816,-0.12068991827841,0.0333327495009821,0.100336194583469,-0.0121147988740842,0.139732440240079,0.0770323048920067,-0.00300220839206142,-0.159644764577221,0.213937972391197,0.0415156953460024,-0.0263449013485247,-0.151274070030602,0.0811537565040081,-0.0892131575587572,0.0637946413475961,-0.826717088392668,-0.0203891837369035,0.0418088115276186,-0.430767595923118,-0.35875684999022,-0.296690492526129,0.169493123350408,-0.450794655960745,0.119408737258857,-0.0160527201724676,-0.280098263542241,0.175149427241455,-0.223501351954372,0.0504499644968856,0.0342946169820288,-0.184403309724008,0.318812680120297,-0.140467656390121,0.0330929568338858,-0.236321843895222,0.217290669978265,0.201879749436455,-0.382710569839297,-0.0337132017484602,0.0985576006154147,-0.137474474303065,0.0280836863888289,0.0490423413619226,-0.061399379701723,-0.0126112845545576,-0.0930918723715055,-0.289927694153304,0.131048984474048,0.152787329419929,0.0862246067068913,-0.0514004997670648,-0.193112914264204,-0.395545210118876,0.287254608481739,-0.00559314999807359,0.278758135116683,0.109026117617371,0.00940118921414702,-0.165119558489979,0.0784802595155361,-0.0864094793946212,0.109749113392465,0.0886739836591559,-0.11885290936789,0.0761959574410424,0.0404334924909292,0.0228206722745863,-0.343018718629776,0.0683692258169938,-0.0738930860568521,0.14941013222403,-0.0646571066688778,-0.00321232666857671,-0.027855900984444,0.165809346329681,-0.102158666636305,-0.158743579630785,-0.334824916351266,0.181603824366499,-0.250804460113835,0.0166864874708129,-0.148109053939689,0.0219815984366738,-0.146944176058278,-0.0579259319610342,0.311208833479458,-0.0317699533760542,0.472966752909139,-0.0303928574655373,-0.376034711310245,0.0771565205588144,-0.119796898715,-0.0647098508053846,0.144714851909881,-0.204743402324041,-0.165084839084366,-0.0359755263165728,0.124844704597651,-0.0284842254979095,0.053546631744496,-0.0231530115917756,-0.159255269748606,-0.146637799718579,-0.173169536712692,-0.0778609579748198,0.049603818522338,0.104780129020224,0.13972947647865,-0.144523950940339,-0.251620419246047,0.0345219313612707,0.0390237883841185,0.0981963039638889,-0.106674337521585,0.437756630219391,-0.0330310751318339,0.0925497951071881,0.282382868564564,-0.0484674427347054,-0.270541400572207,0.173700143893232,0.283214056330539,-0.0188144198510384,0.142718673472835,-0.140563365297895,0.367627667311803,-0.0587028995122336,-0.275581115077461,-0.211014709543482,-0.164982766612663,-0.00751635627104072,0.0131228476568585,-0.0458176061826413,0.612361581281522,0.00815787776170303,-0.0426692225442974,0.056677230472309,-0.0263664920020717,0.390066744568476,0.16097315332608,0.0392339137808207,-0.0837017556059692,0.158893151516127,0.443958286114088,0.0264929061928632,-0.0273897464391043,0.27123710985951,-0.195974380051172,0.0868744175088332,-0.127995683716791,-0.000332349820679433,-0.248621203331062,-0.00432281084591394,0.219719020902309],"PLS15":[0.739373217209155,-0.0795027112466321,-0.0771889517390141,0.120445910458557,0.27850525002799,-0.900360274247053,0.121414718454109,-0.0407382881743951,-0.186999937226001,-0.115466237343494,-0.209015876046625,-0.242122347594151,-0.186162331731139,-0.321735402820863,0.150412699554277,0.202541142155643,0.362990237204936,0.022558997599086,-0.237643187687898,-0.0745446950583022,-0.339135971180846,0.291095619294257,0.147904652435606,-0.753178514940819,-0.14945936778111,-0.0367669323893085,0.01666463250569,-0.0821383784138844,-0.237935178497614,-0.0999822750332038,-0.165206007607297,-0.00883991920330641,-0.177728278410799,-0.0242067064299959,-0.123786612518727,-0.152684041379394,0.0183123937287764,-0.0224455947706686,-0.186550799241968,0.121899753825228,-0.199729076775631,-0.00042502159479608,-0.221376505511535,0.152901653675044,-0.124174848953296,-0.143193087782227,0.10783071566095,-0.106069453900693,0.173448014552272,-0.218504971654067,0.223590205091717,0.0538240155060895,-0.0378359799363269,-0.118161515658765,0.0278854352188961,-0.119786932509131,0.0685263619392081,-0.354201667260334,-0.0692231621976278,0.08330860152649,-0.0553123870889034,0.765541364069105,0.0708796565400653,0.429339297442866,0.588140387275606,0.229266479056112,-0.166749094712338,-0.150819784681006,0.21384254319969,0.887308554733145,-0.065257591950381,0.153546922782649,-0.031054040354575,0.318799555927024,-0.0282129629061988,-0.12970849839418,0.787489286351131,0.13180342539056,0.206170049098623,-0.0361427626673767,0.10208539156874,0.207056740106592,-0.212346949678126,-0.199623763349509,0.256496676499399,-0.0891999464916923,-0.21085341779526,-0.0391343555444653,-0.282373515092825,0.0345622874992423,0.183897748073613,0.0148204204247899,0.0746047831481177,0.0483679710680592,0.65542240847276,0.292723026868454,-0.100288215958293,0.3434828682431,0.153324837843087,-0.153394313294772,-0.274122662194339,-0.041119040893422,-0.0972074022188185,0.368957477793777,0.201527080947468,-0.294332323273885,-0.0706613129682821,-0.0478218551863203,-0.184845464085852,-0.0132034097088576,-0.0591565219683718,-0.0656144537684322,0.251541902830666,0.0493764529359556,0.226506045222842,-0.076447559668775,-0.234362267935625,-0.0797135278101164,-0.222118103235718,-0.0835071781851095,0.0770685965414215,-0.195623438900117,0.0420254820951083,-0.0673915316636088,-0.013450726457267,-0.108741378312443,-0.0868757399140749,0.413835051676464,0.187113555501332,-0.605563268608566,-0.0112881597240395,0.633967527436536,0.0979861418154867,-0.0543617359886398,0.00309487257986691,-0.569705024558269,-0.054649066466032,-0.249192816177104,0.101489739229308,0.213221358579622,-0.0795704349989431,-0.0871947180961841,0.199169516178361,0.0737156594323848,0.148765298286837,0.334887287383079,-0.214204102269442,0.0486533250394644,0.335948582094319,0.0558545836866933,-0.118359533941124,0.0270489361769237,0.0130642537633081,-0.0399440821550812,-0.115554208463302,-0.273873705311645,0.191690461661452,-0.0387263268321351,0.197828816629404,0.358630873748084,0.029658130322793,0.1822969269948,0.153998962167315,0.245317550650508,-0.0781236721095555,0.16536212798305,-0.246014017634588,0.245271822987174,0.232497870971441,-0.291907186365281,-0.159131387674545,-0.0532760857693708,0.118770334302521,0.0979982106639813,-1.06639504752168,-0.632684106879845,0.12067752215881,0.0301967352013266,0.125122199565726,-0.0893643197402603,-0.586482995394697,0.24731012001854,0.0865918928003926,-0.158338431621422,-0.169301443272587,0.466880916200367,-0.00801237726195237,-0.0800032921896279,0.33766230521956,-0.3689135141914,-0.171134331199566,-0.221099405852954,-0.138400573434432,-0.170195570931986,-0.205692427863324,0.244662494476873],"PLS16":[-0.0674273914287874,0.0630619201893026,0.0499538495599536,-0.00375143861245401,0.0154317177711352,0.0906503759612491,0.0196419204748183,0.00300620084136011,0.0347217870591072,-0.00603572650580178,0.0752787715546152,-0.0609769280316218,0.104676572961691,-0.011564990641162,0.0909417357326816,0.0332236771429277,0.150558158166461,-0.0308780603056898,0.0897412425315615,0.0719253788461456,0.00559867105641512,0.145369113213112,0.051133925266453,0.0626326726051105,0.0519626444313376,0.0379998477955454,0.0237631806853885,0.0800900303095731,0.0123549084149117,0.0374155702108434,-0.00851655551666257,-0.0700632967687231,0.0118672143655036,-0.0447312084445653,0.0137885854350873,0.00545967051775855,-0.0645649604512045,0.0856186931882318,0.0173505633544035,-0.00131567150480918,0.0181085153207909,-0.00410035449779832,0.0380440101680309,0.0544871610162247,-0.164468686876216,-0.0402318251429576,-0.0102668829289882,0.168941701678874,-0.00371066442977537,0.0632507365494106,-0.102957361726375,-0.0427545046490353,0.0466148526803648,0.0608464540951996,0.172428662819913,-0.030398992503949,-0.15409802409252,0.00614551536410812,-0.0163663039713761,0.0291601739722156,0.13372148281425,-0.105038399297879,0.335741266281139,0.0207008907023024,-0.147339986753269,0.0187069875980999,0.0233516061001947,-0.336935737655931,0.0965377009481252,-0.186204892766534,0.011775988809885,0.422938613911786,0.117227248868769,0.126938272893725,0.124353937225162,-0.174849735989455,-0.198994516353583,-0.0269880412143298,-0.0353907759108233,-0.0231085803694282,0.0101691148382238,-0.0362689759919162,-0.0995407668584626,-0.0816142535427411,-0.123062672735951,0.035468773435955,-0.188892914573326,0.105427180518269,-0.205769809371791,-0.0156186638665994,0.0489541871920076,0.0498890643822176,-0.0299719705617396,0.0405189565935538,-0.0802334586390335,0.0799556386772884,-0.0867269574842607,0.0144023240001717,0.0938552400277078,-0.121757892916798,0.0717771440499598,-0.320632812133083,-0.260145588580336,0.0724644774834779,0.0817534209490622,0.0255672809345924,-0.12434024401662,-0.0926477515581784,-0.161783923927974,0.0358669146214802,-0.354257254981308,0.00421198679701856,-0.0742174768159046,-0.322920675026113,0.0145983770264695,-0.0819976492150357,-0.23452286293,-0.00114819789051231,0.0116596872641325,0.103276304528495,-0.220435707933044,0.0735084384105256,-0.0169780638613106,-0.0849663996838765,-0.100735038833829,-0.0188042066444927,0.0597694841714447,-0.147026351133616,0.127419080072775,0.159876278027217,0.102466066260778,-0.162725627190563,-0.0447407695566168,-0.110674886340098,0.104903799754791,-0.0440450461224502,0.103955873320534,-0.169040698727531,-0.275146199401152,0.139159171880395,-0.166253733431228,-0.178232182499258,0.124355568882746,0.0415196988978757,-0.00194269409236147,0.668517983026934,-0.140467885635586,0.0733627254946901,0.0379735246588302,0.0302476176846651,0.195668258674177,0.021670112767879,0.018357381516151,-0.0895678150500448,0.194252148066986,-0.0962975336336411,-0.211734391631654,-0.0625806131124139,-0.0948763325460478,-0.133021067603646,-0.00305787836926635,0.124000708989191,-0.219680965954905,0.170358460183621,0.0347559309059727,0.242507995089693,0.11082723374639,0.382394184519599,0.138324667815404,-0.000463882826557109,0.514129433068231,0.236474164675285,-0.0794593512287989,0.0509606072606364,0.0377177084126908,0.0328742155036909,0.0991774544708781,0.266162125699621,-0.0246477334423751,-0.0188443745181079,-0.136556213072471,-0.0281574313072894,0.069564797085691,-0.0155450083212568,-0.222217822510838,-0.0129271307318381,-0.190354880749592,-0.31626785228807,-0.0321444649733835,-0.256633194230298,0.178195517844925,-0.174771164186857,-0.14612708778124,0.245176345146698,0.0598507241125568,-0.0752389887645235],"PLS17":[0.18927837545072,-0.0362073187104308,0.153289527952487,0.0861931163240581,-0.125883524840594,-0.159182471852095,0.118602272710096,0.109605812587706,0.358202245746136,-0.0326653104871091,-0.179318307020029,0.166370171894092,-0.291896626283524,0.24873854214069,0.0411168637763785,0.194969802479499,-0.427983062258733,0.289894795356722,-0.238863974400249,-0.0850144716803199,-0.254153401699715,-0.153965506255261,-0.113815646049647,0.148834936581003,-0.223900480976827,0.0362904779521766,0.159513583245622,-0.115331324910176,0.0912022430010234,-0.144508862298238,0.153258630830302,0.35617994854298,0.195303717336824,0.548229714127561,0.00301211985636983,-0.0988267258663126,0.279177389765389,0.011010359208292,0.235849162019051,0.226263304037571,0.225152157882266,0.139058543568594,0.148857898544394,0.205604316315943,-0.0326135164232594,0.372148274352326,0.361784298767631,-0.132529213064063,0.197973877643416,-0.363683298380077,-0.197959061169428,-0.139494465836823,-0.10439869174993,-0.109351117380369,-0.523355105263807,0.243931407718496,-0.374640107058642,0.103087554148067,-0.0157697730441051,-0.0109883156314792,0.150127820525978,-0.0384884538843153,0.259131935216897,0.0877064909285082,-0.0565882771529796,-0.0769497473046507,-0.341736039384033,-0.195772640176813,-0.419839790853281,0.149895080455168,-0.0899267618795338,0.324522002990224,-0.323984674192916,-0.248797071072295,-0.26339696322259,-0.201611140812824,-0.292750412016369,-0.0197013159445684,-0.133481710437528,0.373633870667784,0.0346243093221676,0.145055137148652,-0.125578711212662,0.0147937062568403,0.504230206870421,-0.22242087199726,0.0708576429146421,-0.2723054011988,0.00160372198165995,0.116842406707968,-0.246320695849551,-0.171346642108723,-0.0151980392616394,0.254721295235652,-0.00698563565043513,0.0182720442172695,-0.0670869406257947,-0.152167893988377,-0.415156809132068,-0.275877547140852,-0.0229802150672271,-0.120061230442275,-0.260068339553019,0.222552829668385,-0.243433074361006,-0.0185214024392332,0.0813843995714301,-0.057033613738751,-0.00960095533746807,0.216484305147397,-0.391365725468524,0.0296534595842107,0.141556291062861,-0.267268721831625,0.0373496618411855,-0.0857476456339839,-0.0949389810201138,-0.395752605336379,-0.163479074165394,-0.0418050839179645,-0.27026464383311,-0.350515680615427,-0.228915845027025,-0.00412666766151611,-0.109406397082289,-0.188262064592284,-0.0622437780462394,0.0346172774336665,-0.122599521395773,-0.340150956111147,-0.218196407926239,-0.0820776290474299,0.137316752882711,0.134908605117303,0.0165951718987437,0.2339268608784,0.079527846716674,-0.124723345269746,-0.0354347666842285,0.0441556070943487,0.142853427245788,-0.00883578557011246,-0.231392415383661,0.0473578497238616,0.39870483529237,0.414913989527127,0.0166212773328104,-0.119971062446971,0.0171509247001221,0.21941737063671,0.0864721845379742,0.285658675135925,-0.310706548027188,-0.108283546891427,-0.0468286259467541,-0.273912987883272,-0.258017910848844,0.261549140693333,0.362790906918549,0.138676376274978,-0.293161796640564,0.054463775027558,0.316432619597956,0.00148479014191995,-0.0974257200533216,-0.124327622622136,-0.0842461801434908,0.0696805091599947,-0.455250808259867,-0.017434138639531,0.0511538250531737,0.00988808061690653,0.317913525621364,-0.435794978190845,0.383471702640225,0.661501700816963,0.174004579276107,-0.0683424745076478,0.287612856728628,-0.0305417273917607,0.0495698691524192,0.308294810031358,0.136225363625052,0.221452754412905,-0.243479376530621,0.51933405231111,0.411048851266098,0.177877914208402,0.223419253931506,0.19983496936334,-0.18569852988961,0.130895346618214,0.0370428009129537,-0.117987435224952,-0.108425564291033,-0.159993616653619],"PLS18":[0.17183546048063,-0.126283506178229,-0.118780571899888,-0.0666519021831693,0.011987958016281,-0.1075925935517,-0.110790158444158,-0.101977030689788,-0.125066537352237,-0.145491110665416,0.182706402646374,0.158527103804326,0.151309736749649,0.0852391143085159,-0.1400046988248,0.104006045811266,-0.041877570575707,-0.0108980207914913,0.186092069158432,-0.35739266274619,0.00130046415946584,-0.0877662805062319,0.0712883704728997,-0.22914015167346,-0.0978833828541293,-0.437153836119714,-0.117501615941026,-0.21140055837578,0.0861075792010956,-0.232894446318039,0.000286613902897876,-0.0776927345848588,-0.150441600335397,0.287238171471694,-0.0419899849813287,0.0380589979103168,0.0815765952293137,-0.293314711764636,0.141686831203473,-0.10487036797135,0.11820190565431,0.0319129956307806,-0.0943244081098918,-0.263390134502082,0.272872256172429,0.188663896579363,0.19652590823906,0.127745594399573,-0.457251406987926,-0.227764037584686,0.205770327261269,-0.0303946479186505,0.111595804343959,-0.1815430864334,-0.131882325054049,0.0614987810339608,-0.0355634749700516,-0.282737119689933,-0.228867965346873,-0.344880433400692,-0.158559750842886,0.0896920561764329,-0.252588758667197,-0.500152407848734,0.2296678002241,-0.285176729795732,0.254204408821217,-0.287674270858711,-0.266867829709115,0.0187410644353073,-0.0551781813533625,0.580269539251013,-0.417073681487543,0.332773230330644,0.0396295379823698,0.582669952516941,0.297890230388583,0.00246207736939515,0.355723870075064,-0.422567653980499,-0.190723734091663,0.154180373349895,-0.3163778065704,0.433593872082567,-0.116450282878926,-0.00336099979060505,0.211646095237003,-0.113483757523066,-0.248922018950836,0.193019375780504,-0.0619506395450422,-0.0951508402765632,-0.15163911585993,-0.147577636419183,0.62026558535307,0.162505013511844,0.086734569879412,0.479252502360564,-0.201029575787753,0.208856132565855,0.165203825821822,-0.0597408926191699,0.036355999635835,-0.605504629940965,-0.0543065999429906,0.21131874471745,-0.189276484096886,0.371654875188632,0.168803863720078,-0.383764982210866,-0.887947534034488,-0.0736366639931298,-0.342391670858135,-0.0579700997535105,-0.0365600881541789,0.125549024986026,0.370490071574219,-0.206846687217684,0.21289394035796,-0.265363326099502,0.363543767172291,0.00844004344247439,-0.0672413968547067,-0.00117717531788894,-0.0598201605115429,-0.0715365419525423,0.582822338067305,0.251163789860437,-0.0786170275914233,0.293986824005531,-0.0847159944982209,0.544111986794868,-0.0713659203780696,0.194394948917426,-0.107002151893746,-0.695728611827752,0.0353396727158919,0.0193819143315127,-0.263617496402031,0.277435809198667,0.352825909201743,-0.0996356644477479,-0.286022729235834,-0.350736218413092,-0.117961251311665,0.0861191021023165,0.296017678861011,-0.00524675300155553,-0.381706284993752,0.115965593302933,0.182883579557949,6.86272280228741e-05,0.557639880274528,-0.0656227358061395,0.173617011951292,0.351211723101853,0.0167503382686118,0.0936169159748432,-0.160677661063671,-0.000138123653784838,0.0298935874774648,-0.41287524632303,0.102787067330575,0.249556325999924,-0.038655888967625,-0.103911633585827,0.108897249912866,0.171254740762172,-0.526692938351181,0.142123082269478,0.530464197741914,-0.159147016327545,0.316906969850104,-0.187355192946379,0.362355181475962,-0.115284076612436,-0.00725911117854796,0.534222354023413,0.124513218540948,0.012022462820705,-0.414395442621407,0.0271358906374384,-0.452243473767016,0.66100475552443,-0.279884696637283,-0.80222456275194,0.0382393217744804,0.056047588568356,0.406354802651008,0.361671723032093,0.574528190325039,0.58908282839247,-0.243405211789165,-0.0197685121739998,-0.29596187803863,0.0304235767358988],"PLS19":[0.0322376790246071,0.000339865888233969,-0.0166234001775782,-0.00876959260585027,0.028827014548436,-0.0178200282836952,0.00849805417755105,-0.0124248699197871,0.00636003037926614,0.0049590483287433,-0.00498926951363205,-0.011770463180932,0.000457126239437238,-0.00525005560081064,0.00420364421106883,0.0181401208476182,-0.0289492060258552,0.0144341399130541,0.00350040472367752,0.00746392672874395,-0.0331503871993294,-0.0280724643358947,0.0277282644263989,-0.0301789359819194,-0.000913993797621944,-0.00407419040705273,0.00457962959224865,0.00374767807988842,0.0170157710677062,-0.00537852992913154,-0.020904258715199,-0.0105850513454726,0.00585162655560008,-0.00777697494757608,0.00456292178759634,0.00527682290848788,0.0328487389141517,0.0189161577570555,0.000308263464812706,0.0400507644221818,0.0169423804578777,-0.00669729891403363,0.000576296018861538,0.0203992496075982,0.000465983996814859,0.00635433554692464,0.0314801176672319,-0.0116813112632801,-0.006024647738613,-0.0275806893452899,-0.00300293096019084,0.0078230687687328,-0.00131973538689852,-0.0019152479816124,0.0190887922976212,-0.00120167576765992,0.00454186459312734,0.0500653200260747,0.0204167508014948,-0.00532930373400761,-0.0570279491865259,0.0164841212103864,-0.127271648538896,0.00433239739578618,-0.00178284624299282,-0.0139674332391405,0.0115056848495033,0.0287295879030798,0.00137819254032266,-0.00667489323372036,0.0085576954338077,-0.0366454869597114,0.0252032464226122,-0.0199064296403068,0.111126371243432,0.044785621794265,-0.0937290965485674,0.00754768239305549,0.0366343428516564,0.0199084770534144,-0.00116992005539761,0.00336293128241746,-0.0172172150568943,-0.00343236215275351,0.0426647096875543,-0.016298644047137,0.00434879196040389,0.0207399362803862,-0.0240691526455297,0.0529778078977751,-0.0181677187168473,0.00686328438103154,-0.0502743833387232,0.0283536969924201,0.00806697363953063,0.00448662664227497,-0.0216463219945814,0.0174866147942171,0.0236353668715752,0.022183330603216,-0.0113286814992065,-0.0603413941153483,-0.0633890841931015,0.0408003541713847,-0.0166152145334671,-0.0542590183368408,-0.0266120938185096,0.00421914495534109,0.0292709069898375,0.0279366944932752,-0.0192645549160533,0.0365283394360855,-0.00612701255495338,-0.0816007093682582,0.0229730175354089,-0.0604932624432539,-0.060653674023312,0.0130972715869779,-0.00542910894336516,0.00859430631741606,-0.0122495754715499,0.00228510490587482,0.0123599989960946,-0.0579837593504244,-0.0255744506161166,-0.0269042895218501,0.0673428283484809,0.0916786697787653,0.0618248752800345,0.0688560555486599,0.00811230593989666,-0.0365314428464845,0.0610649702700933,0.0139584173071726,-0.159509325748264,0.159418336884266,-0.0576998688200368,0.00724723216137643,0.0367341466016174,0.0211530717332092,0.038096628315762,-0.0450262903466828,-3.22894419457588e-05,-0.0211820204884206,0.0417780444338335,-0.0199121688069052,0.053078268119327,-0.00179902353076823,0.0121966319217788,-0.0205512091150954,-0.0288246835616192,0.0531189579093468,0.0717407352365529,-0.0135450757407252,0.119644272870771,-0.0274600304361336,-0.0292012527216908,0.0114569851987143,0.012363276421859,-0.130091671124383,0.0227054234247813,-0.0143980443507864,0.00625190943529124,0.0013770368530978,-0.0158629735551448,-0.0429227889230123,-0.00153512380270496,-0.0102841000882074,0.0809066782565904,-0.00657686759794586,-0.0537475203208414,-0.0824102500225087,0.0319532588201814,0.0564430724261265,0.00895555830348997,-0.0957971340191934,0.00671825058553155,0.0291901238966396,-0.0113458365486793,-0.0530951788361719,-0.00306470170673262,-0.0259469485267021,0.0133541193143189,0.0221497482248012,0.0142232537411895,-0.0234947216802417,0.0352288381885689,-0.0989077790937692,0.0326999291990547,0.0186857983435874,-0.106529182973428,0.0188709974449377,0.0288858927785362,0.0800462836316838,-0.0812683483059005,-0.0083556169872896]},"columns":[{"accessor":"Salary","name":"Salary","type":"numeric"},{"accessor":"PLS01","name":"PLS01","type":"numeric"},{"accessor":"PLS02","name":"PLS02","type":"numeric"},{"accessor":"PLS03","name":"PLS03","type":"numeric"},{"accessor":"PLS04","name":"PLS04","type":"numeric"},{"accessor":"PLS05","name":"PLS05","type":"numeric"},{"accessor":"PLS06","name":"PLS06","type":"numeric"},{"accessor":"PLS07","name":"PLS07","type":"numeric"},{"accessor":"PLS08","name":"PLS08","type":"numeric"},{"accessor":"PLS09","name":"PLS09","type":"numeric"},{"accessor":"PLS10","name":"PLS10","type":"numeric"},{"accessor":"PLS11","name":"PLS11","type":"numeric"},{"accessor":"PLS12","name":"PLS12","type":"numeric"},{"accessor":"PLS13","name":"PLS13","type":"numeric"},{"accessor":"PLS14","name":"PLS14","type":"numeric"},{"accessor":"PLS15","name":"PLS15","type":"numeric"},{"accessor":"PLS16","name":"PLS16","type":"numeric"},{"accessor":"PLS17","name":"PLS17","type":"numeric"},{"accessor":"PLS18","name":"PLS18","type":"numeric"},{"accessor":"PLS19","name":"PLS19","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"48ad4534b92ee2b28b31737cab3a5cb2","key":"48ad4534b92ee2b28b31737cab3a5cb2"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="pls-exploration" class="section level2">
<h2>PLS exploration</h2>
<p>We can explore the results of the PCA using the <a href="https://recipes.tidymodels.org/reference/prep.html"><code>recipes::prep</code></a> and <a href="https://parsnip.tidymodels.org/reference/tidy.model_fit.html"><code>parsnip::tidy</code></a>. We can see that pca is done at step number 5</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>recipes<span class="sc">::</span><span class="fu">prep</span>(<span class="at">x =</span> pls_recipe, <span class="at">training =</span> Hitters_train) <span class="sc">%&gt;%</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-3ecd7feea0da87326e72" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-3ecd7feea0da87326e72">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"number":[1,2,3,4,5],"operation":["step","step","step","step","step"],"type":["novel","dummy","zv","normalize","pls"],"trained":[true,true,true,true,true],"skip":[false,false,false,false,false],"id":["novel_M73z2","dummy_Q5yC4","zv_MpRxu","normalize_1sozO","pls_DrgbK"]},"columns":[{"accessor":"number","name":"number","type":"numeric"},{"accessor":"operation","name":"operation","type":"character"},{"accessor":"type","name":"type","type":"character"},{"accessor":"trained","name":"trained","type":"logical"},{"accessor":"skip","name":"skip","type":"logical"},{"accessor":"id","name":"id","type":"character"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"0f707190bd0920d8d514a4509d93fe6a","key":"0f707190bd0920d8d514a4509d93fe6a"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>As such, we extract the results of step number 5 or the pca step.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>tidied_pls <span class="ot">&lt;-</span> recipes<span class="sc">::</span><span class="fu">prep</span>(<span class="at">x =</span> pls_recipe, <span class="at">training =</span> Hitters_train) <span class="sc">%&gt;%</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">tidy</span>(<span class="dv">5</span>)</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>tidied_pls <span class="sc">%&gt;%</span></span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-26dcdd5f775482f51e95" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-26dcdd5f775482f51e95">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"terms":["AtBat","AtBat","AtBat","AtBat","AtBat","AtBat","AtBat","AtBat","AtBat","AtBat","AtBat","AtBat","AtBat","AtBat","AtBat","AtBat","AtBat","AtBat","AtBat","Hits","Hits","Hits","Hits","Hits","Hits","Hits","Hits","Hits","Hits","Hits","Hits","Hits","Hits","Hits","Hits","Hits","Hits","Hits","HmRun","HmRun","HmRun","HmRun","HmRun","HmRun","HmRun","HmRun","HmRun","HmRun","HmRun","HmRun","HmRun","HmRun","HmRun","HmRun","HmRun","HmRun","HmRun","Runs","Runs","Runs","Runs","Runs","Runs","Runs","Runs","Runs","Runs","Runs","Runs","Runs","Runs","Runs","Runs","Runs","Runs","Runs","RBI","RBI","RBI","RBI","RBI","RBI","RBI","RBI","RBI","RBI","RBI","RBI","RBI","RBI","RBI","RBI","RBI","RBI","RBI","Walks","Walks","Walks","Walks","Walks","Walks","Walks","Walks","Walks","Walks","Walks","Walks","Walks","Walks","Walks","Walks","Walks","Walks","Walks","Years","Years","Years","Years","Years","Years","Years","Years","Years","Years","Years","Years","Years","Years","Years","Years","Years","Years","Years","CAtBat","CAtBat","CAtBat","CAtBat","CAtBat","CAtBat","CAtBat","CAtBat","CAtBat","CAtBat","CAtBat","CAtBat","CAtBat","CAtBat","CAtBat","CAtBat","CAtBat","CAtBat","CAtBat","CHits","CHits","CHits","CHits","CHits","CHits","CHits","CHits","CHits","CHits","CHits","CHits","CHits","CHits","CHits","CHits","CHits","CHits","CHits","CHmRun","CHmRun","CHmRun","CHmRun","CHmRun","CHmRun","CHmRun","CHmRun","CHmRun","CHmRun","CHmRun","CHmRun","CHmRun","CHmRun","CHmRun","CHmRun","CHmRun","CHmRun","CHmRun","CRuns","CRuns","CRuns","CRuns","CRuns","CRuns","CRuns","CRuns","CRuns","CRuns","CRuns","CRuns","CRuns","CRuns","CRuns","CRuns","CRuns","CRuns","CRuns","CRBI","CRBI","CRBI","CRBI","CRBI","CRBI","CRBI","CRBI","CRBI","CRBI","CRBI","CRBI","CRBI","CRBI","CRBI","CRBI","CRBI","CRBI","CRBI","CWalks","CWalks","CWalks","CWalks","CWalks","CWalks","CWalks","CWalks","CWalks","CWalks","CWalks","CWalks","CWalks","CWalks","CWalks","CWalks","CWalks","CWalks","CWalks","PutOuts","PutOuts","PutOuts","PutOuts","PutOuts","PutOuts","PutOuts","PutOuts","PutOuts","PutOuts","PutOuts","PutOuts","PutOuts","PutOuts","PutOuts","PutOuts","PutOuts","PutOuts","PutOuts","Assists","Assists","Assists","Assists","Assists","Assists","Assists","Assists","Assists","Assists","Assists","Assists","Assists","Assists","Assists","Assists","Assists","Assists","Assists","Errors","Errors","Errors","Errors","Errors","Errors","Errors","Errors","Errors","Errors","Errors","Errors","Errors","Errors","Errors","Errors","Errors","Errors","Errors","League_N","League_N","League_N","League_N","League_N","League_N","League_N","League_N","League_N","League_N","League_N","League_N","League_N","League_N","League_N","League_N","League_N","League_N","League_N","Division_W","Division_W","Division_W","Division_W","Division_W","Division_W","Division_W","Division_W","Division_W","Division_W","Division_W","Division_W","Division_W","Division_W","Division_W","Division_W","Division_W","Division_W","Division_W","NewLeague_N","NewLeague_N","NewLeague_N","NewLeague_N","NewLeague_N","NewLeague_N","NewLeague_N","NewLeague_N","NewLeague_N","NewLeague_N","NewLeague_N","NewLeague_N","NewLeague_N","NewLeague_N","NewLeague_N","NewLeague_N","NewLeague_N","NewLeague_N","NewLeague_N"],"value":[0.237821105175479,0.0763159821274657,-0.349917481800569,-0.308545035978661,-0.471590601540933,-0.698248450944627,-0.824399296317879,-1.00963156781123,-0.589795137026972,-0.370239929236674,-0.559628910076597,0.0110790525041727,0.24495229914115,0.354130886232695,0.101857640694409,0.0319562557843267,0.368625069439489,0.54791664118677,0.0456678673750521,0.257530238246242,0.28547695340949,0.0518226228070863,0.281788199570848,0.477873167112019,0.434396103689233,0.477718191429673,0.513223500752669,0.775295438503154,0.753739806052757,0.884185361926257,0.72397295788013,-0.0970195712472623,-0.394495524224875,-0.301235077751452,-0.127968156167942,-0.0527547883730887,-0.000738284633452394,-0.117377905694517,0.193472748151385,-0.164336908079889,-0.525397145574918,-0.354230368843094,-0.317917827114821,0.311127905296359,0.29538250511478,0.429713242953418,0.0257201727330389,0.16371589787688,0.16397010803836,-0.153525797601946,0.0175311178444206,0.00256335699517139,0.0100449373557497,-0.0530822694332677,0.430149640777648,0.193424874058649,-0.0380853224417078,0.237670513528228,0.14476352175909,-0.202433111473693,-0.0518020664365065,-0.104248539965432,-0.0837925865180177,-0.138530245485841,-0.143627257083921,0.0199134257444375,-0.317771188776642,-0.427342253140154,-0.198144591808178,-0.303708804536161,0.0414807135855241,0.38380098275459,0.118283293184071,-0.0249304856215961,-0.521180998215165,0.0827127213638526,0.26030219895257,0.0186934883977391,-0.327832900159159,-0.199516036299992,-0.157469187276418,0.130473100391488,0.0320797382365589,-0.0514559847686569,-0.240764381292221,-0.127960967472633,-0.280560528869809,-0.112690362707328,0.140881296162642,-0.0459965198317928,-0.1278507492064,0.0815754677794344,-0.639024235174388,-0.28224366114258,0.0359184012955112,0.260505042372257,0.279760772394803,0.167238974388777,0.227778840076812,0.279821037244964,0.144645859506333,0.109558960804939,0.3597579570647,0.482202527257773,-0.100713559312358,0.297940049899079,-0.317601832532062,-0.0238457697070833,0.0186173586851384,-0.0774278249237006,-0.0725539751000795,-0.0727261066643927,0.246705266541977,-0.0216865929033558,0.221825570852524,-0.302055834973319,-0.186941084883152,-0.439125527430694,-0.65979253175757,-0.508474531511367,-0.172202554580865,0.0252881942463292,0.182430024401312,0.310495138314433,0.297129395892286,0.156531279443295,-0.11261971868845,0.304331814461218,0.365650062154062,0.0463984906205592,-0.155190549815024,0.285869191786019,0.00928311308919764,0.293811060416467,-0.13272598167778,0.0402987682079713,-0.103419131412283,-0.129815457793052,-0.218482793892378,-0.139700253821802,-0.204098614357325,-0.374877171740332,-0.714288975647499,-1.23960189194282,-0.890013126289558,-0.911870042298052,-1.34474355964721,-1.15228087544992,-1.03941593149772,-0.76476819491325,-0.602565679809794,-0.361293663174568,0.310035553107858,-0.0185774560528656,0.245125153769468,0.212720372092937,0.391207193357933,0.369407833733114,0.527732462365881,0.58398678232127,0.361436305625214,0.0135668103226939,-0.0506708890253679,0.246442132935633,0.272423013961379,0.332106699771392,0.282371506658511,0.465788355508313,0.663978332217182,0.752200548206044,0.884644109014701,0.307025803445631,-0.00254134908430994,0.225405652189548,0.327943030718335,0.500653416462987,0.359916320090948,-0.115629307390463,-0.47705216863285,-0.407133752879784,0.176880329536727,0.324747962046615,-0.0981869377441571,-0.131192645170093,-0.0744713325239844,-0.118460842264073,-0.409261848461624,-0.291656242840973,-0.165168042169882,0.23813853569892,0.317001338602959,-0.0298243861985108,0.214754987478503,0.17716227686998,0.290222095493595,0.285200823679183,0.420805126707948,0.493368608711839,0.446330129797488,0.297858019159132,0.553975640040727,0.703806149630073,0.779404552449124,0.873953783453745,0.279577046314488,-0.18198241664365,-0.266865683165676,-0.560786268385209,-0.443591194578441,0.324035791739605,-0.00356731359702946,0.26554088007452,0.301945817079408,0.502725839424719,0.389177198570956,0.201954010110701,0.0035823668707903,-0.149638075995379,-0.108866693512591,-0.213889961028494,-0.13748586098996,-0.0251589171361965,0.164848063000508,0.494235546791409,0.829198428998474,0.609922061662254,0.382883331175939,-0.380566084792849,0.268913031676421,-0.224077987932482,-0.159293879161938,-0.464178247049291,-0.793764204224974,-0.846395998646706,-0.722901832666493,-0.587502485037092,-0.199944684566145,0.0761180455933372,0.398423380534709,0.10886651557745,0.0936039092882955,-0.257722228190525,-0.0898622707346757,0.276786129721491,0.232921958694128,-0.146909975345707,0.0922614152111262,0.161857771623736,0.411365345039947,0.380097907607015,0.19706624080217,0.038146023311703,-0.343192033317429,-0.375047489716209,0.228517742754954,-0.336102670652952,0.0741782212869765,-0.0722538474722398,-0.0358407329696142,-0.00722305176668172,0.0143081208624325,0.0435078772775511,-0.00855166594127829,-0.0166678085152389,-0.0629059441697733,-0.00346240964244316,0.0204066066835494,0.045936828393484,-0.0877617391032359,0.00452308066661171,0.148158042096258,-0.225709175414733,0.323031694891481,0.0549293899390264,0.168775582120479,0.201886470946215,-0.193802798074453,-0.520366376928926,0.0516558589547982,0.0134876844449882,0.0848974389335781,0.0189646434308499,0.0130783111962069,-0.109067490434226,0.0100876983921409,0.00968019915624119,-0.0336676100524406,-0.254631632421275,-0.143228283381688,0.064090743577323,-0.191192099921528,0.323067260486103,0.0456379212529637,-0.403965955633697,-0.13103310768602,0.366855822659455,0.321357148845976,-0.0635641065525192,0.0179121415664413,-0.0316987777190671,-0.00080336269885096,-0.00696468194949753,0.021094156179603,-0.00687551339745511,-0.0247000120762953,0.221791841813618,0.265142808327255,-0.332852560432928,0.10731674054337,0.0942500575533744,-0.0199264992854878,-0.00807036682083605,0.00535786399915108,-0.0415170265569814,0.0210510675413815,0.0950631033740068,0.132424070829811,-0.188392898385372,0.381435453050642,-0.0408405124799005,-0.0182542415037529,0.101141228772241,0.00581160913274081,-0.128570144393574,-0.610261664289331,-0.760342443055777,-0.167299033057073,0.286238112911539,-0.118870871076271,-0.346916146538169,0.0742489084049674,0.101431649385135,0.0339727725892442,0.010185538750992,0.0240534367597111,0.0130955310117005,0.00449435455494214,0.00806559955519128,0.00795034444576799,-0.0411734233559827,-0.0443314061196799,-0.00277428009651119,-0.00317640690054878,0.219350022913444,0.246061485877829,-0.375872307427577,0.0374234535368962,0.0363078095500556,-0.0865254204342797,-0.0457977959519044,0.0608546177774239,0.0708348426909335,-0.00301299947247796,-0.0898861087162324,-0.132944858571054,0.21708271815803,-0.32814340430525,0.0397442551823362,0.0227515767476712,-0.14472087041227,-0.0101132556424286],"component":["PLS1","PLS2","PLS3","PLS4","PLS5","PLS6","PLS7","PLS8","PLS9","PLS10","PLS11","PLS12","PLS13","PLS14","PLS15","PLS16","PLS17","PLS18","PLS19","PLS1","PLS2","PLS3","PLS4","PLS5","PLS6","PLS7","PLS8","PLS9","PLS10","PLS11","PLS12","PLS13","PLS14","PLS15","PLS16","PLS17","PLS18","PLS19","PLS1","PLS2","PLS3","PLS4","PLS5","PLS6","PLS7","PLS8","PLS9","PLS10","PLS11","PLS12","PLS13","PLS14","PLS15","PLS16","PLS17","PLS18","PLS19","PLS1","PLS2","PLS3","PLS4","PLS5","PLS6","PLS7","PLS8","PLS9","PLS10","PLS11","PLS12","PLS13","PLS14","PLS15","PLS16","PLS17","PLS18","PLS19","PLS1","PLS2","PLS3","PLS4","PLS5","PLS6","PLS7","PLS8","PLS9","PLS10","PLS11","PLS12","PLS13","PLS14","PLS15","PLS16","PLS17","PLS18","PLS19","PLS1","PLS2","PLS3","PLS4","PLS5","PLS6","PLS7","PLS8","PLS9","PLS10","PLS11","PLS12","PLS13","PLS14","PLS15","PLS16","PLS17","PLS18","PLS19","PLS1","PLS2","PLS3","PLS4","PLS5","PLS6","PLS7","PLS8","PLS9","PLS10","PLS11","PLS12","PLS13","PLS14","PLS15","PLS16","PLS17","PLS18","PLS19","PLS1","PLS2","PLS3","PLS4","PLS5","PLS6","PLS7","PLS8","PLS9","PLS10","PLS11","PLS12","PLS13","PLS14","PLS15","PLS16","PLS17","PLS18","PLS19","PLS1","PLS2","PLS3","PLS4","PLS5","PLS6","PLS7","PLS8","PLS9","PLS10","PLS11","PLS12","PLS13","PLS14","PLS15","PLS16","PLS17","PLS18","PLS19","PLS1","PLS2","PLS3","PLS4","PLS5","PLS6","PLS7","PLS8","PLS9","PLS10","PLS11","PLS12","PLS13","PLS14","PLS15","PLS16","PLS17","PLS18","PLS19","PLS1","PLS2","PLS3","PLS4","PLS5","PLS6","PLS7","PLS8","PLS9","PLS10","PLS11","PLS12","PLS13","PLS14","PLS15","PLS16","PLS17","PLS18","PLS19","PLS1","PLS2","PLS3","PLS4","PLS5","PLS6","PLS7","PLS8","PLS9","PLS10","PLS11","PLS12","PLS13","PLS14","PLS15","PLS16","PLS17","PLS18","PLS19","PLS1","PLS2","PLS3","PLS4","PLS5","PLS6","PLS7","PLS8","PLS9","PLS10","PLS11","PLS12","PLS13","PLS14","PLS15","PLS16","PLS17","PLS18","PLS19","PLS1","PLS2","PLS3","PLS4","PLS5","PLS6","PLS7","PLS8","PLS9","PLS10","PLS11","PLS12","PLS13","PLS14","PLS15","PLS16","PLS17","PLS18","PLS19","PLS1","PLS2","PLS3","PLS4","PLS5","PLS6","PLS7","PLS8","PLS9","PLS10","PLS11","PLS12","PLS13","PLS14","PLS15","PLS16","PLS17","PLS18","PLS19","PLS1","PLS2","PLS3","PLS4","PLS5","PLS6","PLS7","PLS8","PLS9","PLS10","PLS11","PLS12","PLS13","PLS14","PLS15","PLS16","PLS17","PLS18","PLS19","PLS1","PLS2","PLS3","PLS4","PLS5","PLS6","PLS7","PLS8","PLS9","PLS10","PLS11","PLS12","PLS13","PLS14","PLS15","PLS16","PLS17","PLS18","PLS19","PLS1","PLS2","PLS3","PLS4","PLS5","PLS6","PLS7","PLS8","PLS9","PLS10","PLS11","PLS12","PLS13","PLS14","PLS15","PLS16","PLS17","PLS18","PLS19","PLS1","PLS2","PLS3","PLS4","PLS5","PLS6","PLS7","PLS8","PLS9","PLS10","PLS11","PLS12","PLS13","PLS14","PLS15","PLS16","PLS17","PLS18","PLS19"],"id":["pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK","pls_DrgbK"]},"columns":[{"accessor":"terms","name":"terms","type":"character"},{"accessor":"value","name":"value","type":"numeric"},{"accessor":"component","name":"component","type":"character"},{"accessor":"id","name":"id","type":"character"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"48ae22f8fc60a880b83dd50a685076fa","key":"48ae22f8fc60a880b83dd50a685076fa"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>We make a visualization to see what the first four components look like</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>tidied_pls <span class="sc">%&gt;%</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(.data[[<span class="st">&quot;component&quot;</span>]] <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;PLS1&quot;</span>, <span class="st">&quot;PLS2&quot;</span>, <span class="st">&quot;PLS3&quot;</span>, <span class="st">&quot;PLS4&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">component =</span> forcats<span class="sc">::</span><span class="fu">fct_inorder</span>(.data[[<span class="st">&quot;component&quot;</span>]])) <span class="sc">%&gt;%</span></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(</span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> .data[[<span class="st">&quot;value&quot;</span>]],</span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> .data[[<span class="st">&quot;terms&quot;</span>]],</span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> .data[[<span class="st">&quot;terms&quot;</span>]]</span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb149-10"><a href="#cb149-10" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">facet_wrap</span>(<span class="at">facets =</span> ggplot2<span class="sc">::</span><span class="fu">vars</span>(.data[[<span class="st">&quot;component&quot;</span>]])) <span class="sc">+</span></span>
<span id="cb149-11"><a href="#cb149-11" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<p><img src="figures/unnamed-chunk-102-1.png" width="3883.2" style="display: block; margin: auto;" /></p>
<p>Let us take a closer look at the top 6 variables that contribute to the first four components</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>tidied_pls <span class="sc">%&gt;%</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(.data[[<span class="st">&quot;component&quot;</span>]] <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;PLS1&quot;</span>, <span class="st">&quot;PLS2&quot;</span>, <span class="st">&quot;PLS3&quot;</span>, <span class="st">&quot;PLS4&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(.data[[<span class="st">&quot;component&quot;</span>]]) <span class="sc">%&gt;%</span></span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">top_n</span>(<span class="dv">6</span>, <span class="fu">abs</span>(.data[[<span class="st">&quot;value&quot;</span>]])) <span class="sc">%&gt;%</span></span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">terms =</span> tidytext<span class="sc">::</span><span class="fu">reorder_within</span>(</span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> .data[[<span class="st">&quot;terms&quot;</span>]],</span>
<span id="cb150-9"><a href="#cb150-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">by =</span> <span class="fu">abs</span>(.data[[<span class="st">&quot;value&quot;</span>]]),</span>
<span id="cb150-10"><a href="#cb150-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">within =</span> .data[[<span class="st">&quot;component&quot;</span>]]</span>
<span id="cb150-11"><a href="#cb150-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb150-12"><a href="#cb150-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb150-13"><a href="#cb150-13" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(</span>
<span id="cb150-14"><a href="#cb150-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">abs</span>(.data[[<span class="st">&quot;value&quot;</span>]]),</span>
<span id="cb150-15"><a href="#cb150-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> .data[[<span class="st">&quot;terms&quot;</span>]],</span>
<span id="cb150-16"><a href="#cb150-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> .data[[<span class="st">&quot;value&quot;</span>]] <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb150-17"><a href="#cb150-17" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb150-18"><a href="#cb150-18" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb150-19"><a href="#cb150-19" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">facet_wrap</span>(</span>
<span id="cb150-20"><a href="#cb150-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">facets =</span> ggplot2<span class="sc">::</span><span class="fu">vars</span>(.data[[<span class="st">&quot;component&quot;</span>]]),</span>
<span id="cb150-21"><a href="#cb150-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span></span>
<span id="cb150-22"><a href="#cb150-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb150-23"><a href="#cb150-23" aria-hidden="true" tabindex="-1"></a>  tidytext<span class="sc">::</span><span class="fu">scale_y_reordered</span>() <span class="sc">+</span></span>
<span id="cb150-24"><a href="#cb150-24" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb150-25"><a href="#cb150-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Absolute value of contribution to PLS component&quot;</span>,</span>
<span id="cb150-26"><a href="#cb150-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb150-27"><a href="#cb150-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Positive?&quot;</span></span>
<span id="cb150-28"><a href="#cb150-28" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="figures/unnamed-chunk-103-1.png" width="3883.2" style="display: block; margin: auto;" /></p>
<p><code>num_comp</code> is the number of partial least square components to retain as new predictors. We will now try to find the best number of component value using the <a href="https://hardhat.tidymodels.org/reference/tune.html"><code>tune::tune()</code></a></p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>pls_recipe <span class="ot">&lt;-</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">recipe</span>(<span class="at">formula =</span> Salary <span class="sc">~</span> ., <span class="at">data =</span> Hitters_train) <span class="sc">%&gt;%</span></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_novel</span>(recipes<span class="sc">::</span><span class="fu">all_nominal_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_dummy</span>(recipes<span class="sc">::</span><span class="fu">all_nominal_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_zv</span>(recipes<span class="sc">::</span><span class="fu">all_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_normalize</span>(recipes<span class="sc">::</span><span class="fu">all_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_pls</span>(recipes<span class="sc">::</span><span class="fu">all_predictors</span>(), <span class="at">num_comp =</span> tune<span class="sc">::</span><span class="fu">tune</span>(), <span class="at">outcome =</span> <span class="st">&quot;Salary&quot;</span>)</span></code></pre></div>
</div>
<div id="specify-the-model-3" class="section level2">
<h2>Specify the model</h2>
<p>We use a linear model</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>lm_spec <span class="ot">&lt;-</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_mode</span>(<span class="st">&quot;regression&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">&quot;lm&quot;</span>)</span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a>lm_spec <span class="sc">%&gt;%</span></span>
<span id="cb152-7"><a href="#cb152-7" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">translate</span>()</span></code></pre></div>
<pre><code>&gt; Linear Regression Model Specification (regression)
&gt; 
&gt; Computational engine: lm 
&gt; 
&gt; Model fit template:
&gt; stats::lm(formula = missing_arg(), data = missing_arg(), weights = missing_arg())</code></pre>
</div>
<div id="create-the-workflow-3" class="section level2">
<h2>Create the workflow</h2>
<p><a href="https://workflows.tidymodels.org/reference/workflow.html"><code>workflows::workflow</code></a>, <a href="https://workflows.tidymodels.org/reference/add_recipe.html"><code>workflows::add_recipe</code></a> and <a href="https://workflows.tidymodels.org/reference/add_model.html"><code>workflows::add_model</code></a> are used.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>pls_workflow <span class="ot">&lt;-</span> workflows<span class="sc">::</span><span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>  workflows<span class="sc">::</span><span class="fu">add_recipe</span>(pls_recipe) <span class="sc">%&gt;%</span></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>  workflows<span class="sc">::</span><span class="fu">add_model</span>(lm_spec)</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>pls_workflow</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; == Workflow ==========================================================
&gt; Preprocessor: Recipe
&gt; Model: linear_reg()
&gt; 
&gt; -- Preprocessor ------------------------------------------------------
&gt; 5 Recipe Steps
&gt; 
&gt; * step_novel()
&gt; * step_dummy()
&gt; * step_zv()
&gt; * step_normalize()
&gt; * step_pls()
&gt; 
&gt; -- Model -------------------------------------------------------------
&gt; Linear Regression Model Specification (regression)
&gt; 
&gt; Computational engine: lm</code></pre>
</div>
<div id="create-the-number-of-components-grid" class="section level2">
<h2>Create the number of components grid</h2>
<p>A number of components grid of <span class="math inline">\(10\)</span> numbers from <span class="math inline">\(1\)</span> to <span class="math inline">\(20\)</span> is created.</p>
<p>Number of components grid is created using <a href="https://dials.tidymodels.org/reference/grid_regular.html"><code>dials::grid_regular</code></a> and <a href="https://dials.tidymodels.org/reference/num_comp.html"><code>dials::num_comp</code></a></p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>num_comp_grid <span class="ot">&lt;-</span> dials<span class="sc">::</span><span class="fu">grid_regular</span>(</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> dials<span class="sc">::</span><span class="fu">num_comp</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">20</span>)),</span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="dv">10</span></span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a>num_comp_grid <span class="sc">%&gt;%</span></span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-9e206886e62a45a2e275" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-9e206886e62a45a2e275">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"num_comp":[1,3,5,7,9,11,13,15,17,20]},"columns":[{"accessor":"num_comp","name":"num_comp","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"626850a1bd9082aebf54f5c5b811d6d4","key":"626850a1bd9082aebf54f5c5b811d6d4"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="partial-least-square-regression-model-fitting-on-cross-validated-data" class="section level2">
<h2>Partial least square regression model fitting on cross validated data</h2>
<p>Now we have everything we need and we can fit all the models on the cross validated data with <a href="https://tune.tidymodels.org/reference/tune_grid.html"><code>tune::tune_grid</code></a>. Note that this process may take some time.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>doParallel<span class="sc">::</span><span class="fu">registerDoParallel</span>()</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>foreach<span class="sc">::</span><span class="fu">getDoParWorkers</span>()</span></code></pre></div>
<pre><code>&gt; [1] 3</code></pre>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>tune_res <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">tune_grid</span>(</span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">object =</span> pls_workflow,</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">resamples =</span> Hitters_fold,</span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">grid =</span> num_comp_grid</span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a>tune_res</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; # Tuning results
&gt; # 10-fold cross-validation 
&gt; # A tibble: 10 x 4
&gt;    splits           id     .metrics          .notes          
&gt;    &lt;list&gt;           &lt;chr&gt;  &lt;list&gt;            &lt;list&gt;          
&gt;  1 &lt;split [176/20]&gt; Fold01 &lt;tibble [20 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  2 &lt;split [176/20]&gt; Fold02 &lt;tibble [20 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  3 &lt;split [176/20]&gt; Fold03 &lt;tibble [20 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  4 &lt;split [176/20]&gt; Fold04 &lt;tibble [20 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  5 &lt;split [176/20]&gt; Fold05 &lt;tibble [20 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  6 &lt;split [176/20]&gt; Fold06 &lt;tibble [20 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  7 &lt;split [177/19]&gt; Fold07 &lt;tibble [20 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  8 &lt;split [177/19]&gt; Fold08 &lt;tibble [20 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt;  9 &lt;split [177/19]&gt; Fold09 &lt;tibble [20 x 5]&gt; &lt;tibble [0 x 3]&gt;
&gt; 10 &lt;split [177/19]&gt; Fold10 &lt;tibble [20 x 5]&gt; &lt;tibble [0 x 3]&gt;</code></pre>
<p>Here we see that the amount of regularization affects the performance metrics differently using <a href="https://tune.tidymodels.org/reference/autoplot.tune_results.html"><code>tune::autoplot</code></a>. Do note that using a different seed will give a different plot</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that a different seed will give different plots</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>tune<span class="sc">::</span><span class="fu">autoplot</span>(tune_res)</span></code></pre></div>
<p><img src="figures/unnamed-chunk-110-1.png" width="3883.2" style="display: block; margin: auto;" /></p>
<p>We can also see the raw metrics that created this chart by calling <a href="https://tune.tidymodels.org/reference/collect_predictions.html"><code>tune::collect_metrics()</code></a>.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>tune<span class="sc">::</span><span class="fu">collect_metrics</span>(tune_res) <span class="sc">%&gt;%</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-864acbf48b38f3c8611c" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-864acbf48b38f3c8611c">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"num_comp":[1,1,3,3,5,5,7,7,9,9,11,11,13,13,15,15,17,17,20,20],".metric":["rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq","rmse","rsq"],".estimator":["standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard"],"mean":[338.238695390283,0.479892166910153,344.000193678024,0.466972396782161,353.81216733646,0.45068878669194,351.128076358436,0.440446505769375,348.899796080916,0.44081309318907,346.403254404069,0.444245665430948,350.7941929353,0.43414788501599,350.278231147235,0.437631128438316,350.063418913844,0.436987950969289,353.975508437056,0.432220245843742],"n":[10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10],"std_err":[36.6276274713211,0.0574587999132583,34.727924188302,0.0482393873480129,33.8100750969693,0.0547328690135794,31.0182177792847,0.0530804886982045,30.7940226336191,0.0488008298977934,30.3359527156053,0.0511054564090822,30.9857808056193,0.0518040007285459,31.4187724590488,0.0508249929520383,30.8995025825278,0.0484976890996026,32.625106728035,0.0498697159452977],".config":["Preprocessor01_Model1","Preprocessor01_Model1","Preprocessor02_Model1","Preprocessor02_Model1","Preprocessor03_Model1","Preprocessor03_Model1","Preprocessor04_Model1","Preprocessor04_Model1","Preprocessor05_Model1","Preprocessor05_Model1","Preprocessor06_Model1","Preprocessor06_Model1","Preprocessor07_Model1","Preprocessor07_Model1","Preprocessor08_Model1","Preprocessor08_Model1","Preprocessor09_Model1","Preprocessor09_Model1","Preprocessor10_Model1","Preprocessor10_Model1"]},"columns":[{"accessor":"num_comp","name":"num_comp","type":"numeric"},{"accessor":".metric","name":".metric","type":"character"},{"accessor":".estimator","name":".estimator","type":"character"},{"accessor":"mean","name":"mean","type":"numeric"},{"accessor":"n","name":"n","type":"numeric"},{"accessor":"std_err","name":"std_err","type":"numeric"},{"accessor":".config","name":".config","type":"character"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"164733d77f184c645164259d3dfcb10e","key":"164733d77f184c645164259d3dfcb10e"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>Here is the <code>ggplot</code> way should <a href="https://tune.tidymodels.org/reference/autoplot.tune_results.html"><code>tune::autoplot</code></a> fails</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>tune_res <span class="sc">%&gt;%</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>  tune<span class="sc">::</span><span class="fu">collect_metrics</span>() <span class="sc">%&gt;%</span></span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> .data[[<span class="st">&quot;num_comp&quot;</span>]],</span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> .data[[<span class="st">&quot;mean&quot;</span>]],</span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> .data[[<span class="st">&quot;.metric&quot;</span>]]</span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb163-8"><a href="#cb163-8" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_errorbar</span>(</span>
<span id="cb163-9"><a href="#cb163-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(</span>
<span id="cb163-10"><a href="#cb163-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymin =</span> .data[[<span class="st">&quot;mean&quot;</span>]] <span class="sc">-</span> .data[[<span class="st">&quot;std_err&quot;</span>]],</span>
<span id="cb163-11"><a href="#cb163-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymax =</span> .data[[<span class="st">&quot;mean&quot;</span>]] <span class="sc">+</span> .data[[<span class="st">&quot;std_err&quot;</span>]]</span>
<span id="cb163-12"><a href="#cb163-12" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb163-13"><a href="#cb163-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb163-14"><a href="#cb163-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb163-15"><a href="#cb163-15" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb163-16"><a href="#cb163-16" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">facet_wrap</span>(</span>
<span id="cb163-17"><a href="#cb163-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">facets =</span> ggplot2<span class="sc">::</span><span class="fu">vars</span>(.data[[<span class="st">&quot;.metric&quot;</span>]]),</span>
<span id="cb163-18"><a href="#cb163-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>,</span>
<span id="cb163-19"><a href="#cb163-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">2</span></span>
<span id="cb163-20"><a href="#cb163-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb163-21"><a href="#cb163-21" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="figures/unnamed-chunk-112-1.png" width="3883.2" style="display: block; margin: auto;" /></p>
<p>Use <a href="https://tune.tidymodels.org/reference/show_best.html"><code>tune::show_best</code></a> to see the top few values for a given metric.</p>
<p>The “best” values can be selected using <a href="https://tune.tidymodels.org/reference/show_best.html"><code>tune::select_best</code></a>, this function requires you to specify a metric that it should select against. The number of components value is 1 for metric <code>rsme</code> since it gives the lowest value. Do note that using a different seed will give a different best number of components value.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>top_num_comp <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">show_best</span>(tune_res, <span class="at">metric =</span> <span class="st">&quot;rmse&quot;</span>, <span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>top_num_comp</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; # A tibble: 5 x 7
&gt;   num_comp .metric .estimator  mean     n std_err .config             
&gt;      &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
&gt; 1        1 rmse    standard    338.    10    36.6 Preprocessor01_Mode~
&gt; 2        3 rmse    standard    344.    10    34.7 Preprocessor02_Mode~
&gt; 3       11 rmse    standard    346.    10    30.3 Preprocessor06_Mode~
&gt; 4        9 rmse    standard    349.    10    30.8 Preprocessor05_Mode~
&gt; 5       17 rmse    standard    350.    10    30.9 Preprocessor09_Mode~</code></pre>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>best_num_comp <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">select_best</span>(tune_res, <span class="at">metric =</span> <span class="st">&quot;rmse&quot;</span>)</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>best_num_comp</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; # A tibble: 1 x 2
&gt;   num_comp .config              
&gt;      &lt;int&gt; &lt;chr&gt;                
&gt; 1        1 Preprocessor01_Model1</code></pre>
</div>
<div id="partial-least-square-model-with-optimised-threshold-value" class="section level2">
<h2>Partial least square model with optimised threshold value</h2>
<p>We create the partial least square regression workflow with the best threshold using <a href="https://tune.tidymodels.org/reference/finalize_model.html"><code>tune::finalize_workflow</code></a>.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>pls_final <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">finalize_workflow</span>(</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> pls_workflow,</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">parameters =</span> best_num_comp</span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a>pls_final</span></code></pre></div>
<pre style="max-height: 150px;"><code>&gt; == Workflow ==========================================================
&gt; Preprocessor: Recipe
&gt; Model: linear_reg()
&gt; 
&gt; -- Preprocessor ------------------------------------------------------
&gt; 5 Recipe Steps
&gt; 
&gt; * step_novel()
&gt; * step_dummy()
&gt; * step_zv()
&gt; * step_normalize()
&gt; * step_pls()
&gt; 
&gt; -- Model -------------------------------------------------------------
&gt; Linear Regression Model Specification (regression)
&gt; 
&gt; Computational engine: lm</code></pre>
<p>We now train the partial least square regression model with the training data using <a href="https://parsnip.tidymodels.org/reference/fit.html"><code>parsnip::fit</code></a></p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>pls_final_fit <span class="ot">&lt;-</span> parsnip<span class="sc">::</span><span class="fu">fit</span>(<span class="at">object =</span> pls_final, <span class="at">data =</span> Hitters_train)</span></code></pre></div>
<p>We can see the coefficients using <a href="https://tune.tidymodels.org/reference/extract-tune.html"><code>tune::extract_fit_parsnip</code></a> and <a href="https://parsnip.tidymodels.org/reference/tidy.model_fit.html"><code>parsnip::tidy</code></a></p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>pls_final_fit <span class="sc">%&gt;%</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>  tune<span class="sc">::</span><span class="fu">extract_fit_parsnip</span>() <span class="sc">%&gt;%</span></span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span></span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-787e36eda7d616a4bd75" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-787e36eda7d616a4bd75">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"term":["(Intercept)","PLS1"],"estimate":[537.573168367347,113.162775413526],"std.error":[24.9844826815819,9.46368559559478],"statistic":[21.5162817344878,11.9575797685208],"p.value":[2.80972384463441e-53,4.77955426176088e-25]},"columns":[{"accessor":"term","name":"term","type":"character"},{"accessor":"estimate","name":"estimate","type":"numeric"},{"accessor":"std.error","name":"std.error","type":"numeric"},{"accessor":"statistic","name":"statistic","type":"numeric"},{"accessor":"p.value","name":"p.value","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"60ddab97250d663019fba3bf4baf2595","key":"60ddab97250d663019fba3bf4baf2595"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="partial-least-square-regression-model-on-test-data" class="section level2">
<h2>Partial least square regression model on test data</h2>
<p>This partial least square regression model can now be applied on our testing data set to validate its performance. For regression models, a <code>.pred</code> column is added when <a href="https://parsnip.tidymodels.org/reference/augment.html"><code>parsnip::augment</code></a> is used.</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>test_results <span class="ot">&lt;-</span> parsnip<span class="sc">::</span><span class="fu">augment</span>(<span class="at">x =</span> pls_final_fit, <span class="at">new_data =</span> Hitters_test)</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>test_results <span class="sc">%&gt;%</span></span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-83cc06ccdf4b53be8ced" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-83cc06ccdf4b53be8ced">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"AtBat":[315,321,413,324,474,550,513,583,181,217,205,214,529,424,388,339,329,458,317,382,233,641,596,370,282,589,438,232,528,309,616,591,315,453,441,551,283,199,464,584,303,381,514,359,309,216,256,466,327,341,486,275,208,459,288,220,581,439,633,368,263,520,19,279,600,610,631],"Hits":[81,87,92,73,129,152,137,168,41,46,57,53,137,119,103,96,83,114,78,119,49,198,171,96,78,170,103,55,132,94,163,157,73,101,118,171,70,52,128,157,71,110,144,80,72,56,70,108,68,110,145,68,57,113,63,66,145,96,210,103,70,120,4,69,139,186,170],"HmRun":[7,10,16,4,10,6,20,17,1,7,8,2,26,6,15,4,9,13,7,13,2,31,34,21,13,40,2,9,21,5,27,16,5,3,28,13,8,9,28,20,3,9,0,15,0,4,13,33,13,9,11,5,8,20,3,5,17,0,6,3,1,17,1,4,0,19,9],"Runs":[24,39,72,32,50,92,90,83,15,32,34,30,86,57,59,37,50,67,35,54,41,101,91,49,37,107,65,34,61,37,83,90,23,46,84,94,33,26,67,95,18,61,67,45,33,22,42,75,42,45,51,42,32,59,25,20,66,44,91,48,26,53,2,35,94,107,77],"RBI":[38,42,48,18,56,37,95,80,21,19,32,29,97,46,47,29,39,57,35,58,23,108,108,46,51,108,32,23,74,32,107,78,37,43,86,83,37,28,94,73,30,45,54,48,31,18,36,86,29,49,76,42,25,57,33,28,68,36,56,28,23,44,3,31,29,98,44],"Walks":[39,30,65,22,40,81,90,56,33,9,9,23,97,13,39,23,56,48,32,36,18,41,52,60,29,69,71,45,41,26,32,26,16,61,68,94,27,21,52,63,36,32,79,63,26,15,44,72,45,46,40,61,18,68,16,13,21,65,59,54,30,21,1,32,60,74,31],"Years":[14,2,1,7,10,5,14,5,2,4,5,2,15,9,6,4,9,4,1,12,8,5,6,15,5,6,2,12,6,13,3,4,4,3,8,13,12,6,13,10,3,7,9,7,5,12,16,3,18,9,11,6,3,12,10,3,2,4,6,8,4,4,1,4,2,6,11],"CAtBat":[3449,396,413,1931,2331,2308,5201,1646,232,694,756,226,6661,3651,2174,1064,3828,1350,317,2133,1350,2129,2862,6986,1649,2325,440,4405,2641,4618,1437,2020,450,948,2723,6090,4479,805,5829,4704,344,3015,4739,1493,354,2796,7058,652,3949,2331,3967,961,653,5348,2682,290,831,711,3070,1897,888,927,19,1359,1236,2728,4908],"CHits":[835,101,92,491,604,633,1382,452,50,160,192,59,1785,1046,555,290,948,298,78,594,336,610,728,1972,453,634,103,1213,671,1330,377,541,108,218,750,1840,1222,191,1552,1320,76,834,1169,359,82,665,1845,142,939,658,1102,238,170,1369,667,80,210,148,872,493,220,227,4,355,309,753,1457],"CHmRun":[69,12,16,13,61,32,166,44,4,32,32,2,291,32,80,11,145,28,7,41,7,92,107,231,73,128,2,194,97,57,65,52,6,6,126,128,94,30,210,93,3,40,13,61,0,43,312,44,78,50,67,16,17,155,38,5,21,1,19,9,9,22,1,31,1,69,30],"CRuns":[321,48,72,291,246,349,763,219,20,86,117,32,1082,461,285,123,575,160,35,287,166,297,361,1070,211,371,67,702,273,616,181,310,38,96,433,969,557,113,740,724,20,451,583,176,41,266,965,102,438,249,410,128,98,713,315,27,106,68,420,207,83,106,2,180,201,399,775],"CRBI":[414,46,48,108,327,182,734,208,29,76,107,32,949,301,274,108,528,123,35,294,122,319,401,955,280,376,32,705,383,522,227,226,46,72,420,900,483,119,840,522,36,249,374,202,32,304,1128,109,380,322,497,104,54,660,259,31,86,56,230,162,82,80,3,148,69,366,357],"CWalks":[375,33,65,180,166,308,784,136,45,32,51,27,989,112,186,55,635,122,32,227,106,117,224,921,138,238,71,625,226,436,82,91,28,91,309,917,307,87,452,576,45,168,528,175,26,198,990,102,466,274,284,172,62,735,204,15,40,99,274,198,86,52,1,158,110,286,249],"League":["N","N","N","N","N","N","A","A","A","A","A","N","A","A","A","A","A","A","A","N","A","A","A","N","A","A","A","N","N","N","A","N","A","N","A","N","A","N","A","A","N","N","N","N","N","A","N","A","A","A","N","N","N","A","A","A","N","N","N","N","N","A","N","N","N","N","A"],"Division":["W","E","E","E","W","W","W","E","E","E","E","E","E","E","W","W","W","W","E","W","E","E","W","E","W","E","W","E","E","E","W","E","W","W","E","E","E","W","W","E","E","E","E","W","E","E","E","E","E","E","E","E","E","W","W","W","E","E","W","W","E","W","W","E","E","E","W"],"PutOuts":[632,805,280,222,732,262,267,109,326,307,58,109,280,224,182,104,276,246,45,59,102,269,118,137,670,368,276,623,885,161,110,290,227,249,190,1199,156,235,0,276,468,228,229,682,117,391,41,286,659,251,88,181,42,0,135,281,320,229,367,209,81,70,692,133,300,1182,408],"Assists":[43,40,9,3,83,329,5,292,29,25,4,7,10,286,9,213,6,389,122,156,132,17,334,5,57,20,7,35,105,3,308,440,15,444,2,149,2,22,0,421,47,7,453,93,269,44,118,8,53,9,204,3,94,0,257,21,465,406,432,246,147,144,70,173,12,96,4],"Errors":[10,4,5,3,13,16,3,25,5,1,4,3,5,8,4,9,2,18,26,9,10,10,21,9,5,3,9,3,8,3,15,25,3,16,2,5,2,5,0,11,6,5,15,13,12,4,8,8,7,4,16,2,13,0,7,3,32,22,16,3,4,11,8,9,9,13,3],"Salary":[475,91.5,100,708.333,750,625,900,612.5,67.5,180,247.5,70,933.333,850,325,275,600,475,70,595,375,1175,900,733.333,500,1237.5,100,1300,1008.333,600,200,640,110,195,1300,1800,225,265,587.5,420,100,800,1940,700,130,250,1050,215,400,560,500,191,140,740,341.667,90,155,150,90,326.667,250,185,920,277.5,160,1300,1000],"NewLeague":["N","N","N","N","N","N","A","A","A","A","A","N","A","N","A","A","A","A","A","N","A","A","A","N","A","A","N","N","N","N","A","N","A","N","A","N","A","N","A","A","N","N","N","N","N","A","A","A","A","A","A","N","N","A","A","A","N","N","N","N","N","A","A","N","N","N","A"],".pred":[505.150612379126,295.007978861202,388.843590792347,302.929045774006,537.452810284664,584.403140579847,1013.59942346079,616.995814125002,136.63535954536,186.172162880393,211.115759104698,142.308468317998,1245.40113309643,512.937429751822,468.00359897179,243.745454334772,632.032545421541,435.276674449978,222.454830244022,487.300668377266,244.605635324734,767.931461773619,777.805595623829,996.451881767754,394.631758706139,864.672681694599,322.715602272862,679.380847403598,666.811264850626,574.203576708669,596.325354611778,594.404659514144,177.440610068194,335.485580561323,751.508470247324,1174.47927069632,548.055357527596,198.941636336747,925.718313376008,909.873642283439,211.911934098216,499.211662226833,719.986074547853,453.530422825809,200.340340957091,349.040087873086,942.03267578186,556.600721781911,623.005680505971,501.28432835675,671.812036266573,333.874647013673,184.425884941223,832.841328097713,331.386110386507,128.460654923125,449.57840381296,338.276427346027,666.286805698464,375.801656239198,206.233112330441,347.537639911788,-25.9771181313033,289.641432939703,450.353504566328,863.817442835731,713.570880351703]},"columns":[{"accessor":"AtBat","name":"AtBat","type":"numeric"},{"accessor":"Hits","name":"Hits","type":"numeric"},{"accessor":"HmRun","name":"HmRun","type":"numeric"},{"accessor":"Runs","name":"Runs","type":"numeric"},{"accessor":"RBI","name":"RBI","type":"numeric"},{"accessor":"Walks","name":"Walks","type":"numeric"},{"accessor":"Years","name":"Years","type":"numeric"},{"accessor":"CAtBat","name":"CAtBat","type":"numeric"},{"accessor":"CHits","name":"CHits","type":"numeric"},{"accessor":"CHmRun","name":"CHmRun","type":"numeric"},{"accessor":"CRuns","name":"CRuns","type":"numeric"},{"accessor":"CRBI","name":"CRBI","type":"numeric"},{"accessor":"CWalks","name":"CWalks","type":"numeric"},{"accessor":"League","name":"League","type":"factor"},{"accessor":"Division","name":"Division","type":"factor"},{"accessor":"PutOuts","name":"PutOuts","type":"numeric"},{"accessor":"Assists","name":"Assists","type":"numeric"},{"accessor":"Errors","name":"Errors","type":"numeric"},{"accessor":"Salary","name":"Salary","type":"numeric"},{"accessor":"NewLeague","name":"NewLeague","type":"factor"},{"accessor":".pred","name":".pred","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"a6558260cdb0d3938d678ea60ea438dd","key":"a6558260cdb0d3938d678ea60ea438dd"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>We check how well the <code>.pred</code> column matches the Salary using <a href="https://yardstick.tidymodels.org/reference/rsq.html"><code>yardstick::rsq</code></a>.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>test_results <span class="sc">%&gt;%</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>  yardstick<span class="sc">::</span><span class="fu">rsq</span>(<span class="at">truth =</span> .data[[<span class="st">&quot;Salary&quot;</span>]], <span class="at">estimate =</span> .data[[<span class="st">&quot;.pred&quot;</span>]]) <span class="sc">%&gt;%</span></span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-48e44a75b8bfde61d9ba" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-48e44a75b8bfde61d9ba">{"x":{"tag":{"name":"Reactable","attribs":{"data":{".metric":["rsq"],".estimator":["standard"],".estimate":[0.460310144571116]},"columns":[{"accessor":".metric","name":".metric","type":"character"},{"accessor":".estimator","name":".estimator","type":"character"},{"accessor":".estimate","name":".estimate","type":"numeric"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"3a91c93c7df454b6a5594a3ebd58bc2f","key":"3a91c93c7df454b6a5594a3ebd58bc2f"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>Alternatively, we can use <a href="https://tune.tidymodels.org/reference/last_fit.html"><code>tune::last_fit</code></a> and <a href="https://tune.tidymodels.org/reference/collect_predictions.html"><code>tune::collect_metrics</code></a>.</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>test_rs <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">last_fit</span>(</span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">object =</span> pls_final_fit,</span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">split =</span> Hitters_split</span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a>test_rs <span class="sc">%&gt;%</span></span>
<span id="cb174-7"><a href="#cb174-7" aria-hidden="true" tabindex="-1"></a>  tune<span class="sc">::</span><span class="fu">collect_metrics</span>() <span class="sc">%&gt;%</span></span>
<span id="cb174-8"><a href="#cb174-8" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-e478163ca04668a396af" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-e478163ca04668a396af">{"x":{"tag":{"name":"Reactable","attribs":{"data":{".metric":["rmse","rsq"],".estimator":["standard","standard"],".estimate":[313.527614655955,0.460310144571116],".config":["Preprocessor1_Model1","Preprocessor1_Model1"]},"columns":[{"accessor":".metric","name":".metric","type":"character"},{"accessor":".estimator","name":".estimator","type":"character"},{"accessor":".estimate","name":".estimate","type":"numeric"},{"accessor":".config","name":".config","type":"character"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"456a91b9360253e801d6e26645aef21f","key":"456a91b9360253e801d6e26645aef21f"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>Use <a href="https://tune.tidymodels.org/reference/collect_predictions.html"><code>tune::collect_predictions</code></a>, to see only the actual and predicted values of the test data.</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>test_rs <span class="sc">%&gt;%</span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(<span class="at">defaultPageSize =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-f9561b307ab87e840159" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-f9561b307ab87e840159">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"id":["train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split","train/test split"],".pred":[505.150612379126,295.007978861202,388.843590792347,302.929045774006,537.452810284664,584.403140579847,1013.59942346079,616.995814125002,136.63535954536,186.172162880393,211.115759104698,142.308468317998,1245.40113309643,512.937429751822,468.00359897179,243.745454334772,632.032545421541,435.276674449978,222.454830244022,487.300668377266,244.605635324734,767.931461773619,777.805595623829,996.451881767754,394.631758706139,864.672681694599,322.715602272862,679.380847403598,666.811264850626,574.203576708669,596.325354611778,594.404659514144,177.440610068194,335.485580561323,751.508470247324,1174.47927069632,548.055357527596,198.941636336747,925.718313376008,909.873642283439,211.911934098216,499.211662226833,719.986074547853,453.530422825809,200.340340957091,349.040087873086,942.03267578186,556.600721781911,623.005680505971,501.28432835675,671.812036266573,333.874647013673,184.425884941223,832.841328097713,331.386110386507,128.460654923125,449.57840381296,338.276427346027,666.286805698464,375.801656239198,206.233112330441,347.537639911788,-25.9771181313033,289.641432939703,450.353504566328,863.817442835731,713.570880351703],".row":[1,4,18,23,24,25,26,28,32,33,36,39,56,57,59,60,64,68,71,73,78,80,86,91,96,106,108,111,113,123,124,130,132,134,138,140,152,154,157,159,169,178,183,184,192,195,196,197,198,199,203,211,214,216,218,221,224,227,230,235,236,240,241,250,252,253,263],"Salary":[475,91.5,100,708.333,750,625,900,612.5,67.5,180,247.5,70,933.333,850,325,275,600,475,70,595,375,1175,900,733.333,500,1237.5,100,1300,1008.333,600,200,640,110,195,1300,1800,225,265,587.5,420,100,800,1940,700,130,250,1050,215,400,560,500,191,140,740,341.667,90,155,150,90,326.667,250,185,920,277.5,160,1300,1000],".config":["Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1","Preprocessor1_Model1"]},"columns":[{"accessor":"id","name":"id","type":"character"},{"accessor":".pred","name":".pred","type":"numeric"},{"accessor":".row","name":".row","type":"numeric"},{"accessor":"Salary","name":"Salary","type":"numeric"},{"accessor":".config","name":".config","type":"character"}],"defaultPageSize":5,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"1767c4758b0e6a72885ba0c0786ba529","key":"1767c4758b0e6a72885ba0c0786ba529"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>Let us take a closer look at the predicted and actual response as a scatter plot.</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>test_rs <span class="sc">%&gt;%</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(</span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> .data[[<span class="st">&quot;Salary&quot;</span>]],</span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> .data[[<span class="st">&quot;.pred&quot;</span>]]</span>
<span id="cb176-6"><a href="#cb176-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb176-7"><a href="#cb176-7" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb176-8"><a href="#cb176-8" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">&quot;midnightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb176-9"><a href="#cb176-9" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">coord_fixed</span>()</span></code></pre></div>
<p><img src="figures/unnamed-chunk-121-1.png" width="3883.2" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="rmarkdown-template" class="section level1">
<h1>Rmarkdown Template</h1>
<p>This Rmarkdown template is created by the <a href="https://realitybending.github.io/">Reality Bending Lab</a>. The template can be download from the lab’s <a href="https://github.com/RealityBending/TemplateResults">github</a> repository. For more information about the motivation behind creating this template, check out <a href="https://dominiquemakowski.github.io/post/2021-02-10-template_results/">Dr. Dominique Makowski’s blog post</a></p>
</div>
<div id="blog-references" class="section level1">
<h1>Blog References</h1>
<ul>
<li><p>Emil Hvitfeldt’s <a href="https://emilhvitfeldt.github.io/ISLR-tidymodels-labs/linear-model-selection-and-regularization.html">ISLR tidymodels Labs</a></p></li>
<li><p>Julia Silge’s <a href="https://juliasilge.com/blog/lasso-the-office.html">blog</a> titled “LASSO regression using tidymodels and #TidyTuesday data for The Office”</p></li>
<li><p>Julia Silge’s <a href="https://juliasilge.com/blog/best-hip-hop.html">blog</a> titled “PCA and the #TidyTuesday best hip hop songs ever”</p></li>
</ul>
</div>
<div id="package-references" class="section level1">
<h1>Package References</h1>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">cite_packages</span>(<span class="fu">sessionInfo</span>())</span></code></pre></div>
<ul>
<li>Brandon M. Greenwell and Bradley C. Boehmke (2020). Variable Importance Plots—An Introduction to the vip Package. The R Journal, 12(1), 343–366. URL <a href="https://doi.org/10.32614/RJ-2020-013" class="uri">https://doi.org/10.32614/RJ-2020-013</a>.</li>
<li>David Robinson, Alex Hayes and Simon Couch (2022). broom: Convert Statistical Objects into Tidy Tibbles. R package version 0.7.12. <a href="https://CRAN.R-project.org/package=broom" class="uri">https://CRAN.R-project.org/package=broom</a></li>
<li>Davis Vaughan (2022). workflows: Modeling Workflows. R package version 0.2.6. <a href="https://CRAN.R-project.org/package=workflows" class="uri">https://CRAN.R-project.org/package=workflows</a></li>
<li>Douglas Bates and Martin Maechler (2021). Matrix: Sparse and Dense Matrix Classes and Methods. R package version 1.4-0. <a href="https://CRAN.R-project.org/package=Matrix" class="uri">https://CRAN.R-project.org/package=Matrix</a></li>
<li>Gareth James, Daniela Witten, Trevor Hastie and Rob Tibshirani (2022). ISLR2: Introduction to Statistical Learning, Second Edition. R package version 1.3-1. <a href="https://CRAN.R-project.org/package=ISLR2" class="uri">https://CRAN.R-project.org/package=ISLR2</a></li>
<li>Garrick Aden-Buie and Matthew T. Warkentin (2022). xaringanExtra: Extras And Extensions for Xaringan Slides. R package version 0.5.5. <a href="https://github.com/gadenbuie/xaringanExtra" class="uri">https://github.com/gadenbuie/xaringanExtra</a></li>
<li>Greg Lin (2020). reactable: Interactive Data Tables Based on ‘React Table’. R package version 0.2.3. <a href="https://CRAN.R-project.org/package=reactable" class="uri">https://CRAN.R-project.org/package=reactable</a></li>
<li>H. Wickham. ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York, 2016.</li>
<li>Hadley Wickham (2021). forcats: Tools for Working with Categorical Variables (Factors). R package version 0.5.1. <a href="https://CRAN.R-project.org/package=forcats" class="uri">https://CRAN.R-project.org/package=forcats</a></li>
<li>Hadley Wickham and Dana Seidel (2020). scales: Scale Functions for Visualization. R package version 1.1.1. <a href="https://CRAN.R-project.org/package=scales" class="uri">https://CRAN.R-project.org/package=scales</a></li>
<li>Hadley Wickham and Maximilian Girlich (2022). tidyr: Tidy Messy Data. R package version 1.2.0. <a href="https://CRAN.R-project.org/package=tidyr" class="uri">https://CRAN.R-project.org/package=tidyr</a></li>
<li>Hadley Wickham, Romain François, Lionel Henry and Kirill Müller (2022). dplyr: A Grammar of Data Manipulation. R package version 1.0.8. <a href="https://CRAN.R-project.org/package=dplyr" class="uri">https://CRAN.R-project.org/package=dplyr</a></li>
<li>Jerome Friedman, Trevor Hastie, Robert Tibshirani (2010). Regularization Paths for Generalized Linear Models via Coordinate Descent. Journal of Statistical Software, 33(1), 1-22. URL <a href="https://www.jstatsoft.org/v33/i01/" class="uri">https://www.jstatsoft.org/v33/i01/</a>.</li>
<li>JJ Allaire and Yihui Xie and Jonathan McPherson and Javier Luraschi and Kevin Ushey and Aron Atkins and Hadley Wickham and Joe Cheng and Winston Chang and Richard Iannone (2022). rmarkdown: Dynamic Documents for R. R package version 2.13. URL <a href="https://rmarkdown.rstudio.com" class="uri">https://rmarkdown.rstudio.com</a>.</li>
<li>Joe Cheng, Carson Sievert, Barret Schloerke, Winston Chang, Yihui Xie and Jeff Allen (2021). htmltools: Tools for HTML. R package version 0.5.2. <a href="https://CRAN.R-project.org/package=htmltools" class="uri">https://CRAN.R-project.org/package=htmltools</a></li>
<li>Julia Silge, Fanny Chow, Max Kuhn and Hadley Wickham (2021). rsample: General Resampling Infrastructure. R package version 0.1.1. <a href="https://CRAN.R-project.org/package=rsample" class="uri">https://CRAN.R-project.org/package=rsample</a></li>
<li>Kirill Müller and Lorenz Walthert (2022). styler: Non-Invasive Pretty Printing of R Code. R package version 1.7.0. <a href="https://CRAN.R-project.org/package=styler" class="uri">https://CRAN.R-project.org/package=styler</a></li>
<li>Makowski, D., Ben-Shachar, M.S., Patil, I. &amp; Lüdecke, D. (2020). Automated Results Reporting as a Practical Tool to Improve Reproducibility and Methodological Best Practices Adoption. CRAN. Available from <a href="https://github.com/easystats/report" class="uri">https://github.com/easystats/report</a>. doi: .</li>
<li>Max Kuhn (2022). tune: Tidy Tuning Tools. R package version 0.2.0. <a href="https://CRAN.R-project.org/package=tune" class="uri">https://CRAN.R-project.org/package=tune</a></li>
<li>Max Kuhn and Davis Vaughan (2021). yardstick: Tidy Characterizations of Model Performance. R package version 0.0.9. <a href="https://CRAN.R-project.org/package=yardstick" class="uri">https://CRAN.R-project.org/package=yardstick</a></li>
<li>Max Kuhn and Davis Vaughan (2022). parsnip: A Common API to Modeling and Analysis Functions. R package version 0.2.1. <a href="https://CRAN.R-project.org/package=parsnip" class="uri">https://CRAN.R-project.org/package=parsnip</a></li>
<li>Max Kuhn and Hadley Wickham (2022). recipes: Preprocessing and Feature Engineering Steps for Modeling. R package version 0.2.0. <a href="https://CRAN.R-project.org/package=recipes" class="uri">https://CRAN.R-project.org/package=recipes</a></li>
<li>Max Kuhn and Hannah Frick (2022). dials: Tools for Creating Tuning Parameter Values. R package version 0.1.0. <a href="https://CRAN.R-project.org/package=dials" class="uri">https://CRAN.R-project.org/package=dials</a></li>
<li>Microsoft and Steve Weston (2022). foreach: Provides Foreach Looping Construct. R package version 1.5.2. <a href="https://CRAN.R-project.org/package=foreach" class="uri">https://CRAN.R-project.org/package=foreach</a></li>
<li>Microsoft Corporation and Steve Weston (2022). doParallel: Foreach Parallel Adaptor for the ‘parallel’ Package. R package version 1.0.17. <a href="https://CRAN.R-project.org/package=doParallel" class="uri">https://CRAN.R-project.org/package=doParallel</a></li>
<li>R Core Team (2022). R: A language and environment for statistical computing. R Foundation for Statistical Computing, Vienna, Austria. URL <a href="https://www.R-project.org/" class="uri">https://www.R-project.org/</a>.</li>
<li>Revolution Analytics and Steve Weston (2022). iterators: Provides Iterator Construct. R package version 1.0.14. <a href="https://CRAN.R-project.org/package=iterators" class="uri">https://CRAN.R-project.org/package=iterators</a></li>
<li>Rohart F, Gautier B, Singh A, and Le Cao K-A (2017) mixOmics: An R package for ’omics feature selection and multiple data integration. PLoS computational biology 13(11):e1005752</li>
<li>Sarkar, Deepayan (2008) Lattice: Multivariate Data Visualization with R. Springer, New York. ISBN 978-0-387-75968-5</li>
<li>Silge J, Robinson D (2016). “tidytext: Text Mining andAnalysis Using Tidy Data Principles in R.” <em>JOSS</em>, <em>1</em>(3).doi: 10.21105/joss.00037 (URL:<a href="https://doi.org/10.21105/joss.00037" class="uri">https://doi.org/10.21105/joss.00037</a>), &lt;URL:<a href="http://dx.doi.org/10.21105/joss.00037" class="uri">http://dx.doi.org/10.21105/joss.00037</a>&gt;.</li>
<li>Stefan Milton Bache and Hadley Wickham (2022). magrittr: A Forward-Pipe Operator for R. R package version 2.0.2. <a href="https://CRAN.R-project.org/package=magrittr" class="uri">https://CRAN.R-project.org/package=magrittr</a></li>
<li>Thomas Lumley based on Fortran code by Alan Miller (2020). leaps: Regression Subset Selection. R package version 3.1. <a href="https://CRAN.R-project.org/package=leaps" class="uri">https://CRAN.R-project.org/package=leaps</a></li>
<li>Venables, W. N. &amp; Ripley, B. D. (2002) Modern Applied Statistics with S. Fourth Edition. Springer, New York. ISBN 0-387-95457-0</li>
<li>Yihui Xie (2022). knitr: A General-Purpose Package for Dynamic Report Generation in R. R package version 1.38.</li>
</ul>
</div>

<div id="rmd-source-code">LS0tDQp0aXRsZTogJyoqQ2hhcHRlciA2IExhYioqJw0KYXV0aG9yOiAiSmVyZW15IFNlbHZhIg0Kc3VidGl0bGU6IFRoaXMgZG9jdW1lbnQgd2FzIHByZXBhcmVkIG9uIGByIGZvcm1hdChTeXMuRGF0ZSgpKWAuDQpvdXRwdXQ6DQogIGh0bWxfZG9jdW1lbnQ6DQogICAgdGhlbWU6IGNlcnVsZWFuDQogICAgaGlnaGxpZ2h0OiBweWdtZW50cw0KICAgIHRvYzogeWVzDQogICAgdG9jX2RlcHRoOiAzDQogICAgdG9jX2Zsb2F0Og0KICAgICAgY29sbGFwc2VkOiB0cnVlDQogICAgICBzbW9vdGhfc2Nyb2xsOiB0cnVlDQogICAgbnVtYmVyX3NlY3Rpb25zOiBubw0KICAgIGNvZGVfZm9sZGluZzogc2hvdw0KICAgIGNvZGVfZG93bmxvYWQ6IHllcw0KICAgIHNlbGZfY29udGFpbmVkOiBmYWxzZQ0KICAgIGxpYl9kaXI6ICJkb2NzL3JtYXJrZG93bl9saWJzIg0KICBybWFya2Rvd246Omh0bWxfdmlnbmV0dGU6DQogICAgdG9jOiB5ZXMNCiAgICB0b2NfZGVwdGg6IDINCmVkaXRvcl9vcHRpb25zOg0KICBjaHVua19vdXRwdXRfdHlwZTogY29uc29sZQ0KICBtYXJrZG93bjogDQogICAgd3JhcDogNzINCi0tLQ0KDQo8IS0tIA0KISEhISBJTVBPUlRBTlQ6IHJ1biBgc291cmNlKCJ1dGlscy9yZW5kZXIuUiIpYCB0byBwdWJsaXNoIGluc3RlYWQgb2YgY2xpY2tpbmcgb24gJ0tuaXQnDQojIFNlZSBodHRwczovL3lpaHVpLm9yZy9rbml0ci9vcHRpb25zLw0KLS0+DQoNCmBgYHtyIHNldHVwLCB3YXJuaW5nPUZBTFNFLCBtZXNzYWdlPVRSVUUsIGluY2x1ZGU9RkFMU0V9DQojIFNldCB1cCB0aGUgZW52aXJvbm1lbnQNCg0KIyBPcHRpb25zIHJlbGF0aXZlIHRvIGZpZ3VyZSBzaXplDQojIDEuNjE4IGlzIHRoZSBnb2xkZW4gcmF0aW8NCmZpZ2hlaWdodCA8LSA0DQpmaWd3aWR0aCA8LSA0ICogMS42MTggDQoNCiMgR2VuZXJhbCBvcHRpb25zDQpvcHRpb25zKGtuaXRyLmthYmxlLk5BID0gIiIsDQogICAgICAgIG5zbWFsbCA9IDMsDQogICAgICAgIHRpZHl2ZXJzZS5xdWlldCA9IFRSVUUNCiAgICAgICAgKQ0KaG9va19vdXRwdXQgPC0ga25pdHI6OmtuaXRfaG9va3MkZ2V0KCdvdXRwdXQnKQ0KDQprbml0cjo6a25pdF9ob29rcyRzZXQoDQogIG91dHB1dCA9IGZ1bmN0aW9uKHgsIG9wdGlvbnMpIHsNCiAgICBpZiAoIWlzLm51bGwob3B0aW9ucyRtYXguaGVpZ2h0KSkgew0KICAgICAgb3B0aW9ucyRhdHRyLm91dHB1dCA8LSBjKG9wdGlvbnMkYXR0ci5vdXRwdXQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ByaW50Zignc3R5bGU9Im1heC1oZWlnaHQ6ICVzOyInLCBvcHRpb25zJG1heC5oZWlnaHQpKQ0KICAgIH0NCiAgICBob29rX291dHB1dCh4LCBvcHRpb25zKQ0KICAgIH0NCiAgKQ0KDQojIENodW5rIG9wdGlvbnMgKHNlZSBodHRwczovL3lpaHVpLm9yZy9rbml0ci9vcHRpb25zLyNjaHVua19vcHRpb25zKQ0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KA0KICBjb21tZW50ID0gIj4iLCAgIyBUaGUgcHJlZml4IHRvIGJlIGFkZGVkIGJlZm9yZSBlYWNoIGxpbmUgb2YgdGhlIHRleHQgb3V0cHV0Lg0KICBkcGkgPSA2MDAsDQogIGZpZy5wYXRoID0gImRvY3MvZmlndXJlcy8iLA0KICBmaWcuaGVpZ2h0ID0gZmlnaGVpZ2h0LA0KICBmaWcud2lkdGggPSBmaWd3aWR0aCwNCiAgZmlnLmFsaWduID0gImNlbnRlciIsDQogICMgU2VlIGh0dHBzOi8vY29tbXVuaXR5LnJzdHVkaW8uY29tL3QvY2VudGVyaW5nLWltYWdlcy1pbi1ibG9nZG93bi1wb3N0LzIwOTYyDQogICMgdG8gbGVhcm4gaG93IHRvIGNlbnRlciBpbWFnZXMNCiAgIyBTZWUgaHR0cHM6Ly9ib29rZG93bi5vcmcveWlodWkvcm1hcmtkb3duLWNvb2tib29rL29wdHMtdGlkeS5odG1sDQogICMgU2VlIGh0dHBzOi8vd3d3LnpvdGVyby5vcmcvc3R5bGVzIGZvciBjaXRhdGlvbiBzdHlsZSByZXNwb3NpdG9yeQ0KICB0aWR5PSdzdHlsZXInLA0KICB0aWR5Lm9wdHM9bGlzdChzdHJpY3Q9VFJVRSkNCikNCg0KaHRtbHRvb2xzOjp0YWdMaXN0KA0KICB4YXJpbmdhbkV4dHJhOjp1c2VfY2xpcGJvYXJkKA0KICAgIGJ1dHRvbl90ZXh0ID0gIjxpIGNsYXNzPVwiZmEgZmEtY2xpcGJvYXJkXCI+PC9pPiBDb3B5IENvZGUiLA0KICAgIHN1Y2Nlc3NfdGV4dCA9ICI8aSBjbGFzcz1cImZhIGZhLWNoZWNrXCIgc3R5bGU9XCJjb2xvcjogIzkwQkU2RFwiPjwvaT4gQ29waWVkISIsDQogICksDQogIHJtYXJrZG93bjo6aHRtbF9kZXBlbmRlbmN5X2ZvbnRfYXdlc29tZSgpDQopDQpgYGANCg0KYGBge3Igd2FybmluZz1GQUxTRSwgbWVzc2FnZT1GQUxTRSwgcmVzdWx0cz0nYXNpcycsIGNsYXNzLnNvdXJjZSA9ICdmb2xkLWhpZGUnfQ0KIyBSbWFya2Rvd24gc3R1ZmYNCmxpYnJhcnkocm1hcmtkb3duLCBxdWlldGx5PVRSVUUpDQpsaWJyYXJ5KGtuaXRyLCBxdWlldGx5PVRSVUUpDQpsaWJyYXJ5KGh0bWx0b29scywgcXVpZXRseT1UUlVFKQ0KbGlicmFyeShzdHlsZXIsIHF1aWV0bHk9VFJVRSkNCmxpYnJhcnkoeGFyaW5nYW5FeHRyYSwgcXVpZXRseT1UUlVFKQ0KDQojIERhdGFzZXQNCmxpYnJhcnkoSVNMUjIsIHF1aWV0bHk9VFJVRSkNCg0KIyBTZXNzaW9uIGluZm8gYW5kIHBhY2thZ2UgcmVwb3J0aW5nDQpsaWJyYXJ5KHJlcG9ydCwgcXVpZXRseT1UUlVFKQ0KDQojIERhdGEgd3JhbmdsaW5nDQoNCmxpYnJhcnkoZHBseXIsIHF1aWV0bHk9VFJVRSkNCmxpYnJhcnkodGlkeXIsIHF1aWV0bHk9VFJVRSkNCmxpYnJhcnkobWFncml0dHIsIHF1aWV0bHk9VFJVRSkNCg0KIyBDcmVhdGUgaW50ZXJhY3RpdmUgdGFibGVzDQpsaWJyYXJ5KHJlYWN0YWJsZSwgcXVpZXRseT1UUlVFKQ0KDQojIEZvciBwbG90dGluZw0KDQpsaWJyYXJ5KGZvcmNhdHMsIHF1aWV0bHk9VFJVRSkNCmxpYnJhcnkoc2NhbGVzLCBxdWlldGx5PVRSVUUpDQpsaWJyYXJ5KHRpZHl0ZXh0LCBxdWlldGx5PVRSVUUpDQpsaWJyYXJ5KGdncGxvdDIsIHF1aWV0bHk9VFJVRSkNCg0KIyBGb3IgcGFyYWxsZWwgcHJvY2Vzc2luZyBmb3IgdHVuaW5nDQpsaWJyYXJ5KGZvcmVhY2gsIHF1aWV0bHk9VFJVRSkNCmxpYnJhcnkoZG9QYXJhbGxlbCwgcXVpZXRseT1UUlVFKQ0KDQojIEZvciBhcHBseWluZyB0aWR5bW9kZWxzDQoNCmxpYnJhcnkoYnJvb20sIHF1aWV0bHk9VFJVRSkNCmxpYnJhcnkocnNhbXBsZSwgcXVpZXRseT1UUlVFKQ0KbGlicmFyeShwYXJzbmlwLCBxdWlldGx5PVRSVUUpDQpsaWJyYXJ5KHJlY2lwZXMsIHF1aWV0bHk9VFJVRSkNCmxpYnJhcnkoZGlhbHMsIHF1aWV0bHk9VFJVRSkNCmxpYnJhcnkodHVuZSwgcXVpZXRseT1UUlVFKQ0KbGlicmFyeSh3b3JrZmxvd3MsIHF1aWV0bHk9VFJVRSkNCmxpYnJhcnkoeWFyZHN0aWNrLCBxdWlldGx5PVRSVUUpDQoNCiMgRm9yIHN1YnNldCBzZWxlY3Rpb24NCmxpYnJhcnkobGVhcHMsIHF1aWV0bHk9VFJVRSkNCg0KIyBGb3IgcmlkZ2UgcmVncmVzc2lvbiBhbmQgbGFzc28NCmxpYnJhcnkoZ2xtbmV0LCBxdWlldGx5PVRSVUUpDQoNCiMgRm9yIHBhcnRpYWwgbGVhc3Qgc3F1YXJlIHJlZ3Jlc3Npb24NCiMgSW4gcmVjaXBlczo6c3RlcF9wbHMNCiMgV2FybmluZyBtZXNzYWdlOg0KIyAgYHN0ZXBfcGxzKClgIGZhaWxlZDogRXJyb3IgaW4gbG9hZE5hbWVzcGFjZSh4KSA6IHRoZXJlIGlzIG5vIHBhY2thZ2UgY2FsbGVkIOKAmG1peE9taWNz4oCZDQojIEluc3RhbGwgZnJvbSBCaW9jb25kdWN0b3INCmxpYnJhcnkobWl4T21pY3MsIHF1aWV0bHk9VFJVRSkNCg0KIyBGb3IgdmFyaWFibGUgaW1wb3J0YW5jZQ0KbGlicmFyeSh2aXAsIHF1aWV0bHk9VFJVRSkNCg0Kc3VtbWFyeShyZXBvcnQ6OnJlcG9ydChzZXNzaW9uSW5mbygpKSkNCmBgYA0KDQojIFN1YnNldCBTZWxlY3Rpb24gTWV0aG9kcw0KDQojIyBCZXN0IFN1YnNldCBTZWxlY3Rpb24NCg0KYGBge3IsIGVjaG89RkFMU0V9DQpzZXQuc2VlZCgxMjM0KQ0KYGBgDQoNCldlIHdpbGwgYmUgdXNpbmcgdGhlIFtgSGl0dGVyc2BdKGh0dHBzOi8vcmRyci5pby9jcmFuL0lTTFIyL21hbi9IaXR0ZXJzLmh0bWwpIGRhdGEgc2V0IGZyb20gdGhlIGBJU0xSMmAgcGFja2FnZS4gV2Ugd2lzaA0KdG8gcHJlZGljdCB0aGUgYmFzZWJhbGwgcGxheWVycyBgU2FsYXJ5YCBiYXNlZCBvbiBzZXZlcmFsIGRpZmZlcmVudA0KY2hhcmFjdGVyaXN0aWNzIHdoaWNoIGFyZSBpbmNsdWRlZCBpbiB0aGUgZGF0YSBzZXQuDQoNClJlbW92ZSBhbGwgcm93cyB3aXRoIG1pc3NpbmcgZGF0YSBmcm9tIHRoYXQgY29sdW1uLg0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCg0KSGl0dGVycyA8LSBkcGx5cjo6YXNfdGliYmxlKElTTFIyOjpIaXR0ZXJzKSAlPiUNCiAgdGlkeXI6OmRyb3BfbmEoKQ0KDQpIaXR0ZXJzICU+JQ0KICByZWFjdGFibGU6OnJlYWN0YWJsZShkZWZhdWx0UGFnZVNpemUgPSA1LA0KICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJhYmxlID0gVFJVRSkNCmBgYA0KDQpVc2UgYGxlYXBzOjpyZWdzdWJzZXRzYCBmdW5jdGlvbiB0byBwZXJmb3JtcyBiZXN0IHN1YnNldCBzZWxlY3Rpb24uDQoNCkFuIGFzdGVyaXNrIGluZGljYXRlcyB0aGF0IGEgZ2l2ZW4gdmFyaWFibGUgaXMgaW5jbHVkZWQgaW4gdGhlDQpjb3JyZXNwb25kaW5nIG1vZGVsLiBGb3IgaW5zdGFuY2UsIHRoaXMgb3V0cHV0IGluZGljYXRlcyB0aGF0IHRoZSBiZXN0DQp0d28tdmFyaWFibGUgbW9kZWwgY29udGFpbnMgb25seSBIaXRzIGFuZCBDUkJJLg0KDQpgYGB7ciwgbWVzc2FnZSA9IEZBTFNFLCBtYXguaGVpZ2h0ID0gJzE1MHB4J30NCg0KcmVnZml0LmZ1bGwgPC0gbGVhcHM6OnJlZ3N1YnNldHMoDQogIHggPSBTYWxhcnkgfiAuLCANCiAgZGF0YSA9IEhpdHRlcnMsDQogIG52bWF4ID0gOCAjZGVmYXVsdA0KICApDQoNCnN1bW1hcnkocmVnZml0LmZ1bGwpDQpgYGANCg0KSGVyZSB3ZSBmaXQgdXAgdG8gYSAxOS12YXJpYWJsZSBtb2RlbC4NCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQoNCnJlZ2ZpdC5mdWxsIDwtIGxlYXBzOjpyZWdzdWJzZXRzKA0KICB4ID0gU2FsYXJ5IH4gLiwgDQogIGRhdGEgPSBIaXR0ZXJzLA0KICBudm1heCA9IDE5DQogICkNCmBgYA0KDQpUaGUgYHN1bW1hcnlgIGZ1bmN0aW9uIGFsc28gcmV0dXJucyAkUl4yJCwgJFJTUyQsIGFkanVzdGVkICRSXjIkLCAkQ19wJCwNCmFuZCAkQklDJC4gV2UgY2FuIGV4YW1pbmUgdGhlc2UgdG8gdHJ5IHRvIHNlbGVjdCB0aGUgYmVzdCBvdmVyYWxsIG1vZGVsLg0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCg0KcmVnLnN1bW1hcnkgPC0gcmVnZml0LmZ1bGwgJT4lDQogIHN1bW1hcnkoKQ0KDQpuYW1lcyhyZWcuc3VtbWFyeSkNCmBgYA0KDQpGb3IgaW5zdGFuY2UsIHdlIHNlZSB0aGF0IHRoZSAkUl4yJCBzdGF0aXN0aWMgaW5jcmVhc2VzIGZyb20gMzIgJSwgd2hlbg0Kb25seSBvbmUgdmFyaWFibGUgaXMgaW5jbHVkZWQgaW4gdGhlIG1vZGVsLCB0byBhbG1vc3QgNTUgJSwgd2hlbiBhbGwNCnZhcmlhYmxlcyBhcmUgaW5jbHVkZWQuIEFzIGV4cGVjdGVkLCB0aGUgJFJeMiQgc3RhdGlzdGljIGluY3JlYXNlcw0KbW9ub3RvbmljYWxseSBhcyBtb3JlIHZhcmlhYmxlcyBhcmUgaW5jbHVkZWQuDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KDQpyZWcuc3VtbWFyeSRyc3ENCmBgYA0KDQpUaGUgYGxlYXBzOjpyZWdzdWJzZXRzYCBmdW5jdGlvbiBoYXMgYSBidWlsdC1pbiBgcGxvdGAgY29tbWFuZCB3aGljaCBjYW4NCmJlIHVzZWQgdG8gZGlzcGxheSB0aGUgc2VsZWN0ZWQgdmFyaWFibGVzIGZvciB0aGUgYmVzdCBtb2RlbCB3aXRoIGENCmdpdmVuIG51bWJlciBvZiBwcmVkaWN0b3JzLCByYW5rZWQgYWNjb3JkaW5nIHRvIHRoZSAkQklDJCwgJENfcCQsDQphZGp1c3RlZCAkUl4yJCwgb3IgJEFJQyQuIFRvIGZpbmQgb3V0IG1vcmUgYWJvdXQgdGhpcyBmdW5jdGlvbiwgdHlwZQ0KYD9wbG90LnJlZ3N1YnNldHNgLg0KDQpUaGUgdG9wIHJvdyBvZiBlYWNoIHBsb3QgY29udGFpbnMgYSBibGFjayBzcXVhcmUgZm9yIGVhY2ggdmFyaWFibGUNCnNlbGVjdGVkIGFjY29yZGluZyB0byB0aGUgb3B0aW1hbCBtb2RlbCBhc3NvY2lhdGVkIHdpdGggdGhhdCBzdGF0aXN0aWMuDQpGb3IgaW5zdGFuY2UsIHdlIHNlZSB0aGF0IHNldmVyYWwgbW9kZWxzIHNoYXJlIGEgJEJJQyQgY2xvc2UgdG8gJOKIkjE1MCQuDQpIb3dldmVyLCB0aGUgbW9kZWwgd2l0aCB0aGUgbG93ZXN0ICRCSUMkIGlzIHRoZSBzaXgtdmFyaWFibGUgbW9kZWwgdGhhdA0KY29udGFpbnMgb25seSBgQXRCYXRgLCBgSGl0c2AsIGBXYWxrc2AsIGBDUkJJYCwgYERpdmlzaW9uV2AsIGFuZA0KYFB1dE91dHNgLg0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCnBsb3QocmVnZml0LmZ1bGwgLCBzY2FsZSA9ICJiaWMiKQ0KYGBgDQoNCldlIGNhbiB1c2UgdGhlIGBjb2VmYCBmdW5jdGlvbiB0byBzZWUgdGhlIGNvZWZmaWNpZW50IGVzdGltYXRlcw0KYXNzb2NpYXRlZCB3aXRoIHRoaXMgbW9kZWwuDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KY29lZihyZWdmaXQuZnVsbCAsIDYpDQpgYGANCg0KIyMgRm9yd2FyZCBhbmQgQmFja3dhcmQgU3RlcHdpc2UgU2VsZWN0aW9uDQoNCldlIGNhbiBhbHNvIHVzZSB0aGUgYGxlYXBzOjpyZWdzdWJzZXRzYCBmdW5jdGlvbiB0byBwZXJmb3JtIGZvcndhcmQNCnN0ZXB3aXNlIHNlbGVjdGlvbiB1c2luZyB0aGUgYXJndW1lbnQgYG1ldGhvZCA9ICJmb3J3YXJkImANCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0UsIG1heC5oZWlnaHQ9JzE1MHB4J30NCnJlZ2ZpdC5md2QgPC0gbGVhcHM6OnJlZ3N1YnNldHMoDQogIHggPSBTYWxhcnkgfiAuLCANCiAgZGF0YSA9IEhpdHRlcnMgLA0KICBudm1heCA9IDE5LCANCiAgbWV0aG9kID0gImZvcndhcmQiDQopDQoNCnN1bW1hcnkocmVnZml0LmZ3ZCkNCmBgYA0KDQpUbyBwZXJmb3JtIGJhY2t3YXJkIHN0ZXB3aXNlIHNlbGVjdGlvbiwgdXNlIHRoZSBhcmd1bWVudA0KYG1ldGhvZCA9ICJiYWNrd2FyZCJgDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFLCBtYXguaGVpZ2h0PScxNTBweCd9DQpyZWdmaXQuYndkIDwtIGxlYXBzOjpyZWdzdWJzZXRzKA0KICB4ID0gU2FsYXJ5IH4gLiwgDQogIGRhdGEgPSBIaXR0ZXJzICwNCiAgbnZtYXggPSAxOSwgDQogIG1ldGhvZCA9ICJiYWNrd2FyZCINCikNCg0Kc3VtbWFyeShyZWdmaXQuYndkKQ0KYGBgDQoNCkZvciB0aGlzIGRhdGEsIHRoZSBiZXN0IHNldmVuLXZhcmlhYmxlIG1vZGVscyBpZGVudGlmaWVkIGJ5IGZvcndhcmQNCnN0ZXB3aXNlIHNlbGVjdGlvbiwgYmFja3dhcmQgc3RlcHdpc2Ugc2VsZWN0aW9uLCBhbmQgYmVzdCBzdWJzZXQNCnNlbGVjdGlvbiBhcmUgZGlmZmVyZW50Lg0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCg0KY29lZihyZWdmaXQuZnVsbCw3KQ0KY29lZihyZWdmaXQuZndkLDcpDQpjb2VmKHJlZ2ZpdC5id2QsNykNCg0KYGBgDQoNCiMjIENob29zaW5nIEFtb25nIE1vZGVscyBVc2luZyB0aGUgVmFsaWRhdGlvbi1TZXQgQXBwcm9hY2gNCg0KV2Ugc3BsaXQgdGhlIHNhbXBsZXMgaW50byB0cmFpbmluZyBzZXQgYW5kIGEgdGVzdCBzZXQNCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQoNCnNldC5zZWVkKDEyMzQpDQoNCkhpdHRlcnMgPC0gSGl0dGVycyAlPiUNCiAgZHBseXI6Om11dGF0ZSgNCiAgICBpc1RyYWluaW5nU2V0ID0gc2FtcGxlKHggPSBjKFRSVUUgLCBGQUxTRSksDQogICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplID0gbnJvdyhIaXR0ZXJzKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcGxhY2UgPSBUUlVFKQ0KICApICU+JQ0KICBkcGx5cjo6cmVsb2NhdGUoLmRhdGFbWyJpc1RyYWluaW5nU2V0Il1dKQ0KDQp0cmFpbiA8LSBIaXR0ZXJzICU+JQ0KICBkcGx5cjo6ZmlsdGVyKC5kYXRhW1siaXNUcmFpbmluZ1NldCJdXSA9PSBUUlVFKSAlPiUNCiAgZHBseXI6OnNlbGVjdCgtYygiaXNUcmFpbmluZ1NldCIpKQ0KDQp0ZXN0IDwtIEhpdHRlcnMgJT4lDQogIGRwbHlyOjpmaWx0ZXIoLmRhdGFbWyJpc1RyYWluaW5nU2V0Il1dPT0gRkFMU0UpICU+JQ0KICBkcGx5cjo6c2VsZWN0KC1jKCJpc1RyYWluaW5nU2V0IikpDQoNCmBgYA0KDQpOb3csIHdlIGFwcGx5IGBsZWFwczo6cmVnc3Vic2V0c2AgdG8gdGhlIHRyYWluaW5nIHNldCBpbiBvcmRlciB0bw0KcGVyZm9ybSBiZXN0IHN1YnNldCBzZWxlY3Rpb24gYW5kIGNvbXB1dGUgdGhlIHRoZSB2YWxpZGF0aW9uIHNldCBlcnJvcg0KZm9yIHRoZSBiZXN0IG1vZGVsIG9mIGVhY2ggbW9kZWwgc2l6ZS4NCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQoNCnJlZ2ZpdC5iZXN0IDwtIGxlYXBzOjpyZWdzdWJzZXRzKFNhbGFyeSB+IC4sIGRhdGEgPSB0cmFpbiwgbnZtYXggPSAxOSkNCg0KdGVzdC5tYXQgPC0gc3RhdHM6Om1vZGVsLm1hdHJpeChTYWxhcnkgfiAuLCBkYXRhID0gdGVzdCkNCg0KdmFsLmVycm9ycyA8LSByZXAoTkEsIDE5KQ0KDQpmb3IgKGkgaW4gMToxOSkgew0KICBjb2VmaSA8LSBzdGF0czo6Y29lZihyZWdmaXQuYmVzdCAsIGlkID0gaSkNCiAgcHJlZCA8LSB0ZXN0Lm1hdFssIG5hbWVzKGNvZWZpKV0gJSolIGNvZWZpDQogIHZhbC5lcnJvcnNbaV0gPC0gbWVhbiAoKCB0ZXN0JFNhbGFyeSAtIHByZWQpXjIpDQp9DQoNCnZhbC5lcnJvcnMNCmBgYA0KDQpXZSBmaW5kIHRoYXQgdGhlIGJlc3QgbW9kZWwgaXMgdGhlIG9uZSB0aGF0IGNvbnRhaW5zIHNldmVuIHZhcmlhYmxlcy4NCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQp3aGljaC5taW4odmFsLmVycm9ycykNCg0KY29lZihyZWdmaXQuYmVzdCAsIDcpDQpgYGANCg0KSG93ZXZlciwgdGhlIGJlc3Qgc2V2ZW4tdmFyaWFibGUgbW9kZWwgb24gdGhlIGZ1bGwgZGF0YSBzZXQgaGFzIGENCmRpZmZlcmVudCBzZXQgb2YgdmFyaWFibGVzIHRoYW4gdGhlIGJlc3Qgc2V2ZW4tdmFyaWFibGUgbW9kZWwgb24gdGhlDQp0cmFpbmluZyBzZXQuDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KcmVnZml0LmJlc3QgPC0gbGVhcHM6OnJlZ3N1YnNldHMoU2FsYXJ5IH4gLiwgZGF0YSA9IEhpdHRlcnMgLCBudm1heCA9IDE5KQ0KY29lZihyZWdmaXQuYmVzdCAsIDcpDQpgYGANCg0KIyMgQ2hvb3NpbmcgQW1vbmcgTW9kZWxzIFVzaW5nIENyb3NzLVZhbGlkYXRpb24NCg0KV2Ugbm93IHRyeSB0byBjaG9vc2UgYW1vbmcgdGhlIG1vZGVscyBvZiBkaWZmZXJlbnQgc2l6ZXMgdXNpbmcgY3Jvc3MNCnZhbGlkYXRpb24uIENyZWF0ZSBhIHZlY3RvciB0aGF0IGFsbG9jYXRlcyBlYWNoIG9ic2VydmF0aW9uIHRvIG9uZSBvZiBrDQo9IDEwIGZvbGRzLg0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCnNldC5zZWVkICgxKQ0KDQprIDwtIDEwDQpuIDwtIG5yb3coSGl0dGVycykNCmZvbGRzIDwtIHNhbXBsZShyZXAgKDE6aywgbGVuZ3RoID0gbikpDQoNCmBgYA0KDQpXZSB3cml0ZSBhIGZvciBsb29wIHRoYXQgcGVyZm9ybXMgY3Jvc3MtdmFsaWRhdGlvbg0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCg0KIyBBIHByZWRpY3QgbWV0aG9kIGZvciBsZWFwczo6cmVnc3Vic2V0cw0KcHJlZGljdC5yZWdzdWJzZXRzIDwtIGZ1bmN0aW9uKG9iamVjdCAsIG5ld2RhdGEgLCBpZCwgLi4uKSB7DQogIGZvcm0gPC0gYXMuZm9ybXVsYShvYmplY3QkY2FsbCBbWzJdXSkNCiAgbWF0IDwtIG1vZGVsLm1hdHJpeChmb3JtICwgbmV3ZGF0YSkNCiAgY29lZmkgPC0gY29lZihvYmplY3QgLCBpZCA9IGlkKQ0KICB4dmFycyA8LSBuYW1lcyhjb2VmaSkNCiAgbWF0WywgeHZhcnNdICUqJSBjb2VmaQ0KICB9DQoNCmN2LmVycm9ycyA8LSBtYXRyaXgoTkEsIGssIDE5LA0KICAgICAgICAgICAgICAgICAgICBkaW1uYW1lcyA9IGxpc3QoTlVMTCAsIHBhc3RlICgxOjE5KSkpDQpmb3IgKGogaW4gMTprKSB7DQogIGJlc3QuZml0IDwtIGxlYXBzOjpyZWdzdWJzZXRzKFNhbGFyeSB+IC4sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSBIaXR0ZXJzW2ZvbGRzICE9IGosXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnZtYXggPSAxOSkNCiAgZm9yIChpIGluIDE6MTkpIHsNCiAgICBwcmVkIDwtIHN0YXRzOjpwcmVkaWN0KGJlc3QuZml0LCBIaXR0ZXJzW2ZvbGRzID09IGosIF0sIGlkID0gaSkNCiAgICBjdi5lcnJvcnNbaiwgaV0gPC0gbWVhbigoIEhpdHRlcnMkU2FsYXJ5W2ZvbGRzID09IGpdIC0gcHJlZCleMikNCiAgfQ0KICB9DQoNCmBgYA0KDQpUaGlzIGhhcyBnaXZlbiB1cyBhICQxMCQgYnkgJDE5JCBtYXRyaXgsIG9mIHdoaWNoIHRoZSAkKGosIGkpJHRoIGVsZW1lbnQNCmNvcnJlc3BvbmRzIHRvIHRoZSB0ZXN0ICRNU0UkIGZvciB0aGUgJGokdGggY3Jvc3MtdmFsaWRhdGlvbiBmb2xkIGZvcg0KdGhlIGJlc3QgJGkkLXZhcmlhYmxlIG1vZGVsLg0KDQpXZSB1c2UgdGhlIGBhcHBseWAgZnVuY3Rpb24gdG8gYXZlcmFnZSBvdmVyIHRoZSBjb2x1bW5zIG9mIHRoaXMgYGFwcGx5YA0KbWF0cml4IGluIG9yZGVyIHRvIG9idGFpbiBhIHZlY3RvciBmb3Igd2hpY2ggdGhlICRpJHRoIGVsZW1lbnQgaXMgdGhlDQpjcm9zcyB2YWxpZGF0aW9uIGVycm9yIGZvciB0aGUgJGkkLXZhcmlhYmxlIG1vZGVsLg0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCg0KbWVhbi5jdi5lcnJvcnMgPC0gYXBwbHkoY3YuZXJyb3JzICwgMiwgbWVhbikNCg0KcGxvdChtZWFuLmN2LmVycm9ycyAsIHR5cGUgPSAiYiIpDQoNCmBgYA0KDQpXZSBzZWUgdGhhdCBjcm9zcy12YWxpZGF0aW9uIHNlbGVjdHMgYSAxMC12YXJpYWJsZSBtb2RlbC4NCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQpyZWdmaXQuYmVzdCA8LSBsZWFwczo6cmVnc3Vic2V0cyhTYWxhcnkgfiAuLCBkYXRhID0gSGl0dGVycyAsIG52bWF4ID0gMTkpDQpjb2VmKHJlZ2ZpdC5iZXN0ICwgMTApDQpgYGANCg0KIyBSaWRnZSBSZWdyZXNzaW9uDQoNCiMjIEludHJvZHVjdGlvbiB0byByaWRnZSByZWdyZXNzaW9uDQoNClVzZQ0KW2BwYXJzbmlwOjpsaW5lYXJfcmVnYF0oaHR0cHM6Ly9wYXJzbmlwLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9saW5lYXJfcmVnLmh0bWwpLA0KW2BwYXJzbmlwOjpzZXRfbW9kZWBdKGh0dHBzOi8vcGFyc25pcC50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2Uvc2V0X2FyZ3MuaHRtbCkNCmFuZA0KW2BwYXJzbmlwOjpzZXRfZW5naW5lYF0oaHR0cHM6Ly9wYXJzbmlwLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9zZXRfZW5naW5lLmh0bWwpDQp0byBjcmVhdGUgdGhlIG1vZGVsLg0KDQpTZXQgbWl4dHVyZSB0byAwIHRvIGluZGljYXRlIFJpZGdlIFJlZ3Jlc3Npb24uIEZvciBub3csIHdlIHNldA0KcGVuYWx0eS9sYW1iZGEgYXMgMC4NCg0KVXNlDQpbYHBhcnNuaXA6OnRyYW5zbGF0ZWBdKGh0dHBzOi8vcGFyc25pcC50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2UvdHJhbnNsYXRlLmh0bWwpDQp0byBiZXR0ZXIgdW5kZXJzdGFuZCB0aGUgbW9kZWwgY3JlYXRlZC4NCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQpIaXR0ZXJzIDwtIGRwbHlyOjphc190aWJibGUoSVNMUjI6OkhpdHRlcnMpICU+JQ0KICB0aWR5cjo6ZHJvcF9uYSgpDQoNCnJpZGdlX3NwZWMgPC0gcGFyc25pcDo6bGluZWFyX3JlZyhtaXh0dXJlID0gMCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZW5hbHR5ID0gMCkgJT4lDQogIHBhcnNuaXA6OnNldF9tb2RlKCJyZWdyZXNzaW9uIikgJT4lDQogIHBhcnNuaXA6OnNldF9lbmdpbmUoImdsbW5ldCIpDQoNCnJpZGdlX3NwZWMgJT4lDQogIHBhcnNuaXA6OnRyYW5zbGF0ZSgpDQpgYGANCg0KT25jZSB0aGUgc3BlY2lmaWNhdGlvbiBpcyBjcmVhdGVkIHdlIGNhbiBmaXQgaXQgdG8gb3VyIGRhdGEgdXNpbmcNCltgcGFyc25pcDo6Zml0YF0oaHR0cHM6Ly9wYXJzbmlwLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9maXQuaHRtbCkuIFdlDQp3aWxsIHVzZSBhbGwgdGhlIHByZWRpY3RvcnMuDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KcmlkZ2VfZml0IDwtIHJpZGdlX3NwZWMgJT4lDQogIHBhcnNuaXA6OmZpdChmb3JtdWxhID0gU2FsYXJ5IH4gLiwgDQogICAgICAgICAgICAgICBkYXRhID0gSGl0dGVycykNCg0KYGBgDQoNCldlIGNhbiBzZWUgdGhlIHBhcmFtZXRlciBlc3RpbWF0ZSBmb3IgZGlmZmVyZW50IHZhbHVlcyBvZiBwZW5hbHR5L2xhbWJkYQ0Kd2l0aA0KW2BwYXJzbmlwOjp0aWR5YF0oaHR0cHM6Ly9wYXJzbmlwLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS90aWR5Lm1vZGVsX2ZpdC5odG1sKS4NCk5vdGljZSBob3cgdGhlIGVzdGltYXRlcyBhcmUgZGVjcmVhc2luZyB3aGVuIHRoZSBhbW91bnQgb2YgcGVuYWx0eSBnb2VzDQp1cA0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRSwgbWF4LmhlaWdodD0nMTUwcHgnfQ0KcGFyc25pcDo6dGlkeShyaWRnZV9maXQpICU+JQ0KICByZWFjdGFibGU6OnJlYWN0YWJsZShkZWZhdWx0UGFnZVNpemUgPSA1KQ0KcGFyc25pcDo6dGlkeShyaWRnZV9maXQsIHBlbmFsdHkgPSA3MDUpICU+JQ0KICByZWFjdGFibGU6OnJlYWN0YWJsZShkZWZhdWx0UGFnZVNpemUgPSA1KQ0KcGFyc25pcDo6dGlkeShyaWRnZV9maXQsIHBlbmFsdHkgPSAxMTQ5OCkgJT4lDQogIHJlYWN0YWJsZTo6cmVhY3RhYmxlKGRlZmF1bHRQYWdlU2l6ZSA9IDUpDQpgYGANCg0KVXNpbmcNCltgcGFyc25pcDo6ZXh0cmFjdF9maXRfZW5naW5lYF0oaHR0cHM6Ly9wYXJzbmlwLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9leHRyYWN0LXBhcnNuaXAuaHRtbCkNCndlIGNhbiB2aXN1YWxpemUgaG93IHRoZSBtYWduaXR1ZGUgb2YgdGhlIGNvZWZmaWNpZW50cyBhcmUgYmVpbmcNCnJlZ3VsYXJpemVkIHRvd2FyZHMgemVybyBhcyB0aGUgcGVuYWx0eSBnb2VzIHVwLg0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCiMgQXJyYW5nZSBmaWd1cmUgbWFyZ2luDQpwYXIobWFyPWMoNSw1LDUsMSkpDQpyaWRnZV9maXQgJT4lDQogIHBhcnNuaXA6OmV4dHJhY3RfZml0X2VuZ2luZSgpICU+JQ0KICBwbG90KHh2YXIgPSAibGFtYmRhIikNCmBgYA0KDQpJdCB3b3VsZCBiZSBuaWNlIGlmIHdlIGNvdWxkIGZpbmQgdGhlICJiZXN0IiB2YWx1ZSBvZiB0aGUNCnBlbmFsdHkvbGFtYmRhLiBXZSBjYW4gZG8gdGhpcyB1c2luZyB0aGUNCltgdHVuZTo6dHVuZV9ncmlkYF0oaHR0cHM6Ly90dW5lLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS90dW5lX2dyaWQuaHRtbCkNCg0KTmVlZCB3ZSBuZWVkIHRocmVlIHRoaW5ncyBpbiBvcmRlciB0byB1c2UgdGhlDQpbYHR1bmU6OnR1bmVfZ3JpZGBdKGh0dHBzOi8vdHVuZS50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2UvdHVuZV9ncmlkLmh0bWwpDQoNCi0gICBhIGByZXNhbXBsZWAgb2JqZWN0IGNvbnRhaW5pbmcgdGhlIHJlc2FtcGxlcyB0aGUgYHdvcmtmbG93YCBzaG91bGQNCiAgICBiZSBmaXR0ZWQgd2l0aGluLA0KDQotICAgYSBgd29ya2Zsb3dgIG9iamVjdCBjb250YWluaW5nIHRoZSBtb2RlbCBhbmQgcHJlcHJvY2Vzc29yLGFuZA0KDQotICAgYSB0aWJibGUgYHBlbmFsdHlfZ3JpZGAgY29udGFpbmluZyB0aGUgcGFyYW1ldGVyIHZhbHVlcyB0byBiZQ0KICAgIGV2YWx1YXRlZC4NCg0KIyMgQ3JlYXRlIHRoZSByZXNhbXBsZSBvYmplY3QNCg0KRmlyc3QsIHdlIHNwbGl0IHRoZSBzYW1wbGVzIGludG8gYSB0cmFpbmluZyBzZXQgYW5kIGEgdGVzdCBzZXQuIEZyb20gdGhlIHRyYWluaW5nIHNldCwgd2UgY3JlYXRlIGEgMTAtZm9sZCBjcm9zcy12YWxpZGF0aW9uIGRhdGEgc2V0IGZyb20gdGhlIHRyYWluaW5nIHNldC4NCg0KVGhpcyBpcyBkb25lIHdpdGggW2Byc2FtcGxlOjppbml0aWFsX3NwbGl0YF0oaHR0cHM6Ly9yc2FtcGxlLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9pbml0aWFsX3NwbGl0Lmh0bWwpLA0KW2Byc2FtcGxlOjp0cmFpbmluZ2BdKGh0dHBzOi8vcnNhbXBsZS50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2UvaW5pdGlhbF9zcGxpdC5odG1sKSwNCltgcnNhbXBsZTo6dGVzdGluZ2BdKGh0dHBzOi8vcnNhbXBsZS50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2UvaW5pdGlhbF9zcGxpdC5odG1sKQ0KYW5kDQpbYHJzYW1wbGU6OnZmb2xkX2N2YF0oaHR0cHM6Ly9yc2FtcGxlLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS92Zm9sZF9jdi5odG1sKS4NCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQpzZXQuc2VlZCgxMjM0KQ0KSGl0dGVycyA8LSBkcGx5cjo6YXNfdGliYmxlKElTTFIyOjpIaXR0ZXJzKSAlPiUNCiAgdGlkeXI6OmRyb3BfbmEoKQ0KDQpIaXR0ZXJzX3NwbGl0IDwtIHJzYW1wbGU6OmluaXRpYWxfc3BsaXQoSGl0dGVycywgc3RyYXRhID0gIlNhbGFyeSIpDQoNCkhpdHRlcnNfdHJhaW4gPC0gcnNhbXBsZTo6dHJhaW5pbmcoSGl0dGVyc19zcGxpdCkNCkhpdHRlcnNfdGVzdCA8LSByc2FtcGxlOjp0ZXN0aW5nKEhpdHRlcnNfc3BsaXQpDQoNCkhpdHRlcnNfZm9sZCA8LSByc2FtcGxlOjp2Zm9sZF9jdihIaXR0ZXJzX3RyYWluLCB2ID0gMTApDQoNCmBgYA0KDQojIyBDcmVhdGUgdGhlIHByZXByb2Nlc3Nvcg0KDQpXZSB1c2UgdGhlIGByZWNpcGVzYCBwYWNrYWdlIHRvIGNyZWF0ZSB0aGUgcHJlcHJvY2Vzc2luZyBzdGVwcy4gSG93ZXZlciwNCnRoZSBvcmRlciBvZiB0aGUgcHJlcHJvY2Vzc2luZyBzdGVwIGlzIGFjdHVhbGx5IGltcG9ydGFudC4gU2VlIHRoZQ0KW09yZGVyaW5nIG9mIHN0ZXBzDQp2aWduZXR0ZV0oaHR0cHM6Ly9jcmFuLnItcHJvamVjdC5vcmcvd2ViL3BhY2thZ2VzL3JlY2lwZXMvdmlnbmV0dGVzL09yZGVyaW5nLmh0bWwpDQoNCldlIGNyZWF0ZSBhIGJhc2ljIHJlY2lwZSB3aXRoDQpbYHJlY2lwZXM6OnJlY2lwZWBdKGh0dHBzOi8vcmVjaXBlcy50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2UvcmVjaXBlLmh0bWwpLg0KDQpBcHBseQ0KW2ByZWNpcGVzOjpwcmVwYF0oaHR0cHM6Ly9yZWNpcGVzLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9wcmVwLmh0bWwpDQphbmQNCltgcmVjaXBlczo6YmFrZWBdKGh0dHBzOi8vcmVjaXBlcy50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2UvYmFrZS5odG1sKSB0bw0KY29tcHV0ZSB0aGUgcHJlcHJvY2Vzc2luZyBzdGVwLg0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCg0KcmlkZ2VfcmVjaXBlIDwtIHJlY2lwZXM6OnJlY2lwZShmb3JtdWxhID0gU2FsYXJ5IH4gLiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IEhpdHRlcnNfdHJhaW4pDQoNCnJlYyA8LSByZWNpcGVzOjpwcmVwKHggPSByaWRnZV9yZWNpcGUsIHRyYWluaW5nID0gSGl0dGVyc190cmFpbikNCiAgDQpyZWMgJT4lDQogIHN1bW1hcnkoKSAlPiUNCiAgcmVhY3RhYmxlOjpyZWFjdGFibGUoZGVmYXVsdFBhZ2VTaXplID0gNSkNCg0KcmVjICU+JQ0KICByZWNpcGVzOjpiYWtlKG5ld19kYXRhID0gSGl0dGVyc190cmFpbikgJT4lDQogIHJlYWN0YWJsZTo6cmVhY3RhYmxlKGRlZmF1bHRQYWdlU2l6ZSA9IDUpDQoNCmBgYA0KDQpEbyBwcmVwcm9jZXNzaW5nIG9uIHRoZSBmYWN0b3IgdmFyaWFibGVzDQpbYHJlY2lwZXM6OmFsbF9ub21pbmFsX3ByZWRpY3RvcnNgXShodHRwczovL3JlY2lwZXMudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL2hhc19yb2xlLmh0bWwpLg0KW2ByZWNpcGVzOjpzdGVwX25vdmVsYF0oaHR0cHM6Ly9yZWNpcGVzLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9zdGVwX25vdmVsLmh0bWwpDQphbmQNCltgcmVjaXBlczo6c3RlcF9kdW1teWBdKGh0dHBzOi8vcmVjaXBlcy50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2Uvc3RlcF9kdW1teS5odG1sKQ0Kd2FzIHVzZWQuDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KDQpyaWRnZV9yZWNpcGUgPC0gcmlkZ2VfcmVjaXBlICU+JQ0KICAjIFN0ZXAgTm92ZWwgaXMgaW1wb3J0YW50Lg0KICAjIElmIHRlc3Qgc2V0IGhhcyBhIG5ldyBmYWN0b3Igbm90IGZvdW5kIGluIHRyYWluaW5nLCBpdCB3aWxsIGJlIHRyZWF0ZWQgYXMgIm5ldyIgYW5kIG5vdCBOQQ0KICAjIFRoaXMgd2lsbCBwcmV2ZW50IHRoZSBtb2RlbCBmcm9tIGdpdmluZyBhbiBlcnJvcg0KICAjIGh0dHBzOi8vYmxvZy5kYXRhc2NpZW5jZWhlcm9lcy5jb20vaG93LXRvLXVzZS1yZWNpcGVzLXBhY2thZ2UtZm9yLW9uZS1ob3QtZW5jb2RpbmcvDQogIHJlY2lwZXM6OnN0ZXBfbm92ZWwocmVjaXBlczo6YWxsX25vbWluYWxfcHJlZGljdG9ycygpKSAlPiUNCiAgIyBDcmVhdGUgRHVtbXkgdmFyaWFibGVzDQogIHJlY2lwZXM6OnN0ZXBfZHVtbXkocmVjaXBlczo6YWxsX25vbWluYWxfcHJlZGljdG9ycygpKQ0KDQpyZWMgPC0gcmVjaXBlczo6cHJlcCh4ID0gcmlkZ2VfcmVjaXBlLCB0cmFpbmluZyA9IEhpdHRlcnNfdHJhaW4pDQogIA0KcmVjICU+JQ0KICBzdW1tYXJ5KCkgJT4lDQogIHJlYWN0YWJsZTo6cmVhY3RhYmxlKGRlZmF1bHRQYWdlU2l6ZSA9IDUpDQoNCnJlYyAlPiUNCiAgcmVjaXBlczo6YmFrZShuZXdfZGF0YSA9IEhpdHRlcnNfdHJhaW4pICU+JQ0KICByZWFjdGFibGU6OnJlYWN0YWJsZShkZWZhdWx0UGFnZVNpemUgPSA1KQ0KDQpgYGANCg0KRG8gbm9ybWFsaXNhdGlvbiBzdGVwIG9uIGFsbCBwcmVkaWN0b3JzDQpbYHJlY2lwZXM6OmFsbF9wcmVkaWN0b3JzKClgXShodHRwczovL3JlY2lwZXMudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL2hhc19yb2xlLmh0bWwpLg0KW2ByZWNpcGVzOjpzdGVwX3p2YF0oaHR0cHM6Ly9yZWNpcGVzLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9zdGVwX3p2Lmh0bWwpDQphbmQNCltgcmVjaXBlczo6c3RlcF9ub3JtYWxpemVgXShodHRwczovL3JlY2lwZXMudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL3N0ZXBfbm9ybWFsaXplLmh0bWwpDQp3YXMgdXNlZC4NCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQoNCnJpZGdlX3JlY2lwZSA8LSByaWRnZV9yZWNpcGUgJT4lDQogICMgUmVtb3ZlIHByZWRpY3RvcnMgd2l0aCB6ZXJvIHZhcmlhdGlvbg0KICByZWNpcGVzOjpzdGVwX3p2KHJlY2lwZXM6OmFsbF9wcmVkaWN0b3JzKCkpICU+JQ0KICAjIFN0YW5kYXJkaXNlIGFsbCB2YXJpYWJsZQ0KICByZWNpcGVzOjpzdGVwX25vcm1hbGl6ZShyZWNpcGVzOjphbGxfcHJlZGljdG9ycygpKQ0KDQpyZWMgPC0gcmVjaXBlczo6cHJlcCh4ID0gcmlkZ2VfcmVjaXBlLCB0cmFpbmluZyA9IEhpdHRlcnNfdHJhaW4pDQogIA0KcmVjICU+JQ0KICByZWNpcGVzOjpiYWtlKG5ld19kYXRhID0gSGl0dGVyc190cmFpbikgJT4lDQogIHJlYWN0YWJsZTo6cmVhY3RhYmxlKGRlZmF1bHRQYWdlU2l6ZSA9IDUpDQoNCg0KYGBgDQoNCiMjIFNwZWNpZnkgdGhlIG1vZGVsDQoNClRoZSBtb2RlbCBzcGVjaWZpY2F0aW9uIHdpbGwgbG9vayB2ZXJ5IHNpbWlsYXIgdG8gd2hhdCB3ZSBoYXZlIHNlZW4NCmVhcmxpZXIsIGJ1dCB3ZSB3aWxsIHNldCBgcGVuYWx0eSA9IHR1bmU6OnR1bmVgLiBUaGlzIHRlbGxzDQpbYHR1bmU6OnR1bmVfZ3JpZGBdKGh0dHBzOi8vdHVuZS50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2UvdHVuZV9ncmlkLmh0bWwpDQp0aGF0IHRoZSBwZW5hbHR5IHBhcmFtZXRlciBzaG91bGQgYmUgdHVuZWQgdXNpbmcNCltgdHVuZTo6dHVuZWBdKGh0dHBzOi8vaGFyZGhhdC50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2UvdHVuZS5odG1sKS4NCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQoNCnJpZGdlX3NwZWMgPC0gDQogIHBhcnNuaXA6OmxpbmVhcl9yZWcocGVuYWx0eSA9IHR1bmU6OnR1bmUoKSwgbWl4dHVyZSA9IDApICU+JSANCiAgcGFyc25pcDo6c2V0X21vZGUoInJlZ3Jlc3Npb24iKSAlPiUgDQogIHBhcnNuaXA6OnNldF9lbmdpbmUoImdsbW5ldCIpDQoNCnJpZGdlX3NwZWMgJT4lDQogIHBhcnNuaXA6OnRyYW5zbGF0ZSgpDQpgYGANCg0KIyMgQ3JlYXRlIHRoZSB3b3JrZmxvdw0KDQpbYHdvcmtmbG93czo6d29ya2Zsb3dgXShodHRwczovL3dvcmtmbG93cy50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2Uvd29ya2Zsb3cuaHRtbCksDQpbYHdvcmtmbG93czo6YWRkX3JlY2lwZWBdKGh0dHBzOi8vd29ya2Zsb3dzLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9hZGRfcmVjaXBlLmh0bWwpDQphbmQNCltgd29ya2Zsb3dzOjphZGRfbW9kZWxgXShodHRwczovL3dvcmtmbG93cy50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2UvYWRkX21vZGVsLmh0bWwpDQphcmUgdXNlZC4NCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0UsIG1heC5oZWlnaHQ9JzE1MHB4J30NCg0KcmlkZ2Vfd29ya2Zsb3cgPC0gIHdvcmtmbG93czo6d29ya2Zsb3coKSAlPiUgDQogIHdvcmtmbG93czo6YWRkX3JlY2lwZShyaWRnZV9yZWNpcGUpICU+JSANCiAgd29ya2Zsb3dzOjphZGRfbW9kZWwocmlkZ2Vfc3BlYykNCg0KcmlkZ2Vfd29ya2Zsb3cNCmBgYA0KDQojIyBDcmVhdGUgdGhlIHBlbmFsdHkvbGFtYmRhIGdyaWQNCg0KQSBwZW5hbHR5L2xhbWJkYSBncmlkIG9mICQ1MCQgbnVtYmVycyBmcm9tICQwLjAwMDAxJCAoJDEwXnstNX0kKSB0bw0KJDEwMDAwJCAoJDEwXjUkKSBpcyBjcmVhdGVkLg0KDQpSZWd1bGFyIGdyaWQgaXMgY3JlYXRlZCB1c2luZw0KW2BkaWFsczo6Z3JpZF9yZWd1bGFyYF0oaHR0cHM6Ly9kaWFscy50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2UvZ3JpZF9yZWd1bGFyLmh0bWwpLA0KW2BkaWFsczo6cGVuYWx0eWBdKGh0dHBzOi8vZGlhbHMudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL3BlbmFsdHkuaHRtbCkNCmFuZA0KW2BzY2FsZXM6OmxvZzEwX3RyYW5zYF0oaHR0cHM6Ly9zY2FsZXMuci1saWIub3JnL3JlZmVyZW5jZS9sb2dfdHJhbnMuaHRtbCkNCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQoNCnBlbmFsdHlfZ3JpZCA8LSBkaWFsczo6Z3JpZF9yZWd1bGFyKHggPSBkaWFsczo6cGVuYWx0eShyYW5nZSA9IGMoLTUsIDUpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zID0gc2NhbGVzOjpsb2cxMF90cmFucygpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXZlbHMgPSA1MCkNCg0KcGVuYWx0eV9ncmlkICAlPiUgDQogIHJlYWN0YWJsZTo6cmVhY3RhYmxlKGRlZmF1bHRQYWdlU2l6ZSA9IDUpDQpgYGANCg0KIyMgUmlkZ2UgcmVncmVzc2lvbiBtb2RlbCBmaXR0aW5nIG9uIGNyb3NzIHZhbGlkYXRlZCBkYXRhDQoNCk5vdyB3ZSBoYXZlIGV2ZXJ5dGhpbmcgd2UgbmVlZCBhbmQgd2UgY2FuIGZpdCBhbGwgdGhlIG1vZGVscyBvbiB0aGUNCmNyb3NzIHZhbGlkYXRlZCBkYXRhIHdpdGgNCltgdHVuZTo6dHVuZV9ncmlkYF0oaHR0cHM6Ly90dW5lLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS90dW5lX2dyaWQuaHRtbCkuDQpOb3RlIHRoYXQgdGhpcyBwcm9jZXNzIG1heSB0YWtlIHNvbWUgdGltZS4NCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQpkb1BhcmFsbGVsOjpyZWdpc3RlckRvUGFyYWxsZWwoKQ0KZm9yZWFjaDo6Z2V0RG9QYXJXb3JrZXJzKCkNCmBgYA0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRSwgbWF4LmhlaWdodD0nMTUwcHgnfQ0KdHVuZV9yZXMgPC0gdHVuZTo6dHVuZV9ncmlkKA0KICBvYmplY3QgPSByaWRnZV93b3JrZmxvdywNCiAgcmVzYW1wbGVzID0gSGl0dGVyc19mb2xkLCANCiAgZ3JpZCA9IHBlbmFsdHlfZ3JpZA0KKQ0KDQp0dW5lX3Jlcw0KYGBgDQoNCkhlcmUgd2Ugc2VlIHRoYXQgdGhlIGFtb3VudCBvZiByZWd1bGFyaXphdGlvbiBhZmZlY3RzIHRoZSBwZXJmb3JtYW5jZQ0KbWV0cmljcyBkaWZmZXJlbnRseSB1c2luZw0KW2B0dW5lOjphdXRvcGxvdGBdKGh0dHBzOi8vdHVuZS50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2UvYXV0b3Bsb3QudHVuZV9yZXN1bHRzLmh0bWwpLg0KRG8gbm90ZSB0aGF0IHVzaW5nIGEgZGlmZmVyZW50IHNlZWQgd2lsbCBnaXZlIGEgZGlmZmVyZW50IHBsb3QNCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQojIE5vdGUgdGhhdCBhIGRpZmZlcmVudCBzZWVkIHdpbGwgZ2l2ZSBkaWZmZXJlbnQgcGxvdHMNCnR1bmU6OmF1dG9wbG90KHR1bmVfcmVzKQ0KYGBgDQoNCldlIGNhbiBhbHNvIHNlZSB0aGUgcmF3IG1ldHJpY3MgdGhhdCBjcmVhdGVkIHRoaXMgY2hhcnQgYnkgY2FsbGluZw0KW2B0dW5lOjpjb2xsZWN0X21ldHJpY3MoKWBdKGh0dHBzOi8vdHVuZS50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2UvY29sbGVjdF9wcmVkaWN0aW9ucy5odG1sKS4NCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0UsIG1heC5oZWlnaHQ9JzE1MHB4J30NCg0KdHVuZTo6Y29sbGVjdF9tZXRyaWNzKHR1bmVfcmVzKSAlPiUgDQogIHJlYWN0YWJsZTo6cmVhY3RhYmxlKGRlZmF1bHRQYWdlU2l6ZSA9IDUpDQpgYGANCg0KSGVyZSBpcyB0aGUgYGdncGxvdGAgd2F5IHNob3VsZA0KW2B0dW5lOjphdXRvcGxvdGBdKGh0dHBzOi8vdHVuZS50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2UvYXV0b3Bsb3QudHVuZV9yZXN1bHRzLmh0bWwpDQpmYWlscw0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRSwgbWF4LmhlaWdodD0nMTUwcHgnfQ0KDQp0dW5lX3JlcyAlPiUNCiAgdHVuZTo6Y29sbGVjdF9tZXRyaWNzKCkgJT4lDQogIGdncGxvdDI6OmdncGxvdChtYXBwaW5nID0gZ2dwbG90Mjo6YWVzKHggPSAuZGF0YVtbInBlbmFsdHkiXV0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHkgPSAuZGF0YVtbIm1lYW4iXV0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG91ciA9IC5kYXRhW1siLm1ldHJpYyJdXSkpICsNCiAgZ2dwbG90Mjo6Z2VvbV9lcnJvcmJhcihtYXBwaW5nID0gZ2dwbG90Mjo6YWVzKHltaW4gPSAuZGF0YVtbIm1lYW4iXV0gLSAuZGF0YVtbInN0ZF9lcnIiXV0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5bWF4ID0gLmRhdGFbWyJtZWFuIl1dICsgLmRhdGFbWyJzdGRfZXJyIl1dKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICBhbHBoYSA9IDAuNSkgKw0KICBnZ3Bsb3QyOjpnZW9tX2xpbmUoc2l6ZSA9IDEuNSkgKw0KICBnZ3Bsb3QyOjpmYWNldF93cmFwKGZhY2V0cyA9IGdncGxvdDI6OnZhcnMoLmRhdGFbWyIubWV0cmljIl1dKSwgDQogICAgICAgICAgICAgICAgICAgICAgc2NhbGVzID0gImZyZWUiLCANCiAgICAgICAgICAgICAgICAgICAgICBucm93ID0gMikgKw0KICBnZ3Bsb3QyOjpzY2FsZV94X2xvZzEwKCkgKw0KICBnZ3Bsb3QyOjp0aGVtZShsZWdlbmQucG9zaXRpb24gPSAibm9uZSIpDQpgYGANCg0KVXNlDQpbYHR1bmU6OnNob3dfYmVzdGBdKGh0dHBzOi8vdHVuZS50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2Uvc2hvd19iZXN0Lmh0bWwpDQp0byBzZWUgdGhlIHRvcCBmZXcgdmFsdWVzIGZvciBhIGdpdmVuIG1ldHJpYy4NCg0KVGhlICJiZXN0IiB2YWx1ZXMgY2FuIGJlIHNlbGVjdGVkIHVzaW5nDQpbYHR1bmU6OnNlbGVjdF9iZXN0YF0oaHR0cHM6Ly90dW5lLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9zaG93X2Jlc3QuaHRtbCksDQp0aGlzIGZ1bmN0aW9uIHJlcXVpcmVzIHlvdSB0byBzcGVjaWZ5IGEgbWV0cmljIHRoYXQgaXQgc2hvdWxkIHNlbGVjdA0KYWdhaW5zdC4gVGhlIHBlbmFsdHkvbGFtYmRhIHZhbHVlIGlzIDU2OSBmb3IgbWV0cmljIGByc3FgIHNpbmNlIGl0IGdpdmVzDQp0aGUgaGlnaGVzdCB2YWx1ZS4gRG8gbm90ZSB0aGF0IHVzaW5nIGEgZGlmZmVyZW50IHNlZWQgd2lsbCBnaXZlIGENCmRpZmZlcmVudCBiZXN0IHBlbmFsdHkvbGFtYmRhIHZhbHVlLg0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRSwgbWF4LmhlaWdodD0nMTUwcHgnfQ0KDQp0b3BfcGVuYWx0eSA8LSB0dW5lOjpzaG93X2Jlc3QodHVuZV9yZXMsIG1ldHJpYyA9ICJyc3EiLCBuID0gNSkNCnRvcF9wZW5hbHR5DQoNCmJlc3RfcGVuYWx0eSA8LSB0dW5lOjpzZWxlY3RfYmVzdCh0dW5lX3JlcywgbWV0cmljID0gInJzcSIpDQpiZXN0X3BlbmFsdHkNCg0KYGBgDQoNCiMjIFJpZGdlIHJlZ3Jlc3Npb24gbW9kZWwgd2l0aCBvcHRpbWlzZWQgcGVuYWx0eS9sYW1iZGEgdmFsdWUNCg0KV2UgY3JlYXRlIHRoZSByaWRnZSByZWdyZXNzaW9uIHdvcmtmbG93IHdpdGggdGhlIGJlc3QgcGVuYWx0eSBzY29yZQ0KdXNpbmcNCltgdHVuZTo6ZmluYWxpemVfd29ya2Zsb3dgXShodHRwczovL3R1bmUudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL2ZpbmFsaXplX21vZGVsLmh0bWwpLg0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRSwgbWF4LmhlaWdodD0nMTUwcHgnfQ0KDQpyaWRnZV9maW5hbCA8LSB0dW5lOjpmaW5hbGl6ZV93b3JrZmxvdyh4ID0gcmlkZ2Vfd29ya2Zsb3csIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1ldGVycyA9IGJlc3RfcGVuYWx0eSkNCg0KcmlkZ2VfZmluYWwNCmBgYA0KDQpXZSBub3cgdHJhaW4gdGhlIHJpZGdlIHJlZ3Jlc3Npb24gbW9kZWwgd2l0aCB0aGUgdHJhaW5pbmcgZGF0YSB1c2luZw0KW2BwYXJzbmlwOjpmaXRgXShodHRwczovL3BhcnNuaXAudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL2ZpdC5odG1sKQ0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCg0KcmlkZ2VfZmluYWxfZml0IDwtIHBhcnNuaXA6OmZpdChvYmplY3QgPSByaWRnZV9maW5hbCwgZGF0YSA9IEhpdHRlcnNfdHJhaW4pDQpgYGANCg0KV2UgY2FuIHNlZSB0aGUgY29lZmZpY2llbnRzIHVzaW5nDQpbYHR1bmU6OmV4dHJhY3RfZml0X3BhcnNuaXBgXShodHRwczovL3R1bmUudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL2V4dHJhY3QtdHVuZS5odG1sKSBhbmQgW2BwYXJzbmlwOjp0aWR5YF0oaHR0cHM6Ly9wYXJzbmlwLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS90aWR5Lm1vZGVsX2ZpdC5odG1sKQ0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCg0KcmlkZ2VfZmluYWxfZml0ICU+JQ0KICB0dW5lOjpleHRyYWN0X2ZpdF9wYXJzbmlwKCkgJT4lDQogIHBhcnNuaXA6OnRpZHkoKSAlPiUNCiAgcmVhY3RhYmxlOjpyZWFjdGFibGUoZGVmYXVsdFBhZ2VTaXplID0gNSkNCmBgYA0KDQojIyBWYXJpYWJsZSBJbXBvcnRhbmNlDQoNCldoaWxlIHdlJ3JlIGF0IGl0LCBsZXQncyBzZWUgd2hhdCB0aGUgbW9zdCBpbXBvcnRhbnQgdmFyaWFibGVzIGFyZSB1c2luZw0KdGhlIGB2aXBgIHBhY2thZ2UgYW5kDQpbYHdvcmtmbG93czo6ZXh0cmFjdF9maXRfcGFyc25pcGBdKGh0dHBzOi8vd29ya2Zsb3dzLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9leHRyYWN0LXdvcmtmbG93Lmh0bWwpLg0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCg0KdmlwX3RhYmxlIDwtIHJpZGdlX2ZpbmFsX2ZpdCAlPiUNCiAgd29ya2Zsb3dzOjpleHRyYWN0X2ZpdF9wYXJzbmlwKCkgJT4lDQogIHZpcDo6dmkobGFtYmRhID0gYmVzdF9wZW5hbHR5JHBlbmFsdHkpIA0KDQp2aXBfdGFibGUgJT4lDQogIHJlYWN0YWJsZTo6cmVhY3RhYmxlKGRlZmF1bHRQYWdlU2l6ZSA9IDUpDQpgYGANCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQp2aXBfdGFibGUgJT4lIA0KICBkcGx5cjo6bXV0YXRlKA0KICAgIEltcG9ydGFuY2UgPSBhYnMoLmRhdGFbWyJJbXBvcnRhbmNlIl1dKSwNCiAgICBWYXJpYWJsZSA9IGZvcmNhdHM6OmZjdF9yZW9yZGVyKC5mID0gLmRhdGFbWyJWYXJpYWJsZSJdXSwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAueCA9IC5kYXRhW1siSW1wb3J0YW5jZSJdXSkNCiAgKSAlPiUNCiAgZ2dwbG90Mjo6Z2dwbG90KG1hcHBpbmcgPSBnZ3Bsb3QyOjphZXMoeCA9IC5kYXRhW1siSW1wb3J0YW5jZSJdXSwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHkgPSAuZGF0YVtbIlZhcmlhYmxlIl1dLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsbCA9IC5kYXRhW1siU2lnbiJdXSkpICsNCiAgZ2dwbG90Mjo6Z2VvbV9jb2woKSArDQogIGdncGxvdDI6OnNjYWxlX3hfY29udGludW91cyhleHBhbmQgPSBjKDAsIDApKSArDQogIGdncGxvdDI6OmxhYnMoeSA9IE5VTEwpDQpgYGANCg0KIyMgUmlkZ2UgcmVncmVzc2lvbiBtb2RlbCBvbiB0ZXN0IGRhdGENCg0KVGhpcyByaWRnZSByZWdyZXNzaW9uIG1vZGVsIGNhbiBub3cgYmUgYXBwbGllZCBvbiBvdXIgdGVzdGluZyBkYXRhIHNldA0KdG8gdmFsaWRhdGUgaXRzIHBlcmZvcm1hbmNlLiBGb3IgcmVncmVzc2lvbiBtb2RlbHMsIGEgYC5wcmVkYCBjb2x1bW4gaXMNCmFkZGVkIHdoZW4NCltgcGFyc25pcDo6YXVnbWVudGBdKGh0dHBzOi8vcGFyc25pcC50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2UvYXVnbWVudC5odG1sKQ0KaXMgdXNlZC4NCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQoNCnRlc3RfcmVzdWx0cyA8LSBwYXJzbmlwOjphdWdtZW50KHggPSByaWRnZV9maW5hbF9maXQsIG5ld19kYXRhID0gSGl0dGVyc190ZXN0KQ0KICANCnRlc3RfcmVzdWx0cyAlPiUNCiAgcmVhY3RhYmxlOjpyZWFjdGFibGUoZGVmYXVsdFBhZ2VTaXplID0gNSkNCiAgDQpgYGANCg0KV2UgY2hlY2sgaG93IHdlbGwgdGhlIGAucHJlZGAgY29sdW1uIG1hdGNoZXMgdGhlIFNhbGFyeSB1c2luZw0KW2B5YXJkc3RpY2s6OnJzcWBdKGh0dHBzOi8veWFyZHN0aWNrLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9yc3EuaHRtbCkuDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KdGVzdF9yZXN1bHRzICU+JQ0KICB5YXJkc3RpY2s6OnJzcSh0cnV0aCA9IC5kYXRhW1siU2FsYXJ5Il1dLCBlc3RpbWF0ZSA9IC5kYXRhW1siLnByZWQiXV0pICU+JQ0KICByZWFjdGFibGU6OnJlYWN0YWJsZShkZWZhdWx0UGFnZVNpemUgPSA1KQ0KYGBgDQoNCkFsdGVybmF0aXZlbHksIHdlIGNhbiB1c2UNCltgdHVuZTo6bGFzdF9maXRgXShodHRwczovL3R1bmUudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL2xhc3RfZml0Lmh0bWwpDQphbmQNCltgdHVuZTo6Y29sbGVjdF9tZXRyaWNzYF0oaHR0cHM6Ly90dW5lLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9jb2xsZWN0X3ByZWRpY3Rpb25zLmh0bWwpLg0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCg0KdGVzdF9ycyA8LSB0dW5lOjpsYXN0X2ZpdChvYmplY3QgPSByaWRnZV9maW5hbF9maXQsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICBzcGxpdCA9IEhpdHRlcnNfc3BsaXQpDQogIA0KdGVzdF9ycyAlPiUNCiAgdHVuZTo6Y29sbGVjdF9tZXRyaWNzKCkgJT4lDQogIHJlYWN0YWJsZTo6cmVhY3RhYmxlKGRlZmF1bHRQYWdlU2l6ZSA9IDUpDQogIA0KYGBgDQoNClVzZSBbYHR1bmU6OmNvbGxlY3RfcHJlZGljdGlvbnNgXShodHRwczovL3R1bmUudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL2NvbGxlY3RfcHJlZGljdGlvbnMuaHRtbCksIHRvIHNlZSBvbmx5IHRoZSBhY3R1YWwgYW5kIHByZWRpY3RlZCB2YWx1ZXMgb2YgdGhlIHRlc3QgZGF0YS4NCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQp0ZXN0X3JzICU+JQ0KICB0dW5lOjpjb2xsZWN0X3ByZWRpY3Rpb25zKCkgJT4lDQogIHJlYWN0YWJsZTo6cmVhY3RhYmxlKGRlZmF1bHRQYWdlU2l6ZSA9IDUpDQpgYGANCg0KTGV0IHVzIHRha2UgYSBjbG9zZXIgbG9vayBhdCB0aGUgcHJlZGljdGVkIGFuZCBhY3R1YWwgcmVzcG9uc2UgYXMgYSBzY2F0dGVyIHBsb3QuDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KdGVzdF9ycyAlPiUNCiAgdHVuZTo6Y29sbGVjdF9wcmVkaWN0aW9ucygpICU+JQ0KICBnZ3Bsb3QyOjpnZ3Bsb3QobWFwcGluZyA9IGdncGxvdDI6OmFlcyh4ID0gLmRhdGFbWyJTYWxhcnkiXV0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHkgPSAuZGF0YVtbIi5wcmVkIl1dDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkNCiAgICAgICAgICAgICAgICAgICkgKw0KICBnZ3Bsb3QyOjpnZW9tX2FibGluZShzbG9wZSA9IDEsIGx0eSA9IDIsIGNvbG9yID0gImdyYXk1MCIsIGFscGhhID0gMC41KSArDQogIGdncGxvdDI6Omdlb21fcG9pbnQoYWxwaGEgPSAwLjYsIGNvbG9yID0gIm1pZG5pZ2h0Ymx1ZSIpICsNCiAgZ2dwbG90Mjo6Y29vcmRfZml4ZWQoKQ0KYGBgDQoNCiMgVGhlIExhc3NvDQoNClRoZSBmb2xsb3dpbmcgcHJvY2VkdXJlIHdpbGwgYmUgdmVyeSBzaW1pbGFyIHRvIHdoYXQgd2Ugc2F3IGluIHRoZSByaWRnZQ0KcmVncmVzc2lvbiBzZWN0aW9uLiBUaGUgcmVzYW1wbGluZyBzdGVwIGlzIHRoZSBzYW1lLg0KDQojIyBDcmVhdGUgdGhlIHJlc2FtcGxlIG9iamVjdA0KDQpGaXJzdCwgd2Ugc3BsaXQgdGhlIHNhbXBsZXMgaW50byBhIHRyYWluaW5nIHNldCBhbmQgYSB0ZXN0IHNldC4gRnJvbSB0aGUgdHJhaW5pbmcgc2V0LCB3ZSBjcmVhdGUgYSAxMC1mb2xkIGNyb3NzLXZhbGlkYXRpb24gZGF0YSBzZXQgZnJvbSB0aGUgdHJhaW5pbmcgc2V0Lg0KDQpUaGlzIGlzIGRvbmUgd2l0aCBbYHJzYW1wbGU6OmluaXRpYWxfc3BsaXRgXShodHRwczovL3JzYW1wbGUudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL2luaXRpYWxfc3BsaXQuaHRtbCksDQpbYHJzYW1wbGU6OnRyYWluaW5nYF0oaHR0cHM6Ly9yc2FtcGxlLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9pbml0aWFsX3NwbGl0Lmh0bWwpLA0KW2Byc2FtcGxlOjp0ZXN0aW5nYF0oaHR0cHM6Ly9yc2FtcGxlLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9pbml0aWFsX3NwbGl0Lmh0bWwpDQphbmQNCltgcnNhbXBsZTo6dmZvbGRfY3ZgXShodHRwczovL3JzYW1wbGUudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL3Zmb2xkX2N2Lmh0bWwpLg0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCnNldC5zZWVkKDEyMzQpDQpIaXR0ZXJzIDwtIGRwbHlyOjphc190aWJibGUoSVNMUjI6OkhpdHRlcnMpICU+JQ0KICB0aWR5cjo6ZHJvcF9uYSgpDQoNCkhpdHRlcnNfc3BsaXQgPC0gcnNhbXBsZTo6aW5pdGlhbF9zcGxpdChIaXR0ZXJzLCBzdHJhdGEgPSAiU2FsYXJ5IikNCg0KSGl0dGVyc190cmFpbiA8LSByc2FtcGxlOjp0cmFpbmluZyhIaXR0ZXJzX3NwbGl0KQ0KSGl0dGVyc190ZXN0IDwtIHJzYW1wbGU6OnRlc3RpbmcoSGl0dGVyc19zcGxpdCkNCg0KSGl0dGVyc19mb2xkIDwtIHJzYW1wbGU6OnZmb2xkX2N2KEhpdHRlcnNfdHJhaW4sIHYgPSAxMCkNCg0KYGBgDQoNCiMjIENyZWF0ZSB0aGUgcHJlcHJvY2Vzc29yDQoNClRoZSBmb2xsb3dpbmcgcHJvY2VkdXJlIHdpbGwgYmUgdmVyeSBzaW1pbGFyIHRvIHdoYXQgd2Ugc2F3IGluIHRoZSByaWRnZQ0KcmVncmVzc2lvbiBzZWN0aW9uLiBUaGUgcHJlcHJvY2Vzc2luZyBzdGVwcyBuZWVkZWQgYXJlIHRoZSBzYW1lIHVzaW5nDQpbYHJlY2lwZXM6OnJlY2lwZWBdKGh0dHBzOi8vcmVjaXBlcy50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2UvcmVjaXBlLmh0bWwpLA0KW2ByZWNpcGVzOjphbGxfbm9taW5hbF9wcmVkaWN0b3JzYF0oaHR0cHM6Ly9yZWNpcGVzLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9oYXNfcm9sZS5odG1sKSwNCltgcmVjaXBlczo6YWxsX3ByZWRpY3RvcnMoKWBdKGh0dHBzOi8vcmVjaXBlcy50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2UvaGFzX3JvbGUuaHRtbCksDQpbYHJlY2lwZXM6OnN0ZXBfbm92ZWxgXShodHRwczovL3JlY2lwZXMudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL3N0ZXBfbm92ZWwuaHRtbCksDQpbYHJlY2lwZXM6OnN0ZXBfZHVtbXlgXShodHRwczovL3JlY2lwZXMudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL3N0ZXBfZHVtbXkuaHRtbCksDQpbYHJlY2lwZXM6OnN0ZXBfenZgXShodHRwczovL3JlY2lwZXMudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL3N0ZXBfenYuaHRtbCkNCmFuZA0KW2ByZWNpcGVzOjpzdGVwX25vcm1hbGl6ZWBdKGh0dHBzOi8vcmVjaXBlcy50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2Uvc3RlcF9ub3JtYWxpemUuaHRtbCkuDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KDQpsYXNzb19yZWNpcGUgPC0gDQogIHJlY2lwZXM6OnJlY2lwZShmb3JtdWxhID0gU2FsYXJ5IH4gLiwgZGF0YSA9IEhpdHRlcnNfdHJhaW4pICU+JSANCiAgcmVjaXBlczo6c3RlcF9ub3ZlbChyZWNpcGVzOjphbGxfbm9taW5hbF9wcmVkaWN0b3JzKCkpICU+JSANCiAgcmVjaXBlczo6c3RlcF9kdW1teShyZWNpcGVzOjphbGxfbm9taW5hbF9wcmVkaWN0b3JzKCkpICU+JSANCiAgcmVjaXBlczo6c3RlcF96dihyZWNpcGVzOjphbGxfcHJlZGljdG9ycygpKSAlPiUgDQogIHJlY2lwZXM6OnN0ZXBfbm9ybWFsaXplKHJlY2lwZXM6OmFsbF9wcmVkaWN0b3JzKCkpDQpgYGANCg0KIyMgU3BlY2lmeSB0aGUgbW9kZWwNCg0KQWdhaW4gd2Ugc2V0IGBwZW5hbHR5ID0gdHVuZTo6dHVuZWAuIFRoaXMgdGVsbHMNCltgdHVuZTo6dHVuZV9ncmlkYF0oaHR0cHM6Ly90dW5lLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS90dW5lX2dyaWQuaHRtbCkNCnRoYXQgdGhlIHBlbmFsdHkgcGFyYW1ldGVyIHNob3VsZCBiZSB0dW5lZCB1c2luZw0KW2B0dW5lOjp0dW5lYF0oaHR0cHM6Ly9oYXJkaGF0LnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS90dW5lLmh0bWwpLg0KDQpUaGlzIHRpbWUsIGl0IGlzIGBtaXh0dXJlPTFgIGluDQpbYHBhcnNuaXA6OmxpbmVhcl9yZWdgXShodHRwczovL3BhcnNuaXAudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL2xpbmVhcl9yZWcuaHRtbCkNCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQoNCmxhc3NvX3NwZWMgPC0gDQogIHBhcnNuaXA6OmxpbmVhcl9yZWcocGVuYWx0eSA9IHR1bmU6OnR1bmUoKSwgbWl4dHVyZSA9IDEpICU+JSANCiAgcGFyc25pcDo6c2V0X21vZGUoInJlZ3Jlc3Npb24iKSAlPiUgDQogIHBhcnNuaXA6OnNldF9lbmdpbmUoImdsbW5ldCIpDQoNCmxhc3NvX3NwZWMgJT4lDQogIHBhcnNuaXA6OnRyYW5zbGF0ZSgpDQoNCmBgYA0KDQojIyBDcmVhdGUgdGhlIHdvcmtmbG93DQoNCltgd29ya2Zsb3dzOjp3b3JrZmxvd2BdKGh0dHBzOi8vd29ya2Zsb3dzLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS93b3JrZmxvdy5odG1sKSwNCltgd29ya2Zsb3dzOjphZGRfcmVjaXBlYF0oaHR0cHM6Ly93b3JrZmxvd3MudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL2FkZF9yZWNpcGUuaHRtbCkNCmFuZA0KW2B3b3JrZmxvd3M6OmFkZF9tb2RlbGBdKGh0dHBzOi8vd29ya2Zsb3dzLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9hZGRfbW9kZWwuaHRtbCkNCmFyZSB1c2VkLg0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRSwgbWF4LmhlaWdodD0nMTUwcHgnfQ0KDQpsYXNzb193b3JrZmxvdyA8LSAgd29ya2Zsb3dzOjp3b3JrZmxvdygpICU+JSANCiAgd29ya2Zsb3dzOjphZGRfcmVjaXBlKGxhc3NvX3JlY2lwZSkgJT4lIA0KICB3b3JrZmxvd3M6OmFkZF9tb2RlbChsYXNzb19zcGVjKQ0KDQpsYXNzb193b3JrZmxvdw0KYGBgDQoNCiMjIENyZWF0ZSB0aGUgcGVuYWx0eS9sYW1iZGEgZ3JpZA0KDQpBIHBlbmFsdHkvbGFtYmRhIGdyaWQgb2YgJDUwJCBudW1iZXJzIGZyb20gJDAuMDEkICgkMTBeey0yfSQpIHRvICQxMDAkDQooJDEwXjIkKSBpcyBjcmVhdGVkLg0KDQpSZWd1bGFyIGdyaWQgaXMgY3JlYXRlZCB1c2luZw0KW2BkaWFsczo6Z3JpZF9yZWd1bGFyYF0oaHR0cHM6Ly9kaWFscy50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2UvZ3JpZF9yZWd1bGFyLmh0bWwpLA0KW2BkaWFsczo6cGVuYWx0eWBdKGh0dHBzOi8vZGlhbHMudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL3BlbmFsdHkuaHRtbCkNCmFuZA0KW2BzY2FsZXM6OmxvZzEwX3RyYW5zYF0oaHR0cHM6Ly9zY2FsZXMuci1saWIub3JnL3JlZmVyZW5jZS9sb2dfdHJhbnMuaHRtbCkNCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQoNCnBlbmFsdHlfZ3JpZCA8LSBkaWFsczo6Z3JpZF9yZWd1bGFyKHggPSBkaWFsczo6cGVuYWx0eShyYW5nZSA9IGMoLTIsIDIpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zID0gc2NhbGVzOjpsb2cxMF90cmFucygpKSwgIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV2ZWxzID0gNTApDQoNCnBlbmFsdHlfZ3JpZCAgJT4lIA0KICByZWFjdGFibGU6OnJlYWN0YWJsZShkZWZhdWx0UGFnZVNpemUgPSA1KQ0KYGBgDQoNCiMjIExhc3NvIG1vZGVsIGZpdHRpbmcgb24gY3Jvc3MgdmFsaWRhdGVkIGRhdGENCg0KTm93IHdlIGhhdmUgZXZlcnl0aGluZyB3ZSBuZWVkIGFuZCB3ZSBjYW4gZml0IGFsbCB0aGUgbW9kZWxzIG9uIHRoZQ0KY3Jvc3MgdmFsaWRhdGVkIGRhdGEgd2l0aA0KW2B0dW5lOjp0dW5lX2dyaWRgXShodHRwczovL3R1bmUudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL3R1bmVfZ3JpZC5odG1sKS4NCk5vdGUgdGhhdCB0aGlzIHByb2Nlc3MgbWF5IHRha2Ugc29tZSB0aW1lLg0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCmRvUGFyYWxsZWw6OnJlZ2lzdGVyRG9QYXJhbGxlbCgpDQpmb3JlYWNoOjpnZXREb1BhcldvcmtlcnMoKQ0KYGBgDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFLCBtYXguaGVpZ2h0PScxNTBweCd9DQp0dW5lX3JlcyA8LSB0dW5lOjp0dW5lX2dyaWQoDQogIG9iamVjdCA9IGxhc3NvX3dvcmtmbG93LA0KICByZXNhbXBsZXMgPSBIaXR0ZXJzX2ZvbGQsIA0KICBncmlkID0gcGVuYWx0eV9ncmlkDQopDQoNCnR1bmVfcmVzDQpgYGANCg0KSGVyZSB3ZSBzZWUgdGhhdCB0aGUgYW1vdW50IG9mIHJlZ3VsYXJpemF0aW9uIGFmZmVjdHMgdGhlIHBlcmZvcm1hbmNlDQptZXRyaWNzIGRpZmZlcmVudGx5IHVzaW5nDQpbYHR1bmU6OmF1dG9wbG90YF0oaHR0cHM6Ly90dW5lLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9hdXRvcGxvdC50dW5lX3Jlc3VsdHMuaHRtbCkuDQpEbyBub3RlIHRoYXQgdXNpbmcgYSBkaWZmZXJlbnQgc2VlZCB3aWxsIGdpdmUgYSBkaWZmZXJlbnQgcGxvdA0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCiMgTm90ZSB0aGF0IGEgZGlmZmVyZW50IHNlZWQgd2lsbCBnaXZlIGRpZmZlcmVudCBwbG90cw0KdHVuZTo6YXV0b3Bsb3QodHVuZV9yZXMpDQpgYGANCg0KV2UgY2FuIGFsc28gc2VlIHRoZSByYXcgbWV0cmljcyB0aGF0IGNyZWF0ZWQgdGhpcyBjaGFydCBieSBjYWxsaW5nDQpbYHR1bmU6OmNvbGxlY3RfbWV0cmljcygpYF0oaHR0cHM6Ly90dW5lLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9jb2xsZWN0X3ByZWRpY3Rpb25zLmh0bWwpLg0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRSwgbWF4LmhlaWdodD0nMTUwcHgnfQ0KDQp0dW5lOjpjb2xsZWN0X21ldHJpY3ModHVuZV9yZXMpICU+JSANCiAgcmVhY3RhYmxlOjpyZWFjdGFibGUoZGVmYXVsdFBhZ2VTaXplID0gNSkNCmBgYA0KDQpIZXJlIGlzIHRoZSBgZ2dwbG90YCB3YXkgc2hvdWxkDQpbYHR1bmU6OmF1dG9wbG90YF0oaHR0cHM6Ly90dW5lLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9hdXRvcGxvdC50dW5lX3Jlc3VsdHMuaHRtbCkNCmZhaWxzDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFLCBtYXguaGVpZ2h0PScxNTBweCd9DQoNCnR1bmVfcmVzICU+JQ0KICB0dW5lOjpjb2xsZWN0X21ldHJpY3MoKSAlPiUNCiAgZ2dwbG90Mjo6Z2dwbG90KG1hcHBpbmcgPSBnZ3Bsb3QyOjphZXMoeCA9IC5kYXRhW1sicGVuYWx0eSJdXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeSA9IC5kYXRhW1sibWVhbiJdXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3VyID0gLmRhdGFbWyIubWV0cmljIl1dKSkgKw0KICBnZ3Bsb3QyOjpnZW9tX2Vycm9yYmFyKG1hcHBpbmcgPSBnZ3Bsb3QyOjphZXMoeW1pbiA9IC5kYXRhW1sibWVhbiJdXSAtIC5kYXRhW1sic3RkX2VyciJdXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHltYXggPSAuZGF0YVtbIm1lYW4iXV0gKyAuZGF0YVtbInN0ZF9lcnIiXV0pLA0KICAgICAgICAgICAgICAgICAgICAgICAgIGFscGhhID0gMC41KSArDQogIGdncGxvdDI6Omdlb21fbGluZShzaXplID0gMS41KSArDQogIGdncGxvdDI6OmZhY2V0X3dyYXAoZmFjZXRzID0gZ2dwbG90Mjo6dmFycyguZGF0YVtbIi5tZXRyaWMiXV0pLCANCiAgICAgICAgICAgICAgICAgICAgICBzY2FsZXMgPSAiZnJlZSIsIA0KICAgICAgICAgICAgICAgICAgICAgIG5yb3cgPSAyKSArDQogIGdncGxvdDI6OnNjYWxlX3hfbG9nMTAoKSArDQogIGdncGxvdDI6OnRoZW1lKGxlZ2VuZC5wb3NpdGlvbiA9ICJub25lIikNCmBgYA0KDQpVc2UNCltgdHVuZTo6c2hvd19iZXN0YF0oaHR0cHM6Ly90dW5lLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9zaG93X2Jlc3QuaHRtbCkNCnRvIHNlZSB0aGUgdG9wIGZldyB2YWx1ZXMgZm9yIGEgZ2l2ZW4gbWV0cmljLg0KDQpUaGUgImJlc3QiIHZhbHVlcyBjYW4gYmUgc2VsZWN0ZWQgdXNpbmcNCltgdHVuZTo6c2VsZWN0X2Jlc3RgXShodHRwczovL3R1bmUudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL3Nob3dfYmVzdC5odG1sKSwNCnRoaXMgZnVuY3Rpb24gcmVxdWlyZXMgeW91IHRvIHNwZWNpZnkgYSBtZXRyaWMgdGhhdCBpdCBzaG91bGQgc2VsZWN0DQphZ2FpbnN0LiBUaGUgcGVuYWx0eS9sYW1iZGEgdmFsdWUgaXMgMjIuMiBmb3IgbWV0cmljIGByc3FgIHNpbmNlIGl0DQpnaXZlcyB0aGUgaGlnaGVzdCB2YWx1ZS4gRG8gbm90ZSB0aGF0IHVzaW5nIGEgZGlmZmVyZW50IHNlZWQgd2lsbCBnaXZlIGENCmRpZmZlcmVudCBiZXN0IHBlbmFsdHkvbGFtYmRhIHZhbHVlLg0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRSwgbWF4LmhlaWdodD0nMTUwcHgnfQ0KDQp0b3BfcGVuYWx0eSA8LSB0dW5lOjpzaG93X2Jlc3QodHVuZV9yZXMsIG1ldHJpYyA9ICJyc3EiLCBuID0gNSkNCnRvcF9wZW5hbHR5DQoNCmJlc3RfcGVuYWx0eSA8LSB0dW5lOjpzZWxlY3RfYmVzdCh0dW5lX3JlcywgbWV0cmljID0gInJzcSIpDQpiZXN0X3BlbmFsdHkNCg0KYGBgDQoNCiMjIExhc3NvIG1vZGVsIHdpdGggb3B0aW1pc2VkIHBlbmFsdHkvbGFtYmRhIHZhbHVlDQoNCldlIGNyZWF0ZSB0aGUgbGFzc28gcmVncmVzc2lvbiB3b3JrZmxvdyB3aXRoIHRoZSBiZXN0IHBlbmFsdHkgc2NvcmUNCnVzaW5nDQpbYHR1bmU6OmZpbmFsaXplX3dvcmtmbG93YF0oaHR0cHM6Ly90dW5lLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9maW5hbGl6ZV9tb2RlbC5odG1sKS4NCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0UsIG1heC5oZWlnaHQ9JzE1MHB4J30NCg0KbGFzc29fZmluYWwgPC0gdHVuZTo6ZmluYWxpemVfd29ya2Zsb3coeCA9IGxhc3NvX3dvcmtmbG93LCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtZXRlcnMgPSBiZXN0X3BlbmFsdHkpDQoNCmxhc3NvX2ZpbmFsDQpgYGANCg0KV2Ugbm93IHRyYWluIHRoZSBsYXNzbyByZWdyZXNzaW9uIG1vZGVsIHdpdGggdGhlIHRyYWluaW5nIGRhdGEgdXNpbmcNCltgcGFyc25pcDo6Zml0YF0oaHR0cHM6Ly9wYXJzbmlwLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9maXQuaHRtbCkNCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQoNCmxhc3NvX2ZpbmFsX2ZpdCA8LSBwYXJzbmlwOjpmaXQob2JqZWN0ID0gbGFzc29fZmluYWwsIGRhdGEgPSBIaXR0ZXJzX3RyYWluKQ0KYGBgDQoNCldlIGNhbiBzZWUgdGhlIGNvZWZmaWNpZW50cyB1c2luZw0KW2B0dW5lOjpleHRyYWN0X2ZpdF9wYXJzbmlwYF0oaHR0cHM6Ly90dW5lLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9leHRyYWN0LXR1bmUuaHRtbCkgYW5kIFtgcGFyc25pcDo6dGlkeWBdKGh0dHBzOi8vcGFyc25pcC50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2UvdGlkeS5tb2RlbF9maXQuaHRtbCkNCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQoNCmxhc3NvX2ZpbmFsX2ZpdCAlPiUNCiAgdHVuZTo6ZXh0cmFjdF9maXRfcGFyc25pcCgpICU+JQ0KICBwYXJzbmlwOjp0aWR5KCkgJT4lDQogIHJlYWN0YWJsZTo6cmVhY3RhYmxlKGRlZmF1bHRQYWdlU2l6ZSA9IDUpDQpgYGANCg0KIyMgVmFyaWFibGUgSW1wb3J0YW5jZQ0KDQpXaGlsZSB3ZSdyZSBhdCBpdCwgbGV0J3Mgc2VlIHdoYXQgdGhlIG1vc3QgaW1wb3J0YW50IHZhcmlhYmxlcyBhcmUgdXNpbmcNCnRoZSBgdmlwYCBwYWNrYWdlIGFuZA0KW2B3b3JrZmxvd3M6OmV4dHJhY3RfZml0X3BhcnNuaXBgXShodHRwczovL3dvcmtmbG93cy50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2UvZXh0cmFjdC13b3JrZmxvdy5odG1sKS4NCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQoNCnZpcF90YWJsZSA8LSBsYXNzb19maW5hbF9maXQgJT4lDQogIHdvcmtmbG93czo6ZXh0cmFjdF9maXRfcGFyc25pcCgpICU+JQ0KICB2aXA6OnZpKGxhbWJkYSA9IGJlc3RfcGVuYWx0eSRwZW5hbHR5KSANCg0KdmlwX3RhYmxlICU+JQ0KICByZWFjdGFibGU6OnJlYWN0YWJsZShkZWZhdWx0UGFnZVNpemUgPSA1KQ0KYGBgDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KdmlwX3RhYmxlICU+JSANCiAgZHBseXI6Om11dGF0ZSgNCiAgICBJbXBvcnRhbmNlID0gYWJzKC5kYXRhW1siSW1wb3J0YW5jZSJdXSksDQogICAgVmFyaWFibGUgPSBmb3JjYXRzOjpmY3RfcmVvcmRlciguZiA9IC5kYXRhW1siVmFyaWFibGUiXV0sIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnggPSAuZGF0YVtbIkltcG9ydGFuY2UiXV0pDQogICkgJT4lDQogIGdncGxvdDI6OmdncGxvdChtYXBwaW5nID0gZ2dwbG90Mjo6YWVzKHggPSAuZGF0YVtbIkltcG9ydGFuY2UiXV0sIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ID0gLmRhdGFbWyJWYXJpYWJsZSJdXSwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGwgPSAuZGF0YVtbIlNpZ24iXV0pKSArDQogIGdncGxvdDI6Omdlb21fY29sKCkgKw0KICBnZ3Bsb3QyOjpzY2FsZV94X2NvbnRpbnVvdXMoZXhwYW5kID0gYygwLCAwKSkgKw0KICBnZ3Bsb3QyOjpsYWJzKHkgPSBOVUxMKQ0KYGBgDQoNCiMjIExhc3NvIHJlZ3Jlc3Npb24gbW9kZWwgb24gdGVzdCBkYXRhDQoNClRoaXMgbGFzc28gcmVncmVzc2lvbiBtb2RlbCBjYW4gbm93IGJlIGFwcGxpZWQgb24gb3VyIHRlc3RpbmcgZGF0YSBzZXQNCnRvIHZhbGlkYXRlIGl0cyBwZXJmb3JtYW5jZS4gRm9yIHJlZ3Jlc3Npb24gbW9kZWxzLCBhIC5wcmVkIGNvbHVtbiBpcw0KYWRkZWQgd2hlbg0KW2BwYXJzbmlwOjphdWdtZW50YF0oaHR0cHM6Ly9wYXJzbmlwLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9hdWdtZW50Lmh0bWwpDQppcyB1c2VkLg0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCg0KdGVzdF9yZXN1bHRzIDwtIHBhcnNuaXA6OmF1Z21lbnQoeCA9IGxhc3NvX2ZpbmFsX2ZpdCwgbmV3X2RhdGEgPSBIaXR0ZXJzX3Rlc3QpDQogIA0KdGVzdF9yZXN1bHRzICU+JQ0KICByZWFjdGFibGU6OnJlYWN0YWJsZShkZWZhdWx0UGFnZVNpemUgPSA1KQ0KICANCmBgYA0KDQpXZSBjaGVjayBob3cgd2VsbCB0aGUgYC5wcmVkYCBjb2x1bW4gbWF0Y2hlcyB0aGUgU2FsYXJ5IHVzaW5nDQpbYHlhcmRzdGljazo6cnNxYF0oaHR0cHM6Ly95YXJkc3RpY2sudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL3JzcS5odG1sKS4NCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQp0ZXN0X3Jlc3VsdHMgJT4lDQogIHlhcmRzdGljazo6cnNxKHRydXRoID0gLmRhdGFbWyJTYWxhcnkiXV0sIGVzdGltYXRlID0gLmRhdGFbWyIucHJlZCJdXSkgJT4lDQogIHJlYWN0YWJsZTo6cmVhY3RhYmxlKGRlZmF1bHRQYWdlU2l6ZSA9IDUpDQpgYGANCg0KQWx0ZXJuYXRpdmVseSwgd2UgY2FuIHVzZQ0KW2B0dW5lOjpsYXN0X2ZpdGBdKGh0dHBzOi8vdHVuZS50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2UvbGFzdF9maXQuaHRtbCkNCmFuZA0KW2B0dW5lOjpjb2xsZWN0X21ldHJpY3NgXShodHRwczovL3R1bmUudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL2NvbGxlY3RfcHJlZGljdGlvbnMuaHRtbCkuDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KDQp0ZXN0X3JzIDwtIHR1bmU6Omxhc3RfZml0KG9iamVjdCA9IGxhc3NvX2ZpbmFsX2ZpdCwgDQogICAgICAgICAgICAgICAgICAgICAgICAgIHNwbGl0ID0gSGl0dGVyc19zcGxpdCkNCiAgDQp0ZXN0X3JzICU+JQ0KICB0dW5lOjpjb2xsZWN0X21ldHJpY3MoKSAlPiUNCiAgcmVhY3RhYmxlOjpyZWFjdGFibGUoZGVmYXVsdFBhZ2VTaXplID0gNSkNCiAgDQpgYGANCg0KVXNlIFtgdHVuZTo6Y29sbGVjdF9wcmVkaWN0aW9uc2BdKGh0dHBzOi8vdHVuZS50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2UvY29sbGVjdF9wcmVkaWN0aW9ucy5odG1sKSwgdG8gc2VlIG9ubHkgdGhlIGFjdHVhbCBhbmQgcHJlZGljdGVkIHZhbHVlcyBvZiB0aGUgdGVzdCBkYXRhLg0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCnRlc3RfcnMgJT4lDQogIHR1bmU6OmNvbGxlY3RfcHJlZGljdGlvbnMoKSAlPiUNCiAgcmVhY3RhYmxlOjpyZWFjdGFibGUoZGVmYXVsdFBhZ2VTaXplID0gNSkNCmBgYA0KDQpMZXQgdXMgdGFrZSBhIGNsb3NlciBsb29rIGF0IHRoZSBwcmVkaWN0ZWQgYW5kIGFjdHVhbCByZXNwb25zZSBhcyBhIHNjYXR0ZXIgcGxvdC4NCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQp0ZXN0X3JzICU+JQ0KICB0dW5lOjpjb2xsZWN0X3ByZWRpY3Rpb25zKCkgJT4lDQogIGdncGxvdDI6OmdncGxvdChtYXBwaW5nID0gZ2dwbG90Mjo6YWVzKHggPSAuZGF0YVtbIlNhbGFyeSJdXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeSA9IC5kYXRhW1siLnByZWQiXV0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKQ0KICAgICAgICAgICAgICAgICAgKSArDQogIGdncGxvdDI6Omdlb21fYWJsaW5lKHNsb3BlID0gMSwgbHR5ID0gMiwgY29sb3IgPSAiZ3JheTUwIiwgYWxwaGEgPSAwLjUpICsNCiAgZ2dwbG90Mjo6Z2VvbV9wb2ludChhbHBoYSA9IDAuNiwgY29sb3IgPSAibWlkbmlnaHRibHVlIikgKw0KICBnZ3Bsb3QyOjpjb29yZF9maXhlZCgpDQpgYGANCg0KIyBQcmluY2lwYWwgQ29tcG9uZW50cyBSZWdyZXNzaW9uDQoNClRoZSBwcmluY2lwYWwgY29tcG9uZW50IHJlZ3Jlc3Npb24gaXMgYSBsaW5lYXIgbW9kZWwgd2l0aCBwY2ENCnRyYW5zZm9ybWVkIGRhdGEuIEhlbmNlLCB0aGUgbWFqb3IgY2hhbmdlcyB3aWxsIGJlIG9uIHRoZSBwcmVwcm9jZXNzaW5nDQpzdGVwcy4NCg0KIyMgQ3JlYXRlIHRoZSByZXNhbXBsZSBvYmplY3QNCg0KRmlyc3QsIHdlIHNwbGl0IHRoZSBzYW1wbGVzIGludG8gYSB0cmFpbmluZyBzZXQgYW5kIGEgdGVzdCBzZXQuIEZyb20gdGhlIHRyYWluaW5nIHNldCwgd2UgY3JlYXRlIGEgMTAtZm9sZCBjcm9zcy12YWxpZGF0aW9uIGRhdGEgc2V0IGZyb20gdGhlIHRyYWluaW5nIHNldC4NCg0KVGhpcyBpcyBkb25lIHdpdGggW2Byc2FtcGxlOjppbml0aWFsX3NwbGl0YF0oaHR0cHM6Ly9yc2FtcGxlLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9pbml0aWFsX3NwbGl0Lmh0bWwpLA0KW2Byc2FtcGxlOjp0cmFpbmluZ2BdKGh0dHBzOi8vcnNhbXBsZS50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2UvaW5pdGlhbF9zcGxpdC5odG1sKSwNCltgcnNhbXBsZTo6dGVzdGluZ2BdKGh0dHBzOi8vcnNhbXBsZS50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2UvaW5pdGlhbF9zcGxpdC5odG1sKQ0KYW5kDQpbYHJzYW1wbGU6OnZmb2xkX2N2YF0oaHR0cHM6Ly9yc2FtcGxlLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS92Zm9sZF9jdi5odG1sKS4NCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQpzZXQuc2VlZCgxMjM0KQ0KSGl0dGVycyA8LSBkcGx5cjo6YXNfdGliYmxlKElTTFIyOjpIaXR0ZXJzKSAlPiUNCiAgdGlkeXI6OmRyb3BfbmEoKQ0KDQpIaXR0ZXJzX3NwbGl0IDwtIHJzYW1wbGU6OmluaXRpYWxfc3BsaXQoSGl0dGVycywgc3RyYXRhID0gIlNhbGFyeSIpDQoNCkhpdHRlcnNfdHJhaW4gPC0gcnNhbXBsZTo6dHJhaW5pbmcoSGl0dGVyc19zcGxpdCkNCkhpdHRlcnNfdGVzdCA8LSByc2FtcGxlOjp0ZXN0aW5nKEhpdHRlcnNfc3BsaXQpDQoNCkhpdHRlcnNfZm9sZCA8LSByc2FtcGxlOjp2Zm9sZF9jdihIaXR0ZXJzX3RyYWluLCB2ID0gMTApDQoNCmBgYA0KDQojIyBDcmVhdGUgdGhlIHByZXByb2Nlc3Nvcg0KDQpXZSBjcmVhdGUgYSByZWNpcGUgd2l0aA0KW2ByZWNpcGVzOjpyZWNpcGVgXShodHRwczovL3JlY2lwZXMudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL3JlY2lwZS5odG1sKSwNCltgcmVjaXBlczo6YWxsX25vbWluYWxfcHJlZGljdG9yc2BdKGh0dHBzOi8vcmVjaXBlcy50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2UvaGFzX3JvbGUuaHRtbCksDQpbYHJlY2lwZXM6OmFsbF9wcmVkaWN0b3JzKClgXShodHRwczovL3JlY2lwZXMudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL2hhc19yb2xlLmh0bWwpLA0KW2ByZWNpcGVzOjpzdGVwX25vdmVsYF0oaHR0cHM6Ly9yZWNpcGVzLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9zdGVwX25vdmVsLmh0bWwpLA0KW2ByZWNpcGVzOjpzdGVwX2R1bW15YF0oaHR0cHM6Ly9yZWNpcGVzLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9zdGVwX2R1bW15Lmh0bWwpLA0KW2ByZWNpcGVzOjpzdGVwX3p2YF0oaHR0cHM6Ly9yZWNpcGVzLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9zdGVwX3p2Lmh0bWwpDQphbmQNCltgcmVjaXBlczo6c3RlcF9ub3JtYWxpemVgXShodHRwczovL3JlY2lwZXMudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL3N0ZXBfbm9ybWFsaXplLmh0bWwpLg0KDQpXZSBhZGQNCltgcmVjaXBlczo6c3RlcF9wY2FgXShodHRwczovL3JlY2lwZXMudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL3N0ZXBfcGNhLmh0bWwpDQp0aGlzIHRpbWUgdG8gcGVyZm9ybSBwcmluY2lwYWwgY29tcG9uZW50IGFuYWx5c2lzIG9uIGFsbCB0aGUgcHJlZGljdG9ycy4NCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQoNCnBjYV9yZWNpcGUgPC0gDQogIHJlY2lwZXM6OnJlY2lwZShmb3JtdWxhID0gU2FsYXJ5IH4gLiwgZGF0YSA9IEhpdHRlcnNfdHJhaW4pICU+JSANCiAgcmVjaXBlczo6c3RlcF9ub3ZlbChyZWNpcGVzOjphbGxfbm9taW5hbF9wcmVkaWN0b3JzKCkpICU+JSANCiAgcmVjaXBlczo6c3RlcF9kdW1teShyZWNpcGVzOjphbGxfbm9taW5hbF9wcmVkaWN0b3JzKCkpICU+JSANCiAgcmVjaXBlczo6c3RlcF96dihyZWNpcGVzOjphbGxfcHJlZGljdG9ycygpKSAlPiUgDQogIHJlY2lwZXM6OnN0ZXBfbm9ybWFsaXplKHJlY2lwZXM6OmFsbF9wcmVkaWN0b3JzKCkpICU+JQ0KICByZWNpcGVzOjpzdGVwX3BjYShyZWNpcGVzOjphbGxfcHJlZGljdG9ycygpLCBpZCA9ICJwY2EiKQ0KYGBgDQoNCkFwcGx5DQpbYHJlY2lwZXM6OnByZXBgXShodHRwczovL3JlY2lwZXMudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL3ByZXAuaHRtbCkNCmFuZA0KW2ByZWNpcGVzOjpiYWtlYF0oaHR0cHM6Ly9yZWNpcGVzLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9iYWtlLmh0bWwpIHRvDQpjb21wdXRlIHRoZSBwcmVwcm9jZXNzaW5nIHN0ZXAuDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KDQpyZWMgPC0gcmVjaXBlczo6cHJlcCh4ID0gcGNhX3JlY2lwZSwgdHJhaW5pbmcgPSBIaXR0ZXJzX3RyYWluKQ0KICANCnJlYyAlPiUNCiAgc3VtbWFyeSgpICU+JQ0KICByZWFjdGFibGU6OnJlYWN0YWJsZShkZWZhdWx0UGFnZVNpemUgPSA1KQ0KDQpyZWMgJT4lDQogIHJlY2lwZXM6OmJha2UobmV3X2RhdGEgPSBIaXR0ZXJzX3RyYWluKSAlPiUNCiAgcmVhY3RhYmxlOjpyZWFjdGFibGUoZGVmYXVsdFBhZ2VTaXplID0gNSkNCg0KYGBgDQoNCiMjIFBDQSBleHBsb3JhdGlvbg0KDQpXZSBjYW4gZXhwbG9yZSB0aGUgcmVzdWx0cyBvZiB0aGUgUENBIHVzaW5nIHRoZSBbYHJlY2lwZXM6OnByZXBgXShodHRwczovL3JlY2lwZXMudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL3ByZXAuaHRtbCkgYW5kDQpbYHBhcnNuaXA6OnRpZHlgXShodHRwczovL3BhcnNuaXAudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL3RpZHkubW9kZWxfZml0Lmh0bWwpLiBXZSBjYW4gc2VlIHRoYXQgcGNhIGlzIGRvbmUgYXQgc3RlcCBudW1iZXIgNQ0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCg0KcmVjaXBlczo6cHJlcCh4ID0gcGNhX3JlY2lwZSwgdHJhaW5pbmcgPSBIaXR0ZXJzX3RyYWluKSAlPiUNCiAgcGFyc25pcDo6dGlkeSgpICU+JQ0KICByZWFjdGFibGU6OnJlYWN0YWJsZShkZWZhdWx0UGFnZVNpemUgPSA1KQ0KYGBgDQoNCkFzIHN1Y2gsIHdlIGV4dHJhY3QgdGhlIHJlc3VsdHMgb2Ygc3RlcCBudW1iZXIgNSBvciB0aGUgcGNhIHN0ZXAuDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KDQp0aWRpZWRfcGNhX2xvYWRpbmdzIDwtIHJlY2lwZXM6OnByZXAoeCA9IHBjYV9yZWNpcGUsIHRyYWluaW5nID0gSGl0dGVyc190cmFpbikgJT4lDQogIHBhcnNuaXA6OnRpZHkoaWQgPSAicGNhIiwgdHlwZSA9ICJjb2VmIikNCg0KDQp0aWRpZWRfcGNhX2xvYWRpbmdzICU+JQ0KICByZWFjdGFibGU6OnJlYWN0YWJsZShkZWZhdWx0UGFnZVNpemUgPSA1KQ0KDQpgYGANCg0KV2UgbWFrZSBhIHZpc3VhbGl6YXRpb24gdG8gc2VlIHdoYXQgdGhlIGZpcnN0IGZvdXIgY29tcG9uZW50cyBsb29rIGxpa2UNCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0UsIGZpZy5oZWlnaHQgPSA4fQ0KDQp0aWRpZWRfcGNhX2xvYWRpbmdzICU+JQ0KICBkcGx5cjo6ZmlsdGVyKC5kYXRhW1siY29tcG9uZW50Il1dICVpbiUgYygiUEMxIiwgIlBDMiIsICJQQzMiLCAiUEM0IikpICU+JQ0KICBkcGx5cjo6bXV0YXRlKGNvbXBvbmVudCA9IGZvcmNhdHM6OmZjdF9pbm9yZGVyKC5kYXRhW1siY29tcG9uZW50Il1dKSkgJT4lDQogIGdncGxvdDI6OmdncGxvdChtYXBwaW5nID0gZ2dwbG90Mjo6YWVzKHggPSAuZGF0YVtbInZhbHVlIl1dLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeSA9IC5kYXRhW1sidGVybXMiXV0sIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxsID0gLmRhdGFbWyJ0ZXJtcyJdXSkpICsNCiAgZ2dwbG90Mjo6Z2VvbV9jb2woc2hvdy5sZWdlbmQgPSBGQUxTRSkgKw0KICBnZ3Bsb3QyOjpmYWNldF93cmFwKGZhY2V0cyA9IGdncGxvdDI6OnZhcnMoLmRhdGFbWyJjb21wb25lbnQiXV0pKSArDQogIGdncGxvdDI6OmxhYnMoeSA9IE5VTEwpDQoNCmBgYA0KDQpMZXQgdXMgdGFrZSBhIGNsb3NlciBsb29rIGF0IHRoZSB0b3AgNiB2YXJpYWJsZXMgdGhhdCBjb250cmlidXRlIHRvIHRoZQ0KZmlyc3QgZm91ciBjb21wb25lbnRzDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KDQp0aWRpZWRfcGNhX2xvYWRpbmdzICU+JQ0KICBkcGx5cjo6ZmlsdGVyKC5kYXRhW1siY29tcG9uZW50Il1dICVpbiUgYygiUEMxIiwgIlBDMiIsICJQQzMiLCAiUEM0IikpICU+JQ0KICBkcGx5cjo6Z3JvdXBfYnkoLmRhdGFbWyJjb21wb25lbnQiXV0pICU+JQ0KICBkcGx5cjo6dG9wX24oNiwgYWJzKC5kYXRhW1sidmFsdWUiXV0pKSAlPiUNCiAgZHBseXI6OnVuZ3JvdXAoKSAlPiUNCiAgZHBseXI6Om11dGF0ZSgNCiAgICB0ZXJtcyA9IHRpZHl0ZXh0OjpyZW9yZGVyX3dpdGhpbih4ID0gLmRhdGFbWyJ0ZXJtcyJdXSwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnkgPSBhYnMoLmRhdGFbWyJ2YWx1ZSJdXSksIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpdGhpbiA9IC5kYXRhW1siY29tcG9uZW50Il1dKQ0KICAgICkgJT4lDQogIGdncGxvdDI6OmdncGxvdChtYXBwaW5nID0gZ2dwbG90Mjo6YWVzKHggPSBhYnMoLmRhdGFbWyJ2YWx1ZSJdXSksIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ID0gLmRhdGFbWyJ0ZXJtcyJdXSwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGwgPSAuZGF0YVtbInZhbHVlIl1dID4gMCkNCiAgICAgICAgICAgICAgICAgICkgKw0KICBnZ3Bsb3QyOjpnZW9tX2NvbCgpICsNCiAgZ2dwbG90Mjo6ZmFjZXRfd3JhcChmYWNldHMgPSBnZ3Bsb3QyOjp2YXJzKC5kYXRhW1siY29tcG9uZW50Il1dKSwgDQogICAgICAgICAgICAgICAgICAgICAgc2NhbGVzID0gImZyZWVfeSIpICsNCiAgdGlkeXRleHQ6OnNjYWxlX3lfcmVvcmRlcmVkKCkgKw0KICBnZ3Bsb3QyOjpsYWJzKA0KICAgIHggPSAiQWJzb2x1dGUgdmFsdWUgb2YgY29udHJpYnV0aW9uIHRvIFBDQSBjb21wb25lbnQiLA0KICAgIHkgPSBOVUxMLCANCiAgICBmaWxsID0gIlBvc2l0aXZlPyINCiAgKQ0KDQpgYGANCg0KSG93IG11Y2ggdmFyaWF0aW9uIGFyZSB3ZSBjYXB0dXJpbmcgZm9yIGVhY2ggY29tcG9uZW50Pw0KDQpIZXJlIGlzIGhvdyB3ZSBjYW4gc2VlIHRoZSB2YXJpYW5jZSBzdGF0aXN0aWNzIGJ1dCBpdCBpcyBpbiBhIGxvbmcgZm9ybQ0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCnRpZGllZF9wY2FfdmFyaWFuY2UgPC0gcmVjaXBlczo6cHJlcCh4ID0gcGNhX3JlY2lwZSwgdHJhaW5pbmcgPSBIaXR0ZXJzX3RyYWluKSAlPiUNCiAgYnJvb206OnRpZHkoaWQgPSAicGNhIiwgdHlwZSA9ICJ2YXJpYW5jZSIpDQoNCnRpZGllZF9wY2FfdmFyaWFuY2UgJT4lIA0KICByZWFjdGFibGU6OnJlYWN0YWJsZShkZWZhdWx0UGFnZVNpemUgPSA1KQ0KYGBgDQoNCkhlcmUgaXMgaG93IHdlIGNhbiBzZWUgdGhlIHZhcmlhbmNlIHN0YXRpc3RpY3MgaW4gaXRzIHdpZGUgZm9ybQ0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCnRpZGllZF9wY2FfdmFyaWFuY2UgJT4lIA0KICB0aWR5cjo6cGl2b3Rfd2lkZXIobmFtZXNfZnJvbSA9IC5kYXRhW1siY29tcG9uZW50Il1dLCANCiAgICAgICAgICAgICAgICAgICAgIHZhbHVlc19mcm9tID0gLmRhdGFbWyJ2YWx1ZSJdXSwgDQogICAgICAgICAgICAgICAgICAgICBuYW1lc19wcmVmaXggPSAiUEMiKSAlPiUgDQogIGRwbHlyOjpzZWxlY3QoLWRwbHlyOjphbGxfb2YoImlkIikpICU+JSANCiAgcmVhY3RhYmxlOjpyZWFjdGFibGUoZGVmYXVsdFBhZ2VTaXplID0gNSkNCmBgYA0KDQpIZXJlIGlzIGEgc2ltcGxlIHBsb3QgdG8gc2hvdyB0aGUgdmFyaWFuY2UgY2FwdHVyZWQgZm9yIGVhY2ggY29tcG9uZW50DQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KIyBHZXQgdGhlIHZhcmlhbmNlDQpwZXJjZW50X3ZhcmlhdGlvbiA8LSB0aWRpZWRfcGNhX3ZhcmlhbmNlICU+JQ0KICBkcGx5cjo6ZmlsdGVyKC5kYXRhW1sidGVybXMiXV0gPT0gInBlcmNlbnQgdmFyaWFuY2UiKSAlPiUgDQogIGRwbHlyOjpwdWxsKC5kYXRhW1sidmFsdWUiXV0pDQoNCnBlcmNlbnRfdmFyaWF0aW9uIDwtIHBlcmNlbnRfdmFyaWF0aW9uLzEwMA0KDQojIEkgdXNlIFsxOjRdIHRvIHNlbGVjdCB0aGUgZmlyc3QgZm91ciBjb21wb25lbnRzDQpkcGx5cjo6dGliYmxlKGNvbXBvbmVudCA9IHVuaXF1ZSh0aWRpZWRfcGNhX2xvYWRpbmdzJGNvbXBvbmVudClbMTo0XSwgDQogICAgICAgICAgICAgIHBlcmNlbnRfdmFyID0gcGVyY2VudF92YXJpYXRpb25bMTo0XSkgJT4lDQogIGRwbHlyOjptdXRhdGUoY29tcG9uZW50ID0gZm9yY2F0czo6ZmN0X2lub3JkZXIoLmRhdGFbWyJjb21wb25lbnQiXV0pKSAlPiUNCiAgZ2dwbG90Mjo6Z2dwbG90KG1hcHBpbmcgPSBnZ3Bsb3QyOjphZXMoeCA9IC5kYXRhW1siY29tcG9uZW50Il1dLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeSA9IC5kYXRhW1sicGVyY2VudF92YXIiXV0pKSArDQogIGdncGxvdDI6Omdlb21fY29sKCkgKw0KICBnZ3Bsb3QyOjpzY2FsZV95X2NvbnRpbnVvdXMobGFiZWxzID0gc2NhbGVzOjpwZXJjZW50X2Zvcm1hdCgpKSArDQogIGdncGxvdDI6OmxhYnMoeCA9IE5VTEwsIA0KICAgICAgICAgICAgICAgIHkgPSAiUGVyY2VudCB2YXJpYW5jZSBleHBsYWluZWQgYnkgZWFjaCBQQ0EgY29tcG9uZW50IikNCg0KYGBgDQoNClRocmVzaG9sZCBpcyB0aGUgZnJhY3Rpb24gb2YgdGhlIHRvdGFsIHZhcmlhbmNlIHRoYXQgc2hvdWxkIGJlIGNvdmVyZWQNCmJ5IHRoZSBjb21wb25lbnRzLiBGb3IgZXhhbXBsZSwgYHRocmVzaG9sZCA9IC43NWAgbWVhbnMgdGhhdCBzdGVwX3BjYQ0Kc2hvdWxkIGdlbmVyYXRlIGVub3VnaCBjb21wb25lbnRzIHRvIGNhcHR1cmUgNzUgcGVyY2VudCBvZiB0aGUNCnZhcmlhYmlsaXR5IGluIHRoZSB2YXJpYWJsZXMuIE5vdGU6IHVzaW5nIHRoaXMgYXJndW1lbnQgd2lsbCBvdmVycmlkZQ0KYW5kIHJlc2V0IGFueSB2YWx1ZSBnaXZlbiB0byBgbnVtX2NvbXBgLg0KDQpXZSB3aWxsIG5vdyB0cnkgdG8gZmluZCB0aGUgYmVzdCB0aHJlc2hvbGQgdmFsdWUgdXNpbmcgdGhlDQpbYHR1bmU6OnR1bmUoKWBdKGh0dHBzOi8vaGFyZGhhdC50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2UvdHVuZS5odG1sKQ0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCg0KcGNhX3JlY2lwZSA8LSANCiAgcmVjaXBlczo6cmVjaXBlKGZvcm11bGEgPSBTYWxhcnkgfiAuLCBkYXRhID0gSGl0dGVyc190cmFpbikgJT4lIA0KICByZWNpcGVzOjpzdGVwX25vdmVsKHJlY2lwZXM6OmFsbF9ub21pbmFsX3ByZWRpY3RvcnMoKSkgJT4lIA0KICByZWNpcGVzOjpzdGVwX2R1bW15KHJlY2lwZXM6OmFsbF9ub21pbmFsX3ByZWRpY3RvcnMoKSkgJT4lIA0KICByZWNpcGVzOjpzdGVwX3p2KHJlY2lwZXM6OmFsbF9wcmVkaWN0b3JzKCkpICU+JSANCiAgcmVjaXBlczo6c3RlcF9ub3JtYWxpemUocmVjaXBlczo6YWxsX3ByZWRpY3RvcnMoKSkgJT4lDQogIHJlY2lwZXM6OnN0ZXBfcGNhKHJlY2lwZXM6OmFsbF9wcmVkaWN0b3JzKCksIHRocmVzaG9sZCA9IHR1bmU6OnR1bmUoKSkNCmBgYA0KDQojIyBTcGVjaWZ5IHRoZSBtb2RlbA0KDQpXZSB1c2UgYSBsaW5lYXIgbW9kZWwNCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQoNCmxtX3NwZWMgPC0gDQogIHBhcnNuaXA6OmxpbmVhcl9yZWcoKSAlPiUgDQogIHBhcnNuaXA6OnNldF9tb2RlKCJyZWdyZXNzaW9uIikgJT4lIA0KICBwYXJzbmlwOjpzZXRfZW5naW5lKCJsbSIpDQoNCmxtX3NwZWMgJT4lDQogIHBhcnNuaXA6OnRyYW5zbGF0ZSgpDQoNCmBgYA0KDQojIyBDcmVhdGUgdGhlIHdvcmtmbG93DQoNCltgd29ya2Zsb3dzOjp3b3JrZmxvd2BdKGh0dHBzOi8vd29ya2Zsb3dzLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS93b3JrZmxvdy5odG1sKSwNCltgd29ya2Zsb3dzOjphZGRfcmVjaXBlYF0oaHR0cHM6Ly93b3JrZmxvd3MudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL2FkZF9yZWNpcGUuaHRtbCkNCmFuZA0KW2B3b3JrZmxvd3M6OmFkZF9tb2RlbGBdKGh0dHBzOi8vd29ya2Zsb3dzLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9hZGRfbW9kZWwuaHRtbCkNCmFyZSB1c2VkLg0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRSwgbWF4LmhlaWdodD0nMTUwcHgnfQ0KDQpwY2Ffd29ya2Zsb3cgPC0gIHdvcmtmbG93czo6d29ya2Zsb3coKSAlPiUgDQogIHdvcmtmbG93czo6YWRkX3JlY2lwZShwY2FfcmVjaXBlKSAlPiUgDQogIHdvcmtmbG93czo6YWRkX21vZGVsKGxtX3NwZWMpDQoNCnBjYV93b3JrZmxvdw0KYGBgDQoNCiMjIENyZWF0ZSB0aGUgdGhyZXNob2xkIGdyaWQNCg0KQSB0aHJlc2hvbGQgZ3JpZCBvZiAkMTAkIG51bWJlcnMgZnJvbSAkMCQgdG8gJDEkIGlzIGNyZWF0ZWQuDQoNClRocmVzaG9sZCBncmlkIGlzIGNyZWF0ZWQgdXNpbmcNCltgZGlhbHM6OmdyaWRfcmVndWxhcmBdKGh0dHBzOi8vZGlhbHMudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL2dyaWRfcmVndWxhci5odG1sKQ0KYW5kDQpbYGRpYWxzOjp0aHJlc2hvbGRgXShodHRwczovL2RpYWxzLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS90aHJlc2hvbGQuaHRtbCkNCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQp0aHJlc2hvbGRfZ3JpZCAgPC0gZGlhbHM6OmdyaWRfcmVndWxhcih4ID0gZGlhbHM6OnRocmVzaG9sZChyYW5nZSA9IGMoMCwgMSkpLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldmVscyA9IDEwKQ0KDQp0aHJlc2hvbGRfZ3JpZCAlPiUgDQogIHJlYWN0YWJsZTo6cmVhY3RhYmxlKGRlZmF1bHRQYWdlU2l6ZSA9IDUpDQpgYGANCg0KIyMgUHJpbmNpcGFsIGNvbXBvbmVudCByZWdyZXNzaW9uIG1vZGVsIGZpdHRpbmcgb24gY3Jvc3MgdmFsaWRhdGVkIGRhdGENCg0KTm93IHdlIGhhdmUgZXZlcnl0aGluZyB3ZSBuZWVkIGFuZCB3ZSBjYW4gZml0IGFsbCB0aGUgbW9kZWxzIG9uIHRoZQ0KY3Jvc3MgdmFsaWRhdGVkIGRhdGEgd2l0aA0KW2B0dW5lOjp0dW5lX2dyaWRgXShodHRwczovL3R1bmUudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL3R1bmVfZ3JpZC5odG1sKS4NCk5vdGUgdGhhdCB0aGlzIHByb2Nlc3MgbWF5IHRha2Ugc29tZSB0aW1lLg0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCmRvUGFyYWxsZWw6OnJlZ2lzdGVyRG9QYXJhbGxlbCgpDQpmb3JlYWNoOjpnZXREb1BhcldvcmtlcnMoKQ0KYGBgDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFLCBtYXguaGVpZ2h0PScxNTBweCd9DQp0dW5lX3JlcyA8LSB0dW5lOjp0dW5lX2dyaWQoDQogIG9iamVjdCA9IHBjYV93b3JrZmxvdywNCiAgcmVzYW1wbGVzID0gSGl0dGVyc19mb2xkLCANCiAgZ3JpZCA9IHRocmVzaG9sZF9ncmlkDQopDQoNCnR1bmVfcmVzDQpgYGANCg0KSGVyZSB3ZSBzZWUgdGhhdCB0aGUgYW1vdW50IG9mIHJlZ3VsYXJpemF0aW9uIGFmZmVjdHMgdGhlIHBlcmZvcm1hbmNlDQptZXRyaWNzIGRpZmZlcmVudGx5IHVzaW5nDQpbYHR1bmU6OmF1dG9wbG90YF0oaHR0cHM6Ly90dW5lLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9hdXRvcGxvdC50dW5lX3Jlc3VsdHMuaHRtbCkuDQpEbyBub3RlIHRoYXQgdXNpbmcgYSBkaWZmZXJlbnQgc2VlZCB3aWxsIGdpdmUgYSBkaWZmZXJlbnQgcGxvdA0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCiMgTm90ZSB0aGF0IGEgZGlmZmVyZW50IHNlZWQgd2lsbCBnaXZlIGRpZmZlcmVudCBwbG90cw0KdHVuZTo6YXV0b3Bsb3QodHVuZV9yZXMpDQpgYGANCg0KV2UgY2FuIGFsc28gc2VlIHRoZSByYXcgbWV0cmljcyB0aGF0IGNyZWF0ZWQgdGhpcyBjaGFydCBieSBjYWxsaW5nDQpbYHR1bmU6OmNvbGxlY3RfbWV0cmljcygpYF0oaHR0cHM6Ly90dW5lLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9jb2xsZWN0X3ByZWRpY3Rpb25zLmh0bWwpLg0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRSwgbWF4LmhlaWdodD0nMTUwcHgnfQ0KDQp0dW5lOjpjb2xsZWN0X21ldHJpY3ModHVuZV9yZXMpICU+JSANCiAgcmVhY3RhYmxlOjpyZWFjdGFibGUoZGVmYXVsdFBhZ2VTaXplID0gNSkNCmBgYA0KDQpIZXJlIGlzIHRoZSBgZ2dwbG90YCB3YXkgc2hvdWxkDQpbYHR1bmU6OmF1dG9wbG90YF0oaHR0cHM6Ly90dW5lLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9hdXRvcGxvdC50dW5lX3Jlc3VsdHMuaHRtbCkNCmZhaWxzDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFLCBtYXguaGVpZ2h0PScxNTBweCd9DQoNCnR1bmVfcmVzICU+JQ0KICB0dW5lOjpjb2xsZWN0X21ldHJpY3MoKSAlPiUNCiAgZ2dwbG90Mjo6Z2dwbG90KG1hcHBpbmcgPSBnZ3Bsb3QyOjphZXMoeCA9IC5kYXRhW1sidGhyZXNob2xkIl1dLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ID0gLmRhdGFbWyJtZWFuIl1dLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvdXIgPSAuZGF0YVtbIi5tZXRyaWMiXV0pKSArDQogIGdncGxvdDI6Omdlb21fZXJyb3JiYXIobWFwcGluZyA9IGdncGxvdDI6OmFlcyh5bWluID0gLmRhdGFbWyJtZWFuIl1dIC0gLmRhdGFbWyJzdGRfZXJyIl1dLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeW1heCA9IC5kYXRhW1sibWVhbiJdXSArIC5kYXRhW1sic3RkX2VyciJdXSksDQogICAgICAgICAgICAgICAgICAgICAgICAgYWxwaGEgPSAwLjUpICsNCiAgZ2dwbG90Mjo6Z2VvbV9saW5lKHNpemUgPSAxLjUpICsNCiAgZ2dwbG90Mjo6ZmFjZXRfd3JhcChmYWNldHMgPSBnZ3Bsb3QyOjp2YXJzKC5kYXRhW1siLm1ldHJpYyJdXSksIA0KICAgICAgICAgICAgICAgICAgICAgIHNjYWxlcyA9ICJmcmVlIiwgDQogICAgICAgICAgICAgICAgICAgICAgbnJvdyA9IDIpICsNCiAgZ2dwbG90Mjo6dGhlbWUobGVnZW5kLnBvc2l0aW9uID0gIm5vbmUiKQ0KYGBgDQoNClVzZQ0KW2B0dW5lOjpzaG93X2Jlc3RgXShodHRwczovL3R1bmUudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL3Nob3dfYmVzdC5odG1sKQ0KdG8gc2VlIHRoZSB0b3AgZmV3IHZhbHVlcyBmb3IgYSBnaXZlbiBtZXRyaWMuDQoNClRoZSAiYmVzdCIgdmFsdWVzIGNhbiBiZSBzZWxlY3RlZCB1c2luZw0KW2B0dW5lOjpzZWxlY3RfYmVzdGBdKGh0dHBzOi8vdHVuZS50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2Uvc2hvd19iZXN0Lmh0bWwpLA0KdGhpcyBmdW5jdGlvbiByZXF1aXJlcyB5b3UgdG8gc3BlY2lmeSBhIG1ldHJpYyB0aGF0IGl0IHNob3VsZCBzZWxlY3QNCmFnYWluc3QuIFRoZSB0aHJlc2hvbGQgdmFsdWUgaXMgMC44ODkgZm9yIG1ldHJpYyBgcnNtZWAgc2luY2UgaXQgZ2l2ZXMNCnRoZSBsb3dlc3QgdmFsdWUuIERvIG5vdGUgdGhhdCB1c2luZyBhIGRpZmZlcmVudCBzZWVkIHdpbGwgZ2l2ZSBhDQpkaWZmZXJlbnQgYmVzdCBudW1iZXIgb2YgdGhyZXNob2xkIHZhbHVlLg0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRSwgbWF4LmhlaWdodD0nMTUwcHgnfQ0KDQp0b3BfdGhyZXNob2xkIDwtIHR1bmU6OnNob3dfYmVzdCh0dW5lX3JlcywgbWV0cmljID0gInJtc2UiLCBuID0gNSkNCnRvcF90aHJlc2hvbGQNCg0KYmVzdF90aHJlc2hvbGQgPC0gdHVuZTo6c2VsZWN0X2Jlc3QodHVuZV9yZXMsIG1ldHJpYyA9ICJybXNlIikNCmJlc3RfdGhyZXNob2xkDQoNCmBgYA0KDQojIyBQcmluY2lwYWwgY29tcG9uZW50IHJlZ3Jlc3Npb24gbW9kZWwgd2l0aCBvcHRpbWlzZWQgdGhyZXNob2xkIHZhbHVlDQoNCldlIGNyZWF0ZSB0aGUgcHJpbmNpcGFsIGNvbXBvbmVudCByZWdyZXNzaW9uIHdvcmtmbG93IHdpdGggdGhlIGJlc3QNCnRocmVzaG9sZCB1c2luZw0KW2B0dW5lOjpmaW5hbGl6ZV93b3JrZmxvd2BdKGh0dHBzOi8vdHVuZS50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2UvZmluYWxpemVfbW9kZWwuaHRtbCkuDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFLCBtYXguaGVpZ2h0PScxNTBweCd9DQoNCnBjYV9maW5hbCA8LSB0dW5lOjpmaW5hbGl6ZV93b3JrZmxvdyh4ID0gcGNhX3dvcmtmbG93LCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbWV0ZXJzID0gYmVzdF90aHJlc2hvbGQpDQoNCnBjYV9maW5hbA0KYGBgDQoNCldlIG5vdyB0cmFpbiB0aGUgcHJpbmNpcGFsIGNvbXBvbmVudCByZWdyZXNzaW9uIG1vZGVsIHdpdGggdGhlIHRyYWluaW5nDQpkYXRhIHVzaW5nDQpbYHBhcnNuaXA6OmZpdGBdKGh0dHBzOi8vcGFyc25pcC50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2UvZml0Lmh0bWwpDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KDQpwY2FfZmluYWxfZml0IDwtIHBhcnNuaXA6OmZpdChvYmplY3QgPSBwY2FfZmluYWwsIGRhdGEgPSBIaXR0ZXJzX3RyYWluKQ0KYGBgDQoNCldlIGNhbiBzZWUgdGhlIGNvZWZmaWNpZW50cyB1c2luZw0KW2B0dW5lOjpleHRyYWN0X2ZpdF9wYXJzbmlwYF0oaHR0cHM6Ly90dW5lLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9leHRyYWN0LXR1bmUuaHRtbCkgYW5kIFtgcGFyc25pcDo6dGlkeWBdKGh0dHBzOi8vcGFyc25pcC50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2UvdGlkeS5tb2RlbF9maXQuaHRtbCkNCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQpwY2FfZmluYWxfZml0ICAlPiUNCiAgdHVuZTo6ZXh0cmFjdF9maXRfcGFyc25pcCgpICU+JQ0KICBwYXJzbmlwOjp0aWR5KCkgJT4lDQogIHJlYWN0YWJsZTo6cmVhY3RhYmxlKGRlZmF1bHRQYWdlU2l6ZSA9IDUpDQpgYGANCg0KIyMgUHJpbmNpcGFsIGNvbXBvbmVudCByZWdyZXNzaW9uIG1vZGVsIG9uIHRlc3QgZGF0YQ0KDQpUaGlzIHByaW5jaXBhbCBjb21wb25lbnQgcmVncmVzc2lvbiBtb2RlbCBjYW4gbm93IGJlIGFwcGxpZWQgb24gb3VyDQp0ZXN0aW5nIGRhdGEgc2V0IHRvIHZhbGlkYXRlIGl0cyBwZXJmb3JtYW5jZS4gRm9yIHJlZ3Jlc3Npb24gbW9kZWxzLCBhDQpgLnByZWRgIGNvbHVtbiBpcyBhZGRlZCB3aGVuDQpbYHBhcnNuaXA6OmF1Z21lbnRgXShodHRwczovL3BhcnNuaXAudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL2F1Z21lbnQuaHRtbCkNCmlzIHVzZWQuDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KDQp0ZXN0X3Jlc3VsdHMgPC0gcGFyc25pcDo6YXVnbWVudCh4ID0gcGNhX2ZpbmFsX2ZpdCwgbmV3X2RhdGEgPSBIaXR0ZXJzX3Rlc3QpDQogIA0KdGVzdF9yZXN1bHRzICU+JQ0KICByZWFjdGFibGU6OnJlYWN0YWJsZShkZWZhdWx0UGFnZVNpemUgPSA1KQ0KICANCmBgYA0KDQpXZSBjaGVjayBob3cgd2VsbCB0aGUgYC5wcmVkYCBjb2x1bW4gbWF0Y2hlcyB0aGUgU2FsYXJ5IHVzaW5nDQpbYHlhcmRzdGljazo6cnNxYF0oaHR0cHM6Ly95YXJkc3RpY2sudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL3JzcS5odG1sKS4NCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQp0ZXN0X3Jlc3VsdHMgJT4lDQogIHlhcmRzdGljazo6cnNxKHRydXRoID0gLmRhdGFbWyJTYWxhcnkiXV0sIGVzdGltYXRlID0gLmRhdGFbWyIucHJlZCJdXSkgJT4lDQogIHJlYWN0YWJsZTo6cmVhY3RhYmxlKGRlZmF1bHRQYWdlU2l6ZSA9IDUpDQpgYGANCg0KQWx0ZXJuYXRpdmVseSwgd2UgY2FuIHVzZQ0KW2B0dW5lOjpsYXN0X2ZpdGBdKGh0dHBzOi8vdHVuZS50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2UvbGFzdF9maXQuaHRtbCkNCmFuZA0KW2B0dW5lOjpjb2xsZWN0X21ldHJpY3NgXShodHRwczovL3R1bmUudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL2NvbGxlY3RfcHJlZGljdGlvbnMuaHRtbCkuDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KDQp0ZXN0X3JzIDwtIHR1bmU6Omxhc3RfZml0KG9iamVjdCA9IHBjYV9maW5hbF9maXQsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICBzcGxpdCA9IEhpdHRlcnNfc3BsaXQpDQogIA0KdGVzdF9ycyAlPiUNCiAgdHVuZTo6Y29sbGVjdF9tZXRyaWNzKCkgJT4lDQogIHJlYWN0YWJsZTo6cmVhY3RhYmxlKGRlZmF1bHRQYWdlU2l6ZSA9IDUpDQogIA0KYGBgDQoNClVzZSBbYHR1bmU6OmNvbGxlY3RfcHJlZGljdGlvbnNgXShodHRwczovL3R1bmUudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL2NvbGxlY3RfcHJlZGljdGlvbnMuaHRtbCksIHRvIHNlZSBvbmx5IHRoZSBhY3R1YWwgYW5kIHByZWRpY3RlZCB2YWx1ZXMgb2YgdGhlIHRlc3QgZGF0YS4NCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQp0ZXN0X3JzICU+JQ0KICB0dW5lOjpjb2xsZWN0X3ByZWRpY3Rpb25zKCkgJT4lDQogIHJlYWN0YWJsZTo6cmVhY3RhYmxlKGRlZmF1bHRQYWdlU2l6ZSA9IDUpDQpgYGANCg0KTGV0IHVzIHRha2UgYSBjbG9zZXIgbG9vayBhdCB0aGUgcHJlZGljdGVkIGFuZCBhY3R1YWwgcmVzcG9uc2UgYXMgYSBzY2F0dGVyIHBsb3QuDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KdGVzdF9ycyAlPiUNCiAgdHVuZTo6Y29sbGVjdF9wcmVkaWN0aW9ucygpICU+JQ0KICBnZ3Bsb3QyOjpnZ3Bsb3QobWFwcGluZyA9IGdncGxvdDI6OmFlcyh4ID0gLmRhdGFbWyJTYWxhcnkiXV0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHkgPSAuZGF0YVtbIi5wcmVkIl1dDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkNCiAgICAgICAgICAgICAgICAgICkgKw0KICBnZ3Bsb3QyOjpnZW9tX2FibGluZShzbG9wZSA9IDEsIGx0eSA9IDIsIGNvbG9yID0gImdyYXk1MCIsIGFscGhhID0gMC41KSArDQogIGdncGxvdDI6Omdlb21fcG9pbnQoYWxwaGEgPSAwLjYsIGNvbG9yID0gIm1pZG5pZ2h0Ymx1ZSIpICsNCiAgZ2dwbG90Mjo6Y29vcmRfZml4ZWQoKQ0KYGBgDQoNCiMgUGFydGlhbCBMZWFzdCBTcXVhcmUNCg0KVGhlIHBhcnRpYWwgbGVhc3Qgc3F1YXJlIHJlZ3Jlc3Npb24gaXMgYSBsaW5lYXIgbW9kZWwgd2l0aCBwbHMNCnRyYW5zZm9ybWVkIGRhdGEuIEhlbmNlLCB0aGUgbWFqb3IgY2hhbmdlcyB3aWxsIGJlIG9uIHRoZSBwcmVwcm9jZXNzaW5nDQpzdGVwcy4NCg0KIyMgQ3JlYXRlIHRoZSByZXNhbXBsZSBvYmplY3QNCg0KRmlyc3QsIHdlIHNwbGl0IHRoZSBzYW1wbGVzIGludG8gYSB0cmFpbmluZyBzZXQgYW5kIGEgdGVzdCBzZXQuIEZyb20gdGhlIHRyYWluaW5nIHNldCwgd2UgY3JlYXRlIGEgMTAtZm9sZCBjcm9zcy12YWxpZGF0aW9uIGRhdGEgc2V0IGZyb20gdGhlIHRyYWluaW5nIHNldC4NCg0KVGhpcyBpcyBkb25lIHdpdGggW2Byc2FtcGxlOjppbml0aWFsX3NwbGl0YF0oaHR0cHM6Ly9yc2FtcGxlLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9pbml0aWFsX3NwbGl0Lmh0bWwpLA0KW2Byc2FtcGxlOjp0cmFpbmluZ2BdKGh0dHBzOi8vcnNhbXBsZS50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2UvaW5pdGlhbF9zcGxpdC5odG1sKSwNCltgcnNhbXBsZTo6dGVzdGluZ2BdKGh0dHBzOi8vcnNhbXBsZS50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2UvaW5pdGlhbF9zcGxpdC5odG1sKQ0KYW5kDQpbYHJzYW1wbGU6OnZmb2xkX2N2YF0oaHR0cHM6Ly9yc2FtcGxlLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS92Zm9sZF9jdi5odG1sKS4NCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQpzZXQuc2VlZCgxMjM0KQ0KSGl0dGVycyA8LSBkcGx5cjo6YXNfdGliYmxlKElTTFIyOjpIaXR0ZXJzKSAlPiUNCiAgdGlkeXI6OmRyb3BfbmEoKQ0KDQpIaXR0ZXJzX3NwbGl0IDwtIHJzYW1wbGU6OmluaXRpYWxfc3BsaXQoSGl0dGVycywgc3RyYXRhID0gIlNhbGFyeSIpDQoNCkhpdHRlcnNfdHJhaW4gPC0gcnNhbXBsZTo6dHJhaW5pbmcoSGl0dGVyc19zcGxpdCkNCkhpdHRlcnNfdGVzdCA8LSByc2FtcGxlOjp0ZXN0aW5nKEhpdHRlcnNfc3BsaXQpDQoNCkhpdHRlcnNfZm9sZCA8LSByc2FtcGxlOjp2Zm9sZF9jdihIaXR0ZXJzX3RyYWluLCB2ID0gMTApDQoNCmBgYA0KDQojIyBDcmVhdGUgdGhlIHByZXByb2Nlc3Nvcg0KDQpXZSBjcmVhdGUgYSByZWNpcGUgd2l0aA0KW2ByZWNpcGVzOjpyZWNpcGVgXShodHRwczovL3JlY2lwZXMudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL3JlY2lwZS5odG1sKSwNCltgcmVjaXBlczo6YWxsX25vbWluYWxfcHJlZGljdG9yc2BdKGh0dHBzOi8vcmVjaXBlcy50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2UvaGFzX3JvbGUuaHRtbCksDQpbYHJlY2lwZXM6OmFsbF9wcmVkaWN0b3JzKClgXShodHRwczovL3JlY2lwZXMudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL2hhc19yb2xlLmh0bWwpLA0KW2ByZWNpcGVzOjpzdGVwX25vdmVsYF0oaHR0cHM6Ly9yZWNpcGVzLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9zdGVwX25vdmVsLmh0bWwpLA0KW2ByZWNpcGVzOjpzdGVwX2R1bW15YF0oaHR0cHM6Ly9yZWNpcGVzLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9zdGVwX2R1bW15Lmh0bWwpLA0KW2ByZWNpcGVzOjpzdGVwX3p2YF0oaHR0cHM6Ly9yZWNpcGVzLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9zdGVwX3p2Lmh0bWwpDQphbmQNCltgcmVjaXBlczo6c3RlcF9ub3JtYWxpemVgXShodHRwczovL3JlY2lwZXMudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL3N0ZXBfbm9ybWFsaXplLmh0bWwpLg0KDQpXZSBhZGQNCltgcmVjaXBlczo6c3RlcF9wbHNgXShodHRwczovL3JlY2lwZXMudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL3N0ZXBfcGxzLmh0bWwpDQp0aGlzIHRpbWUgdG8gcGVyZm9ybSBwYXJ0aWFsIGxlYXN0IHNxdWFyZSBjYWxjdWxhdGlvbiBvbiBhbGwgdGhlDQpwcmVkaWN0b3JzLiBgbnVtX2NvbXBgIGlzIHRoZSBudW1iZXIgb2YgcGFydGlhbCBsZWFzdCBzcXVhcmUgY29tcG9uZW50cw0KdG8gcmV0YWluIGFzIG5ldyBwcmVkaWN0b3JzLiBgb3V0Y29tZWAgaXMgdGhlIHJlc3BvbnNlIHZhcmlhYmxlIGZvcg0KcGFydGlhbCBsZWFzdCBzcXVhcmUgcmVncmVzc2lvbiB0byB1c2UuDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KDQpwbHNfcmVjaXBlIDwtIA0KICByZWNpcGVzOjpyZWNpcGUoZm9ybXVsYSA9IFNhbGFyeSB+IC4sIGRhdGEgPSBIaXR0ZXJzX3RyYWluKSAlPiUgDQogIHJlY2lwZXM6OnN0ZXBfbm92ZWwocmVjaXBlczo6YWxsX25vbWluYWxfcHJlZGljdG9ycygpKSAlPiUgDQogIHJlY2lwZXM6OnN0ZXBfZHVtbXkocmVjaXBlczo6YWxsX25vbWluYWxfcHJlZGljdG9ycygpKSAlPiUgDQogIHJlY2lwZXM6OnN0ZXBfenYocmVjaXBlczo6YWxsX3ByZWRpY3RvcnMoKSkgJT4lIA0KICByZWNpcGVzOjpzdGVwX25vcm1hbGl6ZShyZWNpcGVzOjphbGxfcHJlZGljdG9ycygpKSAlPiUNCiAgcmVjaXBlczo6c3RlcF9wbHMocmVjaXBlczo6YWxsX3ByZWRpY3RvcnMoKSwgbnVtX2NvbXAgPSAxOSAsb3V0Y29tZSA9ICJTYWxhcnkiKQ0KYGBgDQoNCkFwcGx5DQpbYHJlY2lwZXM6OnByZXBgXShodHRwczovL3JlY2lwZXMudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL3ByZXAuaHRtbCkNCmFuZA0KW2ByZWNpcGVzOjpiYWtlYF0oaHR0cHM6Ly9yZWNpcGVzLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9iYWtlLmh0bWwpIHRvDQpjb21wdXRlIHRoZSBwcmVwcm9jZXNzaW5nIHN0ZXAuDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KDQpyZWMgPC0gcmVjaXBlczo6cHJlcCh4ID0gcGxzX3JlY2lwZSwgdHJhaW5pbmcgPSBIaXR0ZXJzX3RyYWluKQ0KICANCnJlYyAlPiUNCiAgc3VtbWFyeSgpICU+JQ0KICByZWFjdGFibGU6OnJlYWN0YWJsZShkZWZhdWx0UGFnZVNpemUgPSA1KQ0KDQpyZWMgJT4lDQogIHJlY2lwZXM6OmJha2UobmV3X2RhdGEgPSBIaXR0ZXJzX3RyYWluKSAlPiUNCiAgcmVhY3RhYmxlOjpyZWFjdGFibGUoZGVmYXVsdFBhZ2VTaXplID0gNSkNCg0KYGBgDQoNCiMjIFBMUyBleHBsb3JhdGlvbg0KDQpXZSBjYW4gZXhwbG9yZSB0aGUgcmVzdWx0cyBvZiB0aGUgUENBIHVzaW5nIHRoZSBbYHJlY2lwZXM6OnByZXBgXShodHRwczovL3JlY2lwZXMudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL3ByZXAuaHRtbCkgYW5kDQpbYHBhcnNuaXA6OnRpZHlgXShodHRwczovL3BhcnNuaXAudGlkeW1vZGVscy5vcmcvcmVmZXJlbmNlL3RpZHkubW9kZWxfZml0Lmh0bWwpLiBXZSBjYW4gc2VlIHRoYXQgcGNhIGlzIGRvbmUgYXQgc3RlcCBudW1iZXIgNQ0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCg0KcmVjaXBlczo6cHJlcCh4ID0gcGxzX3JlY2lwZSwgdHJhaW5pbmcgPSBIaXR0ZXJzX3RyYWluKSAlPiUNCiAgcGFyc25pcDo6dGlkeSgpICU+JQ0KICByZWFjdGFibGU6OnJlYWN0YWJsZShkZWZhdWx0UGFnZVNpemUgPSA1KQ0KYGBgDQoNCkFzIHN1Y2gsIHdlIGV4dHJhY3QgdGhlIHJlc3VsdHMgb2Ygc3RlcCBudW1iZXIgNSBvciB0aGUgcGNhIHN0ZXAuDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KDQp0aWRpZWRfcGxzIDwtIHJlY2lwZXM6OnByZXAoeCA9IHBsc19yZWNpcGUsIHRyYWluaW5nID0gSGl0dGVyc190cmFpbikgJT4lDQogIHBhcnNuaXA6OnRpZHkoNSkNCg0KDQp0aWRpZWRfcGxzICU+JQ0KICByZWFjdGFibGU6OnJlYWN0YWJsZShkZWZhdWx0UGFnZVNpemUgPSA1KQ0KDQpgYGANCg0KV2UgbWFrZSBhIHZpc3VhbGl6YXRpb24gdG8gc2VlIHdoYXQgdGhlIGZpcnN0IGZvdXIgY29tcG9uZW50cyBsb29rIGxpa2UNCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0UsIGZpZy5oZWlnaHQgPSA4fQ0KDQp0aWRpZWRfcGxzICU+JQ0KICBkcGx5cjo6ZmlsdGVyKC5kYXRhW1siY29tcG9uZW50Il1dICVpbiUgYygiUExTMSIsICJQTFMyIiwgIlBMUzMiLCAiUExTNCIpKSAlPiUNCiAgZHBseXI6Om11dGF0ZShjb21wb25lbnQgPSBmb3JjYXRzOjpmY3RfaW5vcmRlciguZGF0YVtbImNvbXBvbmVudCJdXSkpICU+JQ0KICBnZ3Bsb3QyOjpnZ3Bsb3QobWFwcGluZyA9IGdncGxvdDI6OmFlcyh4ID0gLmRhdGFbWyJ2YWx1ZSJdXSwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHkgPSAuZGF0YVtbInRlcm1zIl1dLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsbCA9IC5kYXRhW1sidGVybXMiXV0pKSArDQogIGdncGxvdDI6Omdlb21fY29sKHNob3cubGVnZW5kID0gRkFMU0UpICsNCiAgZ2dwbG90Mjo6ZmFjZXRfd3JhcChmYWNldHMgPSBnZ3Bsb3QyOjp2YXJzKC5kYXRhW1siY29tcG9uZW50Il1dKSkgKw0KICBnZ3Bsb3QyOjpsYWJzKHkgPSBOVUxMKQ0KDQpgYGANCg0KTGV0IHVzIHRha2UgYSBjbG9zZXIgbG9vayBhdCB0aGUgdG9wIDYgdmFyaWFibGVzIHRoYXQgY29udHJpYnV0ZSB0byB0aGUNCmZpcnN0IGZvdXIgY29tcG9uZW50cw0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCg0KdGlkaWVkX3BscyAlPiUNCiAgZHBseXI6OmZpbHRlciguZGF0YVtbImNvbXBvbmVudCJdXSAlaW4lIGMoIlBMUzEiLCAiUExTMiIsICJQTFMzIiwgIlBMUzQiKSkgJT4lDQogIGRwbHlyOjpncm91cF9ieSguZGF0YVtbImNvbXBvbmVudCJdXSkgJT4lDQogIGRwbHlyOjp0b3Bfbig2LCBhYnMoLmRhdGFbWyJ2YWx1ZSJdXSkpICU+JQ0KICBkcGx5cjo6dW5ncm91cCgpICU+JQ0KICBkcGx5cjo6bXV0YXRlKA0KICAgIHRlcm1zID0gdGlkeXRleHQ6OnJlb3JkZXJfd2l0aGluKHggPSAuZGF0YVtbInRlcm1zIl1dLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBieSA9IGFicyguZGF0YVtbInZhbHVlIl1dKSwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2l0aGluID0gLmRhdGFbWyJjb21wb25lbnQiXV0pDQogICAgKSAlPiUNCiAgZ2dwbG90Mjo6Z2dwbG90KG1hcHBpbmcgPSBnZ3Bsb3QyOjphZXMoeCA9IGFicyguZGF0YVtbInZhbHVlIl1dKSwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHkgPSAuZGF0YVtbInRlcm1zIl1dLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsbCA9IC5kYXRhW1sidmFsdWUiXV0gPiAwKQ0KICAgICAgICAgICAgICAgICAgKSArDQogIGdncGxvdDI6Omdlb21fY29sKCkgKw0KICBnZ3Bsb3QyOjpmYWNldF93cmFwKGZhY2V0cyA9IGdncGxvdDI6OnZhcnMoLmRhdGFbWyJjb21wb25lbnQiXV0pLCANCiAgICAgICAgICAgICAgICAgICAgICBzY2FsZXMgPSAiZnJlZV95IikgKw0KICB0aWR5dGV4dDo6c2NhbGVfeV9yZW9yZGVyZWQoKSArDQogIGdncGxvdDI6OmxhYnMoDQogICAgeCA9ICJBYnNvbHV0ZSB2YWx1ZSBvZiBjb250cmlidXRpb24gdG8gUExTIGNvbXBvbmVudCIsDQogICAgeSA9IE5VTEwsIA0KICAgIGZpbGwgPSAiUG9zaXRpdmU/Ig0KICApDQoNCmBgYA0KDQpgbnVtX2NvbXBgIGlzIHRoZSBudW1iZXIgb2YgcGFydGlhbCBsZWFzdCBzcXVhcmUgY29tcG9uZW50cyB0byByZXRhaW4gYXMNCm5ldyBwcmVkaWN0b3JzLiBXZSB3aWxsIG5vdyB0cnkgdG8gZmluZCB0aGUgYmVzdCBudW1iZXIgb2YgY29tcG9uZW50DQp2YWx1ZSB1c2luZyB0aGUNCltgdHVuZTo6dHVuZSgpYF0oaHR0cHM6Ly9oYXJkaGF0LnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS90dW5lLmh0bWwpDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KDQpwbHNfcmVjaXBlIDwtIA0KICByZWNpcGVzOjpyZWNpcGUoZm9ybXVsYSA9IFNhbGFyeSB+IC4sIGRhdGEgPSBIaXR0ZXJzX3RyYWluKSAlPiUgDQogIHJlY2lwZXM6OnN0ZXBfbm92ZWwocmVjaXBlczo6YWxsX25vbWluYWxfcHJlZGljdG9ycygpKSAlPiUgDQogIHJlY2lwZXM6OnN0ZXBfZHVtbXkocmVjaXBlczo6YWxsX25vbWluYWxfcHJlZGljdG9ycygpKSAlPiUgDQogIHJlY2lwZXM6OnN0ZXBfenYocmVjaXBlczo6YWxsX3ByZWRpY3RvcnMoKSkgJT4lIA0KICByZWNpcGVzOjpzdGVwX25vcm1hbGl6ZShyZWNpcGVzOjphbGxfcHJlZGljdG9ycygpKSAlPiUNCiAgcmVjaXBlczo6c3RlcF9wbHMocmVjaXBlczo6YWxsX3ByZWRpY3RvcnMoKSwgbnVtX2NvbXAgPSB0dW5lOjp0dW5lKCkgLCBvdXRjb21lID0gIlNhbGFyeSIpDQpgYGANCg0KIyMgU3BlY2lmeSB0aGUgbW9kZWwNCg0KV2UgdXNlIGEgbGluZWFyIG1vZGVsDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KDQpsbV9zcGVjIDwtIA0KICBwYXJzbmlwOjpsaW5lYXJfcmVnKCkgJT4lIA0KICBwYXJzbmlwOjpzZXRfbW9kZSgicmVncmVzc2lvbiIpICU+JSANCiAgcGFyc25pcDo6c2V0X2VuZ2luZSgibG0iKQ0KDQpsbV9zcGVjICU+JQ0KICBwYXJzbmlwOjp0cmFuc2xhdGUoKQ0KDQpgYGANCg0KIyMgQ3JlYXRlIHRoZSB3b3JrZmxvdw0KDQpbYHdvcmtmbG93czo6d29ya2Zsb3dgXShodHRwczovL3dvcmtmbG93cy50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2Uvd29ya2Zsb3cuaHRtbCksDQpbYHdvcmtmbG93czo6YWRkX3JlY2lwZWBdKGh0dHBzOi8vd29ya2Zsb3dzLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9hZGRfcmVjaXBlLmh0bWwpDQphbmQNCltgd29ya2Zsb3dzOjphZGRfbW9kZWxgXShodHRwczovL3dvcmtmbG93cy50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2UvYWRkX21vZGVsLmh0bWwpDQphcmUgdXNlZC4NCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0UsIG1heC5oZWlnaHQ9JzE1MHB4J30NCg0KcGxzX3dvcmtmbG93IDwtICB3b3JrZmxvd3M6OndvcmtmbG93KCkgJT4lIA0KICB3b3JrZmxvd3M6OmFkZF9yZWNpcGUocGxzX3JlY2lwZSkgJT4lIA0KICB3b3JrZmxvd3M6OmFkZF9tb2RlbChsbV9zcGVjKQ0KDQpwbHNfd29ya2Zsb3cNCmBgYA0KDQojIyBDcmVhdGUgdGhlIG51bWJlciBvZiBjb21wb25lbnRzIGdyaWQNCg0KQSBudW1iZXIgb2YgY29tcG9uZW50cyBncmlkIG9mICQxMCQgbnVtYmVycyBmcm9tICQxJCB0byAkMjAkIGlzIGNyZWF0ZWQuDQoNCk51bWJlciBvZiBjb21wb25lbnRzIGdyaWQgaXMgY3JlYXRlZCB1c2luZw0KW2BkaWFsczo6Z3JpZF9yZWd1bGFyYF0oaHR0cHM6Ly9kaWFscy50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2UvZ3JpZF9yZWd1bGFyLmh0bWwpDQphbmQNCltgZGlhbHM6Om51bV9jb21wYF0oaHR0cHM6Ly9kaWFscy50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2UvbnVtX2NvbXAuaHRtbCkNCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQpudW1fY29tcF9ncmlkICA8LSBkaWFsczo6Z3JpZF9yZWd1bGFyKHggPSBkaWFsczo6bnVtX2NvbXAocmFuZ2UgPSBjKDEsIDIwKSksIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXZlbHMgPSAxMCkNCg0KbnVtX2NvbXBfZ3JpZCAlPiUgDQogIHJlYWN0YWJsZTo6cmVhY3RhYmxlKGRlZmF1bHRQYWdlU2l6ZSA9IDUpDQpgYGANCg0KIyMgUGFydGlhbCBsZWFzdCBzcXVhcmUgcmVncmVzc2lvbiBtb2RlbCBmaXR0aW5nIG9uIGNyb3NzIHZhbGlkYXRlZCBkYXRhDQoNCk5vdyB3ZSBoYXZlIGV2ZXJ5dGhpbmcgd2UgbmVlZCBhbmQgd2UgY2FuIGZpdCBhbGwgdGhlIG1vZGVscyBvbiB0aGUNCmNyb3NzIHZhbGlkYXRlZCBkYXRhIHdpdGgNCltgdHVuZTo6dHVuZV9ncmlkYF0oaHR0cHM6Ly90dW5lLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS90dW5lX2dyaWQuaHRtbCkuDQpOb3RlIHRoYXQgdGhpcyBwcm9jZXNzIG1heSB0YWtlIHNvbWUgdGltZS4NCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQpkb1BhcmFsbGVsOjpyZWdpc3RlckRvUGFyYWxsZWwoKQ0KZm9yZWFjaDo6Z2V0RG9QYXJXb3JrZXJzKCkNCmBgYA0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRSwgbWF4LmhlaWdodD0nMTUwcHgnfQ0KdHVuZV9yZXMgPC0gdHVuZTo6dHVuZV9ncmlkKA0KICBvYmplY3QgPSBwbHNfd29ya2Zsb3csDQogIHJlc2FtcGxlcyA9IEhpdHRlcnNfZm9sZCwgDQogIGdyaWQgPSBudW1fY29tcF9ncmlkDQopDQoNCnR1bmVfcmVzDQpgYGANCg0KSGVyZSB3ZSBzZWUgdGhhdCB0aGUgYW1vdW50IG9mIHJlZ3VsYXJpemF0aW9uIGFmZmVjdHMgdGhlIHBlcmZvcm1hbmNlDQptZXRyaWNzIGRpZmZlcmVudGx5IHVzaW5nDQpbYHR1bmU6OmF1dG9wbG90YF0oaHR0cHM6Ly90dW5lLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9hdXRvcGxvdC50dW5lX3Jlc3VsdHMuaHRtbCkuDQpEbyBub3RlIHRoYXQgdXNpbmcgYSBkaWZmZXJlbnQgc2VlZCB3aWxsIGdpdmUgYSBkaWZmZXJlbnQgcGxvdA0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCiMgTm90ZSB0aGF0IGEgZGlmZmVyZW50IHNlZWQgd2lsbCBnaXZlIGRpZmZlcmVudCBwbG90cw0KdHVuZTo6YXV0b3Bsb3QodHVuZV9yZXMpDQpgYGANCg0KV2UgY2FuIGFsc28gc2VlIHRoZSByYXcgbWV0cmljcyB0aGF0IGNyZWF0ZWQgdGhpcyBjaGFydCBieSBjYWxsaW5nDQpbYHR1bmU6OmNvbGxlY3RfbWV0cmljcygpYF0oaHR0cHM6Ly90dW5lLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9jb2xsZWN0X3ByZWRpY3Rpb25zLmh0bWwpLg0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRSwgbWF4LmhlaWdodD0nMTUwcHgnfQ0KDQp0dW5lOjpjb2xsZWN0X21ldHJpY3ModHVuZV9yZXMpICU+JSANCiAgcmVhY3RhYmxlOjpyZWFjdGFibGUoZGVmYXVsdFBhZ2VTaXplID0gNSkNCmBgYA0KDQpIZXJlIGlzIHRoZSBgZ2dwbG90YCB3YXkgc2hvdWxkDQpbYHR1bmU6OmF1dG9wbG90YF0oaHR0cHM6Ly90dW5lLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9hdXRvcGxvdC50dW5lX3Jlc3VsdHMuaHRtbCkNCmZhaWxzDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFLCBtYXguaGVpZ2h0PScxNTBweCd9DQoNCnR1bmVfcmVzICU+JQ0KICB0dW5lOjpjb2xsZWN0X21ldHJpY3MoKSAlPiUNCiAgZ2dwbG90Mjo6Z2dwbG90KG1hcHBpbmcgPSBnZ3Bsb3QyOjphZXMoeCA9IC5kYXRhW1sibnVtX2NvbXAiXV0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHkgPSAuZGF0YVtbIm1lYW4iXV0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG91ciA9IC5kYXRhW1siLm1ldHJpYyJdXSkpICsNCiAgZ2dwbG90Mjo6Z2VvbV9lcnJvcmJhcihtYXBwaW5nID0gZ2dwbG90Mjo6YWVzKHltaW4gPSAuZGF0YVtbIm1lYW4iXV0gLSAuZGF0YVtbInN0ZF9lcnIiXV0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5bWF4ID0gLmRhdGFbWyJtZWFuIl1dICsgLmRhdGFbWyJzdGRfZXJyIl1dKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICBhbHBoYSA9IDAuNSkgKw0KICBnZ3Bsb3QyOjpnZW9tX2xpbmUoc2l6ZSA9IDEuNSkgKw0KICBnZ3Bsb3QyOjpmYWNldF93cmFwKGZhY2V0cyA9IGdncGxvdDI6OnZhcnMoLmRhdGFbWyIubWV0cmljIl1dKSwgDQogICAgICAgICAgICAgICAgICAgICAgc2NhbGVzID0gImZyZWUiLCANCiAgICAgICAgICAgICAgICAgICAgICBucm93ID0gMikgKw0KICBnZ3Bsb3QyOjp0aGVtZShsZWdlbmQucG9zaXRpb24gPSAibm9uZSIpDQpgYGANCg0KVXNlDQpbYHR1bmU6OnNob3dfYmVzdGBdKGh0dHBzOi8vdHVuZS50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2Uvc2hvd19iZXN0Lmh0bWwpDQp0byBzZWUgdGhlIHRvcCBmZXcgdmFsdWVzIGZvciBhIGdpdmVuIG1ldHJpYy4NCg0KVGhlICJiZXN0IiB2YWx1ZXMgY2FuIGJlIHNlbGVjdGVkIHVzaW5nDQpbYHR1bmU6OnNlbGVjdF9iZXN0YF0oaHR0cHM6Ly90dW5lLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9zaG93X2Jlc3QuaHRtbCksDQp0aGlzIGZ1bmN0aW9uIHJlcXVpcmVzIHlvdSB0byBzcGVjaWZ5IGEgbWV0cmljIHRoYXQgaXQgc2hvdWxkIHNlbGVjdA0KYWdhaW5zdC4gVGhlIG51bWJlciBvZiBjb21wb25lbnRzIHZhbHVlIGlzIDEgZm9yIG1ldHJpYyBgcnNtZWAgc2luY2UgaXQNCmdpdmVzIHRoZSBsb3dlc3QgdmFsdWUuIERvIG5vdGUgdGhhdCB1c2luZyBhIGRpZmZlcmVudCBzZWVkIHdpbGwgZ2l2ZSBhDQpkaWZmZXJlbnQgYmVzdCBudW1iZXIgb2YgY29tcG9uZW50cyB2YWx1ZS4NCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0UsIG1heC5oZWlnaHQ9JzE1MHB4J30NCg0KdG9wX251bV9jb21wIDwtIHR1bmU6OnNob3dfYmVzdCh0dW5lX3JlcywgbWV0cmljID0gInJtc2UiLCBuID0gNSkNCnRvcF9udW1fY29tcA0KDQpiZXN0X251bV9jb21wIDwtIHR1bmU6OnNlbGVjdF9iZXN0KHR1bmVfcmVzLCBtZXRyaWMgPSAicm1zZSIpDQpiZXN0X251bV9jb21wDQoNCmBgYA0KDQojIyBQYXJ0aWFsIGxlYXN0IHNxdWFyZSBtb2RlbCB3aXRoIG9wdGltaXNlZCB0aHJlc2hvbGQgdmFsdWUNCg0KV2UgY3JlYXRlIHRoZSBwYXJ0aWFsIGxlYXN0IHNxdWFyZSByZWdyZXNzaW9uIHdvcmtmbG93IHdpdGggdGhlIGJlc3QNCnRocmVzaG9sZCB1c2luZw0KW2B0dW5lOjpmaW5hbGl6ZV93b3JrZmxvd2BdKGh0dHBzOi8vdHVuZS50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2UvZmluYWxpemVfbW9kZWwuaHRtbCkuDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFLCBtYXguaGVpZ2h0PScxNTBweCd9DQoNCnBsc19maW5hbCA8LSB0dW5lOjpmaW5hbGl6ZV93b3JrZmxvdyh4ID0gcGxzX3dvcmtmbG93LCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbWV0ZXJzID0gYmVzdF9udW1fY29tcCkNCg0KcGxzX2ZpbmFsDQpgYGANCg0KV2Ugbm93IHRyYWluIHRoZSBwYXJ0aWFsIGxlYXN0IHNxdWFyZSByZWdyZXNzaW9uIG1vZGVsIHdpdGggdGhlIHRyYWluaW5nDQpkYXRhIHVzaW5nDQpbYHBhcnNuaXA6OmZpdGBdKGh0dHBzOi8vcGFyc25pcC50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2UvZml0Lmh0bWwpDQoNCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQ0KDQpwbHNfZmluYWxfZml0IDwtIHBhcnNuaXA6OmZpdChvYmplY3QgPSBwbHNfZmluYWwsIGRhdGEgPSBIaXR0ZXJzX3RyYWluKQ0KYGBgDQoNCldlIGNhbiBzZWUgdGhlIGNvZWZmaWNpZW50cyB1c2luZw0KW2B0dW5lOjpleHRyYWN0X2ZpdF9wYXJzbmlwYF0oaHR0cHM6Ly90dW5lLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9leHRyYWN0LXR1bmUuaHRtbCkgYW5kIFtgcGFyc25pcDo6dGlkeWBdKGh0dHBzOi8vcGFyc25pcC50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2UvdGlkeS5tb2RlbF9maXQuaHRtbCkNCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQpwbHNfZmluYWxfZml0ICAlPiUNCiAgdHVuZTo6ZXh0cmFjdF9maXRfcGFyc25pcCgpICU+JQ0KICBwYXJzbmlwOjp0aWR5KCkgJT4lDQogIHJlYWN0YWJsZTo6cmVhY3RhYmxlKGRlZmF1bHRQYWdlU2l6ZSA9IDUpDQpgYGANCg0KIyMgUGFydGlhbCBsZWFzdCBzcXVhcmUgcmVncmVzc2lvbiBtb2RlbCBvbiB0ZXN0IGRhdGENCg0KVGhpcyBwYXJ0aWFsIGxlYXN0IHNxdWFyZSByZWdyZXNzaW9uIG1vZGVsIGNhbiBub3cgYmUgYXBwbGllZCBvbiBvdXINCnRlc3RpbmcgZGF0YSBzZXQgdG8gdmFsaWRhdGUgaXRzIHBlcmZvcm1hbmNlLiBGb3IgcmVncmVzc2lvbiBtb2RlbHMsIGENCmAucHJlZGAgY29sdW1uIGlzIGFkZGVkIHdoZW4NCltgcGFyc25pcDo6YXVnbWVudGBdKGh0dHBzOi8vcGFyc25pcC50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2UvYXVnbWVudC5odG1sKQ0KaXMgdXNlZC4NCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQoNCnRlc3RfcmVzdWx0cyA8LSBwYXJzbmlwOjphdWdtZW50KHggPSBwbHNfZmluYWxfZml0LCBuZXdfZGF0YSA9IEhpdHRlcnNfdGVzdCkNCiAgDQp0ZXN0X3Jlc3VsdHMgJT4lDQogIHJlYWN0YWJsZTo6cmVhY3RhYmxlKGRlZmF1bHRQYWdlU2l6ZSA9IDUpDQogIA0KYGBgDQoNCldlIGNoZWNrIGhvdyB3ZWxsIHRoZSBgLnByZWRgIGNvbHVtbiBtYXRjaGVzIHRoZSBTYWxhcnkgdXNpbmcNCltgeWFyZHN0aWNrOjpyc3FgXShodHRwczovL3lhcmRzdGljay50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2UvcnNxLmh0bWwpLg0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCnRlc3RfcmVzdWx0cyAlPiUNCiAgeWFyZHN0aWNrOjpyc3EodHJ1dGggPSAuZGF0YVtbIlNhbGFyeSJdXSwgZXN0aW1hdGUgPSAuZGF0YVtbIi5wcmVkIl1dKSAlPiUNCiAgcmVhY3RhYmxlOjpyZWFjdGFibGUoZGVmYXVsdFBhZ2VTaXplID0gNSkNCmBgYA0KDQpBbHRlcm5hdGl2ZWx5LCB3ZSBjYW4gdXNlDQpbYHR1bmU6Omxhc3RfZml0YF0oaHR0cHM6Ly90dW5lLnRpZHltb2RlbHMub3JnL3JlZmVyZW5jZS9sYXN0X2ZpdC5odG1sKQ0KYW5kDQpbYHR1bmU6OmNvbGxlY3RfbWV0cmljc2BdKGh0dHBzOi8vdHVuZS50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2UvY29sbGVjdF9wcmVkaWN0aW9ucy5odG1sKS4NCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQoNCnRlc3RfcnMgPC0gdHVuZTo6bGFzdF9maXQob2JqZWN0ID0gcGxzX2ZpbmFsX2ZpdCwgDQogICAgICAgICAgICAgICAgICAgICAgICAgIHNwbGl0ID0gSGl0dGVyc19zcGxpdCkNCiAgDQp0ZXN0X3JzICU+JQ0KICB0dW5lOjpjb2xsZWN0X21ldHJpY3MoKSAlPiUNCiAgcmVhY3RhYmxlOjpyZWFjdGFibGUoZGVmYXVsdFBhZ2VTaXplID0gNSkNCiAgDQpgYGANCg0KVXNlIFtgdHVuZTo6Y29sbGVjdF9wcmVkaWN0aW9uc2BdKGh0dHBzOi8vdHVuZS50aWR5bW9kZWxzLm9yZy9yZWZlcmVuY2UvY29sbGVjdF9wcmVkaWN0aW9ucy5odG1sKSwgdG8gc2VlIG9ubHkgdGhlIGFjdHVhbCBhbmQgcHJlZGljdGVkIHZhbHVlcyBvZiB0aGUgdGVzdCBkYXRhLg0KDQpgYGB7ciwgbWVzc2FnZT1GQUxTRX0NCnRlc3RfcnMgJT4lDQogIHR1bmU6OmNvbGxlY3RfcHJlZGljdGlvbnMoKSAlPiUNCiAgcmVhY3RhYmxlOjpyZWFjdGFibGUoZGVmYXVsdFBhZ2VTaXplID0gNSkNCmBgYA0KDQpMZXQgdXMgdGFrZSBhIGNsb3NlciBsb29rIGF0IHRoZSBwcmVkaWN0ZWQgYW5kIGFjdHVhbCByZXNwb25zZSBhcyBhIHNjYXR0ZXIgcGxvdC4NCg0KYGBge3IsIG1lc3NhZ2U9RkFMU0V9DQp0ZXN0X3JzICU+JQ0KICB0dW5lOjpjb2xsZWN0X3ByZWRpY3Rpb25zKCkgJT4lDQogIGdncGxvdDI6OmdncGxvdChtYXBwaW5nID0gZ2dwbG90Mjo6YWVzKHggPSAuZGF0YVtbIlNhbGFyeSJdXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeSA9IC5kYXRhW1siLnByZWQiXV0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKQ0KICAgICAgICAgICAgICAgICAgKSArDQogIGdncGxvdDI6Omdlb21fYWJsaW5lKHNsb3BlID0gMSwgbHR5ID0gMiwgY29sb3IgPSAiZ3JheTUwIiwgYWxwaGEgPSAwLjUpICsNCiAgZ2dwbG90Mjo6Z2VvbV9wb2ludChhbHBoYSA9IDAuNiwgY29sb3IgPSAibWlkbmlnaHRibHVlIikgKw0KICBnZ3Bsb3QyOjpjb29yZF9maXhlZCgpDQpgYGANCg0KIyBSbWFya2Rvd24gVGVtcGxhdGUNCg0KVGhpcyBSbWFya2Rvd24gdGVtcGxhdGUgaXMgY3JlYXRlZCBieSB0aGUgW1JlYWxpdHkgQmVuZGluZw0KTGFiXShodHRwczovL3JlYWxpdHliZW5kaW5nLmdpdGh1Yi5pby8pLiBUaGUgdGVtcGxhdGUgY2FuIGJlIGRvd25sb2FkDQpmcm9tIHRoZSBsYWIncw0KW2dpdGh1Yl0oaHR0cHM6Ly9naXRodWIuY29tL1JlYWxpdHlCZW5kaW5nL1RlbXBsYXRlUmVzdWx0cykgcmVwb3NpdG9yeS4NCkZvciBtb3JlIGluZm9ybWF0aW9uIGFib3V0IHRoZSBtb3RpdmF0aW9uIGJlaGluZCBjcmVhdGluZyB0aGlzIHRlbXBsYXRlLA0KY2hlY2sgb3V0IFtEci4gRG9taW5pcXVlIE1ha293c2tpJ3MgYmxvZw0KcG9zdF0oaHR0cHM6Ly9kb21pbmlxdWVtYWtvd3NraS5naXRodWIuaW8vcG9zdC8yMDIxLTAyLTEwLXRlbXBsYXRlX3Jlc3VsdHMvKQ0KDQojIEJsb2cgUmVmZXJlbmNlcw0KDQotICAgRW1pbCBIdml0ZmVsZHQncyBbSVNMUiB0aWR5bW9kZWxzDQogICAgTGFic10oaHR0cHM6Ly9lbWlsaHZpdGZlbGR0LmdpdGh1Yi5pby9JU0xSLXRpZHltb2RlbHMtbGFicy9saW5lYXItbW9kZWwtc2VsZWN0aW9uLWFuZC1yZWd1bGFyaXphdGlvbi5odG1sKQ0KDQotICAgSnVsaWEgU2lsZ2Uncw0KICAgIFtibG9nXShodHRwczovL2p1bGlhc2lsZ2UuY29tL2Jsb2cvbGFzc28tdGhlLW9mZmljZS5odG1sKSB0aXRsZWQNCiAgICAiTEFTU08gcmVncmVzc2lvbiB1c2luZyB0aWR5bW9kZWxzIGFuZCAjVGlkeVR1ZXNkYXkgZGF0YSBmb3IgVGhlDQogICAgT2ZmaWNlIg0KDQotICAgSnVsaWEgU2lsZ2UncyBbYmxvZ10oaHR0cHM6Ly9qdWxpYXNpbGdlLmNvbS9ibG9nL2Jlc3QtaGlwLWhvcC5odG1sKQ0KICAgIHRpdGxlZCAiUENBIGFuZCB0aGUgI1RpZHlUdWVzZGF5IGJlc3QgaGlwIGhvcCBzb25ncyBldmVyIg0KDQojIFBhY2thZ2UgUmVmZXJlbmNlcw0KDQpgYGB7ciB3YXJuaW5nPUZBTFNFLCBtZXNzYWdlPVRSVUUsIHJlc3VsdHM9J2FzaXMnfQ0KcmVwb3J0OjpjaXRlX3BhY2thZ2VzKHNlc3Npb25JbmZvKCkpDQpgYGANCg==</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("index.Rmd");
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
